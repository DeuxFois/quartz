<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Chaîne de responsabilité permet de faire circuler des demandes dans une chaîne de handlers. Lorsqu’un handler reçoit une demande, il décide de la traiter ou de l’envoyer au handler suivant de la chaîne."><title>Chaîne de responsabilité / Chain of Responsibility</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://deuxfois.github.io/quartz//icon.png><link href=https://deuxfois.github.io/quartz/styles.b54f56dc7e7fdf6be9a4427dc6b0509b.min.css rel=stylesheet><link href=https://deuxfois.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://deuxfois.github.io/quartz/js/darkmode.69b2c08ae0f08c3a3f86259a122e1f06.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/util.39f53d45cb9520bdaf946bd063598b19.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://deuxfois.github.io/quartz/js/popover.37b1455b8f0603154072b9467132c659.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://deuxfois.github.io/quartz/",fetchData=Promise.all([fetch("https://deuxfois.github.io/quartz/indices/linkIndex.3b4e6d48a296906ef79bdbe4f350bfdc.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://deuxfois.github.io/quartz/indices/contentIndex.33f6c690fea153861f39111344cf2043.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const n=new URL(BASE_URL),s=n.pathname,o=window.location.pathname,i=s==o;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts();const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=i&&!0;drawGraph("https://deuxfois.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:2,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2}),initPopover("https://deuxfois.github.io/quartz",!0,!0)},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/deuxfois.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://deuxfois.github.io/quartz/js/full-text-search.0ec5fb908204b9e13989f2c640c0870b.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://deuxfois.github.io/quartz/>⛄ DeuxFoi's blog</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Chaîne de responsabilité / Chain of Responsibility</h1><p class=meta>Last updated
Aug 3, 2022
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/Architecture/Design-Pattern/Behavioral/Chaine_de_responsabilite.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://deuxfois.github.io/quartz/tags/behavioral/>Behavioral</a></li><li><a href=https://deuxfois.github.io/quartz/tags/design_pattern/>Design pattern</a></li></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#problème>Problème</a></li><li><a href=#solution>Solution</a></li><li><a href=#analogie>Analogie</a></li><li><a href=#structure>Structure</a></li><li><a href=#pseudo-code>Pseudo-code</a></li><li><a href=#possibilités-dapplication>Possibilités d’application</a></li><li><a href=#mise-en-œuvre>Mise en œuvre</a></li><li><a href=#avantages-et-inconvénients>Avantages et inconvénients</a></li><li><a href=#liens-avec-les-autres-patrons>Liens avec les autres patrons</a></li><li><a href=#exemples-de-code>Exemples de code</a><ol><li><a href=#soutenez-notre-site-gratuit-et-obtenez-lebook>Soutenez notre site gratuit et obtenez l’ebook !</a></li></ol></li></ol></nav></details></aside><p><strong>Chaîne de responsabilité</strong> permet de faire circuler des demandes dans une chaîne de handlers. Lorsqu’un handler reçoit une demande, il décide de la traiter ou de l’envoyer au handler suivant de la chaîne.</p><p><img src=https://deuxfois.github.io/quartz//../../_resources/chain-of-responsibility_e3977af6b53c43cb91ac291e68.png width=auto alt="Patron de conception chaîne de responsabilité"></p><a href=#problème><h2 id=problème><span class=hanchor arialabel=Anchor># </span>Problème</h2></a><p>Imaginez que vous travaillez sur un système de commandes en ligne. Vous voulez restreindre l’accès au système pour que seuls les utilisateurs authentifiés puissent créer des commandes. Les utilisateurs qui ont les autorisations administratives doivent avoir un accès total aux commandes.</p><p>Après un travail de préparation, vous vous rendez compte que ces étapes doivent être exécutées dans un ordre précis. L’application peut essayer d’authentifier un utilisateur auprès du système lorsqu’il reçoit une demande qui contient ses identifiants. Mais si ces derniers ne sont pas corrects et que l’authentification échoue, ce n’est pas la peine de lancer d’autres vérifications.</p><img width=600 height=0 src=../../_resources/problem1-fr_2b6f3e03a837497ab045090fadd23865.png><p>La demande doit d’abord passer par une série de vérifications avant que le système de commandes ne prenne le relais.</p><p>Pendant les mois qui ont suivi, vous avez mis en place plusieurs vérifications supplémentaires.</p><ul><li><p>Un de vos collègues vous a fait remarquer qu’il n’était pas très prudent envoyer des données brutes directement dans le système de commandes. Vous avez donc ajouté une étape de validation supplémentaire pour purger les données de la demande.</p></li><li><p>Plus tard, quelqu’un a découvert que le système de mot de passe était vulnérable aux attaques par force brute. Vous avez ajouté une étape qui filtre les échecs répétés provenant de la même adresse IP pour y remédier.</p></li><li><p>Quelqu’un d’autre vous a suggéré d’améliorer la vitesse du système en envoyant les résultats directement depuis le cache, lorsque des demandes répétées retournent les mêmes résultats. Vous avez donc implémenté une autre étape qui laisse la demande passer si le système ne trouve pas la réponse correspondante dans le cache.</p></li></ul><img width=610 height=0 src=../../_resources/problem2-fr_ab53831df60d48efb5c09c2e86ea36e6.png><p>Plus le code grossit et plus il devient moche et désordonné.</p><p>Le code des vérifications — qui n’était déjà pas très ordonné au départ — a grossi au fur et à mesure de l’ajout de nouvelles fonctionnalités. La modification d’une vérification affecte parfois les autres. Le pire dans tout cela, c’est qu’en voulant réutiliser les vérifications existantes pour protéger les autres composants du système, vous avez été obligé de dupliquer du code, car ces composants n’avaient pas besoin de toutes les étapes.</p><p>Le système est devenu très difficile à comprendre et cher à maintenir. Vous vous êtes débattu avec le code pendant un moment, jusqu’au jour où vous avez décidé de tout refaire.</p><a href=#solution><h2 id=solution><span class=hanchor arialabel=Anchor># </span>Solution</h2></a><p>Tout comme plusieurs patrons de conception comportementaux, la <strong>Chaîne de Responsabilité</strong> repose sur la transformation de comportements particuliers en objets autonomes que l’on appelle <em>handlers</em>. Dans notre cas, chaque étape doit être extraite de sa propre classe avec une seule méthode qui effectue la vérification. La demande est passée en paramètre de la méthode avec toutes ses données.</p><p>Le patron vous propose de relier ces handlers par une chaîne. Chaque handler stocke une référence vers le prochain handler de la chaîne dans l’un de ses attributs. En plus de traiter la demande, les handlers la font passer plus loin dans la chaîne. La demande fait le tour de la chaîne jusqu’à ce que tous les handlers aient eu l’occasion de la traiter.</p><p>Le mieux dans tout cela, c’est qu’un handler peut décider de ne pas envoyer la demande plus loin dans la chaîne et de mettre fin à son traitement.</p><p>Dans notre exemple du système de commandes, un handler effectue le traitement et décide s’il doit envoyer la demande plus loin dans la chaîne. Si la commande contient les bonnes données, les handlers peuvent exécuter leur traitement, qu’il s’agisse de l’authentification ou de la mise en cache.</p><img width=640 height=0 src=../../_resources/solution1-fr_2c09f38631634b428e610049835d75e5.png><p>Les handlers forment une chaîne.</p><p>Il existe une approche légèrement différente (un peu plus canonique) dans laquelle un handler décide s’il traite la demande dès sa réception. S’il peut la traiter, la demande n’ira pas plus loin. Dans ce cas de figure, un seul handler s’occupera de traiter la demande (ou aucun). C’est une approche classique utilisée dans les piles d’éléments d’une interface graphique (GUI).</p><p>Par exemple, lorsqu’un utilisateur clique sur un bouton, l’événement est propagé à travers la chaîne des éléments de la GUI. Cette chaîne débute par le bouton, continue avec ses conteneurs (les formulaires ou les panneaux) et se termine avec la fenêtre principale de l’application. L’événement est traité par le premier élément de la chaîne qui est en mesure de s’en occuper. Cet exemple est particulièrement intéressant, car il démontre qu’une chaîne peut toujours être extraite depuis une arborescence.</p><img width=520 height=0 src=../../_resources/solution2-fr_d10a18c7dd9b479aad998e00f22bce3f.png><p>Une chaîne peut être construite à partir de la branche d’une arborescence.</p><p>Les classes handler doivent toutes implémenter la même interface. Chaque handler concret ne se préoccupe que de l’existence d’une méthode <code>traiter</code> chez le handler suivant. Ainsi, vous pouvez créer vos chaînes à l’exécution et utiliser divers handlers sans coupler votre code à leurs classes concrètes.</p><a href=#analogie><h2 id=analogie><span class=hanchor arialabel=Anchor># </span>Analogie</h2></a><img width=600 height=0 src=../../_resources/chain-of-responsibility-comic-1-_c5e8e9e472674469a.png><p>Un appel au support technique passe par plusieurs opérateurs.</p><p>Vous venez juste d’installer un nouveau composant sur votre ordinateur. Comme vous êtes un geek, vous avez installé plusieurs systèmes d’exploitation. Vous essayez de tous les démarrer pour voir si votre matériel est bien pris en compte. Windows détecte votre nouveau composant et l’active automatiquement. En revanche, votre petit chouchou Linux refuse de le faire fonctionner. Avec un soupçon d’espoir, vous appelez le support technique dont le numéro est indiqué sur la boîte.</p><p>Votre premier interlocuteur n’est autre que la voix robotique du répondeur. Il vous propose neuf solutions à des problèmes classiques, mais aucun ne vous concerne. Au bout d’un moment, le robot vous redirige vers un opérateur humain.</p><p>Malheureusement, ce dernier ne vous répond rien de bien intéressant. Il ne cesse de répéter des extraits de son manuel et ignore vos commentaires. Après avoir entendu « avez-vous essayé de redémarrer votre ordinateur ? » pour la dixième fois, vous demandez à parler avec un vrai technicien.</p><p>Finalement, l’opérateur vous envoie vers un de leurs techniciens qui était probablement assis tout seul depuis des heures dans la salle des serveurs, située quelque part dans la cave sombre des bureaux de leur entreprise, et attendait avec impatience de pouvoir parler à quelqu’un. Le technicien vous indique un lien de téléchargement pour récupérer les bons pilotes et la marche à suivre pour les installer sur Linux. Enfin, la solution ! Vous mettez fin à l’appel, fou de joie !</p><a href=#structure><h2 id=structure><span class=hanchor arialabel=Anchor># </span>Structure</h2></a><img width=380 height=0 src=../../_resources/structure_882c6e30b4c74739a1396127e9473c35.png><ol><li><p>Le <strong>Handler</strong> déclare une interface commune pour tous les handlers concrets. En général, il ne comporte qu’une seule méthode pour gérer les demandes, mais il peut parfois en contenir une autre pour désigner le prochain handler de la chaîne.</p></li><li><p>Le <strong>Handler de Base</strong> est une classe facultative dans laquelle le code commun à tous les handlers peut être écrit.</p><p>En général, cette classe définit un attribut qui pointe vers le prochain handler. Les clients peuvent assembler une chaîne en passant un handler au constructeur ou au setter du handler précédent. La classe peut également implémenter le comportement par défaut d’un handler : il s’assure de l’existence du prochain handler, puis lui délègue le travail.</p></li><li><p>Les <strong>Handlers Concrets</strong> contiennent le code qui traite les demandes. Lors de la réception d’une demande, chaque handler décide s’il doit la traiter et s’il doit l’envoyer plus loin dans la chaîne.</p><p>Les handlers sont généralement autonomes et non modifiables, et n’accepteront qu’une seule fois les données nécessaires par le biais du constructeur.</p></li><li><p>Le <strong>Client</strong> peut créer les chaînes juste une fois ou les assembler dynamiquement en fonction de la logique métier. Notez bien que la demande initiale n’est pas obligatoirement envoyée au premier handler de la chaîne.</p></li></ol><a href=#pseudo-code><h2 id=pseudo-code><span class=hanchor arialabel=Anchor># </span>Pseudo-code</h2></a><p>Dans cet exemple, la <strong>Chaîne de responsabilité</strong> est chargée d’afficher l’aide contextuelle pour les éléments actifs de la GUI.</p><img width=610 height=0 src=../../_resources/example-fr_bf148181693642cda57a1fca3f25c67b.png><p>Les classes de la GUI sont construites à l’aide du patron composite. Chaque élément est relié à son conteneur. À n’importe quel moment, vous pouvez bâtir une chaîne d’éléments qui commence par l’élément lui-même et parcourt tous ses conteneurs.</p><p>La GUI de l’application prend généralement la forme d’une arborescence. Par exemple, la classe <code>Dialogue</code> qui s’occupe du rendu de la fenêtre principale de l’application, est la racine de l’arbre. La boîte de dialogue contient des <code>Panneaux</code>, qui peuvent eux-mêmes être composés d’autres panneaux ou d’éléments simples de plus bas niveau comme des <code>Boutons</code> et des <code>ChampsTexte</code>.</p><p>Un composant simple peut afficher brièvement des infobulles contextuelles si son texte d’aide a été configuré. Les composants plus complexes ont leur propre manière d’afficher l’aide contextuelle. Ils peuvent par exemple consulter l’aperçu du manuel ou ouvrir une page dans un navigateur.</p><img width=250 height=0 src=../../_resources/example2-fr_63388b8f09a34098a59dcffe55eeca9b.png><p>Voici comment une demande d’aide parcourt les objets de la GUI.</p><p>Si un utilisateur positionne le pointeur de sa souris sur un élément et appuie sur la touche <code>F1</code>, l’application détecte le composant situé sous le pointeur et lui envoie une demande d’aide. La demande remonte vers la surface en parcourant tous les conteneurs jusqu’à ce qu’elle atteigne un élément qui peut afficher les informations de l’aide.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// L’interface du handler déclare une méthode pour construire
</span></span><span class=line><span class=cl>// une chaîne de handlers. Elle déclare également une méthode
</span></span><span class=line><span class=cl>// pour exécuter la demande.
</span></span><span class=line><span class=cl>interface ComponentWithContextualHelp is
</span></span><span class=line><span class=cl>    method showHelp()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// La classe de base des composants simples.
</span></span><span class=line><span class=cl>abstract class Component implements ComponentWithContextualHelp is
</span></span><span class=line><span class=cl>    field tooltipText: string
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Le conteneur du composant agit comme le prochain maillon
</span></span><span class=line><span class=cl>    // de la chaîne des handlers.
</span></span><span class=line><span class=cl>    protected field container: Container
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Le composant affiche une infobulle si un texte d’aide y
</span></span><span class=line><span class=cl>    // est associé.  Sinon, il envoie l’appel vers le conteneur
</span></span><span class=line><span class=cl>    // (s’il existe).
</span></span><span class=line><span class=cl>    method showHelp() is
</span></span><span class=line><span class=cl>        if (tooltipText != null)
</span></span><span class=line><span class=cl>            // Affiche l’infobulle.
</span></span><span class=line><span class=cl>        else
</span></span><span class=line><span class=cl>            container.showHelp()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// Les conteneurs peuvent avoir des composants simples et
</span></span><span class=line><span class=cl>// d’autres conteneurs enfants. Les liens de la chaîne sont
</span></span><span class=line><span class=cl>// établis ici. La classe hérite du comportement de la méthode
</span></span><span class=line><span class=cl>// montrerAide (showHelp) de son parent.
</span></span><span class=line><span class=cl>abstract class Container extends Component is
</span></span><span class=line><span class=cl>    protected field children: array of Component
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    method add(child) is
</span></span><span class=line><span class=cl>        children.add(child)
</span></span><span class=line><span class=cl>        child.container = this
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// Les composants primitifs peuvent se contenter de l’aide par
</span></span><span class=line><span class=cl>// défaut...
</span></span><span class=line><span class=cl>class Button extends Component is
</span></span><span class=line><span class=cl>    // ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// Mais les composants complexes peuvent redéfinir
</span></span><span class=line><span class=cl>// l’implémentation par défaut. Si le texte d’aide ne peut être
</span></span><span class=line><span class=cl>// fourni d’une autre manière, le composant peut toujours
</span></span><span class=line><span class=cl>// appeler l’implémentation de base (se référer à la classe
</span></span><span class=line><span class=cl>// Composant).
</span></span><span class=line><span class=cl>class Panel extends Container is
</span></span><span class=line><span class=cl>    field modalHelpText: string
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    method showHelp() is
</span></span><span class=line><span class=cl>        if (modalHelpText != null)
</span></span><span class=line><span class=cl>            // Affiche une fenêtre modale avec le texte d’aide.
</span></span><span class=line><span class=cl>        else
</span></span><span class=line><span class=cl>            super.showHelp()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// ...idem qu’au-dessus...
</span></span><span class=line><span class=cl>class Dialog extends Container is
</span></span><span class=line><span class=cl>    field wikiPageURL: string
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    method showHelp() is
</span></span><span class=line><span class=cl>        if (wikiPageURL != null)
</span></span><span class=line><span class=cl>            // Ouvre la page wiki d’aide.
</span></span><span class=line><span class=cl>        else
</span></span><span class=line><span class=cl>            super.showHelp()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// Code client.
</span></span><span class=line><span class=cl>class Application is
</span></span><span class=line><span class=cl>    // Chaque application configure la chaîne différemment.
</span></span><span class=line><span class=cl>    method createUI() is
</span></span><span class=line><span class=cl>        dialog = new Dialog(&#34;Budget  Reports&#34;)
</span></span><span class=line><span class=cl>        dialog.wikiPageURL = &#34;http://...&#34;
</span></span><span class=line><span class=cl>        panel = new Panel(0, 0, 400, 800)
</span></span><span class=line><span class=cl>        panel.modalHelpText = &#34;This  panel  does...&#34;
</span></span><span class=line><span class=cl>        ok = new Button(250, 760, 50, 20, &#34;OK&#34;)
</span></span><span class=line><span class=cl>        ok.tooltipText = &#34;This  is  an  OK  button  that...&#34;
</span></span><span class=line><span class=cl>        cancel = new Button(320, 760, 50, 20, &#34;Cancel&#34;)
</span></span><span class=line><span class=cl>        // ...
</span></span><span class=line><span class=cl>        panel.add(ok)
</span></span><span class=line><span class=cl>        panel.add(cancel)
</span></span><span class=line><span class=cl>        dialog.add(panel)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Imaginez ce qui se passe ici.
</span></span><span class=line><span class=cl>    method onF1KeyPress() is
</span></span><span class=line><span class=cl>        component = this.getComponentAtMouseCoords()
</span></span><span class=line><span class=cl>        component.showHelp()
</span></span></code></pre></td></tr></table></div></div><a href=#possibilités-dapplication><h2 id=possibilités-dapplication><span class=hanchor arialabel=Anchor># </span>Possibilités d’application</h2></a><p>Utilisez la chaîne de responsabilité quand votre programme doit traiter des types de demandes variées de différentes manières, mais que leur type exact et leur ordre dans la chaîne ne sont pas connus à l’avance.</p><p>Ce patron vous permet de former une chaîne avec les handlers et d’interroger chacun d’entre eux lors de la réception de la demande afin de savoir s’ils peuvent la traiter. Chaque handler a ainsi l’opportunité de traiter la demande.</p><p>Utilisez ce patron si vos handlers doivent absolument respecter un ordre donné.</p><p>Comme vous pouvez définir les liens entre les handlers de la chaîne, les demandes la parcourront selon l’ordonnancement que vous avez configuré.</p><p>Utilisez la chaîne de responsabilité si l’ensemble des handlers et leur ordre dans la chaîne peuvent changer lors de l’exécution.</p><p>Si vous fournissez des setters à un attribut à l’intérieur d’une classe handler, vous serez en mesure d’ajouter, de retirer ou d’ordonner dynamiquement les handlers.</p><a href=#mise-en-œuvre><h2 id=mise-en-œuvre><span class=hanchor arialabel=Anchor># </span>Mise en œuvre</h2></a><ol><li><p>Déclarez l’interface du handler et la méthode qui gère les demandes.</p><p>Déterminez la manière dont le client passera les données de la demande dans la méthode. La manière la plus flexible consiste à convertir la demande en objet et à le passer en paramètre de la méthode.</p></li><li><p>Pour éviter la duplication du code de base dans les handlers concrets, il peut être utile de créer une classe abstraite de base pour le handler, dérivée de l’interface handler.</p><p>Cette classe doit posséder un attribut qui est une référence vers le prochain handler de la chaîne et vous devriez envisager de la rendre non modifiable. Mais si vous prévoyez de modifier les chaînes lors de l’exécution, vous devez définir des setters pour changer la valeur de l’attribut qui stocke les références.</p><p>Vous pouvez également mettre en place le comportement par défaut des méthodes des handlers qui consiste à envoyer la demande au prochain objet (s’il en reste). Les handlers concrets peuvent utiliser ce comportement en faisant appel à la méthode de leur parent.</p></li><li><p>Créez les sous-classes des handlers concrets une par une et mettez en place leurs traitements. Chaque handler doit prendre deux décisions lors de la réception d’une demande :</p><ul><li>Traiter ou non la demande.</li><li>Passer ou non la demande au handler suivant de la chaîne.</li></ul></li><li><p>Le client doit assembler lui-même les chaînes ou recevoir des chaînes pré construites via d’autres objets. Dans le dernier cas, vous devez mettre en place des fabriques pour assembler des chaînes selon la configuration ou selon les paramètres d’environnement.</p></li><li><p>Le client peut déclencher n’importe quel élément de la chaîne, pas forcément le premier. La demande continuera de parcourir la chaîne jusqu’à ce qu’un handler refuse de la laisser continuer, ou jusqu’à ce que l’on atteigne la fin de la chaîne.</p></li><li><p>La chaîne étant dynamique, le client doit être capable de gérer les scénarios suivants :</p><ul><li>La chaîne peut être composée d’un unique lien.</li><li>Certaines demandes n’iront pas jusqu’au bout de la chaîne.</li><li>Certaines demandes atteindront la fin de la chaîne sans être traitées.</li></ul></li></ol><a href=#avantages-et-inconvénients><h2 id=avantages-et-inconvénients><span class=hanchor arialabel=Anchor># </span>Avantages et inconvénients</h2></a><ul><li><p>Vous pouvez contrôler l’ordre des traitements de la demande.</p></li><li><p><em>Principe de responsabilité unique</em>. Vous pouvez découpler les classes qui appellent des traitements, de celles qui les exécutent.</p></li><li><p><em>Principe ouvert/fermé</em>. Vous pouvez ajouter de nouveaux handlers dans le programme sans toucher au code client existant.</p></li><li><p>Il se peut que certaines demandes ne soient pas traitées.</p></li></ul><a href=#liens-avec-les-autres-patrons><h2 id=liens-avec-les-autres-patrons><span class=hanchor arialabel=Anchor># </span>Liens avec les autres patrons</h2></a><ul><li>La
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility rel=noopener>Chaîne de responsabilité</a>, la
<a href=https://refactoring.guru/fr/design-patterns/command rel=noopener>Commande</a>, le
<a href=https://refactoring.guru/fr/design-patterns/mediator rel=noopener>Médiateur</a> et l’
<a href=https://refactoring.guru/fr/design-patterns/observer rel=noopener>Observateur</a> proposent différentes solutions pour associer les demandeurs et les récepteurs.<ul><li>La <em>chaîne de responsabilité</em> envoie une demande ordonnée qui est passée tout au long d’une chaîne dynamique de récepteurs potentiels, jusqu’à ce que l’un d’entre eux décide de la traiter.</li><li>La <em>commande</em> établit des connexions unidirectionnelles entre les demandeurs et les récepteurs.</li><li>Le <em>médiateur</em> élimine les liens directs entre les demandeurs et les récepteurs, et les force à communiquer indirectement via un objet médiateur.</li><li>L’<em>observateur</em> permet aux récepteurs de s’inscrire et de se désinscrire dynamiquement à la réception des demandes.</li></ul></li></ul><a href=#exemples-de-code><h2 id=exemples-de-code><span class=hanchor arialabel=Anchor># </span>Exemples de code</h2></a><p><a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/java/example rel=noopener><img width=43 height=56 src=../../_resources/java_140f00c0bd894be0a807878862a4cda5.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/csharp/example rel=noopener><img width=43 height=56 src=../../_resources/csharp_043fb932596e4b9a857b3ee31b90ec8d.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/cpp/example rel=noopener><img width=43 height=56 src=../../_resources/cpp_18bdf4c85a104dcb805b401f4ec66102.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/php/example rel=noopener><img width=43 height=56 src=../../_resources/php_616b603d17d54eed9f32fa09b7874a80.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/python/example rel=noopener><img width=43 height=56 src=../../_resources/python_245ab1ea89a44136936ecb95f29b1753.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/ruby/example rel=noopener><img width=43 height=56 src=../../_resources/ruby_fcdc0b9a13424c4bba99c78d232fffe0.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/swift/example rel=noopener><img width=43 height=56 src=../../_resources/swift_0a34cb28cc3f46fabcdec1c1c4ebe7a7.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/typescript/example rel=noopener><img width=43 height=56 src=../../_resources/typescript_a3e666b7d8494892b5375c1d8aa85dd2.svg></a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility/go/example rel=noopener><img width=43 height=56 src=../../_resources/go_983af88674f74cddbd88d71cdd43442e.svg></a></p><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener><img width=200 height=200 src=../../_resources/patterns-book-banner-3_40863b5ecae4401fb5f16b9e923.png></a></p><a href=#soutenez-notre-site-gratuit-et-obtenez-lebook><h3 id=soutenez-notre-site-gratuit-et-obtenez-lebook><span class=hanchor arialabel=Anchor># </span>Soutenez notre site gratuit et obtenez l’ebook !</h3></a><ul><li>22 patrons de conception et 8 principes expliqués en profondeur.</li><li>444 pages de vulgarisation, bien structurées et faciles à lire.</li><li>225 illustrations et diagrammes clairs pour aider à la compréhension.</li><li>Une archive avec des exemples de code dans 9 langages.</li><li>Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.</li></ul><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener>En savoir plus…</a></p><a href=#suivant><h4 id=suivant><span class=hanchor arialabel=Anchor># </span>Suivant</h4></a><p><a href=https://refactoring.guru/fr/design-patterns/command rel=noopener>Commande</a></p><a href=#retour><h4 id=retour><span class=hanchor arialabel=Anchor># </span>Retour</h4></a><p><a href=https://refactoring.guru/fr/design-patterns/behavioral-patterns rel=noopener>Patrons comportementaux</a></p><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener><img width=245 height=375 src=../../_resources/web-cover-fr_c852e245edb840aaaf28320736719d52.png></a></p><p>Cet article est tiré de notre ebook
<strong>Plongée au cœur des
PATRONS DE CONCEPTION</strong></p><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener>En savoir plus…</a></p><p>Facebook</p><p>Twitter</p><ul><li><a href="https://feedback.refactoring.guru/?lang=en&show_feedback_form_private=true" rel=noopener>Nous contacter</a></li><li><a href=https://refactoring.guru/fr/login rel=noopener>Connexion</a></li></ul><p><a href=https://refactoring.guru/design-patterns/chain-of-responsibility rel=noopener>English</a>
<a href=https://refactoring.guru/es/design-patterns/chain-of-responsibility rel=noopener>Español</a>
<a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility rel=noopener>Français</a>
<a href=https://refactoring.guru/pl/design-patterns/chain-of-responsibility rel=noopener>Polski</a>
<a href=https://refactoring.guru/pt-br/design-patterns/chain-of-responsibility rel=noopener>Português-Br</a>
<a href=https://refactoring.guru/ru/design-patterns/chain-of-responsibility rel=noopener>Русский</a>
<a href=https://refactoring.guru/uk/design-patterns/chain-of-responsibility rel=noopener>Українська</a>
<a href=https://refactoringguru.cn/design-patterns/chain-of-responsibility rel=noopener>中文</a></p><p><a href=https://refactoring.guru/fr rel=noopener><img src=https://deuxfois.github.io/quartz//../../_resources/logo-covid-winter_90a63c86904e4667974e8c2607737c5d.png width=auto alt=Refactoring.Guru></a></p><p><img src=https://deuxfois.github.io/quartz//../../_resources/winter-hat_81a8004335464afba8b37207a9b8cc89.png width=auto alt></p><ul><li><a href=https://refactoring.guru/fr/store rel=noopener>Contenu premium</a></li><li><a href=https://refactoring.guru/fr/design-patterns rel=noopener>Patrons de conception</a><ul><li><a href=https://refactoring.guru/fr/design-patterns/what-is-pattern rel=noopener>Introduction</a></li><li><a href=https://refactoring.guru/fr/design-patterns/catalog rel=noopener>Catalogue</a></li><li><a href=https://refactoring.guru/fr/design-patterns/creational-patterns rel=noopener>Patrons de création</a></li><li><a href=https://refactoring.guru/fr/design-patterns/structural-patterns rel=noopener>Patrons structurels</a></li><li><a href=https://refactoring.guru/fr/design-patterns/behavioral-patterns rel=noopener>Patrons comportementaux</a><ul><li><a href=https://refactoring.guru/fr/design-patterns/chain-of-responsibility rel=noopener>Chaîne de responsabilité</a></li><li><a href=https://refactoring.guru/fr/design-patterns/command rel=noopener>Commande</a></li><li><a href=https://refactoring.guru/fr/design-patterns/iterator rel=noopener>Itérateur</a></li><li><a href=https://refactoring.guru/fr/design-patterns/mediator rel=noopener>Médiateur</a></li><li><a href=https://refactoring.guru/fr/design-patterns/memento rel=noopener>Mémento</a></li><li><a href=https://refactoring.guru/fr/design-patterns/observer rel=noopener>Observateur</a></li><li><a href=https://refactoring.guru/fr/design-patterns/state rel=noopener>État</a></li><li><a href=https://refactoring.guru/fr/design-patterns/strategy rel=noopener>Stratégie</a></li><li><a href=https://refactoring.guru/fr/design-patterns/template-method rel=noopener>Patron de méthode</a></li><li><a href=https://refactoring.guru/fr/design-patterns/visitor rel=noopener>Visiteur</a></li></ul></li><li><a href=https://refactoring.guru/fr/design-patterns/examples rel=noopener>Exemples de code</a></li></ul></li><li><a href=https://refactoring.guru/fr/refactoring rel=noopener>Refactorisation (commenter bientôt)</a></li></ul><p><a href=https://refactoring.guru/fr/login rel=noopener>Connexion</a>
<a href="https://feedback.refactoring.guru/?lang=en" rel=noopener>Nous contacter</a></p><ul><li><a href=https://refactoring.guru/fr rel=noopener>Accueil</a></li><li><a href=https://refactoring.guru/fr/refactoring rel=noopener>Refactorisation</a></li><li><a href=https://refactoring.guru/fr/design-patterns rel=noopener>Patrons de conception</a></li><li><a href=https://refactoring.guru/fr/store rel=noopener>Contenu premium</a></li><li><a href="https://feedback.refactoring.guru/?lang=en" rel=noopener>Forum</a></li><li><a href="https://feedback.refactoring.guru/?lang=en&show_feedback_form_private=true" rel=noopener>Nous contacter</a></li></ul><p>2014-2021
<a href=https://refactoring.guru/fr rel=noopener>Refactoring.Guru</a>. Tous droits réservés.
<img src=https://deuxfois.github.io/quartz//../../_resources/fa-building_d1487c45b2994584a7b23849aa9fa577.svg width=auto alt="Organization address"> Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305
Email:
<a rel=noopener class="internal-link broken" data-src=mailto:support@refactoring.guru>support@refactoring.guru</a></p><p>Illustrations par
<a href=http://zhart.us/ rel=noopener>Dmitry Zhart</a></p><ul><li><a href=https://refactoring.guru/fr/terms rel=noopener>Termes et conditions</a></li><li><a href=https://refactoring.guru/fr/privacy-policy rel=noopener>Politique de protection de la vie privée</a></li><li><a href=https://refactoring.guru/fr/content-usage-policy rel=noopener>Politique de l’utilisation des données</a></li></ul></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://deuxfois.github.io/quartz/js/graph.243ea0d4fc79317e06f846bd698ba136.js></script></div></div><div id=contact_buttons><footer><p>Made by DeuxFois using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2022</p><ul><li><a href=https://deuxfois.github.io/quartz/>Home</a></li><li><a href=https://twitter.com/_jzhao>Twitter</a></li><li><a href=https://github.com/jackyzha0>Github</a></li></ul></footer></div></div></body></html>