<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Fabrique définit une interface pour créer des objets dans une classe mère, mais délègue le choix des types d’objets à créer aux sous-classes."><title>Fabrique / Factory Method</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://deuxfois.github.io/quartz//icon.png><link href=https://deuxfois.github.io/quartz/styles.b54f56dc7e7fdf6be9a4427dc6b0509b.min.css rel=stylesheet><link href=https://deuxfois.github.io/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://deuxfois.github.io/quartz/js/darkmode.69b2c08ae0f08c3a3f86259a122e1f06.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/util.39f53d45cb9520bdaf946bd063598b19.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script src=https://unpkg.com/@floating-ui/core@0.7.3></script>
<script src=https://unpkg.com/@floating-ui/dom@0.5.4></script>
<script src=https://deuxfois.github.io/quartz/js/popover.37b1455b8f0603154072b9467132c659.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/code-title.b35124ad8db0ba37162b886afb711cbc.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/clipboard.c20857734e53a3fb733b7443879efa61.min.js></script>
<script src=https://deuxfois.github.io/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const BASE_URL="https://deuxfois.github.io/quartz/",fetchData=Promise.all([fetch("https://deuxfois.github.io/quartz/indices/linkIndex.3b4e6d48a296906ef79bdbe4f350bfdc.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://deuxfois.github.io/quartz/indices/contentIndex.8c379164d481b4535372d62b3f21de15.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const n=new URL(BASE_URL),s=n.pathname,o=window.location.pathname,i=s==o;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts();const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=i&&!0;drawGraph("https://deuxfois.github.io/quartz",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:2,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2}),initPopover("https://deuxfois.github.io/quartz",!0,!0)},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/deuxfois.github.io\/quartz\/js\/router.9d4974281069e9ebb189f642ae1e3ca2.min.js"
    attachSPARouting(init, render)
  </script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-XYFD95KB4J"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-XYFD95KB4J",{anonymize_ip:!1})}</script><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://deuxfois.github.io/quartz/js/full-text-search.0ec5fb908204b9e13989f2c640c0870b.min.js></script><div class=singlePage><header><h1 id=page-title><a href=https://deuxfois.github.io/quartz/>⛄ DeuxFoi's blog</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Fabrique / Factory Method</h1><p class=meta>Last updated
Aug 4, 2022
<a href=https://github.com/jackyzha0/quartz/tree/hugo/content/Architecture/Design-Pattern/Creation/Fabrique.md rel=noopener>Edit Source</a></p><ul class=tags><li><a href=https://deuxfois.github.io/quartz/tags/cr%C3%A9ation/>Création</a></li><li><a href=https://deuxfois.github.io/quartz/tags/design_pattern/>Design pattern</a></li></ul><aside class=mainTOC><details open><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#problème>Problème</a></li><li><a href=#solution>Solution</a></li><li><a href=#structure>Structure</a></li><li><a href=#pseudo-code>Pseudo-code</a></li><li><a href=#possibilités-dapplication>Possibilités d’application</a></li><li><a href=#mise-en-œuvre>Mise en œuvre</a></li><li><a href=#avantages-et-inconvénients>Avantages et inconvénients</a></li><li><a href=#liens-avec-les-autres-patrons>Liens avec les autres patrons</a></li><li><a href=#exemples-de-code>Exemples de code</a></li><li><a href=#informations-supplémentaires>Informations supplémentaires</a><ol><li><a href=#pourquoi-acheter-le-meilleur-ebook-sur-les-patrons-de-conception>Pourquoi acheter le meilleur ebook sur les patrons de conception ?</a></li></ol></li></ol></nav></details></aside><p><strong>Fabrique</strong> définit une interface pour créer des objets dans une classe mère, mais délègue le choix des types d’objets à créer aux sous-classes.</p><p><img src=https://deuxfois.github.io/quartz//../../_resources/factory-method-fr_9c56a2cdc750461b87b42d9376b693b6.png width=auto alt="Patron de conception fabrique"></p><a href=#problème><h2 id=problème><span class=hanchor arialabel=Anchor># </span>Problème</h2></a><p>Imaginez que vous êtes en train de créer une application de gestion logistique. La première version de votre application ne propose que le transport par camion, la majeure partie de votre code est donc située dans la classe <code>Camion</code>.</p><p>Au bout d’un certain temps, votre application devient populaire et de nombreuses entreprises de transport maritime vous demandent tous les jours d’ajouter la gestion de la logistique maritime dans l’application.</p><p><img src=https://deuxfois.github.io/quartz//../../_resources/problem1-fr_a873b3fd38d5498d8740634f75bb5234.png width=auto alt="Ajouter un nouveau moyen de transport au programme peut créer des problèmes"></p><p>L’ajout d’une nouvelle classe au programme ne s’avère pas si simple que cela si le reste du code est déjà couplé aux classes existantes.</p><p>C’est super, n’est-ce pas ? Mais qu’en est-il du code ? La majeure partie est actuellement couplée à la classe <code>Camion</code>. Pour pouvoir ajouter des <code>Bateaux</code> dans l’application, il faudrait revoir la base du code. De plus, si vous décidez plus tard d’ajouter un autre type de transport dans l’application, il faudra effectuer à nouveau ces changements.</p><p>Par conséquent, vous allez vous retrouver avec du code pas très propre, rempli de conditions qui modifient le comportement du programme en fonction de la classe des objets de transport.</p><a href=#solution><h2 id=solution><span class=hanchor arialabel=Anchor># </span>Solution</h2></a><p>Le patron de conception fabrique vous propose de remplacer les appels directs au constructeur de l’objet (à l’aide de l’opérateur <code>new</code>) en appelant une méthode <em>fabrique</em> spéciale. Pas d’inquiétude, les objets sont toujours créés avec l’opérateur <code>new</code>, mais l’appel se fait à l’intérieur de la méthode fabrique. Les objets qu’elle retourne sont souvent appelés <em>produits</em>.</p><img width=620 height=0 src=../../_resources/solution1_44f9615333de43fc97f87e11a9f1a8cd.png class=jop-noMdConv><p>Les sous-classes peuvent modifier les classes des objets retournés par la méthode fabrique.</p><p>À première vue, cette modification peut sembler inutile : nous avons juste déplacé l’appel du constructeur dans une autre partie du programme. Mais maintenant, vous pouvez redéfinir la méthode fabrique dans la sous-classe et changer la classe des produits créés par la méthode.</p><p>Il y a tout de même une petite limitation : les sous-classes peuvent retourner des produits différents seulement si les produits ont une classe de base ou une interface commune. De plus, cette interface doit être le type retourné par la méthode fabrique de la classe de base.</p><img width=490 height=0 src=../../_resources/solution2-fr_9a42a67615c444a2965ec7d6a7e81bae.png class=jop-noMdConv><p>Les produits doivent tous implémenter la même interface.</p><p>Par exemple, les classes <code>Camion</code> et <code>Bateau</code> doivent toutes les deux implémenter l’interface <code>Transport</code>, qui déclare une méthode <code>livrer</code>. Chaque classe implémente cette méthode à sa façon : les camions livrent par la route et les bateaux livrent par la mer. La méthode fabrique de la classe <code>LogistiqueRoute</code> retourne des camions, alors que celle de la classe <code>LogistiqueMer</code> retourne des bateaux.</p><img width=640 height=0 src=../../_resources/solution3-fr_3300314049144fdb8f4dc77ef85e2372.png class=jop-noMdConv><p>Tant que les classes produit implémentent une interface commune, vous pouvez passer leurs objets au code client sans tout faire planter.</p><p>Le code qui appelle la méthode fabrique (souvent appelé le code <em>client</em>) ne fait pas la distinction entre les différents produits concrets retournés par les sous-classes, il les considère tous comme des <code>Transports</code> abstraits. Le client sait que tous les objets transportés sont censés avoir une méthode <code>livrer</code>, mais son fonctionnement lui importe peu.</p><a href=#structure><h2 id=structure><span class=hanchor arialabel=Anchor># </span>Structure</h2></a><img width=660 height=0 src=../../_resources/structure_ea59814269984a5bbd1765404b5273ef.png class=jop-noMdConv><ol><li><p>L’interface est déclarée par le <strong>Produit</strong> et est commune à tous les objets qui peuvent être conçus par le créateur et ses sous-classes.</p></li><li><p>Les <strong>Produits Concrets</strong> sont différentes implémentations de l’interface produit.</p></li><li><p>La méthode fabrique est déclarée par la classe <strong>Créateur</strong> et retourne les nouveaux produits. Il est important que son type de retour concorde avec l’interface produit.</p><p>Vous pouvez rendre la méthode fabrique abstraite afin d’obliger ses sous-classes à implémenter leur propre version de la méthode ou vous pouvez modifier la méthode fabrique de la classe de base afin qu’elle retourne un type de produit par défaut.</p><p>Il faut bien comprendre que malgré son nom, la création de produits n’est <strong>pas</strong> la responsabilité principale du créateur. La classe créateur a en général déjà un fonctionnement propre lié à la nature de ses produits. La fabrique aide à découpler cette logique des produits concrets. C’est un peu comme une grande entreprise de développement de logiciels : elle peut posséder un département spécialisé dans la formation des développeurs, mais son activité principale reste d’écrire du code, pas de produire des développeurs.</p></li><li><p>Les <strong>Créateurs Concrets</strong> redéfinissent la méthode fabrique de la classe de base afin de pouvoir retourner les différents types de produits.</p><p>Notez toutefois que la méthode fabrique n’est pas obligée de <strong>créer</strong> tout le temps de nouvelles instances. Elle peut retourner des objets depuis un cache, un réservoir d’objets ou une autre source.</p></li></ol><a href=#pseudo-code><h2 id=pseudo-code><span class=hanchor arialabel=Anchor># </span>Pseudo-code</h2></a><p>Cet exemple montre comment la <strong>fabrique</strong> peut être utilisée pour créer des éléments d’une UI (interface utilisateur) multiplateforme sans coupler le code client aux classes concrètes de l’UI.</p><img width=640 height=0 src=../../_resources/example_c9ed934b5f524674b583512946494426.png class=jop-noMdConv><p>Exemple multiplateforme pour une boîte de dialogue.</p><p>La classe de base dialogue utilise différents éléments d’UI pour le rendu de ses fenêtres. Ces éléments peuvent un peu varier en fonction du système d’exploitation, mais ils doivent garder le même comportement. Un bouton sous Windows est aussi un bouton sous Linux.</p><p>Lorsque la fabrique entre dans l’équation, il est inutile de réécrire la logique de la boîte de dialogue pour chaque système d’exploitation. Si nous déclarons une méthode fabrique qui crée des boutons à l’intérieur de la classe de base dialogue, nous pourrons par la suite sous-classer cette dernière afin que la méthode fabrique retourne des boutons dotés du style Windows. La sous-classe hérite alors du code de la classe de base dialogue, mais grâce à la fabrique, elle est capable d’afficher à l’écran des boutons à l’allure Windows.</p><p>Pour le bon fonctionnement de ce patron, la classe de base dialogue doit utiliser des boutons abstraits représentés par une classe de base ou une interface dont tous les boutons concrets hériteront. Ainsi, quel que soit le type de boutons, le code de la classe dialogue reste fonctionnel.</p><p>Bien sûr, cette approche fonctionne également avec les autres éléments de l’UI. Cependant, chaque nouvelle méthode fabrique ajoutée à Dialogue nous rapproche du patron de conception
<a href=https://refactoring.guru/fr/design-patterns/abstract-factory rel=noopener>Fabrique abstraite</a>. Pas de panique, nous aborderons ce patron plus tard !</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// La classe créateur déclare la méthode fabrique qui doit
</span></span><span class=line><span class=cl>// renvoyer un objet de la classe produit. Les sous-classes du
</span></span><span class=line><span class=cl>// créateur fournissent en général une implémentation de cette
</span></span><span class=line><span class=cl>// méthode.
</span></span><span class=line><span class=cl>class Dialog is
</span></span><span class=line><span class=cl>    // Le créateur peut également fournir des implémentations
</span></span><span class=line><span class=cl>    // par défaut de la méthode fabrique.
</span></span><span class=line><span class=cl>    abstract method createButton():Button
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Ne vous laissez pas berner par son nom, la responsabilité
</span></span><span class=line><span class=cl>    // principale du créateur n’est pas de fabriquer des
</span></span><span class=line><span class=cl>    // produits. Il héberge en général de la logique métier qui
</span></span><span class=line><span class=cl>    // concerne les produits retournés par la méthode fabrique.
</span></span><span class=line><span class=cl>    // Les sous-classes peuvent modifier indirectement cette
</span></span><span class=line><span class=cl>    // logique métier en redéfinissant la méthode fabrique et en
</span></span><span class=line><span class=cl>    // lui faisant retourner un type de produit différent.
</span></span><span class=line><span class=cl>    method render() is
</span></span><span class=line><span class=cl>        // Appelle la méthode fabrique pour créer un objet
</span></span><span class=line><span class=cl>        // Produit.
</span></span><span class=line><span class=cl>        Button okButton = createButton()
</span></span><span class=line><span class=cl>        // Utilise le produit.
</span></span><span class=line><span class=cl>        okButton.onClick(closeDialog)
</span></span><span class=line><span class=cl>        okButton.render()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// Les créateurs concrets redéfinissent la méthode fabrique pour
</span></span><span class=line><span class=cl>// changer le type du produit qui en résulte.
</span></span><span class=line><span class=cl>class WindowsDialog extends Dialog is
</span></span><span class=line><span class=cl>    method createButton():Button is
</span></span><span class=line><span class=cl>        return new WindowsButton()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class WebDialog extends Dialog is
</span></span><span class=line><span class=cl>    method createButton():Button is
</span></span><span class=line><span class=cl>        return new HTMLButton()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// L’interface du produit déclare les traitements que tous les
</span></span><span class=line><span class=cl>// produits concrets doivent implémenter.
</span></span><span class=line><span class=cl>interface Button is
</span></span><span class=line><span class=cl>    method render()
</span></span><span class=line><span class=cl>    method onClick(f)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// Les produits concrets fournissent diverses implémentations de
</span></span><span class=line><span class=cl>// l’interface du produit.
</span></span><span class=line><span class=cl>class WindowsButton implements Button is
</span></span><span class=line><span class=cl>    method render(a, b) is
</span></span><span class=line><span class=cl>        // Affiche un bouton avec le style Windows.
</span></span><span class=line><span class=cl>    method onClick(f) is
</span></span><span class=line><span class=cl>        // Attribue un événement sur un clic natif dans un
</span></span><span class=line><span class=cl>        // système d’exploitation.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class HTMLButton implements Button is
</span></span><span class=line><span class=cl>    method render(a, b) is
</span></span><span class=line><span class=cl>        // Retourne une représentation HTML d’un bouton.
</span></span><span class=line><span class=cl>    method onClick(f) is
</span></span><span class=line><span class=cl>        // Attribue un événement sur un clic dans un navigateur
</span></span><span class=line><span class=cl>        // Internet.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class Application is
</span></span><span class=line><span class=cl>    field dialog: Dialog
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // L’application choisit un type de créateur en fonction de
</span></span><span class=line><span class=cl>    // la configuration actuelle ou des paramètres
</span></span><span class=line><span class=cl>    // d’environnement.
</span></span><span class=line><span class=cl>    method initialize() is
</span></span><span class=line><span class=cl>        config = readApplicationConfigFile()
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        if (config.OS == &#34;Windows&#34;) then
</span></span><span class=line><span class=cl>            dialog = new WindowsDialog()
</span></span><span class=line><span class=cl>        else if (config.OS == &#34;Web&#34;) then
</span></span><span class=line><span class=cl>            dialog = new WebDialog()
</span></span><span class=line><span class=cl>        else
</span></span><span class=line><span class=cl>            throw new Exception(&#34;Error!  Unknown  operating  system.&#34;)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Le code client manipule une instance d’un créateur
</span></span><span class=line><span class=cl>    // concret, mais uniquement au moyen de son interface de
</span></span><span class=line><span class=cl>    // base. Tant que le client continue de passer par cette
</span></span><span class=line><span class=cl>    // interface pour manipuler le créateur, vous pouvez passer
</span></span><span class=line><span class=cl>    // n’importe quelle sous-classe du créateur.
</span></span><span class=line><span class=cl>    method main() is
</span></span><span class=line><span class=cl>        this.initialize()
</span></span><span class=line><span class=cl>        dialog.render()
</span></span></code></pre></td></tr></table></div></div><a href=#possibilités-dapplication><h2 id=possibilités-dapplication><span class=hanchor arialabel=Anchor># </span>Possibilités d’application</h2></a><p>Utilisez la fabrique si vous ne connaissez pas à l’avance les types et dépendances précis des objets que vous allez utiliser dans votre code.</p><p>La fabrique effectue une séparation entre le code du constructeur et le code qui utilise réellement le produit. Le code du constructeur devient ainsi plus évolutif et indépendant du reste du code.</p><p>Par exemple, si vous voulez ajouter un nouveau produit dans l’application, il vous suffit d’ajouter une sous-classe de création et d’y redéfinir la méthode fabrique.</p><p>Utilisez la fabrique si vous voulez mettre à disposition une librairie ou un framework pour vos utilisateurs avec un moyen d’étendre ses composants internes.</p><p>L’héritage est probablement le moyen le plus simple pour étendre le comportement par défaut d’une librairie ou d’un framework. Mais comment le framework peut-il savoir qu’il doit utiliser votre sous-classe plutôt qu’un composant standard ?</p><p>La solution est de réunir dans une seule méthode fabrique le code qui construit les composants dans le framework, et non seulement d’étendre ceux-ci, mais de laisser la possibilité de redéfinir la méthode fabrique.</p><p>Voyons un exemple d’utilisation. Imaginez la conception d’une application qui utilise un framework d’UI open source. Vous désirez utiliser des boutons ronds, mais le framework ne fournit que des boutons carrés. Vous étendez le <code>Bouton</code> standard avec une magnifique sous-classe <code>BoutonRond</code>. Mais vous devez à présent expliquer à la classe principale <code>UIFramework</code> qu’elle doit utiliser la sous-classe du nouveau bouton plutôt que celle par défaut.</p><p>Pour ce faire, vous créez une sous-classe <code>UIAvecBoutonsRonds</code> depuis une classe de base du framework et redéfinissez sa méthode <code>créerBouton</code>. Même si la méthode de la classe de base retourne des <code>Boutons</code>, votre sous-classe renvoie des <code>BoutonsRonds</code>. Vous pouvez dorénavant utiliser <code>UIAvecBoutonsRonds</code> à la place de <code>UIFramework</code>. Et c’est à peu près tout !</p><p>Utilisez la fabrique lorsque vous voulez économiser des ressources système en réutilisant des objets au lieu d’en construire de nouveaux.</p><p>Le besoin se présente souvent lorsque l’on utilise des objets qui prennent beaucoup de ressources tels que des bases de données, des systèmes de fichiers ou des ressources réseau.</p><p>Que faut-il pour réutiliser un objet existant ?</p><ol><li>Tout d’abord, vous devez créer un moyen de stockage afin de garder la trace de tous les objets créés.</li><li>Lorsqu’un nouvel objet est demandé, le programme doit chercher un objet libre dans cette réserve.</li><li>… et le renvoyer au code client.</li><li>Si aucun objet n’est disponible, le programme en crée un nouveau (et l’ajoute à la réserve).</li></ol><p>Cela représente un paquet de code ! De plus, il faut tout mettre au même endroit afin de ne pas polluer le code avec des doublons.</p><p>Il serait probablement plus pratique de l’écrire dans le constructeur de la classe de l’objet que l’on veut réutiliser, mais par définition, un constructeur doit toujours renvoyer de <strong>nouveaux objets</strong>. Il ne peut pas retourner des instances existantes.</p><p>C’est pourquoi vous devez disposer d’une méthode non seulement capable de créer de nouveaux objets, mais aussi de réutiliser ceux qui existent déjà. Cela ressemble énormément à un patron de conception fabrique.</p><a href=#mise-en-œuvre><h2 id=mise-en-œuvre><span class=hanchor arialabel=Anchor># </span>Mise en œuvre</h2></a><ol><li><p>Implémentez la même interface pour tous les produits. Cette interface doit déclarer des méthodes que tous les produits peuvent avoir en commun.</p></li><li><p>Ajoutez une méthode fabrique vide à l’intérieur de la classe créateur. Le type de retour de la méthode doit correspondre à l’interface commune des produits.</p></li><li><p>Localisez toutes les références aux constructeurs des produits dans le code du créateur. Remplacez-les une par une par des appels à la méthode fabrique et déplacez le code de la création de produits dans la méthode fabrique.</p><p>Vous allez peut-être devoir ajouter un paramètre temporaire à la méthode fabrique pour vérifier le type du produit retourné.</p><p>À ce stade, le code de la méthode fabrique peut paraître désordonné. Il pourrait même contenir un gros <code>switch</code> qui choisit la classe à instancier. Ne vous inquiétez pas, tout va bientôt rentrer dans l’ordre.</p></li><li><p>Pour chaque type de produit listé dans la méthode fabrique, créez une sous-classe de Créateur. Redéfinissez la méthode fabrique dans les sous-classes et récupérez les morceaux de code appropriés de la méthode de base.</p></li><li><p>S’il y a trop de types de produits et peu d’intérêt de créer des sous-classes pour tous, vous pouvez réutiliser le paramètre de contrôle de la classe de base dans les sous-classes.</p><p>Imaginons la hiérarchie de classes suivante : la classe de base <code>Courrier</code> avec les sous-classes <code>CourrierAérien</code> et <code>CourrierTerrestre</code> ; les classes de <code>Transport</code> sont <code>Avion</code>, <code>Camion</code> et <code>Train</code>. La classe <code>CourrierAérien</code> n’utilise que des <code>Avions</code> et la classe <code>CourrierTerrestre</code> peut utiliser à la fois des <code>Camions</code> et des <code>Trains</code>. Vous pouvez créer une nouvelle sous-classe (<code>CourrierFerroviaire</code> par exemple) pour gérer les deux cas, mais il y a une autre possibilité. Le code client peut passer un argument à la méthode fabrique du <code>CourrierTerrestre</code> pour désigner le type de produit qu’elle veut recevoir.</p></li><li><p>Si après tous ces changements la méthode fabrique de base est devenue complètement vide, vous pouvez la rendre abstraite. S’il reste encore quelques lignes, vous pouvez y laisser un comportement par défaut.</p></li></ol><a href=#avantages-et-inconvénients><h2 id=avantages-et-inconvénients><span class=hanchor arialabel=Anchor># </span>Avantages et inconvénients</h2></a><ul><li><p>Vous désolidarisez le Créateur des produits concrets.</p></li><li><p><em>Principe de responsabilité unique</em>. Vous pouvez déplacer tout le code de création des produits au même endroit, permettant ainsi une meilleure maintenabilité.</p></li><li><p><em>Principe ouvert/fermé</em>. Vous pouvez ajouter de nouveaux types de produits dans le programme sans endommager l’existant.</p></li><li><p>Le code peut devenir plus complexe puisque vous devez introduire de nombreuses sous-classes pour la mise en place du patron. La condition optimale d’intégration du patron dans du code existant se présente lorsque vous avez déjà une hiérarchie existante de classes de création.</p></li></ul><a href=#liens-avec-les-autres-patrons><h2 id=liens-avec-les-autres-patrons><span class=hanchor arialabel=Anchor># </span>Liens avec les autres patrons</h2></a><ul><li><p>La
<a href=https://refactoring.guru/fr/design-patterns/factory-method rel=noopener>Fabrique</a> est souvent utilisée dès le début de la conception (moins compliquée et plus personnalisée grâce aux sous-classes) et évolue vers la
<a href=https://refactoring.guru/fr/design-patterns/abstract-factory rel=noopener>Fabrique abstraite</a>, le
<a href=https://refactoring.guru/fr/design-patterns/prototype rel=noopener>Prototype</a>, ou le
<a href=https://refactoring.guru/fr/design-patterns/builder rel=noopener>Monteur</a> (ce dernier étant plus flexible, mais plus compliqué).</p></li><li><p>Les classes
<a href=https://refactoring.guru/fr/design-patterns/abstract-factory rel=noopener>Fabrique abstraite</a> sont souvent basées sur un ensemble de
<a href=https://refactoring.guru/fr/design-patterns/factory-method rel=noopener>Fabriques</a>, mais vous pouvez également utiliser le
<a href=https://refactoring.guru/fr/design-patterns/prototype rel=noopener>Prototype</a> pour écrire leurs méthodes.</p></li><li><p>Vous pouvez utiliser la
<a href=https://refactoring.guru/fr/design-patterns/factory-method rel=noopener>Fabrique</a> avec l’
<a href=https://refactoring.guru/fr/design-patterns/iterator rel=noopener>Itérateur</a> pour permettre aux sous-classes des collections de renvoyer différents types d’itérateurs compatibles avec les collections.</p></li><li><p>Le
<a href=https://refactoring.guru/fr/design-patterns/prototype rel=noopener>Prototype</a> n’est pas basé sur l’héritage, il n’a donc pas ses désavantages. Mais le <em>prototype</em> requiert une initialisation compliquée pour l’objet cloné. La
<a href=https://refactoring.guru/fr/design-patterns/factory-method rel=noopener>Fabrique</a> est basée sur l’héritage, mais n’a pas besoin d’une étape d’initialisation.</p></li><li><p>La
<a href=https://refactoring.guru/fr/design-patterns/factory-method rel=noopener>Fabrique</a> est une spécialisation du
<a href=https://refactoring.guru/fr/design-patterns/template-method rel=noopener>Patron de méthode</a>. Une <em>fabrique</em> peut aussi faire office d’étape dans un grand <em>patron de méthode</em>.</p></li></ul><a href=#exemples-de-code><h2 id=exemples-de-code><span class=hanchor arialabel=Anchor># </span>Exemples de code</h2></a><p><a href=https://refactoring.guru/fr/design-patterns/factory-method/java/example rel=noopener><img width=43 height=56 src=../../_resources/java_1666917d9f7b4795bbd0828f9a8922d5.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/csharp/example rel=noopener><img width=43 height=56 src=../../_resources/csharp_3589127d5ded41e2b3d2f042272d3475.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/cpp/example rel=noopener><img width=43 height=56 src=../../_resources/cpp_c933f58693144fa2b796247f044dd55c.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/php/example rel=noopener><img width=43 height=56 src=../../_resources/php_ff2e08f607734ec7905a6dac659da652.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/python/example rel=noopener><img width=43 height=56 src=../../_resources/python_996d21f6666a412dbd5faeacdcbfbb91.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/ruby/example rel=noopener><img width=43 height=56 src=../../_resources/ruby_8fa68619e414414f98c396d6b55ffd1c.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/swift/example rel=noopener><img width=43 height=56 src=../../_resources/swift_3b34a780eb184f3ab4067d01702cb2db.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/typescript/example rel=noopener><img width=43 height=56 src=../../_resources/typescript_4fd75f2958254c28a762da282531cfa0.svg class=jop-noMdConv></a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method/go/example rel=noopener><img width=43 height=56 src=../../_resources/go_028710c23fb7445bac4202cd4de706c2.svg class=jop-noMdConv></a></p><a href=#informations-supplémentaires><h2 id=informations-supplémentaires><span class=hanchor arialabel=Anchor># </span>Informations supplémentaires</h2></a><ul><li>Lisez notre
<a href=https://refactoring.guru/fr/design-patterns/factory-comparison rel=noopener>Comparaison des fabriques</a> si vous peinez à saisir la nuance entre les différents concepts et patrons.</li></ul><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener>Votre navigateur ne peut pas lire les vidéos HTML.</a></p><a href=#pourquoi-acheter-le-meilleur-ebook-sur-les-patrons-de-conception><h3 id=pourquoi-acheter-le-meilleur-ebook-sur-les-patrons-de-conception><span class=hanchor arialabel=Anchor># </span>Pourquoi acheter le meilleur ebook sur les patrons de conception ?</h3></a><ul><li>Admettons-le : lire un site Internet n’est pas très amusant.</li><li>Soyez productifs dans les transports en commun.</li><li>Apprenez de nouvelles choses tout en vous reposant sur votre canapé.</li><li>Rempli d’exemples de code très utiles en POO.</li><li>Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.</li></ul><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener>En savoir plus…</a></p><a href=#suivant><h4 id=suivant><span class=hanchor arialabel=Anchor># </span>Suivant</h4></a><p><a href=https://refactoring.guru/fr/design-patterns/abstract-factory rel=noopener>Fabrique abstraite</a></p><a href=#retour><h4 id=retour><span class=hanchor arialabel=Anchor># </span>Retour</h4></a><p><a href=https://refactoring.guru/fr/design-patterns/creational-patterns rel=noopener>Patrons de création</a></p><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener><img width=150 height=205 src=../../_resources/web-cover-en_0c1927f6fda54c9087484914aa3182d3.png class=jop-noMdConv></a></p><p>Cet article est tiré de notre ebook
<strong>Plongée au cœur des
PATRONS DE CONCEPTION</strong></p><p><a href=https://refactoring.guru/fr/design-patterns/book rel=noopener>En savoir plus…</a></p><p>Facebook</p><p>Twitter</p><ul><li><a href="https://feedback.refactoring.guru/?lang=en&show_feedback_form_private=true" rel=noopener>Nous contacter</a></li><li><a href=https://refactoring.guru/fr/login rel=noopener>Connexion</a></li></ul><p><a href=https://refactoring.guru/design-patterns/factory-method rel=noopener>English</a>
<a href=https://refactoring.guru/es/design-patterns/factory-method rel=noopener>Español</a>
<a href=https://refactoring.guru/fr/design-patterns/factory-method rel=noopener>Français</a>
<a href=https://refactoring.guru/pl/design-patterns/factory-method rel=noopener>Polski</a>
<a href=https://refactoring.guru/pt-br/design-patterns/factory-method rel=noopener>Português-Br</a>
<a href=https://refactoring.guru/ru/design-patterns/factory-method rel=noopener>Русский</a>
<a href=https://refactoring.guru/uk/design-patterns/factory-method rel=noopener>Українська</a>
<a href=https://refactoringguru.cn/design-patterns/factory-method rel=noopener>中文</a></p><p><a href=https://refactoring.guru/fr rel=noopener><img src=https://deuxfois.github.io/quartz//../../_resources/logo-covid-winter_37ae71ff2d074d38a224e52bdc8ffdb1.png width=auto alt=Refactoring.Guru></a></p><p><img src=https://deuxfois.github.io/quartz//../../_resources/winter-hat_0b8697bcb474419982bb4e8fb046e6c7.png width=auto alt></p><ul><li><a href=https://refactoring.guru/fr/store rel=noopener>Contenu premium</a></li><li><a href=https://refactoring.guru/fr/design-patterns rel=noopener>Patrons de conception</a><ul><li><a href=https://refactoring.guru/fr/design-patterns/what-is-pattern rel=noopener>Introduction</a></li><li><a href=https://refactoring.guru/fr/design-patterns/catalog rel=noopener>Catalogue</a></li><li><a href=https://refactoring.guru/fr/design-patterns/creational-patterns rel=noopener>Patrons de création</a></li><li><a href=https://refactoring.guru/fr/design-patterns/structural-patterns rel=noopener>Patrons structurels</a></li><li><a href=https://refactoring.guru/fr/design-patterns/behavioral-patterns rel=noopener>Patrons comportementaux</a></li><li><a href=https://refactoring.guru/fr/design-patterns/examples rel=noopener>Exemples de code</a></li></ul></li><li><a href=https://refactoring.guru/fr/refactoring rel=noopener>Refactorisation (commenter bientôt)</a></li></ul><p><a href=https://refactoring.guru/fr/login rel=noopener>Connexion</a>
<a href="https://feedback.refactoring.guru/?lang=en" rel=noopener>Nous contacter</a></p><ul><li><a href=https://refactoring.guru/fr rel=noopener>Accueil</a></li><li><a href=https://refactoring.guru/fr/refactoring rel=noopener>Refactorisation</a></li><li><a href=https://refactoring.guru/fr/design-patterns rel=noopener>Patrons de conception</a></li><li><a href=https://refactoring.guru/fr/store rel=noopener>Contenu premium</a></li><li><a href="https://feedback.refactoring.guru/?lang=en" rel=noopener>Forum</a></li><li><a href="https://feedback.refactoring.guru/?lang=en&show_feedback_form_private=true" rel=noopener>Nous contacter</a></li></ul><p>2014-2021
<a href=https://refactoring.guru/fr rel=noopener>Refactoring.Guru</a>. Tous droits réservés.
<img src=https://deuxfois.github.io/quartz//../../_resources/fa-building_a7c0361655b04fc0812158866baea027.svg width=auto alt="Organization address"> Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305
Email:
<a rel=noopener class="internal-link broken" data-src=mailto:support@refactoring.guru>support@refactoring.guru</a></p><p>Illustrations par
<a href=http://zhart.us/ rel=noopener>Dmitry Zhart</a></p><ul><li><a href=https://refactoring.guru/fr/terms rel=noopener>Termes et conditions</a></li><li><a href=https://refactoring.guru/fr/privacy-policy rel=noopener>Politique de protection de la vie privée</a></li><li><a href=https://refactoring.guru/fr/content-usage-policy rel=noopener>Politique de l’utilisation des données</a></li></ul></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li>No backlinks found</li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://deuxfois.github.io/quartz/js/graph.243ea0d4fc79317e06f846bd698ba136.js></script></div></div><div id=contact_buttons><footer><p>Made by DeuxFois using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2022</p><ul><li><a href=https://deuxfois.github.io/quartz/>Home</a></li><li><a href=https://twitter.com/_jzhao>Twitter</a></li><li><a href=https://github.com/jackyzha0>Github</a></li></ul></footer></div></div></body></html>