{"/":{"title":"🥔 DeuxFois","content":"Hi ✌ Welcome on my second brain !  \nI'm a passionate CS french student.  \nI began to save my notes with markdown, that is often called \"second brain\", for better understanding of studied concepts and for fastly remember notion (but i use obsidian for that, not notion lol)  \nSo, there is the topics\n\n# web\nI like web developpement, it's modern, graphical and often fast for creating beautifull applications with live preview.  \nI have the feeling that React is the most appreciated framework, and it's pretty cool, easy to apprehend and fast to code.  \n[Web and Net](WebNet.md)\n# ML and IA\nI studied machine learning at my first year in Masted and i completed my learning by following Stanford CS221.  \nI think it's important to have a well understanding og mathematical concept behind Machine learning's alrgorithms, because It's a rapidly evolving field and future algorithms will surely be based on same mathematical and statistical domains.  \n[ML and IA](Datas.md)\n\n# Database\nIn my first year of Master i had to write a paper of 15 pages of a chosen subject from a list.\nSo i chose Databases.\nI like to learn about fetching, store and interpret datas. So i use a lot of database. But for creating a database, I prefer NoSQL because the proof of viability   \nDatabase\n\n# Programming Architecture\n\nI love programming, and i start to create big project and think about the architecture of my software. I haven't learn that in my studies, because i chose Mathematical and Computer Science, but i'm interested about creating many modules in a software.  \n[Design Pattern](Architecture/Design_Pattern/Sommaire.md)\n\n# Master\nIn last, there is some note of my Master. I moved Machine Learning and Artificial Inteligence in a whole part and i don't write markdown notes in some courses, like bigdata where we have paper support.  \n[Master](Master.md)\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Chaine_de_responsabilite":{"title":"Chaîne de responsabilité / Chain of Responsibility","content":"\n**Chaîne de responsabilité** permet de faire circuler des demandes dans une chaîne de handlers. Lorsqu’un handler reçoit une demande, il décide de la traiter ou de l’envoyer au handler suivant de la chaîne.\n\n![Patron de conception chaîne de\u0026nbsp;responsabilité](../../_resources/chain-of-responsibility_e3977af6b53c43cb91ac291e68.png)\n\n## Problème\n\nImaginez que vous travaillez sur un système de commandes en ligne. Vous voulez restreindre l’accès au système pour que seuls les utilisateurs authentifiés puissent créer des commandes. Les utilisateurs qui ont les autorisations administratives doivent avoir un accès total aux commandes.\n\nAprès un travail de préparation, vous vous rendez compte que ces étapes doivent être exécutées dans un ordre précis. L’application peut essayer d’authentifier un utilisateur auprès du système lorsqu’il reçoit une demande qui contient ses identifiants. Mais si ces derniers ne sont pas corrects et que l’authentification échoue, ce n’est pas la peine de lancer d’autres vérifications.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/problem1-fr_2b6f3e03a837497ab045090fadd23865.png\"/\u003e\n\nLa demande doit d’abord passer par une série de vérifications avant que le système de commandes ne prenne le relais.\n\nPendant les mois qui ont suivi, vous avez mis en place plusieurs vérifications supplémentaires.\n\n- Un de vos collègues vous a fait remarquer qu’il n’était pas très prudent envoyer des données brutes directement dans le système de commandes. Vous avez donc ajouté une étape de validation supplémentaire pour purger les données de la demande.\n    \n- Plus tard, quelqu’un a découvert que le système de mot de passe était vulnérable aux attaques par force brute. Vous avez ajouté une étape qui filtre les échecs répétés provenant de la même adresse IP pour y remédier.\n    \n- Quelqu’un d’autre vous a suggéré d’améliorer la vitesse du système en envoyant les résultats directement depuis le cache, lorsque des demandes répétées retournent les mêmes résultats. Vous avez donc implémenté une autre étape qui laisse la demande passer si le système ne trouve pas la réponse correspondante dans le cache.\n    \n\n\u003cimg width=\"610\" height=\"0\" src=\"../../_resources/problem2-fr_ab53831df60d48efb5c09c2e86ea36e6.png\"/\u003e\n\nPlus le code grossit et plus il devient moche et désordonné.\n\nLe code des vérifications — qui n’était déjà pas très ordonné au départ — a grossi au fur et à mesure de l’ajout de nouvelles fonctionnalités. La modification d’une vérification affecte parfois les autres. Le pire dans tout cela, c’est qu’en voulant réutiliser les vérifications existantes pour protéger les autres composants du système, vous avez été obligé de dupliquer du code, car ces composants n’avaient pas besoin de toutes les étapes.\n\nLe système est devenu très difficile à comprendre et cher à maintenir. Vous vous êtes débattu avec le code pendant un moment, jusqu’au jour où vous avez décidé de tout refaire.\n\n## Solution\n\nTout comme plusieurs patrons de conception comportementaux, la **Chaîne de Responsabilité** repose sur la transformation de comportements particuliers en objets autonomes que l’on appelle *handlers*. Dans notre cas, chaque étape doit être extraite de sa propre classe avec une seule méthode qui effectue la vérification. La demande est passée en paramètre de la méthode avec toutes ses données.\n\nLe patron vous propose de relier ces handlers par une chaîne. Chaque handler stocke une référence vers le prochain handler de la chaîne dans l’un de ses attributs. En plus de traiter la demande, les handlers la font passer plus loin dans la chaîne. La demande fait le tour de la chaîne jusqu’à ce que tous les handlers aient eu l’occasion de la traiter.\n\nLe mieux dans tout cela, c’est qu’un handler peut décider de ne pas envoyer la demande plus loin dans la chaîne et de mettre fin à son traitement.\n\nDans notre exemple du système de commandes, un handler effectue le traitement et décide s’il doit envoyer la demande plus loin dans la chaîne. Si la commande contient les bonnes données, les handlers peuvent exécuter leur traitement, qu’il s’agisse de l’authentification ou de la mise en cache.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/solution1-fr_2c09f38631634b428e610049835d75e5.png\"/\u003e\n\nLes handlers forment une chaîne.\n\nIl existe une approche légèrement différente (un peu plus canonique) dans laquelle un handler décide s’il traite la demande dès sa réception. S’il peut la traiter, la demande n’ira pas plus loin. Dans ce cas de figure, un seul handler s’occupera de traiter la demande (ou aucun). C’est une approche classique utilisée dans les piles d’éléments d’une interface graphique (GUI).\n\nPar exemple, lorsqu’un utilisateur clique sur un bouton, l’événement est propagé à travers la chaîne des éléments de la GUI. Cette chaîne débute par le bouton, continue avec ses conteneurs (les formulaires ou les panneaux) et se termine avec la fenêtre principale de l’application. L’événement est traité par le premier élément de la chaîne qui est en mesure de s’en occuper. Cet exemple est particulièrement intéressant, car il démontre qu’une chaîne peut toujours être extraite depuis une arborescence.\n\n\u003cimg width=\"520\" height=\"0\" src=\"../../_resources/solution2-fr_d10a18c7dd9b479aad998e00f22bce3f.png\"/\u003e\n\nUne chaîne peut être construite à partir de la branche d’une arborescence.\n\nLes classes handler doivent toutes implémenter la même interface. Chaque handler concret ne se préoccupe que de l’existence d’une méthode `traiter` chez le handler suivant. Ainsi, vous pouvez créer vos chaînes à l’exécution et utiliser divers handlers sans coupler votre code à leurs classes concrètes.\n\n## Analogie\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/chain-of-responsibility-comic-1-_c5e8e9e472674469a.png\"/\u003e\n\nUn appel au support technique passe par plusieurs opérateurs.\n\nVous venez juste d’installer un nouveau composant sur votre ordinateur. Comme vous êtes un geek, vous avez installé plusieurs systèmes d’exploitation. Vous essayez de tous les démarrer pour voir si votre matériel est bien pris en compte. Windows détecte votre nouveau composant et l’active automatiquement. En revanche, votre petit chouchou Linux refuse de le faire fonctionner. Avec un soupçon d’espoir, vous appelez le support technique dont le numéro est indiqué sur la boîte.\n\nVotre premier interlocuteur n’est autre que la voix robotique du répondeur. Il vous propose neuf solutions à des problèmes classiques, mais aucun ne vous concerne. Au bout d’un moment, le robot vous redirige vers un opérateur humain.\n\nMalheureusement, ce dernier ne vous répond rien de bien intéressant. Il ne cesse de répéter des extraits de son manuel et ignore vos commentaires. Après avoir entendu « avez-vous essayé de redémarrer votre ordinateur ? » pour la dixième fois, vous demandez à parler avec un vrai technicien.\n\nFinalement, l’opérateur vous envoie vers un de leurs techniciens qui était probablement assis tout seul depuis des heures dans la salle des serveurs, située quelque part dans la cave sombre des bureaux de leur entreprise, et attendait avec impatience de pouvoir parler à quelqu’un. Le technicien vous indique un lien de téléchargement pour récupérer les bons pilotes et la marche à suivre pour les installer sur Linux. Enfin, la solution ! Vous mettez fin à l’appel, fou de joie !\n\n## Structure\n\n\u003cimg width=\"380\" height=\"0\" src=\"../../_resources/structure_882c6e30b4c74739a1396127e9473c35.png\"/\u003e\n\n1.  Le **Handler** déclare une interface commune pour tous les handlers concrets. En général, il ne comporte qu’une seule méthode pour gérer les demandes, mais il peut parfois en contenir une autre pour désigner le prochain handler de la chaîne.\n    \n2.  Le **Handler de Base** est une classe facultative dans laquelle le code commun à tous les handlers peut être écrit.\n    \n    En général, cette classe définit un attribut qui pointe vers le prochain handler. Les clients peuvent assembler une chaîne en passant un handler au constructeur ou au setter du handler précédent. La classe peut également implémenter le comportement par défaut d’un handler : il s’assure de l’existence du prochain handler, puis lui délègue le travail.\n    \n3.  Les **Handlers Concrets** contiennent le code qui traite les demandes. Lors de la réception d’une demande, chaque handler décide s’il doit la traiter et s’il doit l’envoyer plus loin dans la chaîne.\n    \n    Les handlers sont généralement autonomes et non modifiables, et n’accepteront qu’une seule fois les données nécessaires par le biais du constructeur.\n    \n4.  Le **Client** peut créer les chaînes juste une fois ou les assembler dynamiquement en fonction de la logique métier. Notez bien que la demande initiale n’est pas obligatoirement envoyée au premier handler de la chaîne.\n    \n\n## Pseudo-code\n\nDans cet exemple, la **Chaîne de responsabilité** est chargée d’afficher l’aide contextuelle pour les éléments actifs de la GUI.\n\n\u003cimg width=\"610\" height=\"0\" src=\"../../_resources/example-fr_bf148181693642cda57a1fca3f25c67b.png\"/\u003e\n\nLes classes de la GUI sont construites à l’aide du patron composite. Chaque élément est relié à son conteneur. À n’importe quel moment, vous pouvez bâtir une chaîne d’éléments qui commence par l’élément lui-même et parcourt tous ses conteneurs.\n\nLa GUI de l’application prend généralement la forme d’une arborescence. Par exemple, la classe `Dialogue` qui s’occupe du rendu de la fenêtre principale de l’application, est la racine de l’arbre. La boîte de dialogue contient des `Panneaux`, qui peuvent eux-mêmes être composés d’autres panneaux ou d’éléments simples de plus bas niveau comme des `Boutons` et des `ChampsTexte`.\n\nUn composant simple peut afficher brièvement des infobulles contextuelles si son texte d’aide a été configuré. Les composants plus complexes ont leur propre manière d’afficher l’aide contextuelle. Ils peuvent par exemple consulter l’aperçu du manuel ou ouvrir une page dans un navigateur.\n\n\u003cimg width=\"250\" height=\"0\" src=\"../../_resources/example2-fr_63388b8f09a34098a59dcffe55eeca9b.png\"/\u003e\n\nVoici comment une demande d’aide parcourt les objets de la GUI.\n\nSi un utilisateur positionne le pointeur de sa souris sur un élément et appuie sur la touche `F1`, l’application détecte le composant situé sous le pointeur et lui envoie une demande d’aide. La demande remonte vers la surface en parcourant tous les conteneurs jusqu’à ce qu’elle atteigne un élément qui peut afficher les informations de l’aide.\n\n```\n// L’interface du handler déclare une méthode pour construire\n// une chaîne de handlers. Elle déclare également une méthode\n// pour exécuter la demande.\ninterface ComponentWithContextualHelp is\n    method showHelp()\n\n// La classe de base des composants simples.\nabstract class Component implements ComponentWithContextualHelp is\n    field tooltipText: string\n\n    // Le conteneur du composant agit comme le prochain maillon\n    // de la chaîne des handlers.\n    protected field container: Container\n\n    // Le composant affiche une infobulle si un texte d’aide y\n    // est associé.  Sinon, il envoie l’appel vers le conteneur\n    // (s’il existe).\n    method showHelp() is\n        if (tooltipText != null)\n            // Affiche l’infobulle.\n        else\n            container.showHelp()\n\n// Les conteneurs peuvent avoir des composants simples et\n// d’autres conteneurs enfants. Les liens de la chaîne sont\n// établis ici. La classe hérite du comportement de la méthode\n// montrerAide (showHelp) de son parent.\nabstract class Container extends Component is\n    protected field children: array of Component\n\n    method add(child) is\n        children.add(child)\n        child.container = this\n\n// Les composants primitifs peuvent se contenter de l’aide par\n// défaut...\nclass Button extends Component is\n    // ...\n\n// Mais les composants complexes peuvent redéfinir\n// l’implémentation par défaut. Si le texte d’aide ne peut être\n// fourni d’une autre manière, le composant peut toujours\n// appeler l’implémentation de base (se référer à la classe\n// Composant).\nclass Panel extends Container is\n    field modalHelpText: string\n\n    method showHelp() is\n        if (modalHelpText != null)\n            // Affiche une fenêtre modale avec le texte d’aide.\n        else\n            super.showHelp()\n\n// ...idem qu’au-dessus...\nclass Dialog extends Container is\n    field wikiPageURL: string\n\n    method showHelp() is\n        if (wikiPageURL != null)\n            // Ouvre la page wiki d’aide.\n        else\n            super.showHelp()\n\n// Code client.\nclass Application is\n    // Chaque application configure la chaîne différemment.\n    method createUI() is\n        dialog = new Dialog(\"Budget  Reports\")\n        dialog.wikiPageURL = \"http://...\"\n        panel = new Panel(0, 0, 400, 800)\n        panel.modalHelpText = \"This  panel  does...\"\n        ok = new Button(250, 760, 50, 20, \"OK\")\n        ok.tooltipText = \"This  is  an  OK  button  that...\"\n        cancel = new Button(320, 760, 50, 20, \"Cancel\")\n        // ...\n        panel.add(ok)\n        panel.add(cancel)\n        dialog.add(panel)\n\n    // Imaginez ce qui se passe ici.\n    method onF1KeyPress() is\n        component = this.getComponentAtMouseCoords()\n        component.showHelp()\n\n```\n\n## Possibilités d’application\n\nUtilisez la chaîne de responsabilité quand votre programme doit traiter des types de demandes variées de différentes manières, mais que leur type exact et leur ordre dans la chaîne ne sont pas connus à l’avance.\n\nCe patron vous permet de former une chaîne avec les handlers et d’interroger chacun d’entre eux lors de la réception de la demande afin de savoir s’ils peuvent la traiter. Chaque handler a ainsi l’opportunité de traiter la demande.\n\nUtilisez ce patron si vos handlers doivent absolument respecter un ordre donné.\n\nComme vous pouvez définir les liens entre les handlers de la chaîne, les demandes la parcourront selon l’ordonnancement que vous avez configuré.\n\nUtilisez la chaîne de responsabilité si l’ensemble des handlers et leur ordre dans la chaîne peuvent changer lors de l’exécution.\n\nSi vous fournissez des setters à un attribut à l’intérieur d’une classe handler, vous serez en mesure d’ajouter, de retirer ou d’ordonner dynamiquement les handlers.\n\n## Mise en œuvre\n\n1.  Déclarez l’interface du handler et la méthode qui gère les demandes.\n    \n    Déterminez la manière dont le client passera les données de la demande dans la méthode. La manière la plus flexible consiste à convertir la demande en objet et à le passer en paramètre de la méthode.\n    \n2.  Pour éviter la duplication du code de base dans les handlers concrets, il peut être utile de créer une classe abstraite de base pour le handler, dérivée de l’interface handler.\n    \n    Cette classe doit posséder un attribut qui est une référence vers le prochain handler de la chaîne et vous devriez envisager de la rendre non modifiable. Mais si vous prévoyez de modifier les chaînes lors de l’exécution, vous devez définir des setters pour changer la valeur de l’attribut qui stocke les références.\n    \n    Vous pouvez également mettre en place le comportement par défaut des méthodes des handlers qui consiste à envoyer la demande au prochain objet (s’il en reste). Les handlers concrets peuvent utiliser ce comportement en faisant appel à la méthode de leur parent.\n    \n3.  Créez les sous-classes des handlers concrets une par une et mettez en place leurs traitements. Chaque handler doit prendre deux décisions lors de la réception d’une demande :\n    \n    - Traiter ou non la demande.\n    - Passer ou non la demande au handler suivant de la chaîne.\n4.  Le client doit assembler lui-même les chaînes ou recevoir des chaînes pré construites via d’autres objets. Dans le dernier cas, vous devez mettre en place des fabriques pour assembler des chaînes selon la configuration ou selon les paramètres d’environnement.\n    \n5.  Le client peut déclencher n’importe quel élément de la chaîne, pas forcément le premier. La demande continuera de parcourir la chaîne jusqu’à ce qu’un handler refuse de la laisser continuer, ou jusqu’à ce que l’on atteigne la fin de la chaîne.\n    \n6.  La chaîne étant dynamique, le client doit être capable de gérer les scénarios suivants :\n    \n    - La chaîne peut être composée d’un unique lien.\n    - Certaines demandes n’iront pas jusqu’au bout de la chaîne.\n    - Certaines demandes atteindront la fin de la chaîne sans être traitées.\n\n## Avantages et inconvénients\n\n- Vous pouvez contrôler l’ordre des traitements de la demande.\n- *Principe de responsabilité unique*. Vous pouvez découpler les classes qui appellent des traitements, de celles qui les exécutent.\n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouveaux handlers dans le programme sans toucher au code client existant.\n\n- Il se peut que certaines demandes ne soient pas traitées.\n\n## Liens avec les autres patrons\n\n- La [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility), la [Commande](https://refactoring.guru/fr/design-patterns/command), le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) et l’[Observateur](https://refactoring.guru/fr/design-patterns/observer) proposent différentes solutions pour associer les demandeurs et les récepteurs.\n    - La *chaîne de responsabilité* envoie une demande ordonnée qui est passée tout au long d’une chaîne dynamique de récepteurs potentiels, jusqu’à ce que l’un d’entre eux décide de la traiter.\n    - La *commande* établit des connexions unidirectionnelles entre les demandeurs et les récepteurs.\n    - Le *médiateur* élimine les liens directs entre les demandeurs et les récepteurs, et les force à communiquer indirectement via un objet médiateur.\n    - L’*observateur* permet aux récepteurs de s’inscrire et de se désinscrire dynamiquement à la réception des demandes.\n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_140f00c0bd894be0a807878862a4cda5.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/java/example \"Patrons de conception : Chaîne de responsabilité en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_043fb932596e4b9a857b3ee31b90ec8d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/csharp/example \"Patrons de conception : Chaîne de responsabilité en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_18bdf4c85a104dcb805b401f4ec66102.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/cpp/example \"Patrons de conception : Chaîne de responsabilité en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_616b603d17d54eed9f32fa09b7874a80.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/php/example \"Patrons de conception : Chaîne de responsabilité en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_245ab1ea89a44136936ecb95f29b1753.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/python/example \"Patrons de conception : Chaîne de responsabilité en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_fcdc0b9a13424c4bba99c78d232fffe0.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/ruby/example \"Patrons de conception : Chaîne de responsabilité en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_0a34cb28cc3f46fabcdec1c1c4ebe7a7.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/swift/example \"Patrons de conception : Chaîne de responsabilité en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_a3e666b7d8494892b5375c1d8aa85dd2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/typescript/example \"Patrons de conception : Chaîne de responsabilité en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_983af88674f74cddbd88d71cdd43442e.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/chain-of-responsibility/go/example \"Patrons de conception : Chaîne de responsabilité en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_40863b5ecae4401fb5f16b9e923.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Commande](https://refactoring.guru/fr/design-patterns/command)\n\n#### Retour\n\n[Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_c852e245edb840aaaf28320736719d52.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/chain-of-responsibility \"English\") [Español](https://refactoring.guru/es/design-patterns/chain-of-responsibility \"Español\") [Français](https://refactoring.guru/fr/design-patterns/chain-of-responsibility \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/chain-of-responsibility \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/chain-of-responsibility \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/chain-of-responsibility \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/chain-of-responsibility \"Українська\") [中文](https://refactoringguru.cn/design-patterns/chain-of-responsibility \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_90a63c86904e4667974e8c2607737c5d.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_81a8004335464afba8b37207a9b8cc89.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_d1487c45b2994584a7b23849aa9fa577.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Commande":{"title":"Commande / Command","content":"\n**Commande** prend une action à effectuer et la transforme en un objet autonome qui contient tous les détails de cette action. Cette transformation permet de paramétrer des méthodes avec différentes actions, planifier leur exécution, les mettre dans une file d’attente ou d’annuler des opérations effectuées.\n\n![Patron de conception\u0026nbsp;commande](../../_resources/command-fr_787ffeb0f2814bf1b60a1647af987cf1.png)\n\n## Problème\n\nImaginez-vous en train de développer un nouvel éditeur de texte. Vous travaillez actuellement sur la création d’une barre d’outils équipée d’un ensemble de boutons qui permettent d’effectuer diverses opérations dans l’éditeur. Vous avez créé une belle classe `Bouton` qui peut être utilisée pour les boutons de la barre d’outils ou pour les boutons génériques des différentes boîtes de dialogue.\n\n![Problème résolu grâce au patron de conception commande](../../_resources/problem1_0a1d8f8507fd4fd38c429d2198aceebd.png)\n\nTous les boutons de l’application sont dérivés de la même classe.\n\nCes boutons ont beau se ressembler, ils sont censés effectuer des actions différentes. Où va-t-on bien pouvoir mettre le code des actions que ces différents boutons déclenchent ? Le plus simple est de créer des tonnes de sous-classes où les boutons sont utilisés. Ces sous-classes vont contenir le code exécuté lors d’un clic sur un bouton.\n\n\u003cimg width=\"400\" height=\"0\" src=\"../../_resources/problem2_61c5cc835bf5489aaf6313660e5ab36c.png\"/\u003e\n\nDe nombreuses sous-classes de boutons. Tout semble aller pour le mieux.\n\nMais bientôt, vous allez remarquer que cette approche comporte de sérieux défauts. Le premier que nous allons aborder ici, est le fait que vous avez créé énormément de sous-classes. Lors de chaque modification de la classe `Bouton`, vous risquez d’ajouter de nouveaux bugs dans le code. Pour faire simple, votre GUI (interface graphique utilisateur) est devenue un peu trop dépendante du code volatile de la logique métier.\n\n\u003cimg width=\"480\" height=\"0\" src=\"../../_resources/problem3-fr_96602177276743e9919a2525579306f2.png\"/\u003e\n\nPlusieurs classes implémentent la même fonctionnalité.\n\nAbordons à présent le défaut majeur. Certaines opérations, comme copier-coller du texte, doivent être appelées depuis différents endroits. Par exemple, un utilisateur peut cliquer sur un petit bouton « copier » de la barre d’outils, copier via le menu contextuel ou encore faire `Ctrl+C` sur son clavier.\n\nÀ l’époque où notre application n’avait qu’une barre d’outils, cela ne posait pas de problème de mettre l’implémentation des différentes actions dans la sous-classe du bouton. Vous pouviez écrire le code de la copie du texte dans la sous-classe `BoutonCopier` sans problème. Mais lorsque vous implémentez des menus contextuels, des raccourcis ou autres fonctionnalités du même ordre, vous devez dupliquer le code de ces actions dans plusieurs classes ou rendre les menus dépendants des boutons, ce qui est encore pire.\n\n## Solution\n\nUn logiciel bien conçu repose souvent sur le *principe de séparation des préoccupations*, qui est en général obtenu en décomposant l’application en plusieurs couches. Le cas le plus classique consiste à avoir une couche pour la GUI et une autre pour la logique métier. La couche GUI a la responsabilité d’afficher une belle image à l’écran, de détecter les actions de l’utilisateur et de l’application, et de les répercuter à l’écran. Mais en ce qui concerne l’exécution des traitements importants comme calculer la trajectoire vers la lune ou générer les rapports annuels, la couche GUI délègue le travail à la couche métier.\n\nDans le code, on se retrouve avec un objet GUI qui appelle une méthode de l’objet de la logique métier et lui passe des paramètres. Ce processus est souvent décrit comme un objet envoyant une *demande* à un autre.\n\n\u003cimg width=\"470\" height=\"0\" src=\"../../_resources/solution1-fr_f0bfc13936a646c08478833b5d9cadc2.png\"/\u003e\n\nLes objets de la GUI peuvent accéder directement aux objets de la couche métier.\n\nLe patron de conception commande propose de ne pas envoyer ces demandes directement depuis les objets de la GUI. À la place, vous devez extraire le détail de ces demandes (un appel vers l’objet, le nom de la méthode et la liste des paramètres) dans une classe *commande* séparée avec une unique méthode qui déclenche cette demande.\n\nLes objets commande servent de lien entre les diverses GUI et les objets métier. À partir de maintenant, l’objet GUI ne saura plus quel objet métier reçoit la demande et comment il la traite. L’objet GUI déclenche juste la commande, et cette dernière se charge de gérer les détails.\n\n\u003cimg width=\"550\" height=\"0\" src=\"../../_resources/solution2-fr_b398e7a1d8f5438f8204c6a5801123f7.png\"/\u003e\n\nAccéder à la couche métier via une commande.\n\nLa prochaine étape consiste à implémenter la même interface pour toutes vos commandes. En général, elle ne possède qu’une seule méthode d’exécution et ne prend aucun paramètre. Cette interface vous permet d’utiliser diverses commandes avec le même demandeur (invoker), sans avoir à la coupler avec les classes concrètes des commandes. En bonus, vous pouvez dorénavant échanger les objets de la commande liés au demandeur, ce qui permet de modifier le comportement du demandeur lors de l’exécution.\n\nVous vous êtes peut-être rendu compte qu’il manquait une pièce du puzzle : les paramètres de la demande. Un objet GUI devrait les fournir à la couche métier. Mais comme la méthode d’exécution de la commande ne possède aucun paramètre, comment allons-nous nous en sortir ? En fait, la commande doit être pré configurée avec ces données ou être capable de les récupérer par elle-même.\n\n\u003cimg width=\"440\" height=\"0\" src=\"../../_resources/solution3-fr_605f9965c7dd444dafdd84bc897d819a.png\"/\u003e\n\nLes objets de la GUI délèguent le travail aux commandes.\n\nRevenons à notre éditeur de texte. Après avoir mis en place le patron de conception commande, nous n’avons plus besoin de toutes ces sous-classes pour implémenter le comportement des différents clics. Vous pouvez vous contenter de mettre un seul attribut dans la classe de base `Bouton` qui conserve une référence vers un objet commande et lui permet de lancer cette commande lors d’un clic.\n\nVous allez implémenter plusieurs classes commande pour chaque opération possible, et allez les relier avec les boutons en fonction du comportement attendu.\n\nVous pouvez implémenter tous les autres éléments de la GUI comme des menus, raccourcis ou des boîtes de dialogue complètes de la même manière. Ils seront reliés à une commande qui est exécutée lorsqu’un utilisateur interagit avec l’élément de la GUI. Vous l’avez probablement deviné, les éléments qui déclenchent les mêmes actions seront reliés aux mêmes commandes afin d’éviter la duplication de code.\n\nLes commandes forment ainsi une couche intermédiaire très pratique et réduisent le couplage entre la GUI et les couches métier. Et nous n’avons abordé qu’une infime partie des bénéfices que le patron de conception commande peut apporter.\n\n## Analogie\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/command-comic-1_2ac73732d661451b97ca1fde356f3c24.png\"/\u003e\n\nPasser une commande au restaurant.\n\nAprès une longue balade en ville, vous trouvez un restaurant sympa et vous vous asseyez à une table près de la fenêtre. Un serveur aimable se rapproche et prend votre commande en l’écrivant sur un bout de papier. Il se rend dans la cuisine et colle la commande sur le mur. Au bout d’un moment, la commande arrive au chef, qui la lit et prépare le plat. Le cuisinier place le repas sur un plateau avec la commande. Le serveur découvre le plateau, vérifie la commande pour s’assurer que tout est conforme, et l’apporte à votre table.\n\nLe bout de papier joue le rôle de la commande. Il reste dans une file d’attente jusqu’à ce que le chef soit prêt à la servir. Il peut commencer à cuisiner directement, car la commande contient toutes les informations permettant au chef de préparer le plat. C’est mieux que de perdre du temps à venir vous demander les détails de la commande.\n\n## Structure\n\n\u003cimg width=\"630\" height=\"0\" src=\"../../_resources/structure_a31bf8616bbd4b5c9f69145b30e62ce7.png\"/\u003e\n\n1.  La classe **Demandeur** (*invoker*) a la responsabilité de l’envoi des demandes. Elle doit inclure un attribut qui stocke la référence à un objet commande. Le demandeur déclenche la commande plutôt que de l’envoyer directement au récepteur. Gardez bien en tête que le demandeur n’est pas responsable de la création de l’objet commande. En général, il s’agit d’une commande créée auparavant dans le constructeur du client.\n    \n2.  L’interface **Commande** déclare habituellement une seule méthode pour exécuter la commande.\n    \n3.  Les **Commandes Concrètes** implémentent plusieurs types de demandes. Une commande concrète n’est pas censée accomplir la tâche d’elle-même. Elle transmet l’appel aux objets de la logique métier. Mais pour simplifier le code, ces classes peuvent être fusionnées.\n    \n    Les paramètres nécessaires à l’exécution d’une méthode sur un objet récepteur peuvent être déclarés comme des attributs de la commande concrète. Vous pouvez rendre les objets de la commande non modifiables en autorisant uniquement l’initialisation de ces attributs dans le constructeur.\n    \n4.  La classe **Récepteur** porte la logique métier. À peu près n’importe quel objet peut prendre le rôle de récepteur. La majorité des commandes se contentent de passer la demande au récepteur et ce dernier se charge du traitement.\n    \n5.  Le **Client** crée et configure les objets de la commande concrète. Il doit passer tous les paramètres de la demande (dont l’instance du récepteur) dans le constructeur de la commande. Ensuite, la commande qui en résulte peut être associée avec un ou plusieurs demandeurs.\n    \n\n## Pseudo-code\n\nDans cet exemple, le patron de conception **Commande** aide à tracer l’historique des traitements et est en mesure d’annuler les modifications effectuées par un traitement.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/example_d52951cee5ac4b8fa02dbd2e96556ce0.png\"/\u003e\n\nActions pouvant être annulées dans un éditeur de texte.\n\nLes commandes qui modifient l’état de l’éditeur (par exemple couper et coller) font une sauvegarde de son état avant de lancer le traitement associé à la commande. Une fois que la commande a été exécutée, elle est placée dans un historique de commandes (une pile d’objets commande) avec une sauvegarde de l’état actuel de l’éditeur. Si l’utilisateur a besoin d’annuler un traitement, l’application peut prendre la commande la plus récente de l’historique, lire la sauvegarde associée à l’état de l’éditeur et la restaurer.\n\nLe code client (éléments de la GUI, historique des commandes, etc.) n’est pas couplé avec les classes de la commande concrète, car il interagit avec les commandes via l’interface commande. Cette approche vous permet d’ajouter de nouvelles commandes dans l’application sans endommager l’existant.\n\n```\n// La classe de base commande définit une interface commune pour\n// toutes les commandes concrètes.\nabstract class Command is\n    protected field app: Application\n    protected field editor: Editor\n    protected field backup: text\n\n    constructor Command(app: Application, editor: Editor) is\n        this.app = app\n        this.editor = editor\n\n    // Fait une sauvegarde de l’état de l’éditeur.\n    method saveBackup() is\n        backup = editor.text\n\n    // Rétablit l’état de l’éditeur.\n    method undo() is\n        editor.text = backup\n\n    // La méthode d’exécution est abstraite pour forcer les\n    // commandes concrètes à fournir leurs propres\n    // implémentations. La méthode doit retourner un booléen qui\n    // indique si la commande a modifié l'état de l’éditeur.\n    abstract method execute()\n\n// Les commandes concrètes sont écrites ici.\nclass CopyCommand extends Command is\n    // La commande pour copier n’est pas sauvegardée dans\n    // l’historique, car elle ne modifie pas l'état de\n    // l’éditeur.\n    method execute() is\n        app.clipboard = editor.getSelection()\n        return false\n\nclass CutCommand extends Command is\n    // La commande ‘couper’ change l’état de l’éditeur, elle\n    // doit donc être sauvegardée dans l’historique. Elle sera\n    // sauvegardée tant que la méthode renvoie vrai.\n    method execute() is\n        saveBackup()\n        app.clipboard = editor.getSelection()\n        editor.deleteSelection()\n        return true\n\nclass PasteCommand extends Command is\n    method execute() is\n        saveBackup()\n        editor.replaceSelection(app.clipboard)\n        return true\n\n// Le traitement ‘annuler’ est aussi une commande.\nclass UndoCommand extends Command is\n    method execute() is\n        app.undo()\n        return false\n\n// L’historique principal des commandes est juste une pile.\nclass CommandHistory is\n    private field history: array of Command\n\n    // Dernier entré...\n    method push(c: Command) is\n        // Pousse la commande à la fin du tableau de\n        // l’historique.\n\n    // ...premier sorti.\n    method pop():Command is\n        // Récupère la commande la plus récente de l’historique.\n\n// La classe éditeur possède des fonctionnalités de traitement\n// de texte. Elle joue le rôle du récepteur : toutes les\n// commandes finissent par déléguer l’exécution aux méthodes de\n// l’éditeur.\nclass Editor is\n    field text: string\n\n    method getSelection() is\n        // Retourne le texte sélectionné.\n\n    method deleteSelection() is\n        // Supprime le texte sélectionné.\n\n    method replaceSelection(text) is\n        // Insère le contenu du presse-papiers à la position\n        // actuelle.\n\n// La classe application configure les relations de l’objet.\n// Elle agit comme un demandeur : lorsque quelque chose doit\n// être fait, elle crée un objet commande et lance son\n// traitement.\nclass Application is\n    field clipboard: string\n    field editors: array of Editors\n    field activeEditor: Editor\n    field history: CommandHistory\n\n    // Le code qui assigne les commandes à l’objet UI pourrait\n    // ressembler à ceci.\n    method createUI() is\n        // ...\n        copy = function() { executeCommand(\n            new CopyCommand(this, activeEditor)) }\n        copyButton.setCommand(copy)\n        shortcuts.onKeyPress(\"Ctrl+C\", copy)\n\n        cut = function() { executeCommand(\n            new CutCommand(this, activeEditor)) }\n        cutButton.setCommand(cut)\n        shortcuts.onKeyPress(\"Ctrl+X\", cut)\n\n        paste = function() { executeCommand(\n            new PasteCommand(this, activeEditor)) }\n        pasteButton.setCommand(paste)\n        shortcuts.onKeyPress(\"Ctrl+V\", paste)\n\n        undo = function() { executeCommand(\n            new UndoCommand(this, activeEditor)) }\n        undoButton.setCommand(undo)\n        shortcuts.onKeyPress(\"Ctrl+Z\", undo)\n\n    // Lance une commande et vérifie si elle doit être ajoutée à\n    // l’historique.\n    method executeCommand(command) is\n        if (command.execute)\n            history.push(command)\n\n    // Prend la commande la plus récente dans l’historique et\n    // lance sa méthode ‘annuler’. Vous remarquerez que nous ne\n    // connaissons pas la classe de la commande. Nous n’avons\n    // pas besoin de la connaître puisque la commande sait\n    // comment annuler sa propre action.\n    method undo() is\n        command = history.pop()\n        if (command != null)\n            command.undo()\n\n```\n\n## Possibilités d’application\n\nUtilisez le patron de conception commande lorsque vous voulez paramétrer des objets avec des traitements.\n\nLe patron de conception commande peut transformer l’appel d’une méthode en un objet autonome. Cette approche permet des utilisations très intéressantes : vous pouvez passer des commandes dans les paramètres d’une méthode, les stocker à l’intérieur d’objets, modifier les liens des commandes à l’exécution, etc.\n\nVoici un exemple : vous développez un composant de GUI (un menu contextuel par exemple) et vous voulez que vos utilisateurs puissent configurer des éléments de menu qui déclenchent des traitements lorsqu’un utilisateur final clique dessus.\n\nUtilisez ce patron si vous voulez mettre des traitements dans une file d’attente, programmer leur déclenchement, ou les exécuter à distance.\n\nComme pour tous les objets, une commande peut être sérialisée, ce qui veut dire qu’on la convertit en une chaîne de caractères qui peut facilement être écrite dans un fichier ou dans une base de données. La chaîne de caractère pourra ensuite être restaurée et utilisée par l’objet de la commande originale. Vous pouvez ainsi différer et planifier l’exécution de la commande. Mais ce n’est pas tout ! De la même manière, vous pouvez mettre une commande dans une file d’attente, l’historiser ou l’envoyer par le réseau.\n\nUtilisez le patron de conception commande quand vous voulez implémenter des opérations réversibles.\n\nParmi les nombreuses techniques qui permettent d’implémenter la fonctionnalité annuler/rétablir, le patron de conception commande est probablement le plus populaire.\n\nPour pouvoir annuler des traitements, vous devez mettre en place un historique des actions effectuées. L’historique des commandes est une pile qui contient tous les objets des commandes exécutées avec l’état de l’application correspondant.\n\nCette méthode possède deux défauts. Premièrement, l’état d’une application n’est pas facile à sauvegarder, car une partie peut être privée. Ce problème peut être résolu grâce à l’intervention du patron de conception [Mémento](https://refactoring.guru/fr/design-patterns/memento).\n\nDeuxièmement, la sauvegarde de l’état risque de consommer beaucoup de RAM. Par conséquent, vous pouvez utiliser une autre alternative : plutôt que de rétablir l’état précédent, la commande effectue l’inverse de la modification, ce qui est malheureusement parfois impossible ou difficile à mettre en place.\n\n## Mise en œuvre\n\n1.  Déclarez l’interface commande avec une seule méthode d’exécution.\n    \n2.  Commencez à récupérer les demandes et à les mettre dans les classes concrètes Commande qui implémentent l’interface commande. Chaque classe doit comporter un ensemble d’attributs qui permettent de stocker les paramètres des demandes, avec une référence à l’objet initial du récepteur. Ces valeurs doivent toutes être initialisées dans le constructeur de la commande.\n    \n3.  Identifiez les classes qui vont jouer le rôle de *Demandeurs*. Créez les attributs de ces classes qui vont stocker les commandes. Les demandeurs doivent uniquement communiquer avec leurs commandes via l’interface commande. En général, ils ne créent pas les objets commande, c’est le code client qui s’en charge.\n    \n4.  Plutôt que d’envoyer la demande directement au récepteur, modifiez les demandeurs afin qu’ils exécutent la commande.\n    \n5.  Le client doit initialiser les objets dans l’ordre suivant :\n    \n    - Créer les récepteurs.\n    - Créer les commandes et les associer avec les récepteurs si besoin.\n    - Créer les demandeurs et les associer avec les commandes.\n\n## Avantages et inconvénients\n\n- *Principe de responsabilité unique*. Vous pouvez découpler les classes qui appellent des traitements, de celles qui les exécutent.\n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouvelles commandes dans le programme sans endommager le code client existant.\n- Vous pouvez mettre en place une fonctionnalité annuler-rétablir.\n- Vous pouvez différer l’exécution de vos traitements.\n- Vous pouvez assembler plusieurs commandes simples en une seule plus complexe.\n\n- Le code peut devenir plus compliqué, car vous créez une nouvelle couche entre les demandeurs et les récepteurs.\n\n## Liens avec les autres patrons\n\n- La [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility), la [Commande](https://refactoring.guru/fr/design-patterns/command), le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) et l’[Observateur](https://refactoring.guru/fr/design-patterns/observer) proposent différentes solutions pour associer les demandeurs et les récepteurs.\n    \n    - La *chaîne de responsabilité* envoie une demande ordonnée qui est passée tout au long d’une chaîne dynamique de récepteurs potentiels, jusqu’à ce que l’un d’entre eux décide de la traiter.\n    - La *commande* établit des connexions unidirectionnelles entre les demandeurs et les récepteurs.\n    - Le *médiateur* élimine les liens directs entre les demandeurs et les récepteurs, et les force à communiquer indirectement via un objet médiateur.\n    - L’*observateur* permet aux récepteurs de s’inscrire et de se désinscrire dynamiquement à la réception des demandes.\n- Les handlers dans la [Chaîne de Responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility \"Chaîne de responsabilité\") peuvent être implémentés comme des [Commandes](https://refactoring.guru/fr/design-patterns/command). Dans ce cas, vous pouvez lancer beaucoup de traitements différents sur le même objet contexte, représenté par une demande.\n    \n    Vous pouvez cependant utiliser une autre approche dans laquelle la demande en elle-même est un objet *commande*. Vous pouvez ainsi exécuter le même traitement dans une série de différents contextes connectés par une chaîne.\n    \n- Vous pouvez utiliser la [Commande](https://refactoring.guru/fr/design-patterns/command) et le [Mémento](https://refactoring.guru/fr/design-patterns/memento) ensemble pour implémenter la fonctionnalité « annuler ». Dans ce cas, les commandes ont la responsabilité d’exécuter les divers traitements sur un objet cible. Les mémentos sauvegardent l’état de cet objet juste avant le lancement de la commande.\n    \n- La [Commande](https://refactoring.guru/fr/design-patterns/command) et la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) peuvent se ressembler, car vous les utilisez toutes les deux pour paramétrer un objet avec une action. Cependant, ces patrons ont des intentions très différentes.\n    \n    - Vous pouvez utiliser la *commande* pour convertir un traitement en un objet. Les paramètres du traitement deviennent des attributs de cet objet. La conversion vous permet de différer le lancement du traitement, le mettre dans une file d’attente, stocker l’historique des commandes, envoyer les commandes à des services distants, etc.\n        \n    - La *stratégie* quant à elle, décrit généralement différentes manières de faire la même chose et vous laisse permuter entre ces algorithmes à l’intérieur d’une unique classe contexte.\n        \n- Le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) se révèle utile lorsque vous voulez sauvegarder des copies de [Commandes](https://refactoring.guru/fr/design-patterns/command) dans l’historique.\n    \n- Vous pouvez traiter le [Visiteur](https://refactoring.guru/fr/design-patterns/visitor) comme une version plus puissante du patron de conception [Commande](https://refactoring.guru/fr/design-patterns/command). Ses objets peuvent lancer des traitements sur divers objets dans différentes classes.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_9dde852adff34fa4a10abd21826c9e9a.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/java/example \"Patrons de conception : Commande en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_4a431deef84845d7bb92c28c0e4e8f44.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/csharp/example \"Patrons de conception : Commande en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_23110627b7bc4a1f971ed7921a374376.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/cpp/example \"Patrons de conception : Commande en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_8f6e35dab074422d90dfca2f3a3649f8.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/php/example \"Patrons de conception : Commande en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_7c6111689cc442b2ab75afd599f6bd46.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/python/example \"Patrons de conception : Commande en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_793212824ac74f4397cf08fcf74f28f0.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/ruby/example \"Patrons de conception : Commande en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_6a6f040c76a542729b27db1390d3c1d5.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/swift/example \"Patrons de conception : Commande en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_ecb8e29d27aa408e9a018e02fa1f4f54.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/typescript/example \"Patrons de conception : Commande en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_076a877ae3734eec84f2229d11cf7892.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/command/go/example \"Patrons de conception : Commande en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_30b19b0f23f74abbafdb4404cb3.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n\n#### Retour\n\n[Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_3f4a8916710b4671a528035f3c803611.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/command \"English\") [Español](https://refactoring.guru/es/design-patterns/command \"Español\") [Français](https://refactoring.guru/fr/design-patterns/command \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/command \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/command \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/command \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/command \"Українська\") [中文](https://refactoringguru.cn/design-patterns/command \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_04757fa9b0e641afad98e62c6cdde892.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_16151f0b6383437e8823a655796eb20e.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_cf28be56a9eb4af29104ab20662cfc63.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Etat":{"title":"État / State","content":"\n**État** permet de modifier le comportement d’un objet lorsque son état interne change. L’objet donne l’impression qu’il change de classe.\n\n![Patron de conception\u0026nbsp;état](../../_resources/state-fr_7368c6b587874b7e830f220d8295c19a.png)\n\n## Problème\n\nLe patron de conception est très proche du concept de l’[Automate fini](https://fr.wikipedia.org/wiki/Automate_fini).\n\n![Automate fini](../../_resources/problem1_e0c985d3f29c40609bb5ab30b1284951.png)\n\nAutomate fini.\n\nLe principe repose sur le fait qu’un programme possède un nombre *fini* d'*états*. Le programme se comporte différemment selon son état et peut en changer instantanément. En revanche, selon l’état dans lequel il se trouve, certains états ne lui sont pas accessibles. Ces règles de changement d’état sont appelées *transitions*. Elles sont également finies et prédéterminées.\n\nVous pouvez appliquer cette approche aux objets. Imaginons une classe `Document`. Un document peut être dans l’un des trois états suivants : `Brouillon` (draft), `Modération` et `Publié`. La méthode `publier` du document fonctionne un peu différemment en fonction de son état :\n\n- Dans `Brouillon`, elle passe le document en modération.\n- Dans `Modération`, elle rend le document public si l’utilisateur actuel est un administrateur.\n- Dans `Publié`, elle ne fait rien du tout.\n\n\u003cimg width=\"560\" height=\"0\" src=\"../../_resources/problem2-fr_ce199476de484ec080252139b51e6a21.png\"/\u003e\n\nLes états et transitions possibles d’un objet document.\n\nLes automates sont généralement implémentés avec beaucoup d’opérateurs conditionnels (`if` ou `switch`) qui choisissent le comportement approprié en fonction de l’état actuel de l’objet. Cet « état » se limite souvent à un ensemble de valeurs dans les attributs de l’objet. Même si vous n’avez jamais entendu parler des automates finis, vous avez probablement déjà implémenté un état au moins une fois. La structure du code suivant vous dit-elle quelque chose ?\n\n```\nclass Document is\n    field state: string\n    // ...\n    method publish() is\n        switch (state)\n            \"draft\":\n                state = \"moderation\"\n                break\n            \"moderation\":\n                if (currentUser.role == 'admin')\n                    state = \"published\"\n                break\n            \"published\":\n                // Do nothing.\n                break\n    // ...\n\n```\n\nLa plus grosse faiblesse de l’automate fini devient visible lorsque l’on commence à ajouter de plus en plus d’états et de comportements qui en sont dépendants à la classe `Document`. La majorité des méthodes va contenir d’énormes blocs de conditions qui vont choisir le comportement d’une méthode en fonction de l’état actuel. Ce genre de code est très difficile à maintenir, car tout changement dans la logique de transition demande de modifier les états conditionnels dans chaque méthode.\n\nPlus le projet évolue et plus cette faiblesse s’aggrave. Il est très difficile de prédire tous les états et transitions possibles lors de la phase de conception. Un automate fini doté d’un nombre limité de conditions peut se transformer en un bazar pas possible au bout d’un certain temps.\n\n## Solution\n\nLe patron de conception état propose de créer de nouvelles classes pour tous les états possibles d’un objet et d’extraire les comportements liés aux états dans ces classes.\n\nPlutôt que d’implémenter tous les comportements de lui-même, l’objet original que l’on nomme *contexte*, stocke une référence vers un des objets état qui représente son état actuel. Il délègue tout ce qui concerne la manipulation des états à cet objet.\n\n\u003cimg width=\"490\" height=\"0\" src=\"../../_resources/solution-fr_185ff9d6455c44a29778798580e63d51.png\"/\u003e\n\nDocument délègue la tâche à un objet état.\n\nPour faire passer le contexte dans un autre état, remplacez l’objet état par un autre qui représente son nouvel état. Vous ne pourrez le faire que si toutes les classes suivent la même interface et si le contexte utilise cette dernière pour manipuler ces objets.\n\nCette structure ressemble de près au patron de conception [Stratégie](https://refactoring.guru/fr/design-patterns/strategy), mais il y a une différence majeure. Dans le patron de conception état, les états ont de la visibilité entre eux et peuvent lancer les transitions d’un état à l’autre, alors que les stratégies ne peuvent pas se voir.\n\n## Analogie\n\nLes boutons de votre smartphone fonctionnent différemment selon l’état de l’appareil :\n\n- Si le téléphone est déverrouillé, appuyer sur des boutons lance différentes fonctionnalités.\n- Si le téléphone est verrouillé, appuyer sur n’importe quel bouton envoie sur l’écran de déverrouillage.\n- Si la batterie du téléphone est faible, appuyer sur n’importe quel bouton montre l’écran de charge.\n\n## Structure\n\n\u003cimg width=\"540\" height=\"0\" src=\"../../_resources/structure-fr_212cf9cf716e49088232c0d41657b24d.png\"/\u003e\n\n1.  Le **Contexte** stocke une référence vers un des objets concrets État et lui délègue toutes les tâches concernant les états. Il utilise l’interface état pour communiquer avec l’objet état. Il expose un setter pour lui passer un nouvel état.\n    \n2.  L’interface **État** déclare les méthodes spécifiques aux états. Ces méthodes doivent fonctionner avec tous les états concrets : des méthodes inutiles qui ne sont jamais appelées à l’intérieur de vos états sont à proscrire.\n    \n3.  Les **États Concrets** fournissent leurs propres implémentations aux méthodes qui agissent sur les états. Pour éviter d’écrire le même code dans les différents états, vous pouvez créer des classes abstraites intermédiaires qui encapsulent les comportements identiques.\n    \n    Les états peuvent garder une référence vers le contexte. Grâce à cette référence, l’état peut récupérer des informations depuis le contexte et lancer des transitions.\n    \n4.  Le contexte et les états concrets peuvent modifier le prochain état du contexte et lancer une transition en remplaçant l’état lié au contexte.\n    \n\n## Pseudo-code\n\nDans cet exemple, le patron de conception **État** permet aux touches du lecteur multimédia d’avoir un comportement relatif à l’état actuel de la lecture.\n\n\u003cimg width=\"590\" height=\"0\" src=\"../../_resources/example_7f3ee819c1654a1da41ad9c13a1844f0.png\"/\u003e\n\nUn exemple de modification du comportement de l’objet effectué à l’aide d’objets état.\n\nL’objet principal du lecteur est toujours associé à un objet état qui effectue la majeure partie du travail pour le lecteur. Certaines actions remplacent l’état actuel du lecteur par un autre, modifiant sa manière de réagir aux interactions de l’utilisateur.\n\n```\n// La classe lecteurAudio prend le rôle du contexte. Elle\n// maintient également une référence vers l’instance de l’une\n// des classes état qui représente l’état actuel du lecteur\n// audio.\nclass AudioPlayer is\n    field state: State\n    field UI, volume, playlist, currentSong\n\n    constructor AudioPlayer() is\n        this.state = new ReadyState(this)\n\n        // Le contexte délègue la gestion des interventions de\n        // l’utilisateur à un objet état. Le résultat va\n        // évidemment dépendre de l'état actuel, puisque chaque\n        // état réagit différemment aux manipulations des\n        // utilisateurs.\n        UI = new UserInterface()\n        UI.lockButton.onClick(this.clickLock)\n        UI.playButton.onClick(this.clickPlay)\n        UI.nextButton.onClick(this.clickNext)\n        UI.prevButton.onClick(this.clickPrevious)\n\n    // Les autres objets doivent pouvoir changer l'état du\n    // lecteur audio.\n    method changeState(state: State) is\n        this.state = state\n\n    // Les méthodes de l’UI délèguent l’exécution à l'état\n    // actuel.\n    method clickLock() is\n        state.clickLock()\n    method clickPlay() is\n        state.clickPlay()\n    method clickNext() is\n        state.clickNext()\n    method clickPrevious() is\n        state.clickPrevious()\n\n    // Un état peut appeler les méthodes d’un service sur le\n    // contexte.\n    method startPlayback() is\n        // ...\n    method stopPlayback() is\n        // ...\n    method nextSong() is\n        // ...\n    method previousSong() is\n        // ...\n    method fastForward(time) is\n        // ...\n    method rewind(time) is\n        // ...\n\n// La classe de base état déclare des méthodes que tous les\n// états concrets doivent obligatoirement implémenter et fournit\n// aussi une référence arrière vers l’objet du contexte associé\n// à l’état. Les états peuvent utiliser cette référence arrière\n// pour permuter l’état du contexte.\nabstract class State is\n    protected field player: AudioPlayer\n\n    // Le contexte s’envoie lui-même au constructeur de l’état,\n    // permettant de donner un coup de pouce à l'état pour\n    // récupérer des données contextuelles si nécessaire.\n    constructor State(player) is\n        this.player = player\n\n    abstract method clickLock()\n    abstract method clickPlay()\n    abstract method clickNext()\n    abstract method clickPrevious()\n\n// Les états concrets implémentent différents comportements\n// associés à un état du contexte.\nclass LockedState extends State is\n\n    // Lorsque vous déverrouillez un lecteur verrouillé, il peut\n    // prendre l’un des deux états.\n    method clickLock() is\n        if (player.playing)\n            player.changeState(new PlayingState(player))\n        else\n            player.changeState(new ReadyState(player))\n\n    method clickPlay() is\n        // Verrouillé, ne rien faire.\n\n    method clickNext() is\n        // Verrouillé, ne rien faire.\n\n    method clickPrevious() is\n        // Verrouillé, ne rien faire.\n\n// Ils peuvent également déclencher les transitions de l’état\n// dans le contexte.\nclass ReadyState extends State is\n    method clickLock() is\n        player.changeState(new LockedState(player))\n\n    method clickPlay() is\n        player.startPlayback()\n        player.changeState(new PlayingState(player))\n\n    method clickNext() is\n        player.nextSong()\n\n    method clickPrevious() is\n        player.previousSong()\n\nclass PlayingState extends State is\n    method clickLock() is\n        player.changeState(new LockedState(player))\n\n    method clickPlay() is\n        player.stopPlayback()\n        player.changeState(new ReadyState(player))\n\n    method clickNext() is\n        if (event.doubleclick)\n            player.nextSong()\n        else\n            player.fastForward(5)\n\n    method clickPrevious() is\n        if (event.doubleclick)\n            player.previous()\n        else\n            player.rewind(5)\n\n```\n\n## Possibilités d’application\n\nUtilisez le patron de conception état lorsque le comportement de l’un de vos objets varie en fonction de son état, qu’il y a beaucoup d’états différents et que ce code change souvent.\n\nCe patron vous propose d’extraire tout le code lié aux états et de le mettre dans des classes distinctes. Ceci vous permet d’ajouter de nouveaux états ou de modifier ceux qui existent indépendamment des autres, et de réduire les coûts de maintenance.\n\nUtilisez ce patron si l’une de vos classes est polluée par d’énormes blocs conditionnels qui modifient le comportement de la classe en fonction de la valeur de ses attributs.\n\nLe patron de conception état vous permet d’extraire des branches de ces conditions et de les transformer en méthodes dans les classes état. Tout en faisant vos modifications, vous pouvez retirer les attributs temporaires et les méthodes qui gèrent les changements d’état du code de votre classe principale.\n\nUtilisez ce patron de conception si vous avez trop de code dupliqué dans des états et transitions similaires de votre automate.\n\nLe patron de conception état vous permet d’assembler des hiérarchies de classes état et de réduire la duplication de code en regroupant le code commun dans des classes de base abstraites.\n\n## Mise en œuvre\n\n1.  Choisissez la classe qui va prendre le rôle du contexte. Cette classe peut déjà exister et posséder du code qui gère les états, mais vous pouvez en créer une nouvelle si ce code est réparti dans plusieurs classes.\n    \n2.  Déclarez l’interface état. Vous pourriez très bien vous contenter de recopier toutes les méthodes déclarées dans le contexte, mais ne reprenez que celles qui concernent les états.\n    \n3.  Pour chaque état, créez une classe qui dérive de l’interface état. Parcourez ensuite les méthodes du contexte pour identifier le code qui concerne cet état et recopiez-le dans votre nouvelle classe.\n    \n    En effectuant cette manipulation, vous pourriez tomber sur des membres privés dans le contexte. Il y a plusieurs moyens de contournement :\n    \n    - Rendez ces attributs ou ces méthodes publics.\n    - Transformez le comportement que vous extrayez en méthode publique que vous mettez dans le contexte, puis appelez-la depuis la classe état. Ce n’est pas le plus esthétique, mais vous pourrez revenir dessus plus tard.\n    - Imbriquez les classes état dans la classe contexte si votre langage de programmation le permet.\n4.  Dans votre classe contexte, ajoutez un attribut qui référence le type de l’interface état et un setter public qui permet de redéfinir la valeur de cet attribut.\n    \n5.  Parcourez à nouveau les méthodes du contexte et remplacez les conditions concernant les états par des appels aux méthodes correspondantes de l’objet état.\n    \n6.  Pour changer l’état du contexte, créez une instance de l’une des classes état et passez-la au contexte. Ceci peut être fait à l’intérieur du contexte, dans les différents états ou dans le client. Où qu’elle soit, cette classe devient dépendante de la classe concrète État qu’elle instancie.\n    \n\n## Avantages et inconvénients\n\n- *Principe de responsabilité unique*. Organisez le code lié aux différents états dans des classes séparées.\n- *Principe ouvert/fermé*. Ajoutez de nouveaux états sans modifier les classes état ou le contexte existants.\n- Simplifiez le code du contexte en éliminant les gros blocs conditionnels de l’automate.\n\n- L’utilisation de ce patron est un peu exagérée si votre automate n’a que quelques états ou qu’il y a peu de transitions.\n\n## Liens avec les autres patrons\n\n- Le [Pont](https://refactoring.guru/fr/design-patterns/bridge), l’[État](https://refactoring.guru/fr/design-patterns/state), la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) (et dans une certaine mesure l’[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)) ont des structures très similaires. En effet, ces patrons sont basés sur la composition, qui délègue les tâches aux autres objets. Cependant, ils résolvent différents problèmes. Un patron n’est pas juste une recette qui vous aide à structurer votre code d’une certaine manière. C’est aussi une façon de communiquer aux autres développeurs le problème qu’il résout.\n    \n- L’[État](https://refactoring.guru/fr/design-patterns/state) peut être considéré comme une extension de la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy). Ces deux patrons de conception sont basés sur la composition : ils changent le comportement du contexte en déléguant certaines tâches aux objets assistant. La *stratégie* rend ces objets complètement indépendants sans aucune visibilité l’un sur l’autre. Cependant, l’*état* n’impose pas de restrictions sur les dépendances entre les états concrets, et leur laisse modifier l’état du contexte à volonté.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_38e38a44146a41f085d0963bf27055be.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/java/example \"Patrons de conception : État en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_dcb24a4ad5c341f5b3d1305ad5379aca.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/csharp/example \"Patrons de conception : État en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_24eb3e52cf52406c89fc6ec8740adf4b.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/cpp/example \"Patrons de conception : État en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_57b0630edcdb438d8a4d674e2e20819f.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/php/example \"Patrons de conception : État en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_04f176c1ead64aadbd2a238fb21ce06d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/python/example \"Patrons de conception : État en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_21c68026b9194c1d8d47445829541392.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/ruby/example \"Patrons de conception : État en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_0a5e43e4853747eda8130a799801c41c.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/swift/example \"Patrons de conception : État en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_83004feed206441db270c9295c520a87.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/typescript/example \"Patrons de conception : État en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_1afbe281ebeb42c59c3e6b49f6a9a082.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/state/go/example \"Patrons de conception : État en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_75b3edbae34c403987d97b67482.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n\n#### Retour\n\n[Observateur](https://refactoring.guru/fr/design-patterns/observer)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_17f812cb8d664ee5953e06b049846025.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/state \"English\") [Español](https://refactoring.guru/es/design-patterns/state \"Español\") [Français](https://refactoring.guru/fr/design-patterns/state \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/state \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/state \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/state \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/state \"Українська\") [中文](https://refactoringguru.cn/design-patterns/state \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_99a2bc13f2944cb2a3b459ecbb639f0a.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_0830521447a542b0b0614e2dd748b019.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_4c438f64160147cfbe29175337a1960c.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Iterateur":{"title":"Itérateur / Iterator","content":"\n**Itérateur** permet de parcourir les éléments d’une collection sans révéler sa représentation interne (liste, pile, arbre, etc.).\n\n![Patron de conception\u0026nbsp;itérateur](../../_resources/iterator-en_501f7a11e44141d492b0baad75db40a4.png)\n\n## Problème\n\nLes collections ne servent que de conteneur pour un groupe d’objets, mais elles demeurent l’un des types de données les plus utilisés en programmation.\n\n![Différents types de collections](../../_resources/problem1_2fc25640bca040988e4287daebb51b84.png)\n\nDifférents types de collections.\n\nLa majorité des collections stockent leurs éléments dans de simples listes, mais certaines d’entre elles sont basées sur les piles, les arbres, les graphes ou d’autres structures complexes de données.\n\nQuelle que soit sa structure, une collection doit fournir un moyen d’accéder à ses éléments pour permettre au code de les utiliser. Elle doit donner la possibilité de parcourir tous ses éléments sans passer plusieurs fois par les mêmes.\n\nÀ première vue, cela semble simple pour les collections qui ressemblent à une liste. Vous lancez juste une boucle sur tous les éléments. Mais comment faites-vous pour parcourir séquentiellement les éléments d’une structure complexe de données comme un arbre ? Un jour donné, vous allez peut-être vous en sortir avec un parcours en profondeur. Mais le lendemain, vous allez avoir besoin d’un parcours en largeur. La semaine d’après, vous allez avoir besoin d’autre chose pour établir un parcours aléatoire des éléments de l’arbre.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/problem2_0ecb79889e184ac98023693dac74e812.png\"/\u003e\n\nIl y a plusieurs manières de parcourir une même collection.\n\nPlus vous ajoutez d’algorithmes différents pour parcourir votre collection et plus vous masquez sa responsabilité principale : stocker efficacement les données. De plus, certains algorithmes sont dédiés à un usage spécifique. Il serait donc bizarre de les ajouter au comportement d’une collection générique.\n\nLe code client qui va se servir de ces collections se fiche probablement de la manière dont elles stockent leurs éléments. Cependant, ces collections fournissent différentes manières d’accéder à leurs éléments, vous couplez donc forcément votre code aux classes de ces collections.\n\n## Solution\n\nLe but du patron de conception itérateur est d’extraire le comportement qui permet de parcourir une collection et de le mettre dans un objet que l’on nomme *itérateur*.\n\n\u003cimg width=\"400\" height=\"0\" src=\"../../_resources/solution1_21256d25a80e4bcf81bc90fdc0941349.png\"/\u003e\n\nLes itérateurs implémentent différents algorithmes de parcours. Plusieurs itérateurs peuvent parcourir une même collection simultanément.\n\nEn plus d’implémenter l’algorithme de parcours, un objet itérateur encapsule tous les détails comme la position actuelle et le nombre d’éléments restants avant d’atteindre la fin. Grâce à cela, plusieurs itérateurs peuvent parcourir une même collection simultanément et indépendamment les uns des autres.\n\nEn général, les itérateurs fournissent une méthode principale pour récupérer les éléments d’une collection. Le client peut appeler la méthode en continu jusqu’à ce qu’elle ne retourne plus rien, ce qui signifie que l’itérateur a parcouru tous les éléments.\n\nLes itérateurs doivent tous implémenter la même interface. Le code client est ainsi compatible avec tous les types de collections et tous les algorithmes de parcours, tant que l’itérateur adéquat existe. Si vous voulez effectuer un parcours un peu spécial dans une collection, il vous suffit de créer une nouvelle classe itérateur, sans toucher à la collection ni au client.\n\n## Analogie\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/iterator-comic-1-fr_fcc0876115e6408691fe2cd5a9e8bc.png\"/\u003e\n\nDifférentes manières de parcourir Rome.\n\nVous projetez de visiter Rome pendant quelques jours et voulez voir ses principaux sites et attractions. Mais une fois sur place, vous risquez de perdre beaucoup de temps à tourner en rond et même de ne pas réussir à trouver le Colisée.\n\nVous pourriez acheter une application de guide virtuel sur votre smartphone qui vous permettrait de trouver votre chemin. C’est pratique et peu onéreux, et vous pourriez visiter des sites intéressants à volonté.\n\nVous pourriez également dépenser une partie de votre budget pour engager un guide local qui connait la ville comme sa poche. Il adapterait votre séjour en fonction de vos goûts et de vos attentes, vous ferait visiter toutes les attractions et vous raconterait des histoires passionnantes. Ce serait vraiment génial, mais malheureusement, beaucoup plus cher.\n\nToutes ces possibilités — des directions aléatoires que vous prenez, l’application sur smartphone ou le guide humain — sont des itérateurs sur une vaste collection de sites et d’attractions dans Rome.\n\n## Structure\n\n\u003cimg width=\"480\" height=\"0\" src=\"../../_resources/structure_1f99bf777bea49bd89ea0878050acb3d.png\"/\u003e\n\n1.  L’interface **Itérateur** déclare les opérations nécessaires au parcours d’une collection : récupérer le prochain élément, donner la position actuelle, recommencer la boucle depuis le début, etc.\n    \n2.  Les **Itérateurs Concrets** implémentent les algorithmes qui servent au parcours d’une collection. L’objet itérateur doit garder la trace du parcours actuel. Grâce à cela, plusieurs itérateurs peuvent parcourir la même collection de manière indépendante.\n    \n3.  L’interface **Collection** déclare une ou plusieurs méthodes pour récupérer des itérateurs compatibles avec la collection. Le type de retour de la méthode doit être l’interface de l’itérateur afin de permettre aux collections concrètes de renvoyer tous types d’itérateurs.\n    \n4.  Les **Collections Concrètes** renvoient les nouvelles instances de la classe concrète de l’itérateur lorsque le client en demande une. Vous vous demandez peut-être où l’on doit mettre le reste du code de la collection. Ne vous inquiétez pas, il devrait être dans la même classe. Ces détails ne sont pas très importants pour ce patron de conception, je me permets donc de les omettre.\n    \n5.  Le **Client** manipule les collections et les itérateurs grâce à leurs interfaces. Ceci permet de ne pas coupler le client avec les classes concrètes et d’utiliser différents itérateurs et collections avec le même code client.\n    \n    En général, les clients ne créent pas les itérateurs, ils les récupèrent auprès des collections. Mais dans certains cas, le client peut en créer un directement. Le client peut par exemple définir son propre itérateur spécial.\n    \n\n## Pseudo-code\n\nDans cet exemple, le patron de conception **Itérateur** va servir à parcourir un type spécial de collection qui encapsule l’accès au graphe social de Facebook. Cette collection procure plusieurs itérateurs qui parcourent les profils de différentes manières.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/example_2ddab3334fe4409a838558aa329de764.png\"/\u003e\n\nUn exemple d’itération sur les profils sociaux.\n\nL’itérateur des ‘amis’ peut être utilisé pour parcourir les amis d’un profil donné. L’itérateur des ‘collègues’ fait la même chose, sauf qu’il ignore les amis qui ne travaillent pas dans la même entreprise que la personne sélectionnée. Ces deux itérateurs implémentent une interface commune qui permet aux clients d’aller chercher les profils sans tenir compte des détails de l’implémentation, comme l’identification ou l’envoi de requêtes REST.\n\nLe code client n’est pas couplé aux classes concrètes, car il manipule les collections et les itérateurs en passant par leurs interfaces. Si vous décidez de connecter votre application à un réseau social, vous devez simplement fournir de nouvelles classes de collections et d’itérateurs sans toucher au code existant.\n\n```\n// L’interface collection doit déclarer une fabrique pour créer\n// des itérateurs. Si vous avez besoin de plusieurs types\n// d’itérations dans votre programme, vous pouvez déclarer\n// plusieurs méthodes.\ninterface SocialNetwork is\n    method createFriendsIterator(profileId):ProfileIterator\n    method createCoworkersIterator(profileId):ProfileIterator\n\n// Chaque collection concrète est couplée à un ensemble de\n// classes concrètes Itérateur qu’elle retourne. Mais le client\n// en est indépendant, car la signature de ces méthodes renvoie\n// des interfaces itérateur.\nclass Facebook implements SocialNetwork is\n    // ...Le code principal de la collection devrait être écrit\n    // ici...\n\n    // Code de création de l’itérateur.\n    method createFriendsIterator(profileId) is\n        return new FacebookIterator(this, profileId, \"friends\")\n    method createCoworkersIterator(profileId) is\n        return new FacebookIterator(this, profileId, \"coworkers\")\n\n// L’interface commune à tous les itérateurs.\ninterface ProfileIterator is\n    method getNext():Profile\n    method hasMore():bool\n\n// La classe concrète Itérateur.\nclass FacebookIterator implements ProfileIterator is\n    // L’itérateur a besoin d’une référence à la collection\n    // qu’il parcourt.\n    private field facebook: Facebook\n    private field profileId, type: string\n\n    // Un objet itérateur parcourt la collection indépendamment\n    // des autres itérateurs. Il doit donc stocker l’état de\n    // l’itération.\n    private field currentPosition\n    private field cache: array of Profile\n\n    constructor FacebookIterator(facebook, profileId, type) is\n        this.facebook = facebook\n        this.profileId = profileId\n        this.type = type\n\n    private method lazyInit() is\n        if (cache == null)\n            cache = facebook.socialGraphRequest(profileId, type)\n\n    // Chaque classe concrète Itérateur a sa propre\n    // implémentation de l’interface commune Itérateur.\n    method getNext() is\n        if (hasMore())\n            currentPosition++\n            return cache[currentPosition]\n\n    method hasMore() is\n        lazyInit()\n        return currentPosition \u003c cache.length\n\n// Voici une astuce très pratique : vous pouvez passer un\n// itérateur à une classe du client, plutôt que de lui donner\n// accès à une collection complète. Cette manipulation vous\n// permet de ne pas exposer la collection au client.\n//\n// Elle vous permet également de modifier la façon dont le\n// client fonctionne avec les collections lors de son exécution,\n// en lui passant un itérateur différent. Cette manipulation\n// serait impossible si le code client était couplé aux classes\n// concrètes de l’itérateur.\nclass SocialSpammer is\n    method send(iterator: ProfileIterator, message: string) is\n        while (iterator.hasMore())\n            profile = iterator.getNext()\n            System.sendEmail(profile.getEmail(), message)\n\n// La classe application configure les collections et les\n// itérateurs, puis les envoie au code client.\nclass Application is\n    field network: SocialNetwork\n    field spammer: SocialSpammer\n\n    method config() is\n        if working with Facebook\n            this.network = new Facebook()\n        if working with LinkedIn\n            this.network = new LinkedIn()\n        this.spammer = new SocialSpammer()\n\n    method sendSpamToFriends(profile) is\n        iterator = network.createFriendsIterator(profile.getId())\n        spammer.send(iterator, \"Very  important  message\")\n\n    method sendSpamToCoworkers(profile) is\n        iterator = network.createCoworkersIterator(profile.getId())\n        spammer.send(iterator, \"Very  important  message\")\n\n```\n\n## Possibilités d’application\n\nUtilisez le patron de conception itérateur quand la structure de données de votre collection est trop complexe et que vous voulez cacher ces détails aux clients (parce que c’est pratique ou pour des raisons de sécurité).\n\nL’itérateur encapsule le détail du fonctionnement de la structure complexe de données et passe plusieurs méthodes simples au client qui lui permettent d’accéder aux éléments de la collection. En plus d’être très pratique pour le client, ce fonctionnement permet de protéger la collection d’actions maladroites ou malicieuses que le client pourrait entreprendre s’il travaillait directement avec la collection.\n\nUtilisez l’itérateur pour que le code du parcours soit le moins dupliqué possible dans votre application.\n\nUn algorithme qui permet une itération complexe sur la collection a tendance à être très volumineux. Si on le place à l’intérieur de la logique de l’application, cela va masquer la responsabilité du code original et le rendre moins maintenable. Pour rendre le code encore plus simple et propre, vous pouvez écrire l’algorithme de parcours dans leur itérateur.\n\nUtilisez ce patron pour permettre à votre code de naviguer dans des structures de données complexes ou inconnues.\n\nCe patron procure des interfaces génériques pour les collections et les itérateurs. Si votre code utilise bien ces interfaces, il va pouvoir manipuler toutes les collections (et leurs itérateurs) qui les implémentent.\n\n## Mise en œuvre\n\n1.  Déclarez l’interface itérateur. Elle doit comporter au moins une méthode qui récupère le prochain élément de la collection. Mais pour qu’elle soit vraiment utile, vous devriez en ajouter d’autres, par exemple récupérer l’élément précédent, connaitre la position actuelle ou vérifier la fin de l’itération.\n    \n2.  Déclarez l’interface de la collection et écrivez une méthode pour récupérer les itérateurs. Le type de la valeur de retour doit être l’interface de l’itérateur. Vous pouvez déclarer des itérateurs supplémentaires si vous pensez en utiliser d’autres.\n    \n3.  Mettez en place les classes concrètes des itérateurs pour les collections que vous allez parcourir. Un objet itérateur ne peut être lié qu’à une seule instance d’une collection. En général, ce lien est établi dans le constructeur de l’itérateur.\n    \n4.  Implémentez l’interface de la collection dans les classes de collection. Son but est de fournir un raccourci pour le client qui crée les itérateurs spécifiques à chaque classe de la collection. L’objet collection doit s’envoyer lui-même au constructeur de l’itérateur pour établir un lien entre eux.\n    \n5.  Écumez le code et remplacez toutes les occurrences de parcours de collection par vos itérateurs. Le client va chercher un nouvel itérateur chaque fois qu’il parcourt les éléments d’une collection.\n    \n\n## Avantages et inconvénients\n\n- *Principe de responsabilité unique*. Vous allez nettoyer le code client et les collections en déplaçant les algorithmes de parcours — souvent très lourds — dans des classes séparées.\n- *Principe ouvert/fermé*. Vous pouvez implémenter de nouveaux types de collections et d’itérateurs et les utiliser avec le code existant sans rien endommager.\n- Vous pouvez parcourir une même collection avec plusieurs itérateurs simultanément, car chacun possède son propre état d’itération.\n- Pour cette même raison, vous pouvez arrêter une itération et la reprendre quand vous le souhaitez.\n\n- L’utilisation de ce patron est exagérée si votre application ne se sert que de collections simples.\n- Les itérateurs sont parfois moins efficaces que certaines collections spécialisées.\n\n## Liens avec les autres patrons\n\n- Vous pouvez utiliser les [Itérateurs](https://refactoring.guru/fr/design-patterns/iterator) pour parcourir des arbres [Composites](https://refactoring.guru/fr/design-patterns/composite).\n    \n- Vous pouvez utiliser la [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) avec l’[Itérateur](https://refactoring.guru/fr/design-patterns/iterator) pour permettre aux sous-classes des collections de renvoyer différents types d’itérateurs compatibles avec les collections.\n    \n- Vous pouvez utiliser le [Mémento](https://refactoring.guru/fr/design-patterns/memento) avec l’[Itérateur](https://refactoring.guru/fr/design-patterns/iterator) pour récupérer l’état actuel de l’itération et rétablir sa valeur plus tard si besoin.\n    \n- Vous pouvez utiliser le [Visiteur](https://refactoring.guru/fr/design-patterns/visitor) avec l’[Itérateur](https://refactoring.guru/fr/design-patterns/iterator) pour parcourir une structure de données complexe et lancer un traitement sur ses éléments, même s’ils ont des classes différentes.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_80295644eeeb4e4a972ef25b49bc2f84.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/java/example \"Patrons de conception : Itérateur en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_a3bb14453ba248209a05c5cf757e853d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/csharp/example \"Patrons de conception : Itérateur en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_e20bc7135f8f4cbcab34e445aab47a45.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/cpp/example \"Patrons de conception : Itérateur en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_f3b217e7d71441829db577cbd79a775f.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/php/example \"Patrons de conception : Itérateur en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_331652b8107d4be69f6cb734dfd670d8.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/python/example \"Patrons de conception : Itérateur en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_b5f3b8ad6111427db96cb188aeedb21d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/ruby/example \"Patrons de conception : Itérateur en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_2dca1076918a4873b4081dc406724da9.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/swift/example \"Patrons de conception : Itérateur en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_fafb290b652e4a6cace0e60aeebe87a8.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/typescript/example \"Patrons de conception : Itérateur en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_fbdf882ed399416899d18c0995afa795.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/iterator/go/example \"Patrons de conception : Itérateur en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_b247475588e24e328a07540bc39.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n\n#### Retour\n\n[Commande](https://refactoring.guru/fr/design-patterns/command)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_265d416a363d448ca9c0b2d2d4d267cc.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/iterator \"English\") [Español](https://refactoring.guru/es/design-patterns/iterator \"Español\") [Français](https://refactoring.guru/fr/design-patterns/iterator \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/iterator \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/iterator \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/iterator \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/iterator \"Українська\") [中文](https://refactoringguru.cn/design-patterns/iterator \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_d4a3549cf80e41cb8d56f93adbf43b33.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_32416e0a3bfd423e8b557478b85bede0.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_ea399000da7f42d690350c9008b03211.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Mediateur":{"title":"Médiateur / Mediator","content":"\n**Médiateur** diminue les dépendances chaotiques entre les objets. Il restreint les communications directes entre les objets et les force à collaborer uniquement via un objet médiateur.\n\n![Patron de conception\u0026nbsp;médiateur](../../_resources/mediator_439dcb260c8b446ab7602c447fc50598.png)\n\n## Problème\n\nPrenons une boîte de dialogue qui crée et modifie des profils client. Elle comporte plusieurs contrôles de formulaires comme des champs de texte, des cases à cocher, des boutons, etc.\n\n![Liens chaotiques entre éléments de l’interface utilisateur](../../_resources/problem1-fr_ca25d340de5d4f0b92ba3a5677f497fa.png)\n\nLes dépendances entre les éléments de l’interface utilisateur peuvent devenir chaotiques avec l’évolution de l’application.\n\nCertains éléments du formulaire peuvent interagir. Par exemple, en cochant la case « J’ai un chien », vous allez révéler un champ de texte caché qui vous permet d’écrire le nom du chien. Vous pourriez également avoir un bouton Envoyer qui doit valider les valeurs de tous les champs avant de sauvegarder les données.\n\n\u003cimg width=\"360\" height=\"0\" src=\"../../_resources/problem2_fb154012ed2c446d86e92ac310e9ab19.png\"/\u003e\n\nLes éléments peuvent avoir beaucoup de liens. De plus, la modification de certains éléments peut influer sur d’autres.\n\nEn écrivant directement la logique dans le code des éléments du formulaire, vous rendez les classes de ces éléments bien plus difficiles à réutiliser dans l’application. Par exemple, vous ne pourrez pas utiliser la classe de la case à cocher dans un autre formulaire, car elle est couplée avec le champ de texte du chien. Vous êtes par conséquent obligé d’utiliser toutes les classes du formulaire du profil si vous voulez vous servir de l’une d’entre elles.\n\n## Solution\n\nLe patron de conception médiateur vous propose de mettre fin à toutes les communications directes entre les composants et de rendre ces derniers indépendants les uns des autres. À la place, ces composants collaborent indirectement en utilisant un objet spécial médiateur qui redirige les appels vers les composants appropriés. Ainsi, les composants ne reposent que sur une seule classe médiateur plutôt que d’être couplés à de nombreux collègues.\n\nDans notre exemple qui porte sur l’édition du formulaire d’un profil, la classe dialogue peut prendre le rôle du médiateur. Elle connait déjà probablement tous ses sous-éléments, vous n’avez donc pas besoin d’y ajouter des dépendances.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/solution1-fr_e669a3897c6c4bb0b1c7783ed570c7b9.png\"/\u003e\n\nLes éléments de l’UI doivent communiquer directement avec l’objet médiateur.\n\nLe changement le plus important intervient sur les éléments du formulaire. Prenons le bouton Envoyer. Avant, chaque fois qu’un utilisateur appuyait sur ce bouton, ce dernier devait valider les valeurs des éléments individuels du formulaire. À présent, il se contente d’informer la classe dialogue lorsqu’un clic a lieu. Après avoir reçu cette notification, la classe dialogue effectue la validation ou délègue la tâche aux différents éléments. Le bouton n’est ainsi couplé qu’avec la classe dialogue, au lieu d’être relié à un paquet d’éléments.\n\nVous pouvez pousser le vice plus loin et diminuer encore plus cette dépendance en extrayant l’interface commune pour toutes ces boîtes de dialogue. L’interface devrait déclarer la méthode de notification que tous les éléments du formulaire utilisent pour prévenir la classe dialogue des événements qui les affectent. Notre bouton Envoyer devrait dorénavant pouvoir manipuler n’importe quelle boîte de dialogue qui implémente cette interface.\n\nAinsi, le patron de conception médiateur vous permet d’encapsuler une toile complexe de relations entre divers objets à l’intérieur d’un simple objet médiateur. Moins une classe a de dépendances et plus il est facile de la modifier, de l’étendre ou de la réutiliser.\n\n## Analogie\n\n\u003cimg width=\"370\" height=\"0\" src=\"../../_resources/live-example_9641ac6b666747688150ebec224d7c5b.png\"/\u003e\n\nLes pilotes d’avion ne communiquent pas directement ensemble pour déterminer qui sera le prochain à atterrir. Toute communication passe par la tour de contrôle.\n\nLes pilotes qui vont décoller ou atterrir sur la piste ne communiquent pas ensemble directement. Ils s’adressent à un contrôleur aérien qui est assis dans une grande tour près de la piste d’atterrissage. Sans lui, les pilotes seraient obligés de savoir si d’autres avions sont à proximité et décider des priorités d’atterrissage avec un ensemble de pilotes. Les accidents d’avion augmenteraient probablement beaucoup.\n\nLa tour n’a pas besoin de contrôler la totalité d’un vol. Elle n’est là que pour faire respecter des contraintes au départ et à l’arrivée, pour faire en sorte que les pilotes n’aient pas trop de paramètres à gérer.\n\n## Structure\n\n\u003cimg width=\"520\" height=\"0\" src=\"../../_resources/structure_01f0779cbc9d4706a80fbad61db44928.png\"/\u003e\n\n1.  Les classes **Composant** contiennent de la logique métier. Chaque composant possède une référence vers un médiateur, déclaré avec le type de l’interface médiateur. Le composant ne connait pas la classe du médiateur, vous pouvez ainsi réutiliser les mêmes composants dans d’autres programmes en les liant à un autre médiateur.\n    \n2.  L’interface **Médiateur** déclare des méthodes pour communiquer avec les composants et n’est généralement dotée que d’une seule méthode de notification. Les composants peuvent passer n’importe quel contexte en paramètre de cette méthode (ce qui inclut leurs propres objets), mais en évitant de provoquer un couplage entre un composant récepteur et la classe du demandeur.\n    \n3.  Les **Médiateurs Concrets** encapsulent les relations entre les divers composants. Les médiateurs concrets gardent souvent des références vers les composants qu’ils gèrent et s’occupent même parfois de leur cycle de vie.\n    \n4.  Les composants ne doivent pas avoir de visibilité sur les autres composants. S’il arrive quelque chose d’important à un composant, il doit seulement en prévenir le médiateur. Quand ce dernier reçoit la notification, il doit pouvoir facilement identifier le demandeur, ce qui peut suffire pour déterminer le composant qui doit être déclenché en retour.\n    \n    De son point de vue, le composant ne voit qu’une boîte noire. Le demandeur ne sait pas qui va se charger de sa demande, et le récepteur ignore qui l’a envoyée.\n    \n\n## Pseudo-code\n\nDans cet exemple, le **Médiateur** vous aide à éliminer les dépendances mutuelles entre différentes classes de l’UI (boutons, cases à cocher et libellés de texte).\n\n\u003cimg width=\"560\" height=\"0\" src=\"../../_resources/example_3ba810927e5d4f9f8964a3839812443b.png\"/\u003e\n\nStructure des classes des boîtes de dialogue de l’UI.\n\nUn élément déclenché par un utilisateur ne communique pas directement avec les autres éléments, même si c’est l’impression qui s’en dégage. À la place, l’élément n’a besoin que de prévenir son médiateur qu’un événement a eu lieu, en lui donnant les informations contextuelles avec la notification.\n\nDans cet exemple, la boîte de dialogue d’identification prend le rôle du médiateur. Elle sait comment les éléments concrets sont censés collaborer et facilite leur communication indirecte. Lorsque la boîte de dialogue reçoit une notification d’événement, elle sait quel élément est concerné et redirige l’appel en conséquence.\n\n```\n// L’interface médiateur déclare une méthode qui permet aux\n// composants d’avertir le médiateur au sujet de divers\n// événements. Le médiateur peut réagir à ces événements et\n// passer les appels aux autres composants.\ninterface Mediator is\n    method notify(sender: Component, event: string)\n\n// La classe concrète Médiateur. Les interconnexions entre les\n// composants individuels ont été démêlées et transférées dans\n// le médiateur.\nclass AuthenticationDialog implements Mediator is\n    private field title: string\n    private field loginOrRegisterChkBx: Checkbox\n    private field loginUsername, loginPassword: Textbox\n    private field registrationUsername, registrationPassword,\n                  registrationEmail: Textbox\n    private field okBtn, cancelBtn: Button\n\n    constructor AuthenticationDialog() is\n        // Crée les composants et passe le médiateur actuel dans\n        // leurs constructeurs pour établir les liens.\n\n    // Le médiateur est averti si un composant est affecté par\n    // quoi que ce soit. Lorsqu’un médiateur reçoit une\n    // notification, il peut lancer un traitement ou envoyer la\n    // demande à un autre composant.\n    method notify(sender, event) is\n        if (sender == loginOrRegisterChkBx and event == \"check\")\n            if (loginOrRegisterChkBx.checked)\n                title = \"Log  in\"\n                // 1. Affiche les composants du formulaire\n                // d’identification.\n                // 2. Cache les composants du formulaire\n                // d’inscription.\n            else\n                title = \"Register\"\n                // 1. Affiche les composants du formulaire\n                // d’inscription.\n                // 2. Cache les composants du formulaire\n                // d’identification.\n\n        if (sender == okBtn \u0026\u0026 event == \"click\")\n            if (loginOrRegister.checked)\n                // Essaye de trouver un utilisateur à l’aide de\n                // ses identifiants.\n                if (!found)\n                    // Montre un message d’erreur au-dessus du\n                    // champ identifiant.\n            else\n                // 1. Crée un compte utilisateur en utilisant\n                // les données saisies dans les champs\n                // d’inscription.\n                // 2. Connecte cet utilisateur.\n                // ...\n\n// Les composants communiquent avec un médiateur en utilisant\n// son interface. Grâce à cela, vous pouvez utiliser les mêmes\n// composants dans d’autres contextes en les associant avec\n// d’autres objets médiateur.\nclass Component is\n    field dialog: Mediator\n\n    constructor Component(dialog) is\n        this.dialog = dialog\n\n    method click() is\n        dialog.notify(this, \"click\")\n\n    method keypress() is\n        dialog.notify(this, \"keypress\")\n\n// Les composants concrets ne communiquent pas ensemble. Leur\n// unique canal de communication leur sert à envoyer des\n// notifications au médiateur.\nclass Button extends Component is\n    // ...\n\nclass Textbox extends Component is\n    // ...\n\nclass Checkbox extends Component is\n    method check() is\n        dialog.notify(this, \"check\")\n    // ...\n\n```\n\n## Possibilités d’application\n\nUtilisez ce patron si vous rencontrez des difficultés pour modifier certaines classes trop fortement couplées avec d’autres.\n\nLe médiateur vous permet d’extraire toutes les relations entre les classes dans une classe séparée, en isolant les modifications appliquées à un composant spécifique du reste des composants.\n\nUtilisez ce patron quand vous ne pouvez pas réutiliser un composant ailleurs, car il est trop dépendant des autres composants.\n\nAprès avoir mis en place le médiateur, les composants individuels n’ont plus de visibilité sur les autres composants. Ils peuvent toujours communiquer ensemble mais indirectement, via un objet médiateur. Pour réutiliser un composant dans une application différente, vous n’avez besoin que de lui fournir une classe médiateur.\n\nUtilisez le médiateur lorsque vous créez des tonnes de sous-classes pour les composants, juste pour pouvoir bénéficier de leur comportement de base dans différents contextes.\n\nToutes les relations entre composants se trouvent à l’intérieur d’un médiateur. De nouvelles classes médiateur peuvent donc facilement définir de nouveaux moyens de collaboration pour ces composants sans avoir à les modifier.\n\n## Mise en œuvre\n\n1.  Identifiez des classes qui sont fortement couplées et qui pourraient bénéficier de plus d’indépendance (pour une maintenance plus aisée ou pour faciliter la réutilisation de ces classes).\n    \n2.  Déclarez l’interface médiateur et écrivez le protocole de communication voulu entre les médiateurs et les différents composants. Dans la plupart des cas, une seule méthode est suffisante pour recevoir les notifications des composants.\n    \n    Cette interface est cruciale si vous voulez pouvoir réutiliser les classes des composants dans différents contextes. Tant que le composant communique avec le médiateur en passant par l’interface générique, vous pouvez relier le composant avec une implémentation différente du médiateur.\n    \n3.  Implémentez la classe concrète du médiateur. Faites en sorte que cette classe garde des références vers tous les composants qu’elle gère. Elle en tirera de gros bénéfices.\n    \n4.  Vous pouvez encore aller plus loin en rendant le médiateur responsable de la création et de la destruction des objets composant. Le médiateur ressemblera ainsi à une [fabrique](https://refactoring.guru/fr/design-patterns/abstract-factory \"Fabrique abstraite\") ou à une [façade](https://refactoring.guru/fr/design-patterns/facade).\n    \n5.  Les composants doivent avoir une référence vers l’objet médiateur. La connexion est souvent établie dans le constructeur du composant, dans lequel un objet médiateur est passé en paramètre.\n    \n6.  Modifiez le code des composants afin qu’ils appellent la méthode de notification du médiateur plutôt que des méthodes écrites dans d’autres composants. Mettez tout le code qui appelle les autres composants dans la classe médiateur, puis appelez-le lorsque le médiateur reçoit des notifications de ce composant.\n    \n\n## Avantages et inconvénients\n\n- *Principe de responsabilité unique*. Vous pouvez mettre les communications entre les différents composants au même endroit, rendant le code plus facile à comprendre et à maintenir.\n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouveaux médiateurs sans avoir à modifier les composants déjà en place.\n- Vous diminuez le couplage entre les différents composants d’un programme.\n- Vous pouvez réutiliser les composants individuels plus facilement.\n\n- Avec le temps, un médiateur peut évoluer en [Objet Omniscient](https://refactoring.guru/fr/antipatterns/god-object).\n\n## Liens avec les autres patrons\n\n- La [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility), la [Commande](https://refactoring.guru/fr/design-patterns/command), le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) et l’[Observateur](https://refactoring.guru/fr/design-patterns/observer) proposent différentes solutions pour associer les demandeurs et les récepteurs.\n    \n    - La *chaîne de responsabilité* envoie une demande ordonnée qui est passée tout au long d’une chaîne dynamique de récepteurs potentiels, jusqu’à ce que l’un d’entre eux décide de la traiter.\n    - La *commande* établit des connexions unidirectionnelles entre les demandeurs et les récepteurs.\n    - Le *médiateur* élimine les liens directs entre les demandeurs et les récepteurs, et les force à communiquer indirectement via un objet médiateur.\n    - L’*observateur* permet aux récepteurs de s’inscrire et de se désinscrire dynamiquement à la réception des demandes.\n- La [Façade](https://refactoring.guru/fr/design-patterns/facade) et le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) ont des rôles similaires : ils essayent de faire collaborer des classes étroitement liées.\n    \n    - La *façade* définit une interface simplifiée pour un sous-système d’objets, mais elle n’ajoute pas de nouvelles fonctionnalités. Le sous-système est conscient de l’existence de la façade. Les objets situés à l’intérieur du sous-système peuvent communiquer directement.\n    - Le *médiateur* centralise la communication entre les composants du système. Les composants ne voient que l’objet médiateur et ne communiquent pas directement.\n- La différence entre le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) et l’[Observateur](https://refactoring.guru/fr/design-patterns/observer) est souvent très fine. Dans la majorité des cas, vous pouvez implémenter l’un ou l’autre, mais parfois vous pouvez les utiliser simultanément. Regardons comment faire.\n    \n    Le but principal du *médiateur* est d’éliminer les dépendances mutuelles entre un ensemble de composants du système. À la place, ces composants peuvent devenir dépendants d’un unique objet médiateur. Le but de l’*observateur* est d’établir des connexions dynamiques à sens unique entre les objets, où certains objets peuvent être les subordonnés d’autres objets.\n    \n    Il existe une implémentation populaire du *médiateur* qui repose sur l’*observateur*. L’objet médiateur joue le rôle du diffuseur et les composants agissent comme des souscripteurs qui s’inscrivent et se désinscrivent des événements du médiateur. Lorsque ce type de conception est mis en place, le *médiateur* ressemble de près à l’*observateur*.\n    \n    Si vous êtes un peu perdu, rappelez-vous qu’il y a plusieurs manières d’implémenter le médiateur. Par exemple, vous pouvez associer de manière permanente tous les composants au même objet médiateur. Cette implémentation ne ressemblera pas à l’*observateur*, mais sera tout de même une instance du patron de conception médiateur.\n    \n    Maintenant, imaginez un programme dont tous les composants sont devenus des diffuseurs, permettant des connexions dynamiques les uns avec les autres. Nous n’aurons pas d’objet médiateur centralisé, seulement un ensemble d’observateurs distribués.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_48593603ce014b40a9fcce2b1a6a4f19.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/java/example \"Patrons de conception : Médiateur en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_de1bfccd8e6f41d8b949760accc460d3.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/csharp/example \"Patrons de conception : Médiateur en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_1598bf3540e34d2c87f5f869d57762f7.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/cpp/example \"Patrons de conception : Médiateur en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_b24f90df19c848b991d05559151ef163.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/php/example \"Patrons de conception : Médiateur en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_c75d74cbe1c64ae1aa8899b5f2906d7d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/python/example \"Patrons de conception : Médiateur en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_976fc074c6f94ec8a742a4498b4dc02d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/ruby/example \"Patrons de conception : Médiateur en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_e44d8b6c28c046caa7d9a354a78b1d72.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/swift/example \"Patrons de conception : Médiateur en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_864db6cc9e8c401ebae6865d606f1cbb.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/typescript/example \"Patrons de conception : Médiateur en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_062ad75dfd424a52ade66c4af740b5ba.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/mediator/go/example \"Patrons de conception : Médiateur en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_27d0684a40f6495fbf596613451.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Mémento](https://refactoring.guru/fr/design-patterns/memento)\n\n#### Retour\n\n[Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_9955f58440e541408b66399a05cb111a.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/mediator \"English\") [Español](https://refactoring.guru/es/design-patterns/mediator \"Español\") [Français](https://refactoring.guru/fr/design-patterns/mediator \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/mediator \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/mediator \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/mediator \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/mediator \"Українська\") [中文](https://refactoringguru.cn/design-patterns/mediator \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_d8c8406bb2d24c958a8bad22c8fef870.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_77dbcf600a7b4c408ff655115196342f.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_fb5da57192134c2ab0bc7d74b7d210df.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Memento":{"title":"Mémento / Memento","content":"\n**Mémento** permet de sauvegarder et de rétablir l’état précédent d’un objet sans révéler les détails de son implémentation.\n\n![Patron de conception\u0026nbsp;mémento](../../_resources/memento-fr_66e03e2a2fea4a8282a85380144a01fa.png)\n\n## Problème\n\nImaginez que vous êtes en train de créer un éditeur de texte. En plus de pouvoir écrire du texte, votre éditeur permet de le formater, d’insérer des images alignées, etc.\n\nAu bout d’un moment, vous décidez d’ajouter une fonctionnalité qui permet aux utilisateurs d’annuler une action sur le texte. Cette fonctionnalité est devenue si classique au fil des années, que les utilisateurs s’attendent systématiquement à en disposer. Vous choisissez une approche directe pour la mettre en place. Avant d’effectuer une action, l’application enregistre l’état de tous les objets et les sauvegarde. Plus tard, lorsqu’un utilisateur décide d’annuler une action, l’application récupère la dernière sauvegarde de l’historique et s’en sert pour restaurer l’état de tous les objets.\n\n\u003cimg width=\"470\" height=\"0\" src=\"../../_resources/problem1-fr_fa7f3dd064484673adf792002729e3af.png\"/\u003e\n\nAvant d’effectuer une action, l’application prend un instantané (snapshot) du dernier état des objets. Il peut être utilisé plus tard pour rétablir les objets dans leur ancien état.\n\nPrenons un moment pour réfléchir à ces photos. Comment va-t-on s’y prendre pour les créer ? Vous allez probablement devoir parcourir tous les attributs d’un objet et copier leurs valeurs quelque part. Cependant, cela ne fonctionnera que si le contenu de l’objet ne possède pas trop de restrictions. Malheureusement, la plupart des objets ne se laissent pas approcher si facilement et cachent les données importantes dans des attributs privés.\n\nLaissons de côté ce problème pour le moment et considérons que nos objets se comportent en bons hippies : ils préfèrent avoir des relations ouvertes et garder leur état public. Même si cette approche nous permet de produire des instantanés de l’état des objets à volonté, de sérieux problèmes demeurent. Dans le futur, vous pourriez décider de refactoriser certaines classes de l’éditeur, ou d’ajouter ou de supprimer certains attributs. Cela semble facile à première vue, mais vous allez devoir également modifier les classes qui ont la responsabilité de créer la copie de l’état des objets concernés.\n\n\u003cimg width=\"300\" height=\"0\" src=\"../../_resources/problem2-fr_80975a310d0f4d7bb8a8ab114078b84f.png\"/\u003e\n\nComment faire une copie de l’état privé d’un objet ?\n\nMais ce n’est pas tout ! Regardons un peu du côté des « photos » de l’état de l’éditeur. Quel genre de données contiennent-elles ? On doit au moins avoir accès aux coordonnées du curseur de la souris, à la position de la barre de défilement, etc. Pour prendre une photo, vous devez récupérer ces valeurs et les mettre dans un conteneur.\n\nVous allez très certainement stocker un paquet de ces conteneurs dans une liste qui représente l’historique. Ces conteneurs seront probablement les objets d’une classe. Cette classe possèdera très peu de méthodes, mais aura beaucoup d’attributs qui répliquent l’état de l’éditeur. Pour permettre à d’autres objets de lire et d’écrire les données d’une photo, vous allez devoir rendre ses attributs publics, ce qui exposerait les états de l’éditeur, qu’ils soient privés ou non. Les autres classes deviendraient dépendantes au moindre changement apporté à la classe photo. Si nous rendons ses attributs et méthodes privés, ces changements ne seraient de toute façon pas répercutés sur les autres classes.\n\nIl semblerait que nous sommes dans une impasse : soit on expose tous les détails d’une classe, ce qui les rend trop fragiles, soit on restreint l’accès à leur état, ce qui empêche de prendre des instantanés. Dispose-t-on d’une autre technique pour implémenter un « annuler » ?\n\n## Solution\n\nTous les problèmes que nous rencontrons sont provoqués par une mauvaise encapsulation. Certains objets essayent d’en faire plus que ce qu’ils sont supposés faire. Pour récupérer les données dont ils ont besoin pour effectuer une action, ils envahissent l’espace personnel des autres objets, plutôt que de leur demander d’exécuter l’action eux-mêmes.\n\nLe mémento délègue la création des états des photos à leur propriétaire, l’objet *créateur* (originator). Plutôt que d’essayer de copier l’état de l’éditeur depuis « l’extérieur », la classe de l’éditeur de texte peut prendre la photo elle-même, car elle a accès à son propre état.\n\nCe patron propose de stocker la copie de l’état de l’objet dans un objet spécial appelé *mémento*. Son contenu n’est accessible que pour l’objet qui l’a créé. Les autres objets peuvent communiquer avec les mémentos via une interface limitée qui leur permet de récupérer certaines métadonnées de la photo (date de création, nom de l’action effectuée, etc.), mais pas l’état de l’objet original contenu dans la photo.\n\n\u003cimg width=\"610\" height=\"0\" src=\"../../_resources/solution-fr_e5c079381dc546f4b3d5f0f7d4f60733.png\"/\u003e\n\nLe créateur a un accès total au mémento, alors que le gardien ne peut que consulter les métadonnées.\n\nUne telle stratégie vous permet de stocker des mémentos à l’intérieur d’autres objets que l’on appelle *gardiens* (caretakers). Le gardien ne manipule le mémento qu’en passant par l’interface limitée. Il ne peut donc pas modifier les états qui y sont stockés. De son côté, le créateur rétablit les états qu’il désire, car il a accès à tous les attributs du mémento.\n\nDans l’exemple de notre éditeur de texte, nous pouvons créer une classe historique séparée qui prend le rôle du gardien. La pile de mémentos stockée dans le gardien va grandir chaque fois que l’éditeur va effectuer une action. Vous pouvez même afficher cette pile dans l’interface utilisateur, afin de montrer les dernières opérations effectuées par un utilisateur.\n\nLorsqu’un utilisateur veut annuler une action, l’historique prend le mémento le plus récent de la pile et l’envoie à l’éditeur en demandant un rollback. Comme l’éditeur possède un accès total au mémento, il change lui-même son état en copiant les valeurs du mémento.\n\n## Structure\n\n#### Implémentation basée sur des classes imbriquées\n\nL’implémentation classique du patron repose sur le principe des classes imbriquées, disponibles dans de nombreux langages de programmation populaires (comme le C++, C# et Java).\n\n\u003cimg width=\"580\" height=\"0\" src=\"../../_resources/structure1_34c2ae97af17429ebb3694f5c21bf5eb.png\"/\u003e\n\n1.  La classe **Créateur** (Originator) peut prendre des instantanés de son propre état, et le restaurer à volonté.\n    \n2.  Le **Mémento** est un objet de valeur qui joue le rôle d’un instantané d’un état du créateur. En général, le mémento n’est pas modifiable et écrit ses données une seule fois dans son constructeur.\n    \n3.  Le **Gardien** sait « quand » et « pourquoi » il doit photographier l’état du créateur, mais il sait également quand l’état doit être restauré.\n    \n    Le gardien peut conserver la trace de l’historique du créateur en enregistrant une pile de mémentos. Lorsque le créateur veut revenir dans le passé, le gardien récupère l’élément du haut de la pile et l’envoie à la méthode de restauration du créateur.\n    \n4.  Dans cette implémentation, la classe mémento est imbriquée à l’intérieur du créateur. Ceci permet au créateur d’accéder aux attributs et méthodes du mémento, même s’ils sont privés. Le gardien quant à lui n’a qu’un accès limité aux attributs et méthodes du mémento : on le laisse entasser les mémentos dans la pile, mais il ne peut pas les modifier.\n    \n\n#### Implémentation basée sur une interface intermédiaire\n\nVoici une autre possibilité très pratique pour les langages qui ne gèrent pas les classes imbriquées (oui PHP, je te regarde).\n\n\u003cimg width=\"560\" height=\"0\" src=\"../../_resources/structure2_f623ccee869148db8ac94dba7b451b89.png\"/\u003e\n\n1.  En l’absence de classes imbriquées, vous pouvez restreindre l’accès aux attributs du mémento en établissant une convention : les gardiens ne vont pouvoir manipuler un mémento qu’à travers une interface intermédiaire déclarée explicitement. Cette interface ne déclare que des méthodes liées aux métadonnées du mémento.\n    \n2.  De leur côté, les créateurs peuvent manipuler directement les objets mémento, accéder à leurs attributs et méthodes déclarés dans la classe mémento. L’inconvénient de cette technique est que vous devez déclarer tous les membres du mémento en public.\n    \n\n#### Implémentation avec une encapsulation encore plus stricte\n\nSi vous ne voulez vraiment pas que les autres classes accèdent au créateur en passant par le mémento, vous pouvez vous y prendre différemment.\n\n\u003cimg width=\"590\" height=\"0\" src=\"../../_resources/structure3_82aecfba5f5b4323bafec0affac38f07.png\"/\u003e\n\n1.  Cette implémentation permet de gérer plusieurs créateurs et plusieurs mémentos. Chaque créateur manipule sa propre classe mémento. Les créateurs et les mémentos n’exposent pas leur état aux autres.\n    \n2.  Il est désormais explicité que les gardiens ne peuvent pas modifier l’état stocké dans le mémento. De plus, la classe gardien n’est plus couplée avec le créateur, car la méthode de restauration est maintenant définie dans la classe mémento.\n    \n3.  Chaque mémento devient lié au créateur qui l’a produite. Le créateur s’envoie lui-même et toutes les valeurs de son état au constructeur du mémento. Grâce à l’étroite proximité de ces deux classes, un mémento peut restaurer l’état de son créateur, tant que ce dernier a bien défini les setters appropriés.\n    \n\n## Pseudo-code\n\nCet exemple utilise le patron [Commande](https://refactoring.guru/fr/design-patterns/command) en plus du mémento pour stocker les photos de l’état de l’éditeur de texte complexe, et rétablit un état précédent lorsqu’on le lui demande.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/example_5e4ab6e60ec64528baac79ac3f05dd8b.png\"/\u003e\n\nSauvegarder des photos de l’état de l’éditeur de texte.\n\nLes objets commande prennent le rôle de gardiens. Ils vont chercher le mémento de l’éditeur avant de lancer les actions déclenchées par les commandes. Lorsqu’un utilisateur veut annuler l’action la plus récente, l’éditeur peut se servir du mémento stocké dans cette commande pour revenir à son état précédent.\n\nLa classe mémento ne déclare aucun attribut public, ni de getters et de setters. Aucun objet ne peut modifier son contenu. Les mémentos sont reliés à l’objet éditeur qui les a créés. Le mémento peut aussi restaurer l’état de l’éditeur qui lui est associé, en passant les données dans les setters de l’objet éditeur. Comme les mémentos sont liés à des objets éditeur spécifiques, votre application peut gérer plusieurs fenêtres avec des éditeurs indépendants et une pile centralisée d’états à rétablir.\n\n```\n// Le créateur conserve des données importantes qui varient\n// parfois avec le temps. Il définit également une méthode pour\n// sauvegarder son état dans un mémento, et une autre méthode\n// pour rétablir cet état.\nclass Editor is\n    private field text, curX, curY, selectionWidth\n\n    method setText(text) is\n        this.text = text\n\n    method setCursor(x, y) is\n        this.curX = x\n        this.curY = y\n\n    method setSelectionWidth(width) is\n        this.selectionWidth = width\n\n    // Sauvegarde l’état actuel dans un mémento.\n    method createSnapshot():Snapshot is\n        // Le mémento est un objet non modifiable. C’est pour\n        // cela que le créateur passe son état dans les\n        // paramètres du constructeur du mémento.\n        return new Snapshot(this, text, curX, curY, selectionWidth)\n\n// La classe mémento conserve un ancien état de l’éditeur.\nclass Snapshot is\n    private field editor: Editor\n    private field text, curX, curY, selectionWidth\n\n    constructor Snapshot(editor, text, curX, curY, selectionWidth) is\n        this.editor = editor\n        this.text = text\n        this.curX = x\n        this.curY = y\n        this.selectionWidth = selectionWidth\n\n    // Un objet mémento peut être utilisé pour rétablir un\n    // ancien état de l’éditeur.\n    method restore() is\n        editor.setText(text)\n        editor.setCursor(curX, curY)\n        editor.setSelectionWidth(selectionWidth)\n\n// Un objet commande peut prendre le rôle du gardien. Dans ce\n// cas, un mémento est affecté à la commande juste avant que\n// l'état du créateur ne change. Lorsqu’une demande de\n// restauration arrive, il rétablit l’état du créateur à partir\n// du mémento.\nclass Command is\n    private field backup: Snapshot\n\n    method makeBackup() is\n        backup = editor.createSnapshot()\n\n    method undo() is\n        if (backup != null)\n            backup.restore()\n    // ...\n\n```\n\n## Possibilités d’application\n\nUtilisez le mémento si vous voulez prendre des photos de l’état d’un objet afin de pouvoir rétablir un de ses états précédents.\n\nLe mémento vous permet de faire des copies complètes de l’état d’un objet (attributs privés inclus), et les stocke en dehors de l’objet. Ce patron est surtout connu pour l’utilisation de la fonctionnalité annuler, mais est également indispensable pour les transactions (par exemple, pour permettre le rollback d’une opération en erreur).\n\nUtilisez ce patron lorsque vous ne pouvez pas accéder directement aux attributs/getters/setters d’un objet sans enfreindre les principes de l’encapsulation.\n\nLe mémento rend l’objet responsable de lui-même, ce qui sécurise les données de l’état de l’objet. Aucun autre objet ne peut lire les données de la photo, l’objet original est donc complètement sécurisé.\n\n## Mise en œuvre\n\n1.  Déterminez la classe qui jouera le rôle du créateur. Il est important de savoir si le programme va utiliser un seul objet central ou plusieurs petits objets.\n    \n2.  Créez la classe mémento. Déclarez un à un l’ensemble des attributs qui recopient les attributs de la classe créateur.\n    \n3.  Rendez la classe mémento non modifiable. Un mémento ne doit écrire ses données qu’une seule fois via son constructeur. Sa classe ne doit pas avoir de setters.\n    \n4.  Si votre langage de programmation accepte les classes imbriquées, mettez le mémento à l’intérieur du créateur. Sinon, extrayez une interface vide depuis la classe du mémento et obligez les autres objets à utiliser cette interface pour y accéder. Vous pouvez ajouter des opérations sur les métadonnées dans l’interface, mais rien qui ne puisse exposer l’état du créateur.\n    \n5.  Ajoutez une méthode qui crée des mémentos à la classe créateur. Le créateur doit passer son état dans un ou plusieurs paramètres du constructeur du mémento.\n    \n    Le type de la valeur de retour de la méthode doit être l’interface extraite dans l’étape précédente (si vous avez suivi cette étape). La méthode qui crée le mémento doit directement manipuler la classe mémento.\n    \n6.  Écrivez la méthode qui permet de rétablir l’état du créateur dans sa propre classe. Il doit prendre un objet mémento en paramètre. Si vous avez extrait une interface lors de l’une des étapes précédentes, c’est le type de la valeur de retour que cette méthode doit accepter. Dans ce cas, vous devez caster cet objet dans la classe mémento, car le créateur a besoin d’un accès total à cet objet.\n    \n7.  Le gardien, que ce soit une commande, un historique ou n’importe quoi d’autre, doit savoir quand demander de nouveaux mémentos au créateur, comment les stocker et quand restaurer le créateur à l’aide d’un mémento donné.\n    \n8.  Le lien entre les gardiens et les créateurs peut être déplacé dans la classe mémento. Dans ce cas, chaque mémento doit être associé à son propre créateur. La méthode de restauration doit également être déplacée dans la classe mémento. Mais faites-le uniquement si la classe mémento est imbriquée dans son créateur, ou si la classe du créateur fournit assez de setters pour redéfinir son état.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez prendre des instantanés de l’état d’un objet tout en respectant son encapsulation.\n- Vous pouvez simplifier le code du créateur en laissant le gardien gérer l’historique de l’état du créateur.\n\n- L’application pourrait consommer beaucoup de RAM si les clients créent des mémentos trop souvent.\n- Les gardiens doivent garder la trace du cycle de vie des créateurs pour pouvoir détruire les mémentos obsolètes.\n- La majorité des langages de programmation dynamiques comme le PHP, Python ou le JavaScript ne peuvent pas garantir que l’état sauvegardé dans le mémento ne sera pas modifié.\n\n## Liens avec les autres patrons\n\n- Vous pouvez utiliser la [Commande](https://refactoring.guru/fr/design-patterns/command) et le [Mémento](https://refactoring.guru/fr/design-patterns/memento) ensemble pour implémenter la fonctionnalité « annuler ». Dans ce cas, les commandes ont la responsabilité d’exécuter les divers traitements sur un objet cible. Les mémentos sauvegardent l’état de cet objet juste avant le lancement de la commande.\n    \n- Vous pouvez utiliser le [Mémento](https://refactoring.guru/fr/design-patterns/memento) avec l’[Itérateur](https://refactoring.guru/fr/design-patterns/iterator) pour récupérer l’état actuel de l’itération et rétablir sa valeur plus tard si besoin.\n    \n- Parfois le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) peut venir remplacer le [Mémento](https://refactoring.guru/fr/design-patterns/memento) et proposer une solution plus simple. Cela n’est possible que si l’objet (l’état que vous voulez stocker dans l’historique) est assez direct et ne possède pas de liens vers des ressources externes, ou que les liens sont faciles à recréer.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_bb24a0ec83eb45659ad0ca626065e81a.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/java/example \"Patrons de conception : Mémento en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_acaaf63c1dc342faaaca6a691718109d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/csharp/example \"Patrons de conception : Mémento en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_dbe89c1423f94fc18dfa833ff90c966d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/cpp/example \"Patrons de conception : Mémento en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_36f9f74901434ccfad22ee18aaa66e6c.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/php/example \"Patrons de conception : Mémento en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_d4f6bc1d3e7948f589cec749d357e508.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/python/example \"Patrons de conception : Mémento en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_c9324f1b778841b3850b5c5f3fa1fd1a.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/ruby/example \"Patrons de conception : Mémento en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_f71621aeb3f442ad90fa8e259d0d8082.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/swift/example \"Patrons de conception : Mémento en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_354a1917fe32401b8c3f7614927b900e.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/typescript/example \"Patrons de conception : Mémento en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_5e5cce54e2034d98909afff545fadb29.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/memento/go/example \"Patrons de conception : Mémento en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_89ed79455d9440fd824034deb5f.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Observateur](https://refactoring.guru/fr/design-patterns/observer)\n\n#### Retour\n\n[Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_182eb7a47d2a4b7f8e875095be2a48df.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/memento \"English\") [Español](https://refactoring.guru/es/design-patterns/memento \"Español\") [Français](https://refactoring.guru/fr/design-patterns/memento \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/memento \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/memento \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/memento \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/memento \"Українська\") [中文](https://refactoringguru.cn/design-patterns/memento \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_233a9b0746fa4eb5aa4fe979ce2218a7.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_7110bf5a5ba24131870dc90154a62986.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_92749a2b41304699a390922775e15f9e.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Observateur":{"title":"Observateur / Observer","content":"\nL’**Observateur** permet de mettre en place un mécanisme de souscription pour envoyer des notifications à plusieurs objets, au sujet d’événements concernant les objets qu’ils observent.\n\n![Patron de conception\u0026nbsp;observateur](../../_resources/observer_cd44810e58424fcf996dc6dd8ea71b07.png)\n\n## Problème\n\nImaginez que vous avez deux types d’objets : un `Client` et un `Magasin`. Le client s’intéresse à une marque spécifique d’un produit (disons que c’est un nouveau modèle d’iPhone) qui sera bientôt disponible dans la boutique.\n\nLe client pourrait se rendre sur place tous les jours et vérifier la disponibilité du produit. Mais comme le produit n’est pas encore prêt, ses allées et venues seraient inutiles.\n\n![Se rendre au magasin ou envoyer du spam](../../_resources/observer-comic-1-fr_80107edbebe24cc98e769565366b00.png)\n\nSe rendre au magasin ou envoyer du spam.\n\nÀ la place, le magasin pourrait envoyer des tonnes d’e-mails (ce qui peut être vu comme du spam) à leurs clients chaque fois qu’un nouveau produit est disponible. Cette solution économiserait bien des voyages à leurs clients. En contrepartie, le magasin risque de se mettre à dos ceux qui ne sont pas intéressés par les nouveaux produits.\n\nNous nous retrouvons dans une situation conflictuelle. Soit les clients perdent leur temps à venir vérifier la disponibilité des produits, soit le magasin gâche des ressources pour prévenir des clients qui ne sont pas concernés.\n\n## Solution\n\nL’objet que l’on veut suivre est en général appelé *sujet*, mais comme il va envoyer des notifications pour prévenir les autres objets dès qu’il est modifié, nous l’appellerons *diffuseur* (publisher). Tous les objets qui veulent suivre les modifications apportées au diffuseur sont appelés des *souscripteurs* (subscribers).\n\nLe patron de conception Observateur vous propose d’ajouter un mécanisme de souscription à la classe diffuseur pour permettre aux objets individuels de s’inscrire ou se désinscrire de ce diffuseur. Pas d’inquiétude ! Ce n’est pas si compliqué que cela en a l’air. En réalité, ce mécanisme est composé 1) d’un tableau d’attributs qui stocke une liste de références vers les objets souscripteur et 2) de plusieurs méthodes publiques qui permettent d’ajouter ou de supprimer des souscripteurs de cette liste.\n\n\u003cimg width=\"470\" height=\"0\" src=\"../../_resources/solution1-fr_f7e5474286de4c84bb5d0c1fd5a26b0e.png\"/\u003e\n\nUn mécanisme de souscription qui permet aux objets individuels de s’inscrire aux notifications des événements.\n\nQuand un événement important arrive au diffuseur, il fait le tour de ses souscripteurs et appelle la méthode de notification sur leurs objets.\n\nLes applications peuvent comporter des dizaines de classes souscripteur différentes qui veulent être tenues au courant des événements qui affectent une même classe diffuseur. Vous n’avez sûrement pas envie de coupler le diffuseur à toutes ces classes. De plus, certaines ne seront peut-être pas connues à l’avance, dans les cas où votre classe diffuseur est censée pouvoir être utilisée par d’autres personnes.\n\nC’est pourquoi il est crucial que tous les souscripteurs implémentent la même interface et qu’elle soit le seul moyen utilisé par le diffuseur pour communiquer avec eux. Elle doit déclarer la méthode de notification avec un ensemble de paramètres que le diffuseur peut utiliser pour envoyer des données contextuelles avec la notification.\n\n\u003cimg width=\"460\" height=\"0\" src=\"../../_resources/solution2-fr_3d8497b4c27a4b318d29a0ab457aadcb.png\"/\u003e\n\nLe diffuseur envoie des notifications aux souscripteurs en appelant la méthode de notification spécifique sur leurs objets.\n\nDe plus, les diffuseurs doivent tous suivre la même interface si votre application en comporte plusieurs types et que vous voulez que vos souscripteurs soient tous compatibles avec eux. Cette interface doit contenir quelques méthodes de souscription et elle doit permettre aux souscripteurs d’observer les états du diffuseur sans le coupler avec leurs classes concrètes.\n\n## Analogie\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/observer-comic-2-fr_c30250ceed22477488c7a7460e0abd.png\"/\u003e\n\nAbonnement aux magazines et aux journaux.\n\nLorsque vous vous inscrivez à un journal ou à un magazine, vous n’avez plus besoin de vous rendre en magasin pour vérifier si le dernier numéro est sorti. À la place, le diffuseur vous envoie directement les nouveaux numéros dans votre boîte aux lettres dès qu’ils le publient, ou même parfois en avance.\n\nLe diffuseur garde une liste de souscripteurs et connait les magazines qui les intéressent. S’ils ne souhaitent plus recevoir les nouveaux numéros, les souscripteurs peuvent quitter la liste à n’importe quel moment.\n\n## Structure\n\n\u003cimg width=\"610\" height=\"0\" src=\"../../_resources/structure_5a495d48b0c448cba69f66acb7002f9b.png\"/\u003e\n\n1.  Le **Diffuseur** envoie des événements intéressants à d’autres objets. Ces événements se produisent quand le diffuseur change d’état ou exécute certains comportements. Le diffuseur possède une infrastructure d’inscription qui permet aux nouveaux souscripteurs de rejoindre la liste et aux souscripteurs actuels de la quitter.\n    \n2.  Quand un nouvel événement survient, le diffuseur parcourt la liste d’inscriptions et appelle la méthode de notification déclarée dans l’interface des souscripteurs sur chaque objet souscripteur.\n    \n3.  L’interface **Souscripteur** déclare les méthodes de notification. Dans la majorité des cas, il n’y a qu’une seule méthode `update`. Elle peut prendre plusieurs paramètres pour que le diffuseur leur envoie plus de détails concernant la modification.\n    \n4.  Les **Souscripteurs Concrets** exécutent certaines actions en réponse aux notifications envoyées par le diffuseur. Toutes ces classes doivent implémenter la même interface pour ne pas coupler le diffuseur avec leurs classes concrètes.\n    \n5.  En général, les souscripteurs ont besoin de détails à propos du contexte afin d’exécuter correctement la mise à jour. C’est pour cela que les diffuseurs passent souvent des données du contexte en paramètre de la méthode de notification. Le diffuseur peut même s’envoyer lui-même en paramètre et laisser les souscripteurs récupérer directement les données nécessaires.\n    \n6.  Le **Client** crée des objets diffuseur et Souscripteur séparément et inscrit les souscripteurs aux mises à jour du diffuseur.\n    \n\n## Pseudo-code\n\nDans cet exemple, le patron de conception **Observateur** permet à l’objet éditeur de texte d’avertir d’autres objets de service des changements de son état.\n\n\u003cimg width=\"510\" height=\"0\" src=\"../../_resources/example_3551f760a6ad43d593e1b20ae3c0f9eb.png\"/\u003e\n\nEnvoyer des notifications aux objets au sujet d’événements qui affectent d’autres objets.\n\nLa liste des souscripteurs est compilée dynamiquement : les objets peuvent commencer ou arrêter de suivre les notifications lors du lancement de l’application, en fonction du comportement voulu.\n\nDans cette implémentation, la classe éditeur ne gère pas la liste des souscripteurs toute seule. Elle délègue la tâche à l’objet spécial assistant dont c’est la seule tâche. Vous pouvez moduler cet objet afin qu’il serve de centrale de distribution, transformant n’importe quel objet en diffuseur.\n\nTant que les classes diffuseur passent toutes par la même interface pour communiquer avec les souscripteurs, l’ajout de nouveaux souscripteurs ne nécessite aucun changement dans les classes diffuseur.\n\n```\n// La classe de base diffuseur contient le code pour\n// l’inscription et les méthodes de notification.\nclass EventManager is\n    private field listeners: hash map of event types and listeners\n\n    method subscribe(eventType, listener) is\n        listeners.add(eventType, listener)\n\n    method unsubscribe(eventType, listener) is\n        listeners.remove(eventType, listener)\n\n    method notify(eventType, data) is\n        foreach (listener in listeners.of(eventType)) do\n            listener.update(data)\n\n// Le diffuseur concret abrite de la logique métier dédiée à\n// certains souscripteurs. Nous pourrions dériver cette classe\n// depuis le diffuseur de base, mais ce n’est pas toujours\n// possible, car le diffuseur concret pourrait déjà être une\n// sous-classe. Dans ce cas, vous pouvez utiliser la composition\n// pour effectuer le lien avec la logique de souscription, comme\n// effectué ci-dessous :\nclass Editor is\n    public field events: EventManager\n    private field file: File\n\n    constructor Editor() is\n        events = new EventManager()\n\n    // Les méthodes de la logique métier peuvent prévenir les\n    // souscripteurs de toute modification.\n    method openFile(path) is\n        this.file = new File(path)\n        events.notify(\"open\", file.name)\n\n    method saveFile() is\n        file.write()\n        events.notify(\"save\", file.name)\n\n    // ...\n\n// Voici l’interface des souscripteurs. Si votre langage de\n// programmation prend en charge les types fonctionnels, vous\n// pouvez remplacer toute la hiérarchie des souscripteurs par un\n// ensemble de fonctions.\ninterface EventListener is\n    method update(filename)\n\n// Les souscripteurs concrets réagissent aux mises à jour de\n// leur diffuseur.\nclass LoggingListener implements EventListener is\n    private field log: File\n    private field message: string\n\n    constructor LoggingListener(log_filename, message) is\n        this.log = new File(log_filename)\n        this.message = message\n\n    method update(filename) is\n        log.write(replace('%s',filename,message))\n\nclass EmailAlertsListener implements EventListener is\n    private field email: string\n    private field message: string\n\n    constructor EmailAlertsListener(email, message) is\n        this.email = email\n        this.message = message\n\n    method update(filename) is\n        system.email(email, replace('%s',filename,message))\n\n// Une application peut configurer des diffuseurs et des\n// souscripteurs à l’exécution.\nclass Application is\n    method config() is\n        editor = new Editor()\n\n        logger = new LoggingListener(\n            \"/path/to/log.txt\",\n            \"Someone  has  opened  the  file:  %s\")\n        editor.events.subscribe(\"open\", logger)\n\n        emailAlerts = new EmailAlertsListener(\n            \"admin@example.com\",\n            \"Someone  has  changed  the  file:  %s\")\n        editor.events.subscribe(\"save\", emailAlerts)\n\n```\n\n## Possibilités d’application\n\nUtilisez le patron de conception Observateur quand des modifications de l’état d’un objet peuvent en impacter d’autres, et que l’ensemble des objets n’est pas connu à l’avance ou qu’il change dynamiquement.\n\nCe problème est souvent rencontré lorsque l’on travaille sur des classes d’une interface utilisateur graphique. Par exemple, si vous créez des classes bouton personnalisées et que vous voulez que les clients puissent y ajouter du code déclenché par le clic d’un utilisateur.\n\nL’observateur permet à tous les objets qui suivent l’interface souscripteur de s’inscrire aux notifications des événements des objets diffuseur. Vous pouvez ajouter le mécanisme de souscription à tous vos boutons et laisser les clients mettre leur code personnalisé dans des classes souscripteur personnalisées.\n\nUtilisez ce patron quand certains objets de votre application doivent en suivre d’autres, mais seulement pendant un certain temps ou dans des cas spécifiques.\n\nLa liste d’inscription est dynamique, les souscripteurs peuvent donc rejoindre ou quitter la liste quand ils le désirent.\n\n## Mise en œuvre\n\n1.  Passez en revue votre logique métier et découpez-la en deux parties : la fonctionnalité principale (indépendante du reste du code) prendra le rôle du diffuseur ; le reste va être transformé en classes souscripteur.\n    \n2.  Déclarez l’interface souscripteur. Elle doit au moins contenir une méthode `update`.\n    \n3.  Déclarez l’interface diffuseur et écrivez des méthodes qui permettent d’ajouter et de retirer des objets souscripteur de la liste. Rappelez-vous que les diffuseurs doivent manipuler les souscripteurs uniquement en passant par l’interface des souscripteurs.\n    \n4.  Décidez où vous allez mettre la liste de souscription ainsi que l’implémentation des méthodes de souscription. En général, ce code est presque identique pour tous les types de diffuseurs. Le mieux est donc de le mettre dans une classe abstraite directement dérivée de l’interface diffuseur. Les diffuseurs concrets étendent cette classe et héritent du comportement de la souscription.\n    \n    Si vous implémentez ce patron dans une hiérarchie de classes existante, pensez à la composition : mettez la logique de souscription dans un objet séparé et faites en sorte que les diffuseurs l’utilisent.\n    \n5.  Créez les classes concrètes Diffuseur. Chaque fois que quelque chose d’important se produit chez un diffuseur, il doit prévenir ses souscripteurs.\n    \n6.  Implémentez les méthodes de notifications (`update`) dans les classes concrètes Souscripteur. La majorité des souscripteurs va vouloir des données du contexte qui concernent l’événement en question. Vous pouvez les envoyer en paramètre de la méthode de notification.\n    \n    Mais il y a une autre possibilité. Lors de la réception d’une notification, le souscripteur peut aller chercher les données directement dans la notification. Dans ce cas, le diffuseur doit s’envoyer lui-même en paramètre de la méthode `update`. On peut également lier un diffuseur à un souscripteur de manière permanente dans le constructeur, mais cette possibilité est moins flexible.\n    \n7.  Le client doit créer tous les souscripteurs nécessaires et les enregistrer auprès des diffuseurs.\n    \n\n## Avantages et inconvénients\n\n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouvelles classes souscripteur sans avoir à modifier le code du diffuseur (et inversement si vous avez une interface diffuseur).\n- Vous pouvez établir des relations entre les objets lors du lancement de l’application.\n\n- Les souscripteurs sont avertis dans un ordre aléatoire.\n\n## Liens avec les autres patrons\n\n- La [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility), la [Commande](https://refactoring.guru/fr/design-patterns/command), le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) et l’[Observateur](https://refactoring.guru/fr/design-patterns/observer) proposent différentes solutions pour associer les demandeurs et les récepteurs.\n    \n    - La *chaîne de responsabilité* envoie une demande ordonnée qui est passée tout au long d’une chaîne dynamique de récepteurs potentiels, jusqu’à ce que l’un d’entre eux décide de la traiter.\n    - La *commande* établit des connexions unidirectionnelles entre les demandeurs et les récepteurs.\n    - Le *médiateur* élimine les liens directs entre les demandeurs et les récepteurs, et les force à communiquer indirectement via un objet médiateur.\n    - L’*observateur* permet aux récepteurs de s’inscrire et de se désinscrire dynamiquement à la réception des demandes.\n- La différence entre le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) et l’[Observateur](https://refactoring.guru/fr/design-patterns/observer) est souvent très fine. Dans la majorité des cas, vous pouvez implémenter l’un ou l’autre, mais parfois vous pouvez les utiliser simultanément. Regardons comment faire.\n    \n    Le but principal du *médiateur* est d’éliminer les dépendances mutuelles entre un ensemble de composants du système. À la place, ces composants peuvent devenir dépendants d’un unique objet médiateur. Le but de l’*observateur* est d’établir des connexions dynamiques à sens unique entre les objets, où certains objets peuvent être les subordonnés d’autres objets.\n    \n    Il existe une implémentation populaire du *médiateur* qui repose sur l’*observateur*. L’objet médiateur joue le rôle du diffuseur et les composants agissent comme des souscripteurs qui s’inscrivent et se désinscrivent des événements du médiateur. Lorsque ce type de conception est mis en place, le *médiateur* ressemble de près à l’*observateur*.\n    \n    Si vous êtes un peu perdu, rappelez-vous qu’il y a plusieurs manières d’implémenter le médiateur. Par exemple, vous pouvez associer de manière permanente tous les composants au même objet médiateur. Cette implémentation ne ressemblera pas à l’*observateur*, mais sera tout de même une instance du patron de conception médiateur.\n    \n    Maintenant, imaginez un programme dont tous les composants sont devenus des diffuseurs, permettant des connexions dynamiques les uns avec les autres. Nous n’aurons pas d’objet médiateur centralisé, seulement un ensemble d’observateurs distribués.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_6151b7cbd3cf48b1926f235607565ad2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/java/example \"Patrons de conception : Observateur en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_292ebba4cc7a4d7aa8e46cee18176793.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/csharp/example \"Patrons de conception : Observateur en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_be87849b3a3148ab8b9a89dca2b42673.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/cpp/example \"Patrons de conception : Observateur en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_e9bc4d4fb943486f988f530ccf3abfc0.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/php/example \"Patrons de conception : Observateur en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_3514e806444a4260b07127e40da1cbbd.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/python/example \"Patrons de conception : Observateur en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_a8be9dad7b1941139d347ab5df4c1185.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/ruby/example \"Patrons de conception : Observateur en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_297f0b7036684941948abe0a0044f0dc.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/swift/example \"Patrons de conception : Observateur en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_b9e0a01ecc83421981227f7d219bb7bf.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/typescript/example \"Patrons de conception : Observateur en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_65198590a21e4eb08bfcebe5757456bc.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/observer/go/example \"Patrons de conception : Observateur en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_2e1e682d15924113a7ff33b00aa.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[État](https://refactoring.guru/fr/design-patterns/state)\n\n#### Retour\n\n[Mémento](https://refactoring.guru/fr/design-patterns/memento)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_468b488e20324e2595fde02d2bd27096.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/observer \"English\") [Español](https://refactoring.guru/es/design-patterns/observer \"Español\") [Français](https://refactoring.guru/fr/design-patterns/observer \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/observer \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/observer \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/observer \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/observer \"Українська\") [中文](https://refactoringguru.cn/design-patterns/observer \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_483c527d4b144ecd81a3f5d8ebf4e9f8.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_bc4768ed65be455e9ff3b3eb8d3fb61b.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_f037e27a79aa411697579406054ac05b.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Patron_de_methode":{"title":"Patron de méthode / Template Method","content":"\n**Patron de Méthode** permet de mettre le squelette d’un algorithme dans la classe mère, mais laisse les sous-classes redéfinir certaines étapes de l’algorithme sans changer sa structure.\n\n![Patron de conception patron de\u0026nbsp;méthode](../../_resources/template-method_b69262f94731486b9b8ad05c2ad3b94c.png)\n\n## Problème\n\nImaginez que vous êtes en train de créer une application de data mining (exploration de données) qui analyse les documents d’une entreprise. Les utilisateurs alimentent l’application avec différents formats (PDF, DOC, CSV) et celle-ci tente de récupérer les données utiles dans un format uniforme.\n\nLa première version de l’application ne fonctionnait qu’avec les fichiers DOC. Dans la version suivante, les fichiers CSV étaient acceptés. Un mois plus tard, vous lui avez « appris » à récupérer les données des fichiers PDF.\n\n![Les classes de data mining contiennent beaucoup de code dupliqué](../../_resources/problem_6670b65736b8415586597473be4cd39d.png)\n\nLes classes de data mining contiennent beaucoup de code dupliqué.\n\nAu bout d’un moment, vous remarquez que ces trois classes comportent beaucoup de code similaire. Bien que le code qui gère les différents formats de données soit complètement différent d’une classe à l’autre, celui qui traite et analyse les données est presque identique. Ne serait-ce pas super de se débarrasser de tout ce code dupliqué tout en laissant la structure de l’algorithme intact ?\n\nUn autre problème se pose avec le code client qui utilise ces classes. Il y a de gros blocs conditionnels qui choisissent un comportement en fonction de la classe de l’objet traité. Si ces trois classes avaient une interface commune (ou une classe de base), vous pourriez enlever toutes les conditions du code client et utiliser le polymorphisme lorsque vous appelez les méthodes sur un objet à traiter.\n\n## Solution\n\nLe patron de méthode vous propose de découper un algorithme en une série d’étapes, de transformer ces étapes en méthodes et de mettre l’ensemble des appels à ces méthodes dans une seule méthode socle, le *patron de méthode*. Les étapes peuvent être `abstraites` ou avoir une implémentation par défaut. Pour utiliser l’algorithme, le client doit fournir sa propre sous-classe, implémenter toutes les étapes abstraites et redéfinir certaines d’entre elles si besoin (mais pas la méthode socle elle-même).\n\nMettons ceci en application dans notre logiciel de data mining. Nous pouvons créer une classe de base pour les trois algorithmes d’analyse syntaxique (parsing). Cette classe définit une méthode socle, composée d’une série d’appels à plusieurs étapes qui traitent les documents.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/solution-fr_607cb7fa61f24fd78b5331b5bc71ebf3.png\"/\u003e\n\nLa méthode socle scinde l’algorithme en plusieurs étapes, permettant aux sous-classes de les redéfinir, mais on ne redéfinit pas la méthode socle elle-même.\n\nEn premier lieu, nous pouvons déclarer toutes les étapes `abstraites` afin de forcer les sous-classes à définir leur propre implémentation pour ces méthodes. Dans notre cas, les sous-classes ont déjà les implémentations nécessaires. Nous devons donc uniquement ajuster les signatures des méthodes en les faisant correspondre à celles de la classe mère.\n\nÀ présent, voyons ce que l’on peut faire pour se débarrasser du code dupliqué. Il semblerait que le code pour ouvrir/fermer les fichiers et récupérer/parser les données est différent pour chaque format de données, il n’y a donc aucune raison de toucher à ces méthodes. En revanche, les autres étapes (analyser les données brutes et établir les rapports) se ressemblent de près et leur implémentation peut donc être déplacée dans la classe de base, où les sous-classes se partagent le code.\n\nComme vous pouvez le voir, nous avons deux types d’étapes :\n\n- les *opérations abstraites* qui doivent être implémentées dans chaque sous-classe.\n- les *opérations facultatives* qui possèdent déjà une implémentation par défaut, mais peuvent être redéfinies si besoin.\n\nToutefois, un autre type d’étape existe : les *crochets* (hooks). Un crochet est une étape facultative dont le corps de méthode est laissé vide. Un patron de méthode peut fonctionner même si un crochet n’est pas redéfini. En général, les crochets sont placés avant ou après les étapes cruciales des algorithmes et procurent aux sous-classes des points d’extension supplémentaires.\n\n## Analogie\n\n\u003cimg width=\"590\" height=\"0\" src=\"../../_resources/live-example_cbe119a3086644f38bd0d442e8e55b25.png\"/\u003e\n\nUn plan architectural typique peut être légèrement remanié pour mieux répondre aux besoins d’un client.\n\nLe patron de méthode peut être utilisé pour construire des maisons en série. Le plan architectural pour construire une maison standard peut être doté de plusieurs points d’extensions qui permettent à un propriétaire potentiel d’ajuster certains détails dans la maison.\n\nChaque étape de construction (poser les fondations, poser la charpente, monter les murs, installer la plomberie pour l’eau et les câbles pour l’électricité, etc.) peut être légèrement modifiée pour différencier un peu la maison des autres.\n\n## Structure\n\n\u003cimg width=\"340\" height=\"0\" src=\"../../_resources/structure_c023936c9a544ad499dec4c7354b5d01.png\"/\u003e\n\n1.  La **Classe Abstraite** déclare des méthodes (qui représentent les étapes d’un algorithme) et la méthode patronDeMéthode qui appelle toutes ces méthodes dans un ordre spécifique. Les étapes peuvent être déclarées abstraites ou posséder une implémentation par défaut.\n    \n2.  Les **Classes Concrètes** peuvent redéfinir toutes les étapes, mais pas patronDeMéthode.\n    \n\n## Pseudo-code\n\nDans cet exemple, le patron de conception **Patron de Méthode** fournit un squelette pour les branches de l’IA (intelligence artificielle) d’un jeu vidéo de stratégie simple.\n\n\u003cimg width=\"430\" height=\"0\" src=\"../../_resources/example_0b7f81a0eab240d192fa73be34d75645.png\"/\u003e\n\nLes classes d’IA dans un jeu vidéo simple.\n\nToutes les races du jeu ont à peu près les mêmes unités et bâtiments. Vous pouvez donc réutiliser la même structure d’IA pour les différentes races, tout en personnalisant certains détails. Grâce à cette approche, vous pouvez redéfinir l’IA des orcs pour la rendre plus agressive, obtenir des humains plus défensifs, et faire en sorte que les monstres ne puissent pas construire de bâtiments. Pour ajouter une autre race au jeu, vous devez simplement créer une nouvelle sous-classe d’IA et redéfinir les méthodes par défaut déclarées dans la classe de base de l’IA.\n\n```\n// La classe abstraite définit un patron de méthode qui contient\n// le squelette d’un algorithme. Ce dernier est généralement\n// composé d’appels à des opérations primitives abstraites. Les\n// sous-classes concrètes implémentent ces opérations, mais ne\n// touchent pas au patron de méthode.\nclass GameAI is\n    // Le patron de méthode définit le squelette d’un\n    // algorithme.\n    method turn() is\n        collectResources()\n        buildStructures()\n        buildUnits()\n        attack()\n\n    // Certaines étapes peuvent être implémentées directement\n    // dans une classe de base.\n    method collectResources() is\n        foreach (s in this.builtStructures) do\n            s.collect()\n\n    // Et certaines peuvent être abstraites.\n    abstract method buildStructures()\n    abstract method buildUnits()\n\n    // Une classe peut avoir plusieurs patrons de méthode.\n    method attack() is\n        enemy = closestEnemy()\n        if (enemy == null)\n            sendScouts(map.center)\n        else\n            sendWarriors(enemy.position)\n\n    abstract method sendScouts(position)\n    abstract method sendWarriors(position)\n\n// Les classes concrètes doivent implémenter toutes les\n// opérations abstraites de la classe de base, mais elles ne\n// doivent pas redéfinir le patron de méthode.\nclass OrcsAI extends GameAI is\n    method buildStructures() is\n        if (there are some resources) then\n            // Construit des fermes, des casernes, puis une\n            // forteresse.\n\n    method buildUnits() is\n        if (there are plenty of resources) then\n            if (there are no scouts)\n                // Construit un ouvrier et l’ajoute au groupe\n                // d’éclaireurs.\n            else\n                // Construit un combattant et l’ajoute au groupe\n                // des guerriers.\n\n    // ...\n\n    method sendScouts(position) is\n        if (scouts.length \u003e 0) then\n            // Envoie les éclaireurs à la position.\n\n    method sendWarriors(position) is\n        if (warriors.length \u003e 5) then\n            // Envoie les guerriers à la position.\n\n// Les sous-classes peuvent redéfinir certaines opérations avec\n// une implémentation par défaut.\nclass MonstersAI extends GameAI is\n    method collectResources() is\n        // Les monstres ne récoltent pas de ressources.\n\n    method buildStructures() is\n        // Les monstres ne fabriquent pas de bâtiments.\n\n    method buildUnits() is\n        // Les monstres ne construisent pas d'unités.\n\n```\n\n## Possibilités d’application\n\nUtilisez le patron de méthode si vous voulez que vos clients puissent étendre des étapes spécifiques d’un algorithme, mais pas l’algorithme entier ou sa structure.\n\nLe patron de méthode vous permet de transformer un algorithme monolithique en une série d’étapes individuelles qui peuvent être facilement étendues par des sous-classes, tout en gardant intacte la structure établie dans une classe mère.\n\nUtilisez ce patron si vous avez plusieurs classes qui contiennent des algorithmes presque identiques, avec seulement quelques différences mineures. Par conséquent, vous risqueriez de devoir retoucher toutes les classes lorsque vous modifiez l’algorithme.\n\nLorsque vous transformez un tel algorithme en un patron de méthode, vous pouvez également remonter les étapes dotées d’implémentations similaires dans la classe mère, afin d’éviter la duplication de code. Vous pouvez laisser le reste du code dans les sous-classes.\n\n## Mise en œuvre\n\n1.  Analysez l’algorithme ciblé pour voir si vous pouvez le décomposer en étapes. Déterminez les étapes communes à toutes les sous-classes et celles qui sont uniques.\n    \n2.  Créez une classe de base abstraite et déclarez le patron de méthode et un ensemble de méthodes abstraites pour représenter les opérations de l’algorithme. Faites une ébauche de la structure de l’algorithme dans ce patron de méthode en appelant les opérations correspondantes. Rendez ce patron `final` pour empêcher les sous-classes de la redéfinir.\n    \n3.  Cela ne pose aucun problème si toutes les opérations sont abstraites, mais une implémentation par défaut bénéficierait à certaines opérations. Les sous-classes n’ont pas besoin d’implémenter ces méthodes.\n    \n4.  Pensez à ajouter des crochets entre les étapes cruciales de votre algorithme.\n    \n5.  Pour chaque variante de l’algorithme, créez une nouvelle sous-classe. Elle *doit* implémenter toutes les opérations abstraites, mais *peut* également redéfinir les opérations facultatives.\n    \n\n## Avantages et inconvénients\n\n- Vous permettez aux clients de redéfinir certaines parties d’un grand algorithme. Elles sont ainsi moins affectées par les modifications apportées aux autres parties de l’algorithme.\n- Vous pouvez remonter le code dupliqué dans la classe mère.\n\n- Certains clients peuvent être limités à cause du squelette de l’algorithme.\n- Vous ne respectez pas le *Principe de substitution de Liskov*, si vous supprimez l’implémentation d’une étape par défaut dans une sous-classe.\n- Plus vous avez d’étapes, plus le patron de méthode devient difficile à maintenir.\n\n## Liens avec les autres patrons\n\n- La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est une spécialisation du [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method). Une *fabrique* peut aussi faire office d’étape dans un grand *patron de méthode*.\n    \n- Le [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method) est basé sur l’héritage : il vous laisse modifier certaines parties d’un algorithme en les étendant dans les sous-classes. La [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) est basée sur la composition : vous pouvez modifier certaines parties du comportement de l’objet en lui fournissant différentes stratégies qui correspondent à ce comportement. Le *patron de méthode* agit au niveau de la classe, il est donc statique. La *stratégie* agit au niveau de l’objet et vous laisse permuter les comportements à l’exécution.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_9aaa4c2e3ccc4b699f62a3670f7c250c.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/java/example \"Patrons de conception : Patron de méthode en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_5e4dcb193c364f6c8dc7bda670ba13e3.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/csharp/example \"Patrons de conception : Patron de méthode en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_d2dbb1f82cdc489185f3eb0aac85c6f9.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/cpp/example \"Patrons de conception : Patron de méthode en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_478bbb4e306d412cbedc242da92146b2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/php/example \"Patrons de conception : Patron de méthode en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_7c8201aaa5ab480586871511009e1aaf.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/python/example \"Patrons de conception : Patron de méthode en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_94ffc034621748abb6963cda8992d566.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/ruby/example \"Patrons de conception : Patron de méthode en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_4dc78ba3db184f39b74c2eab1d5ffdf2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/swift/example \"Patrons de conception : Patron de méthode en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_fde7d6ee001c4e5d8a0621199fb0a23b.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/typescript/example \"Patrons de conception : Patron de méthode en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_6181061eef244e298b461e0c83c82544.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/template-method/go/example \"Patrons de conception : Patron de méthode en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_751def784d3742ae96793690326.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n\n#### Retour\n\n[Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_d6f958870a4148b88a932eddd32657d8.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/template-method \"English\") [Español](https://refactoring.guru/es/design-patterns/template-method \"Español\") [Français](https://refactoring.guru/fr/design-patterns/template-method \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/template-method \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/template-method \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/template-method \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/template-method \"Українська\") [中文](https://refactoringguru.cn/design-patterns/template-method \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_1e7e0d1c04304ed98cc2c8cdc8387fa0.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_8240bf2ec4974f00b06fcbf1deb727d3.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_448d9b061b40475ea98fc157d7462b8f.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Sommaire":{"title":"","content":"| notebook | image | excerpt |\n\n| --- | --- | --- |\n\n|👀Behavioral|![](../_resources/command-fr_787ffeb0f2814bf1b60a1647af987cf1.png)|[Commande](Architecture/Design_Pattern/Behavioral/Commande.md) prend une action à effectuer et la transforme en un objet autonome qui contient tous les détails de cette action. Cette transformation permet de paramétrer des méthodes avec différentes actio...|\n\n|👀Behavioral|![](../_resources/state-fr_7368c6b587874b7e830f220d8295c19a.png)|[État](Architecture/Design_Pattern/Behavioral/Etat.md) permet de modifier le comportement d’un objet lorsque son état interne change. L’objet donne l’impression qu’il change de classe. Problème Le patron de conception est très proche du concept de l’...|\n\n|👀Behavioral|![](../_resources/iterator-en_501f7a11e44141d492b0baad75db40a4.png)|[Itérateur](Architecture/Design_Pattern/Behavioral/Iterateur.md) permet de parcourir les éléments d’une collection sans révéler sa représentation interne (liste, pile, arbre, etc.). Problème Les collections ne servent que de conteneur pour un groupe d’obj...|\n\n|👀Behavioral|![](../_resources/mediator_439dcb260c8b446ab7602c447fc50598.png)|[Médiateur](Architecture/Design_Pattern/Behavioral/Mediateur.md) diminue les dépendances chaotiques entre les objets. Il restreint les communications directes entre les objets et les force à collaborer uniquement via un objet médiateur. Problème Prenons u...|\n\n|👀Behavioral|![](../_resources/memento-fr_66e03e2a2fea4a8282a85380144a01fa.png)|[Mémento](Architecture/Design_Pattern/Behavioral/Memento.md) permet de sauvegarder et de rétablir l’état précédent d’un objet sans révéler les détails de son implémentation. Problème Imaginez que vous êtes en train de créer un éditeur de texte. En plus ...|\n\n|👀Behavioral|![](../_resources/observer_cd44810e58424fcf996dc6dd8ea71b07.png)|[Observateur](Architecture/Design_Pattern/Behavioral/Observateur.md) permet de mettre en place un mécanisme de souscription pour envoyer des notifications à plusieurs objets, au sujet d’événements concernant les objets qu’ils observent. Problème Imaginez ...|\n\n|👀Behavioral|![](../_resources/template-method_b69262f94731486b9b8ad05c2ad3b94c.png)|[Patron_de_methode](Architecture/Design_Pattern/Behavioral/Patron_de_methode.md) permet de mettre le squelette d’un algorithme dans la classe mère, mais laisse les sous-classes redéfinir certaines étapes de l’algorithme sans changer sa structure. Problème Imagine...|\n\n|👀Behavioral|![](../_resources/strategy_063f6e651d104b90b9d27810a0040bec.png)|[Stratégie](Architecture/Design_Pattern/Behavioral/Strategie.md) permet de définir une famille d’algorithmes, de les mettre dans des classes séparées et de rendre leurs objets interchangeables. Problème Un beau jour, vous avez décidé de créer une applicat...|\n\n|👀Behavioral|![](../_resources/visitor_df679eb372cc4b0f8e1e9d6c78e50bf2.png)|[Visiteur](Architecture/Design_Pattern/Behavioral/Visiteur.md) vous permet de séparer les algorithmes et les objets sur lesquels ils opèrent. Problème Imaginez que votre équipe développe une application avec des informations géographiques qui prennent la...|\n\n\u003c!--endoverview--\u003e","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Strategie":{"title":"Stratégie / Strategy","content":"\n**Stratégie** permet de définir une famille d’algorithmes, de les mettre dans des classes séparées et de rendre leurs objets interchangeables.\n\n![Patron de conception\u0026nbsp;stratégie](../../_resources/strategy_063f6e651d104b90b9d27810a0040bec.png)\n\n## Problème\n\nUn beau jour, vous avez décidé de créer une application de navigation pour les voyageurs occasionnels. Vous l’avez développé avec une superbe carte comme fonctionnalité principale, qui aide les utilisateurs à s’orienter rapidement dans n’importe quelle ville.\n\nLa fonctionnalité la plus demandée était la planification d’itinéraire. Un utilisateur devrait pouvoir entrer une adresse et le chemin le plus rapide pour arriver à destination s’afficherait sur la carte.\n\nLa première version de l’application ne pouvait tracer des itinéraires que sur les routes. Les automobilistes étaient comblés. Mais apparemment, certaines personnes préfèrent utiliser d’autres moyens de locomotion pendant leurs vacances. Vous avez ajouté la possibilité de créer des trajets à pied dans la version suivante. Juste après cela, vous avez ajouté la possibilité d’utiliser les transports en commun dans les itinéraires.\n\nMais tout ceci n’était que le début. Vous avez continué en adaptant l’application pour les cyclistes, et plus tard, ajouté la possibilité de construire les itinéraires en passant par les attractions touristiques de la ville.\n\n\u003cimg width=\"330\" height=\"0\" src=\"../../_resources/problem_8cb26d9af91d40a4a8b9f62545d91fa0.png\"/\u003e\n\nLe code du navigateur grossit à vue d’œil.\n\nL’application a beau avoir très bien marché d’un point de vue financier, vous vous êtes arraché les cheveux sur le côté technique. Chaque fois que vous ajoutiez un nouvel algorithme pour tracer les itinéraires, la classe principale Navigateur doublait de taille. À un moment donné, la bête n’était plus possible à maintenir.\n\nQue ce soit pour corriger un petit problème ou pour ajuster les scores des rues, la moindre touche apportée aux algorithmes impactait la totalité de la classe, augmentant les chances de créer des bugs dans du code qui fonctionnait très bien.\n\nDe plus, travailler en équipe n’était plus efficace. Les membres de votre équipe embauchés juste après la sortie et le succès de votre application se plaignaient de passer trop de temps à résoudre des problèmes de fusion. Ajouter une nouvelle fonctionnalité vous demandait de modifier une classe énorme, créant des conflits dans le code produit par les autres développeurs.\n\n## Solution\n\nLe patron de conception stratégie vous propose de prendre une classe dotée d’un comportement spécifique mais qui l’exécute de différentes façons, et de décomposer ses algorithmes en classes séparées appelées *stratégies*.\n\nLa classe originale (le *contexte*) doit avoir un attribut qui garde une référence vers une des stratégies. Plutôt que de s’occuper de la tâche, le contexte la délègue à l’objet stratégie associé.\n\nLe contexte n’a pas la responsabilité de la sélection de l’algorithme adapté, c’est le client qui lui envoie la stratégie. En fait, le contexte n’y connait pas grand-chose en stratégies, c’est l’interface générique qui lui permet de les utiliser. Elle n’expose qu’une seule méthode pour déclencher l’algorithme encapsulé à l’intérieur de la stratégie sélectionnée.\n\nLe contexte devient indépendant des stratégies concrètes. Vous pouvez ainsi modifier des algorithmes ou en ajouter de nouveaux sans toucher au code du contexte ou aux autres stratégies.\n\n\u003cimg width=\"570\" height=\"0\" src=\"../../_resources/solution_3aa3e1b8b89e4b4894ee5e7bd58f6dae.png\"/\u003e\n\nStratégies de planification d’itinéraire.\n\nDans notre application de navigation, chaque algorithme d’itinéraire peut être extrait de sa propre classe avec une seule méthode `tracerItinéraire`. La méthode accepte une origine et une destination, puis retourne une liste de points de passage.\n\nQuand bien même les différentes classes itinéraire ne donneraient pas un résultat identique avec les mêmes paramètres, la classe navigateur principale ne se préoccupe pas de l’algorithme sélectionné, car sa fonction première est d’afficher les points de passage sur la carte. La classe navigateur possède une méthode pour changer la stratégie d’itinéraire active afin que ses clients (les boutons de l’interface utilisateur par exemple) puissent remplacer le comportement sélectionné par un autre.\n\n## Analogie\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/strategy-comic-1-fr_974d0462c8b64b53bd59f917cb01c9.png\"/\u003e\n\nDifférentes stratégies pour se rendre à l’aéroport.\n\nImaginez que vous devez vous rendre à l’aéroport. Vous pouvez prendre le bus, appeler un taxi ou enfourcher votre vélo. Ce sont vos stratégies de transport. Vous pouvez sélectionner une de ces stratégies en fonction de certains facteurs, comme le budget ou les contraintes de temps.\n\n## Structure\n\n\u003cimg width=\"440\" height=\"0\" src=\"../../_resources/structure_d77fa9851eec4b0c88c2830f4a77a8a5.png\"/\u003e\n\n1.  Le **Contexte** garde une référence vers une des stratégies concrètes et communique avec cet objet uniquement au travers de l’interface stratégie.\n    \n2.  L’interface **Stratégie** est commune à toutes les stratégies concrètes. Elle déclare une méthode que le contexte utilise pour exécuter une stratégie.\n    \n3.  Les **Stratégies Concrètes** implémentent différentes variantes d’algorithmes utilisées par le contexte.\n    \n4.  Chaque fois qu’il veut lancer un algorithme, le contexte appelle la méthode d’exécution de l’objet stratégie associé. Le contexte ne sait pas comment la stratégie fonctionne ni comment l’algorithme est lancé.\n    \n5.  Le **Client** crée un objet spécifique Stratégie et le passe au contexte. Le contexte expose un setter qui permet aux clients de remplacer la stratégie associée au contexte lors de l’exécution.\n    \n\n## Pseudo-code\n\nDans cet exemple, le contexte utilise plusieurs **Stratégies** pour lancer diverses opérations arithmétiques.\n\n```\n// L’interface stratégie déclare les traitements communs à\n// toutes les versions supportées de l’algorithme. Le contexte\n// utilise cette interface pour appeler l’algorithme défini par\n// les stratégies concrètes.\ninterface Strategy is\n    method execute(a, b)\n\n// Les stratégies concrètes implémentent l’interface de base\n// Stratégie et hébergent l’algorithme. L’interface les rend\n// interchangeables dans le contexte.\nclass ConcreteStrategyAdd implements Strategy is\n    method execute(a, b) is\n        return a + b\n\nclass ConcreteStrategySubtract implements Strategy is\n    method execute(a, b) is\n        return a - b\n\nclass ConcreteStrategyMultiply implements Strategy is\n    method execute(a, b) is\n        return a * b\n\n// Le contexte définit l’interface dont les clients ont besoin.\nclass Context is\n    // Le contexte maintient une référence à l’un des objets\n    // Stratégie. Le contexte ne connait pas la classe concrète\n    // de la stratégie. Il doit manipuler toutes les stratégies\n    // via l’interface stratégie.\n    private strategy: Strategy\n\n    // En général, le contexte accepte une stratégie en\n    // paramètre du constructeur et fournit un setter pour\n    // permettre de changer de stratégie lors de l’exécution.\n    method setStrategy(Strategy strategy) is\n        this.strategy = strategy\n\n    // Le contexte délègue certaines tâches à l’objet stratégie,\n    // plutôt que d’implémenter plusieurs versions de\n    // l’algorithme.\n    method executeStrategy(int a, int b) is\n        return strategy.execute(a, b)\n\n// Le code client choisit une stratégie concrète et la passe au\n// contexte. Le client doit connaitre les différences entre les\n// stratégies afin de faire le bon choix.\nclass ExampleApplication is\n    method main() is\n        Create context object.\n\n        Read first number.\n        Read last number.\n        Read the desired action from user input.\n\n        if (action == addition) then\n            context.setStrategy(new ConcreteStrategyAdd())\n\n        if (action == subtraction) then\n            context.setStrategy(new ConcreteStrategySubtract())\n\n        if (action == multiplication) then\n            context.setStrategy(new ConcreteStrategyMultiply())\n\n        result = context.executeStrategy(First number, Second number)\n\n        Print result.\n\n```\n\n## Possibilités d’application\n\nUtilisez le patron de conception stratégie si vous voulez avoir différentes variantes d’un algorithme à l’intérieur d’un objet à disposition, et pouvoir passer d’un algorithme à l’autre lors de l’exécution.\n\nCe patron vous permet de modifier indirectement le comportement de l’objet lors de l’exécution, en l’associant avec différents sous-objets qui peuvent accomplir des sous-tâches spécifiques de différentes manières.\n\nUtilisez la stratégie si vous avez beaucoup de classes dont la seule différence est leur façon d’exécuter un comportement.\n\nCe patron vous permet d’extraire des variantes d’un comportement dans une hiérarchie de classes séparées et de combiner les classes originales dans une seule, évitant de dupliquer du code.\n\nUtilisez la stratégie pour isoler la logique métier d’une classe, de l’implémentation des algorithmes dont les détails ne sont pas forcément importants pour le contexte.\n\nCe patron vous permet de séparer le code, les données internes et les dépendances des divers algorithmes du reste du code. Une interface toute simple permet aux clients d’exécuter les algorithmes et d’en changer lors de l’exécution.\n\nUtilisez ce patron si votre classe possède un gros bloc conditionnel qui choisit entre différentes variantes du même algorithme.\n\nLa stratégie vous débarrasse de toutes ces conditions en extrayant tous les algorithmes dans des classes séparées, et ces dernières implémentent toutes la même interface. L’objet original délègue l’exécution à l’un de ces objets, au lieu d’implémenter toutes les variantes de l’algorithme.\n\n## Mise en œuvre\n\n1.  Dans la classe contexte, identifiez un algorithme qui varie souvent. Il peut s’agir d’un gros bloc conditionnel qui sélectionne une variante du même algorithme lors de l’exécution.\n    \n2.  Déclarez l’interface stratégie commune à toutes les variantes de l’algorithme.\n    \n3.  Extrayez tous les algorithmes un par un et mettez-les dans leurs propres classes. Elles doivent toutes implémenter l’interface stratégie.\n    \n4.  Ajoutez un attribut pour garder une référence vers un objet stratégie dans la classe contexte. Créez un setter pour modifier le contenu de cet attribut. Le contexte ne doit manipuler l’objet stratégie qu’au travers de l’interface stratégie. Le contexte peut définir une interface qui laisse la stratégie accéder à ses données.\n    \n5.  Les clients d’un contexte doivent l’associer avec une stratégie adaptée au comportement attendu.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez permuter l’algorithme utilisé à l’intérieur d’un objet à l’exécution.\n- Vous pouvez séparer les détails de l’implémentation d’un algorithme et le code qui l’utilise.\n- Vous pouvez remplacer l’héritage par la composition.\n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouvelles stratégies sans avoir à modifier le contexte.\n\n- Si vous n’avez que quelques algorithmes qui ne varient pas beaucoup, nul besoin de rendre votre programme plus compliqué avec les nouvelles classes et interfaces qui accompagnent la mise en place du patron.\n- Les clients doivent pouvoir comparer les différentes stratégies et choisir la bonne.\n- De nombreux langages de programmation modernes gèrent les types fonctionnels et vous permettent d’implémenter différentes versions d’un algorithme à l’intérieur d’un ensemble de fonctions anonymes. Vous pouvez ensuite utiliser ces fonctions exactement comme vous le feriez pour des objets stratégie, sans encombrer votre code avec des classes et interfaces supplémentaires.\n\n## Liens avec les autres patrons\n\n- Le [Pont](https://refactoring.guru/fr/design-patterns/bridge), l’[État](https://refactoring.guru/fr/design-patterns/state), la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) (et dans une certaine mesure l’[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)) ont des structures très similaires. En effet, ces patrons sont basés sur la composition, qui délègue les tâches aux autres objets. Cependant, ils résolvent différents problèmes. Un patron n’est pas juste une recette qui vous aide à structurer votre code d’une certaine manière. C’est aussi une façon de communiquer aux autres développeurs le problème qu’il résout.\n    \n- La [Commande](https://refactoring.guru/fr/design-patterns/command) et la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) peuvent se ressembler, car vous les utilisez toutes les deux pour paramétrer un objet avec une action. Cependant, ces patrons ont des intentions très différentes.\n    \n    - Vous pouvez utiliser la *commande* pour convertir un traitement en un objet. Les paramètres du traitement deviennent des attributs de cet objet. La conversion vous permet de différer le lancement du traitement, le mettre dans une file d’attente, stocker l’historique des commandes, envoyer les commandes à des services distants, etc.\n        \n    - La *stratégie* quant à elle, décrit généralement différentes manières de faire la même chose et vous laisse permuter entre ces algorithmes à l’intérieur d’une unique classe contexte.\n        \n- Le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) vous permet de changer la peau d’un objet, alors que la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) vous permet de changer ses tripes.\n    \n- Le [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method) est basé sur l’héritage : il vous laisse modifier certaines parties d’un algorithme en les étendant dans les sous-classes. La [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) est basée sur la composition : vous pouvez modifier certaines parties du comportement de l’objet en lui fournissant différentes stratégies qui correspondent à ce comportement. Le *patron de méthode* agit au niveau de la classe, il est donc statique. La *stratégie* agit au niveau de l’objet et vous laisse permuter les comportements à l’exécution.\n    \n- L’[État](https://refactoring.guru/fr/design-patterns/state) peut être considéré comme une extension de la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy). Ces deux patrons de conception sont basés sur la composition : ils changent le comportement du contexte en déléguant certaines tâches aux objets assistant. La *stratégie* rend ces objets complètement indépendants sans aucune visibilité l’un sur l’autre. Cependant, l’*état* n’impose pas de restrictions sur les dépendances entre les états concrets, et leur laisse modifier l’état du contexte à volonté.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_0671d268bc8a4cc99bc7b0b2f076ab1c.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/java/example \"Patrons de conception : Stratégie en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_790603965dbc483c9ab9260e0298db80.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/csharp/example \"Patrons de conception : Stratégie en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_7164a480463f45bb854d0b1aec87dde7.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/cpp/example \"Patrons de conception : Stratégie en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_ed3212e7f8a940de85214e70a0d67191.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/php/example \"Patrons de conception : Stratégie en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_b42f680cd332455ea19ce3cba166e844.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/python/example \"Patrons de conception : Stratégie en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_4177d1e45286482ba117f1a36822cbf9.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/ruby/example \"Patrons de conception : Stratégie en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_c5b0805e91694c3396c39a5c552b3549.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/swift/example \"Patrons de conception : Stratégie en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_6ea16e3698d2481983189128154bb271.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/typescript/example \"Patrons de conception : Stratégie en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_a4f0f582a8974effbc2209fca785f1e1.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/strategy/go/example \"Patrons de conception : Stratégie en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_5a5661196eca4534af8c3961393.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n\n#### Retour\n\n[État](https://refactoring.guru/fr/design-patterns/state)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_648c1ff9963943f19e01b47331b15b61.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/strategy \"English\") [Español](https://refactoring.guru/es/design-patterns/strategy \"Español\") [Français](https://refactoring.guru/fr/design-patterns/strategy \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/strategy \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/strategy \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/strategy \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/strategy \"Українська\") [中文](https://refactoringguru.cn/design-patterns/strategy \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_13ee3659b4264ddba651dbcc1ecd6f09.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_eb703a88f5bc4d61b6fbaf6141d546ce.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_d7094997382b40b99b196a1809c1dd14.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.469738571Z","tags":null},"/Architecture/Design_Pattern/Behavioral/Visiteur":{"title":"Visiteur / Visitor","content":"\n**Visiteur** vous permet de séparer les algorithmes et les objets sur lesquels ils opèrent.\n\n![Patron de conception\u0026nbsp;visiteur](../../_resources/visitor_df679eb372cc4b0f8e1e9d6c78e50bf2.png)\n\n## Problème\n\nImaginez que votre équipe développe une application avec des informations géographiques qui prennent la forme d’un graphe géant. Chaque nœud du graphe peut représenter une entité complexe comme une ville, mais aussi des choses plus spécifiques comme des usines, des sites touristiques, etc. Les nœuds sont interconnectés s’il est possible de les relier. Dans le code, chaque type de nœud est représenté par sa propre classe et chaque nœud spécifique est un objet.\n\n![Export du graphe en XML](../../_resources/problem1_eccc2e36b63e4ef3b40a70a9f6af4d61.png)\n\nExport du graphe en XML.\n\nLe jour vient où vous devez vous attaquer à la mise en place de l’export du graphe au format XML. À première vue, cela semble assez simple. Vous avez prévu de mettre en place une méthode d’export pour chaque classe nœud, puis vous exécutez la méthode sur chaque nœud du graphe en le parcourant récursivement. La solution était simple mais élégante : grâce au polymorphisme, vous n’avez pas couplé le code qui appelait la méthode d’exportation aux classes concrètes des nœuds.\n\nMalheureusement, l’architecte du système vous a interdit de modifier les classes nœud existantes. Sa décision était basée sur le fait que le code était déjà en production et que vos modifications pourraient causer des bugs.\n\n\u003cimg width=\"500\" height=\"0\" src=\"../../_resources/problem2-fr_89e9ccd442f240638b2a5e39c23487c5.png\"/\u003e\n\nLa méthode d’export XML devait être ajoutée dans toutes les classes nœud, ce qui risquait de compromettre l’intégrité du code de l’application.\n\nDe plus, il a remis en question la pertinence de placer le code d’export XML à l’intérieur des nœuds. Le rôle principal de ces classes est de manipuler les données géographiques, ce code serait perçu comme un intrus.\n\nIl a avancé un autre argument contre votre modification. Il semblait très probable qu’une fois cette fonctionnalité en place, une personne du service marketing demande un export dans un format différent ou d’autres trucs bizarres. Cela vous obligerait à modifier une fois de plus ces petites classes fragiles.\n\n## Solution\n\nLe patron de conception visiteur vous propose de placer ce nouveau comportement dans une classe séparée que l’on appelle *visiteur*, plutôt que de l’intégrer dans des classes existantes. L’objet qui devait lancer ce traitement à l’origine est maintenant passé en paramètre des méthodes du visiteur, ce qui permet à la méthode d’avoir accès à toutes les données nécessaires qui se trouvent à l’intérieur de l’objet.\n\nComment fait-on pour que ce comportement puisse être exécuté sur des objets de différentes classes ? Par exemple, dans le cas de notre export XML, l’implémentation sera probablement légèrement différente pour chaque nœud. La classe visiteur va donc avoir besoin d’un ensemble de méthodes et chacune d’entre elles pourra prendre des paramètres de différents types, comme ce qui suit :\n\n```\nclass ExportVisitor implements Visitor is\n    method doForCity(City c) { ... }\n    method doForIndustry(Industry f) { ... }\n    method doForSightSeeing(SightSeeing ss) { ... }\n    // ...\n\n```\n\nMais comment allons-nous appeler ces méthodes, surtout celles qui gèrent le graphe complet ? Nous ne pouvons pas utiliser le polymorphisme, car ces méthodes ont différentes signatures. Pour sélectionner une méthode qui peut traiter un objet donné, nous devons vérifier sa classe. On se croirait dans un cauchemar !\n\n```\nforeach (Node node in graph)\n    if (node instanceof City)\n        exportVisitor.doForCity((City) node)\n    if (node instanceof Industry)\n        exportVisitor.doForIndustry((Industry) node)\n    // ...\n}\n\n```\n\nIl vous est peut-être venu à l’esprit d’utiliser la surcharge. La surcharge, c’est une technique qui permet de donner le même nom à toutes les méthodes, même si elles n’ont pas des paramètres identiques. Malheureusement, même si l’on suppose que notre langage de programmation nous le permet (le Java et le C# par exemple), cela ne nous sera d’aucune aide. Comme nous ne connaissons pas la classe d’un nœud à l’avance, le mécanisme de la surcharge ne sera pas capable de déterminer la bonne méthode à exécuter. Il ira systématiquement chercher la méthode qui prend un objet de la classe de base `Nœud`.\n\nHeureusement, le patron de conception visiteur résout ce problème. Il utilise une technique appelée [double répartition](https://refactoring.guru/fr/design-patterns/visitor-double-dispatch \"Visiteur et double répartition\") (double dispatch), qui aide à lancer la bonne méthode sans s’encombrer avec des blocs conditionnels. Plutôt que de laisser le client choisir la version de la méthode à appeler, pourquoi ne déléguons-nous pas la décision aux objets que nous passons en paramètre au visiteur ? Comme les objets connaissent leur propre classe, ils seront plus à même de choisir la méthode adaptée au visiteur. Ils « acceptent » un visiteur et lui indiquent la méthode à exécuter.\n\n```\n// Code client\nforeach (Node node in graph)\n    node.accept(exportVisitor)\n\n// City\nclass City is\n    method accept(Visitor v) is\n        v.doForCity(this)\n    // ...\n\n// Industry\nclass Industry is\n    method accept(Visitor v) is\n        v.doForIndustry(this)\n    // ...\n\n```\n\nJ’avoue. Nous avons finalement été obligés de toucher aux classes nœud. Mais cette modification est mineure et elle nous permet d’ajouter de nouveaux comportements sans avoir à retoucher le code.\n\nÀ présent, si nous extrayons une interface pour tous les visiteurs, les nœuds existants vont accepter tous les visiteurs ajoutés dans l’application. Pour ajouter un nouveau comportement aux nœuds, il vous suffit d’implémenter une nouvelle classe visiteur.\n\n## Analogie\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/visitor-comic-1_b1d8e2d074b04ab1ab50e9bbeed82412.png\"/\u003e\n\nUn bon agent d’assurance est toujours prêt à proposer différents contrats pour différentes organisations.\n\nImaginez un agent d’assurance expérimenté qui veut absolument acquérir de nouveaux clients. Il peut faire du porte-à-porte dans tous les bâtiments d’un quartier et essayer de vendre des assurances à tous ceux qu’il rencontre. En fonction du type d’entreprise qui occupe le bâtiment, il peut proposer des contrats d’assurance adaptés :\n\n- Si c’est un bâtiment résidentiel, il vend des assurances maladie.\n- Si c’est une banque, il vend des assurances contre le vol.\n- Si c’est un café, il vend des assurances contre les incendies et les inondations.\n\n## Structure\n\n\u003cimg width=\"520\" height=\"0\" src=\"../../_resources/structure-fr_015ddc89ef9a41748b0cc4d127f68aa6.png\"/\u003e\n\n1.  L’interface **Visiteur** déclare un ensemble de méthodes de parcours qui peuvent prendre les éléments concrets d’une structure d’objets en paramètre. Ces méthodes peuvent avoir le même nom si le programme est écrit dans un langage qui gère la surcharge, mais le type de ses paramètres sera différent.\n    \n2.  Chaque **Visiteur Concret** implémente plusieurs versions des mêmes comportements, en fonction des classes des éléments concrets.\n    \n3.  L’interface **Élément** déclare une méthode qui « accepte » les visiteurs. Cette méthode déclare un paramètre du type de l’interface visiteur.\n    \n4.  Chaque **Élément Concret** doit implémenter une méthode d’acceptation. Le but de cette méthode est de rediriger l’appel vers la méthode appropriée du visiteur en fonction de la classe de l’élément actuel. Soyez conscient que même si la classe d’un élément de base implémente cette méthode, toutes les sous-classes doivent tout de même la redéfinir et appeler la méthode appropriée sur l’objet visiteur.\n    \n5.  Le **Client** représente en général une collection ou tout autre objet complexe (par exemple un arbre [Composite](https://refactoring.guru/fr/design-patterns/composite)). En général, les clients n’ont pas de visibilité sur les classes des éléments concrets, car ils manipulent les objets de cette collection via une interface abstraite.\n    \n\n## Pseudo-code\n\nDans cet exemple, le **Visiteur** implémente l’export XML dans la hiérarchie de classes des formes géométriques.\n\n\u003cimg width=\"560\" height=\"0\" src=\"../../_resources/example_bcaf73dcdeb54b8b8320f858d9b4d5aa.png\"/\u003e\n\nExporter différents types d’objets vers le format XML à l’aide d’un objet visiteur.\n\n```\n// L’interface élément déclare une méthode `accepter` qui prend\n// l’interface de base visiteur en argument.\ninterface Shape is\n    method move(x, y)\n    method draw()\n    method accept(v: Visitor)\n\n// Chaque classe concrète Élément doit implémenter la méthode\n// `accepter` et la faire appeler la méthode du visiteur qui\n// correspond à la classe de l’élément.\nclass Dot implements Shape is\n    // ...\n\n    // Vous remarquerez que nous appelons `visiterPoint`, ce qui\n    // correspond au nom de la classe actuelle. Ainsi, nous\n    // fournissons le nom de la classe de l’élément au visiteur\n    // qui le manipule.\n    method accept(v: Visitor) is\n        v.visitDot(this)\n\nclass Circle implements Shape is\n    // ...\n    method accept(v: Visitor) is\n        v.visitCircle(this)\n\nclass Rectangle implements Shape is\n    // ...\n    method accept(v: Visitor) is\n        v.visitRectangle(this)\n\nclass CompoundShape implements Shape is\n    // ...\n    method accept(v: Visitor) is\n        v.visitCompoundShape(this)\n\n\n// L’interface visiteur déclare un ensemble de méthodes visiter\n// qui correspondent aux classes élément. La signature de la\n// méthode visiter permet au visiteur d’identifier la classe\n// exacte de l’élément qu’il manipule.\ninterface Visitor is\n    method visitDot(d: Dot)\n    method visitCircle(c: Circle)\n    method visitRectangle(r: Rectangle)\n    method visitCompoundShape(cs: CompoundShape)\n\n// Les visiteurs concrets implémentent plusieurs versions du\n// même algorithme. Ce dernier fonctionne avec toutes les\n// classes concrètes Élément.\n//\n// Vous tirez tous les bénéfices du patron de conception\n// visiteur lorsque vous l’utilisez avec une structure complexe\n// d’objets, comme une arborescence. Dans ce cas, il peut être\n// pratique de stocker certains états intermédiaires de\n// l’algorithme tout en exécutant les méthodes du visiteur sur\n// les différents objets de la structure.\nclass XMLExportVisitor implements Visitor is\n    method visitDot(d: Dot) is\n        // Exporte l’ID du point et ses coordonnées.\n\n    method visitCircle(c: Circle) is\n        // Exporte l’ID du cercle, les coordonnées de son centre\n        // et son rayon.\n\n    method visitRectangle(r: Rectangle) is\n        // Exporte l’ID du rectangle, les coordonnées du point\n        // supérieur gauche, ainsi que sa largeur et sa\n        // longueur.\n\n    method visitCompoundShape(cs: CompoundShape) is\n        // Exporte l’ID de la forme, ainsi qu’une liste des ID\n        // de ses enfants.\n\n\n// Le code client peut lancer des traitements du visiteur sur\n// n’importe quel ensemble d’éléments sans connaître leurs\n// classes concrètes. La méthode accepter envoie un appel au\n// traitement approprié de l’objet visiteur.\nclass Application is\n    field allShapes: array of Shapes\n\n    method export() is\n        exportVisitor = new XMLExportVisitor()\n\n        foreach (shape in allShapes) do\n            shape.accept(exportVisitor)\n\n```\n\nSi vous voulez savoir pourquoi nous avons besoin d’une méthode `accepter` dans cet exemple, vous pouvez consulter mon article [Visiteur et Double répartition](https://refactoring.guru/fr/design-patterns/visitor-double-dispatch \"Visiteur et double répartition\") qui décrit le sujet en détail.\n\n## Possibilités d’application\n\nUtilisez le visiteur lorsque vous voulez lancer des traitements sur les éléments d’un objet ayant une structure complexe (une arborescence par exemple).\n\nLe patron de conception visiteur vous permet de lancer des traitements sur un ensemble d’objets de différentes classes à l’aide d’un objet visiteur qui implémente une variante d’un même traitement pour chaque classe visée.\n\nUtilisez le visiteur pour nettoyer la logique métier de tous les comportements secondaires.\n\nCe patron vous permet de spécialiser encore plus les classes principales de votre application, en transférant les autres comportements dans des classes visiteur.\n\nUtilisez le visiteur si un comportement n’est adapté que pour certaines classes d’une hiérarchie de classes, mais pas pour les autres.\n\nVous pouvez envoyer ce comportement dans une classe visiteur séparée, implémenter seulement les méthodes de visite qui acceptent les objets des classes concernées et laisser le reste vide.\n\n## Mise en œuvre\n\n1.  Déclarez l’interface visiteur avec un ensemble de méthodes « visiter » ; une pour chaque classe d’élément concret qui existe dans le programme.\n    \n2.  Déclarez l’interface élément. Si vous avez déjà une hiérarchie de classes élément, ajoutez la méthode abstraite « accepter » à la classe de base de la hiérarchie. Cette méthode doit prendre un Visiteur en paramètre.\n    \n3.  Implémentez les méthodes d’acceptation dans toutes les classes des éléments concrets. Ces méthodes doivent simplement rediriger l’appel vers la méthode de visite de l’objet visiteur qui correspond à la classe de l’élément actuel.\n    \n4.  Les classes élément doivent uniquement interagir avec les visiteurs via l’interface visiteur. En revanche, les visiteurs doivent avoir la visibilité sur toutes les classes des éléments concrets, qui sont référencés comme les types des paramètres des méthodes de visite.\n    \n5.  Pour chaque comportement qui ne peut être écrit à l’intérieur de la hiérarchie des éléments, créez une nouvelle classe concrète Visiteur et implémentez toutes les méthodes de visite.\n    \n    Vous pourriez vous retrouver dans une situation où le visiteur aura besoin d’un accès aux membres privés d’une classe élément. Dans ce cas, vous pouvez rendre ces attributs ou méthodes publics (ce qui ne respecte pas l’encapsulation de l’élément) ou imbriquer la classe visiteur dans la classe de l’élément. Cette dernière possibilité n’est envisageable que si votre langage de programmation gère les classes imbriquées.\n    \n6.  Le client doit créer des objets visiteur et les passer dans des éléments via des méthodes « accepter ».\n    \n\n## Avantages et inconvénients\n\n- *Principe ouvert/fermé*. Vous pouvez ajouter un nouveau comportement qui acceptera les objets de différentes classes sans les modifier.\n- *Principe de responsabilité unique*. Vous pouvez déplacer plusieurs versions du même comportement dans une seule classe.\n- Un objet visiteur peut accumuler des informations utiles en manipulant différents objets. Cela peut se révéler pratique si vous voulez parcourir une structure complexe d’objets comme un arbre, et lancer le traitement du visiteur sur chaque objet de cette structure.\n\n- Vous devez mettre à jour les visiteurs chaque fois qu’une classe est ajoutée ou retirée de la hiérarchie des éléments.\n- Les visiteurs n’ont parfois pas les accès nécessaires aux attributs ou méthodes privés des éléments qu’ils sont censés manipuler.\n\n## Liens avec les autres patrons\n\n- Vous pouvez traiter le [Visiteur](https://refactoring.guru/fr/design-patterns/visitor) comme une version plus puissante du patron de conception [Commande](https://refactoring.guru/fr/design-patterns/command). Ses objets peuvent lancer des traitements sur divers objets dans différentes classes.\n    \n- Vous pouvez utiliser le [Visiteur](https://refactoring.guru/fr/design-patterns/visitor) pour lancer une opération sur un arbre [Composite](https://refactoring.guru/fr/design-patterns/composite) entier.\n    \n- Vous pouvez utiliser le [Visiteur](https://refactoring.guru/fr/design-patterns/visitor) avec l’[Itérateur](https://refactoring.guru/fr/design-patterns/iterator) pour parcourir une structure de données complexe et lancer un traitement sur ses éléments, même s’ils ont des classes différentes.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_e0525d7ad18143148b216dffe26863e2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/java/example \"Patrons de conception : Visiteur en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_5048387a95804fa08476c1bdd3e5d4be.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/csharp/example \"Patrons de conception : Visiteur en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_d9a26fa3c8ae4f058832f7fbcbcfd2c4.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/cpp/example \"Patrons de conception : Visiteur en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_56d76c08ed054db094717a24792e5f9e.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/php/example \"Patrons de conception : Visiteur en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_85e37f96fa184bf0a65f64d15251e846.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/python/example \"Patrons de conception : Visiteur en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_7932415689b6460599fa9bd24656184e.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/ruby/example \"Patrons de conception : Visiteur en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_141ec61410b942ffb3484e5270248cba.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/swift/example \"Patrons de conception : Visiteur en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_3503798b09f54132b8a53d7e7316c0c2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/typescript/example \"Patrons de conception : Visiteur en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_fd16a9b0507446f5acdd021abda97fc6.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/visitor/go/example \"Patrons de conception : Visiteur en Go\")\n\n## Informations supplémentaires\n\n- Vous demandez-vous toujours pourquoi vous ne pouvez pas remplacer le patron de conception visiteur par la surcharge ? Lisez mon article [Visiteur et double répartition](https://refactoring.guru/fr/design-patterns/visitor-double-dispatch) pour mieux comprendre ces vilains détails.\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_067889e7a692473bb183585cf31.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Visiteur et double répartition](https://refactoring.guru/fr/design-patterns/visitor-double-dispatch)\n\n#### Retour\n\n[Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_f421adc19d7e4ad1bce6e534c3d98019.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/visitor \"English\") [Español](https://refactoring.guru/es/design-patterns/visitor \"Español\") [Français](https://refactoring.guru/fr/design-patterns/visitor \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/visitor \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/visitor \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/visitor \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/visitor \"Українська\") [中文](https://refactoringguru.cn/design-patterns/visitor \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_dc7f44a6e8504378973c79837cbbcd98.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_3ddd85238ad34d2e92fe5a16e7e29b33.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n        - [Chaîne de responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility)\n        - [Commande](https://refactoring.guru/fr/design-patterns/command)\n        - [Itérateur](https://refactoring.guru/fr/design-patterns/iterator)\n        - [Médiateur](https://refactoring.guru/fr/design-patterns/mediator)\n        - [Mémento](https://refactoring.guru/fr/design-patterns/memento)\n        - [Observateur](https://refactoring.guru/fr/design-patterns/observer)\n        - [État](https://refactoring.guru/fr/design-patterns/state)\n        - [Stratégie](https://refactoring.guru/fr/design-patterns/strategy)\n        - [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method)\n        - [Visiteur](https://refactoring.guru/fr/design-patterns/visitor)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_4b20b337243d479eb4cd2b39d7f3591a.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Creation/Fabrique":{"title":"Fabrique / Factory Method","content":"\n**Fabrique** définit une interface pour créer des objets dans une classe mère, mais délègue le choix des types d’objets à créer aux sous-classes.\n\n![Patron de conception fabrique](../../_resources/factory-method-fr_9c56a2cdc750461b87b42d9376b693b6.png)\n\n## Problème\n\nImaginez que vous êtes en train de créer une application de gestion logistique. La première version de votre application ne propose que le transport par camion, la majeure partie de votre code est donc située dans la classe `Camion`.\n\nAu bout d’un certain temps, votre application devient populaire et de nombreuses entreprises de transport maritime vous demandent tous les jours d’ajouter la gestion de la logistique maritime dans l’application.\n\n![Ajouter un nouveau moyen de transport au programme peut créer des problèmes](../../_resources/problem1-fr_a873b3fd38d5498d8740634f75bb5234.png)\n\nL’ajout d’une nouvelle classe au programme ne s’avère pas si simple que cela si le reste du code est déjà couplé aux classes existantes.\n\nC’est super, n’est-ce pas ? Mais qu’en est-il du code ? La majeure partie est actuellement couplée à la classe `Camion`. Pour pouvoir ajouter des `Bateaux` dans l’application, il faudrait revoir la base du code. De plus, si vous décidez plus tard d’ajouter un autre type de transport dans l’application, il faudra effectuer à nouveau ces changements.\n\nPar conséquent, vous allez vous retrouver avec du code pas très propre, rempli de conditions qui modifient le comportement du programme en fonction de la classe des objets de transport.\n\n## Solution\n\nLe patron de conception fabrique vous propose de remplacer les appels directs au constructeur de l’objet (à l’aide de l’opérateur `new`) en appelant une méthode *fabrique* spéciale. Pas d’inquiétude, les objets sont toujours créés avec l’opérateur `new`, mais l’appel se fait à l’intérieur de la méthode fabrique. Les objets qu’elle retourne sont souvent appelés *produits*.\n\n\u003cimg width=\"620\" height=\"0\" src=\"../../_resources/solution1_44f9615333de43fc97f87e11a9f1a8cd.png\" class=\"jop-noMdConv\"\u003e\n\nLes sous-classes peuvent modifier les classes des objets retournés par la méthode fabrique.\n\nÀ première vue, cette modification peut sembler inutile : nous avons juste déplacé l’appel du constructeur dans une autre partie du programme. Mais maintenant, vous pouvez redéfinir la méthode fabrique dans la sous-classe et changer la classe des produits créés par la méthode.\n\nIl y a tout de même une petite limitation : les sous-classes peuvent retourner des produits différents seulement si les produits ont une classe de base ou une interface commune. De plus, cette interface doit être le type retourné par la méthode fabrique de la classe de base.\n\n\u003cimg width=\"490\" height=\"0\" src=\"../../_resources/solution2-fr_9a42a67615c444a2965ec7d6a7e81bae.png\" class=\"jop-noMdConv\"\u003e\n\nLes produits doivent tous implémenter la même interface.\n\nPar exemple, les classes `Camion` et `Bateau` doivent toutes les deux implémenter l’interface `Transport`, qui déclare une méthode `livrer`. Chaque classe implémente cette méthode à sa façon : les camions livrent par la route et les bateaux livrent par la mer. La méthode fabrique de la classe `LogistiqueRoute` retourne des camions, alors que celle de la classe `LogistiqueMer` retourne des bateaux.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/solution3-fr_3300314049144fdb8f4dc77ef85e2372.png\" class=\"jop-noMdConv\"\u003e\n\nTant que les classes produit implémentent une interface commune, vous pouvez passer leurs objets au code client sans tout faire planter.\n\nLe code qui appelle la méthode fabrique (souvent appelé le code *client*) ne fait pas la distinction entre les différents produits concrets retournés par les sous-classes, il les considère tous comme des `Transports` abstraits. Le client sait que tous les objets transportés sont censés avoir une méthode `livrer`, mais son fonctionnement lui importe peu.\n\n## Structure\n\n\u003cimg width=\"660\" height=\"0\" src=\"../../_resources/structure_ea59814269984a5bbd1765404b5273ef.png\" class=\"jop-noMdConv\"\u003e\n\n1.  L’interface est déclarée par le **Produit** et est commune à tous les objets qui peuvent être conçus par le créateur et ses sous-classes.\n    \n2.  Les **Produits Concrets** sont différentes implémentations de l’interface produit.\n    \n3.  La méthode fabrique est déclarée par la classe **Créateur** et retourne les nouveaux produits. Il est important que son type de retour concorde avec l’interface produit.\n    \n    Vous pouvez rendre la méthode fabrique abstraite afin d’obliger ses sous-classes à implémenter leur propre version de la méthode ou vous pouvez modifier la méthode fabrique de la classe de base afin qu’elle retourne un type de produit par défaut.\n    \n    Il faut bien comprendre que malgré son nom, la création de produits n’est **pas** la responsabilité principale du créateur. La classe créateur a en général déjà un fonctionnement propre lié à la nature de ses produits. La fabrique aide à découpler cette logique des produits concrets. C’est un peu comme une grande entreprise de développement de logiciels : elle peut posséder un département spécialisé dans la formation des développeurs, mais son activité principale reste d’écrire du code, pas de produire des développeurs.\n    \n4.  Les **Créateurs Concrets** redéfinissent la méthode fabrique de la classe de base afin de pouvoir retourner les différents types de produits.\n    \n    Notez toutefois que la méthode fabrique n’est pas obligée de **créer** tout le temps de nouvelles instances. Elle peut retourner des objets depuis un cache, un réservoir d’objets ou une autre source.\n    \n\n## Pseudo-code\n\nCet exemple montre comment la **fabrique** peut être utilisée pour créer des éléments d’une UI (interface utilisateur) multiplateforme sans coupler le code client aux classes concrètes de l’UI.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/example_c9ed934b5f524674b583512946494426.png\" class=\"jop-noMdConv\"\u003e\n\nExemple multiplateforme pour une boîte de dialogue.\n\nLa classe de base dialogue utilise différents éléments d’UI pour le rendu de ses fenêtres. Ces éléments peuvent un peu varier en fonction du système d’exploitation, mais ils doivent garder le même comportement. Un bouton sous Windows est aussi un bouton sous Linux.\n\nLorsque la fabrique entre dans l’équation, il est inutile de réécrire la logique de la boîte de dialogue pour chaque système d’exploitation. Si nous déclarons une méthode fabrique qui crée des boutons à l’intérieur de la classe de base dialogue, nous pourrons par la suite sous-classer cette dernière afin que la méthode fabrique retourne des boutons dotés du style Windows. La sous-classe hérite alors du code de la classe de base dialogue, mais grâce à la fabrique, elle est capable d’afficher à l’écran des boutons à l’allure Windows.\n\nPour le bon fonctionnement de ce patron, la classe de base dialogue doit utiliser des boutons abstraits représentés par une classe de base ou une interface dont tous les boutons concrets hériteront. Ainsi, quel que soit le type de boutons, le code de la classe dialogue reste fonctionnel.\n\nBien sûr, cette approche fonctionne également avec les autres éléments de l’UI. Cependant, chaque nouvelle méthode fabrique ajoutée à Dialogue nous rapproche du patron de conception [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory). Pas de panique, nous aborderons ce patron plus tard !\n\n```\n// La classe créateur déclare la méthode fabrique qui doit\n// renvoyer un objet de la classe produit. Les sous-classes du\n// créateur fournissent en général une implémentation de cette\n// méthode.\nclass Dialog is\n    // Le créateur peut également fournir des implémentations\n    // par défaut de la méthode fabrique.\n    abstract method createButton():Button\n\n    // Ne vous laissez pas berner par son nom, la responsabilité\n    // principale du créateur n’est pas de fabriquer des\n    // produits. Il héberge en général de la logique métier qui\n    // concerne les produits retournés par la méthode fabrique.\n    // Les sous-classes peuvent modifier indirectement cette\n    // logique métier en redéfinissant la méthode fabrique et en\n    // lui faisant retourner un type de produit différent.\n    method render() is\n        // Appelle la méthode fabrique pour créer un objet\n        // Produit.\n        Button okButton = createButton()\n        // Utilise le produit.\n        okButton.onClick(closeDialog)\n        okButton.render()\n\n// Les créateurs concrets redéfinissent la méthode fabrique pour\n// changer le type du produit qui en résulte.\nclass WindowsDialog extends Dialog is\n    method createButton():Button is\n        return new WindowsButton()\n\nclass WebDialog extends Dialog is\n    method createButton():Button is\n        return new HTMLButton()\n\n// L’interface du produit déclare les traitements que tous les\n// produits concrets doivent implémenter.\ninterface Button is\n    method render()\n    method onClick(f)\n\n// Les produits concrets fournissent diverses implémentations de\n// l’interface du produit.\nclass WindowsButton implements Button is\n    method render(a, b) is\n        // Affiche un bouton avec le style Windows.\n    method onClick(f) is\n        // Attribue un événement sur un clic natif dans un\n        // système d’exploitation.\n\nclass HTMLButton implements Button is\n    method render(a, b) is\n        // Retourne une représentation HTML d’un bouton.\n    method onClick(f) is\n        // Attribue un événement sur un clic dans un navigateur\n        // Internet.\n\nclass Application is\n    field dialog: Dialog\n\n    // L’application choisit un type de créateur en fonction de\n    // la configuration actuelle ou des paramètres\n    // d’environnement.\n    method initialize() is\n        config = readApplicationConfigFile()\n\n        if (config.OS == \"Windows\") then\n            dialog = new WindowsDialog()\n        else if (config.OS == \"Web\") then\n            dialog = new WebDialog()\n        else\n            throw new Exception(\"Error!  Unknown  operating  system.\")\n\n    // Le code client manipule une instance d’un créateur\n    // concret, mais uniquement au moyen de son interface de\n    // base. Tant que le client continue de passer par cette\n    // interface pour manipuler le créateur, vous pouvez passer\n    // n’importe quelle sous-classe du créateur.\n    method main() is\n        this.initialize()\n        dialog.render()\n\n```\n\n## Possibilités d’application\n\nUtilisez la fabrique si vous ne connaissez pas à l’avance les types et dépendances précis des objets que vous allez utiliser dans votre code.\n\nLa fabrique effectue une séparation entre le code du constructeur et le code qui utilise réellement le produit. Le code du constructeur devient ainsi plus évolutif et indépendant du reste du code.\n\nPar exemple, si vous voulez ajouter un nouveau produit dans l’application, il vous suffit d’ajouter une sous-classe de création et d’y redéfinir la méthode fabrique.\n\nUtilisez la fabrique si vous voulez mettre à disposition une librairie ou un framework pour vos utilisateurs avec un moyen d’étendre ses composants internes.\n\nL’héritage est probablement le moyen le plus simple pour étendre le comportement par défaut d’une librairie ou d’un framework. Mais comment le framework peut-il savoir qu’il doit utiliser votre sous-classe plutôt qu’un composant standard ?\n\nLa solution est de réunir dans une seule méthode fabrique le code qui construit les composants dans le framework, et non seulement d’étendre ceux-ci, mais de laisser la possibilité de redéfinir la méthode fabrique.\n\nVoyons un exemple d’utilisation. Imaginez la conception d’une application qui utilise un framework d’UI open source. Vous désirez utiliser des boutons ronds, mais le framework ne fournit que des boutons carrés. Vous étendez le `Bouton` standard avec une magnifique sous-classe `BoutonRond`. Mais vous devez à présent expliquer à la classe principale `UIFramework` qu’elle doit utiliser la sous-classe du nouveau bouton plutôt que celle par défaut.\n\nPour ce faire, vous créez une sous-classe `UIAvecBoutonsRonds` depuis une classe de base du framework et redéfinissez sa méthode `créerBouton`. Même si la méthode de la classe de base retourne des `Boutons`, votre sous-classe renvoie des `BoutonsRonds`. Vous pouvez dorénavant utiliser `UIAvecBoutonsRonds` à la place de `UIFramework`. Et c’est à peu près tout !\n\nUtilisez la fabrique lorsque vous voulez économiser des ressources système en réutilisant des objets au lieu d’en construire de nouveaux.\n\nLe besoin se présente souvent lorsque l’on utilise des objets qui prennent beaucoup de ressources tels que des bases de données, des systèmes de fichiers ou des ressources réseau.\n\nQue faut-il pour réutiliser un objet existant ?\n\n1.  Tout d’abord, vous devez créer un moyen de stockage afin de garder la trace de tous les objets créés.\n2.  Lorsqu’un nouvel objet est demandé, le programme doit chercher un objet libre dans cette réserve.\n3.  … et le renvoyer au code client.\n4.  Si aucun objet n’est disponible, le programme en crée un nouveau (et l’ajoute à la réserve).\n\nCela représente un paquet de code ! De plus, il faut tout mettre au même endroit afin de ne pas polluer le code avec des doublons.\n\nIl serait probablement plus pratique de l’écrire dans le constructeur de la classe de l’objet que l’on veut réutiliser, mais par définition, un constructeur doit toujours renvoyer de **nouveaux objets**. Il ne peut pas retourner des instances existantes.\n\nC’est pourquoi vous devez disposer d’une méthode non seulement capable de créer de nouveaux objets, mais aussi de réutiliser ceux qui existent déjà. Cela ressemble énormément à un patron de conception fabrique.\n\n## Mise en œuvre\n\n1.  Implémentez la même interface pour tous les produits. Cette interface doit déclarer des méthodes que tous les produits peuvent avoir en commun.\n    \n2.  Ajoutez une méthode fabrique vide à l’intérieur de la classe créateur. Le type de retour de la méthode doit correspondre à l’interface commune des produits.\n    \n3.  Localisez toutes les références aux constructeurs des produits dans le code du créateur. Remplacez-les une par une par des appels à la méthode fabrique et déplacez le code de la création de produits dans la méthode fabrique.\n    \n    Vous allez peut-être devoir ajouter un paramètre temporaire à la méthode fabrique pour vérifier le type du produit retourné.\n    \n    À ce stade, le code de la méthode fabrique peut paraître désordonné. Il pourrait même contenir un gros `switch` qui choisit la classe à instancier. Ne vous inquiétez pas, tout va bientôt rentrer dans l’ordre.\n    \n4.  Pour chaque type de produit listé dans la méthode fabrique, créez une sous-classe de Créateur. Redéfinissez la méthode fabrique dans les sous-classes et récupérez les morceaux de code appropriés de la méthode de base.\n    \n5.  S’il y a trop de types de produits et peu d’intérêt de créer des sous-classes pour tous, vous pouvez réutiliser le paramètre de contrôle de la classe de base dans les sous-classes.\n    \n    Imaginons la hiérarchie de classes suivante : la classe de base `Courrier` avec les sous-classes `CourrierAérien` et `CourrierTerrestre` ; les classes de `Transport` sont `Avion`, `Camion` et `Train`. La classe `CourrierAérien` n’utilise que des `Avions` et la classe `CourrierTerrestre` peut utiliser à la fois des `Camions` et des `Trains`. Vous pouvez créer une nouvelle sous-classe (`CourrierFerroviaire` par exemple) pour gérer les deux cas, mais il y a une autre possibilité. Le code client peut passer un argument à la méthode fabrique du `CourrierTerrestre` pour désigner le type de produit qu’elle veut recevoir.\n    \n6.  Si après tous ces changements la méthode fabrique de base est devenue complètement vide, vous pouvez la rendre abstraite. S’il reste encore quelques lignes, vous pouvez y laisser un comportement par défaut.\n    \n\n## Avantages et inconvénients\n\n- Vous désolidarisez le Créateur des produits concrets.\n    \n- *Principe de responsabilité unique*. Vous pouvez déplacer tout le code de création des produits au même endroit, permettant ainsi une meilleure maintenabilité.\n    \n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouveaux types de produits dans le programme sans endommager l’existant.\n    \n- Le code peut devenir plus complexe puisque vous devez introduire de nombreuses sous-classes pour la mise en place du patron. La condition optimale d’intégration du patron dans du code existant se présente lorsque vous avez déjà une hiérarchie existante de classes de création.\n    \n\n## Liens avec les autres patrons\n\n- La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est souvent utilisée dès le début de la conception (moins compliquée et plus personnalisée grâce aux sous-classes) et évolue vers la [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory), le [Prototype](https://refactoring.guru/fr/design-patterns/prototype), ou le [Monteur](https://refactoring.guru/fr/design-patterns/builder) (ce dernier étant plus flexible, mais plus compliqué).\n    \n- Les classes [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) sont souvent basées sur un ensemble de [Fabriques](https://refactoring.guru/fr/design-patterns/factory-method), mais vous pouvez également utiliser le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) pour écrire leurs méthodes.\n    \n- Vous pouvez utiliser la [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) avec l’[Itérateur](https://refactoring.guru/fr/design-patterns/iterator) pour permettre aux sous-classes des collections de renvoyer différents types d’itérateurs compatibles avec les collections.\n    \n- Le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) n’est pas basé sur l’héritage, il n’a donc pas ses désavantages. Mais le *prototype* requiert une initialisation compliquée pour l’objet cloné. La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est basée sur l’héritage, mais n’a pas besoin d’une étape d’initialisation.\n    \n- La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est une spécialisation du [Patron de méthode](https://refactoring.guru/fr/design-patterns/template-method). Une *fabrique* peut aussi faire office d’étape dans un grand *patron de méthode*.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_1666917d9f7b4795bbd0828f9a8922d5.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/java/example \"Patrons de conception : Fabrique en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_3589127d5ded41e2b3d2f042272d3475.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/csharp/example \"Patrons de conception : Fabrique en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_c933f58693144fa2b796247f044dd55c.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/cpp/example \"Patrons de conception : Fabrique en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_ff2e08f607734ec7905a6dac659da652.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/php/example \"Patrons de conception : Fabrique en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_996d21f6666a412dbd5faeacdcbfbb91.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/python/example \"Patrons de conception : Fabrique en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_8fa68619e414414f98c396d6b55ffd1c.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/ruby/example \"Patrons de conception : Fabrique en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_3b34a780eb184f3ab4067d01702cb2db.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/swift/example \"Patrons de conception : Fabrique en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_4fd75f2958254c28a762da282531cfa0.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/typescript/example \"Patrons de conception : Fabrique en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_028710c23fb7445bac4202cd4de706c2.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/factory-method/go/example \"Patrons de conception : Fabrique en Go\")\n\n## Informations supplémentaires\n\n- Lisez notre [Comparaison des fabriques](https://refactoring.guru/fr/design-patterns/factory-comparison) si vous peinez à saisir la nuance entre les différents concepts et patrons.\n\n[Votre navigateur ne peut pas lire les vidéos HTML.](https://refactoring.guru/fr/design-patterns/book)\n\n### Pourquoi acheter le meilleur ebook sur les patrons de conception ?\n\n- Admettons-le : lire un site Internet n’est pas très amusant.\n- Soyez productifs dans les transports en commun.\n- Apprenez de nouvelles choses tout en vous reposant sur votre canapé.\n- Rempli d’exemples de code très utiles en POO.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory)\n\n#### Retour\n\n[Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n\n[\u003cimg width=\"150\" height=\"205\" src=\"../../_resources/web-cover-en_0c1927f6fda54c9087484914aa3182d3.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/factory-method \"English\") [Español](https://refactoring.guru/es/design-patterns/factory-method \"Español\") [Français](https://refactoring.guru/fr/design-patterns/factory-method \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/factory-method \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/factory-method \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/factory-method \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/factory-method \"Українська\") [中文](https://refactoringguru.cn/design-patterns/factory-method \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_37ae71ff2d074d38a224e52bdc8ffdb1.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_0b8697bcb474419982bb4e8fb046e6c7.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n![Organization address](../../_resources/fa-building_a7c0361655b04fc0812158866baea027.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Creation/Fabrique_abstraite":{"title":"Fabrique abstraite / Abstract Factory","content":"\n**Fabrique abstraite** permet de créer des familles d’objets apparentés sans préciser leur classe concrète.\n\n![Patron de conception fabrique abstraite](../../_resources/abstract-factory-fr_d627b05adce64634b9de210dc74587.png)\n\n## Problème\n\nImaginons la création d’un simulateur pour un magasin de meubles. Votre code contient les classes suivantes :\n\n1.  Une famille de produits appartenant à un même thème : `Chaise` \\+ `Sofa` \\+ `TableBasse`.\n    \n2.  Plusieurs variantes de cette famille. Par exemple, les produits `Chaise` \\+ `Sofa` \\+ `TableBasse` sont disponibles dans les variantes suivantes : `Moderne`, `Victorien`, `ArtDéco`.\n    \n\n![Familles de produits et leurs variantes](../../_resources/problem-fr_2064ebbba37e4f05818766362d9d1dd9.png)\n\nFamilles de produits et leurs variantes.\n\nVous devez trouver une solution pour créer des objets individuels (des meubles) et les faire correspondre à d’autres objets de la même famille. Les clients sont agacés lorsqu’ils reçoivent des meubles qui ne se marient pas.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/abstract-factory-comic-1-fr_420a4a25fc424ff7ba7cd6.png\" class=\"jop-noMdConv\"\u003e\n\nUn sofa moderne ne se marie pas avec des chaises de style victorien.\n\nDe plus, vous n’avez pas envie de réécrire votre code chaque fois que vous ajoutez de nouvelles familles de produits à votre programme. Les vendeurs de meubles alimentent régulièrement leurs catalogues et il n’est pas envisageable de restructurer le code à chaque mise à jour.\n\n## Solution\n\nLa première chose que propose la fabrique abstraite est de déclarer explicitement des interfaces pour chaque produit de la famille de produits (dans notre cas : chaise, sofa, table basse). Toutes les autres variantes de produits peuvent ensuite se servir de ces interfaces. Par exemple, toutes les variantes de chaises peuvent implémenter l’interface `Chaise` ; toutes les variantes de tables basses peuvent implémenter `TableBasse`, etc.\n\n\u003cimg width=\"420\" height=\"0\" src=\"../../_resources/solution1_cfcf64e484574e72bc8100689f8f92e2.png\" class=\"jop-noMdConv\"\u003e\n\nToutes les variantes du même objet peuvent être rangées dans la même hiérarchie de classe.\n\nLa prochaine étape est de déclarer la *fabrique abstraite* — une interface armée d’une liste de méthodes de création pour toutes les familles de produits (par exemple : `créerChaise`, `créerSofa` et `créerTableBasse`). Ces méthodes doivent renvoyer tous les types de produits **abstraits** des interfaces que nous avons créées précédemment : `Chaise`, `Sofa`, `TableBasse`, etc.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/solution2_e6b5780abba24a85b2313f973507e5ad.png\" class=\"jop-noMdConv\"\u003e\n\nChaque fabrique concrète correspond à une variante d’un produit spécifique.\n\nMais que deviennent les variantes des produits ? Pour chaque variante d’une famille de produits, nous créons une classe fabrique qui implémente l’interface `FabriqueAbstraite`. Une fabrique est une classe qui retourne un certain type de produits. Par exemple, la `FabriqueMeubleModerne` peut uniquement créer des `ChaiseModerne`, des `SofaModerne` et des `TableBasseModerne`.\n\nLe code client travaille simultanément avec les interfaces abstraites respectives des fabriques et des produits. Nous pouvons ainsi changer le type de fabrique passé au code client et la variante de produit qu’il reçoit, sans avoir à le modifier.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/abstract-factory-comic-2-fr_30b3e8fb3eee4b6e86d1fa.png\" class=\"jop-noMdConv\"\u003e\n\nLe client n’a pas besoin de connaître la classe concrète des fabriques qu’il utilise.\n\nImaginons un cas où le client désire une fabrique qui peut produire une chaise. Le client n’a pas à se préoccuper de la classe de la fabrique ni du type de chaise qu’il va obtenir. Il doit traiter les chaises de la même manière, que ce soit un modèle de style moderne ou victorien, en utilisant l’interface abstraite `Chaise`. Grâce à cette approche, le client ne sait qu’une seule chose à propos de la chaise, c’est qu’elle implémente la méthode `sasseoir`. De plus, quelle que soit la variante de la chaise renvoyée, elle correspondra systématiquement au type de sofa ou de table basse produit par le même objet fabrique.\n\nIl ne reste plus qu’un point à éclaircir : si le client n’est lié qu’aux interfaces abstraites, comment les objets de la fabrique sont-ils créés ? En général, l’application crée un objet fabrique concret lors de l’initialisation. Mais avant cela, l’application doit choisir le type de la fabrique en fonction de la configuration ou des paramètres d’environnement.\n\n## Structure\n\n\u003cimg width=\"720\" height=\"0\" src=\"../../_resources/structure_70f1dd00d1474d72872306b7ca75bd65.png\" class=\"jop-noMdConv\"\u003e\n\n1.  Les **Produits Abstraits** déclarent une interface pour un ensemble d’objets distincts mais apparentés, qui forment une famille de produits.\n    \n2.  Les **Produits Concrets** sont des implémentations des produits abstraits groupés par variantes. Chaque produit abstrait (chaise/sofa) doit être implémenté dans toutes les variantes (victorien/moderne).\n    \n3.  L’interface **Fabrique Abstraite** déclare un ensemble de méthodes pour créer chacun des produits abstraits.\n    \n4.  Les **Fabriques Concrètes** implémentent les opérations de création d’objets de la fabrique abstraite. Chaque fabrique concrète correspond à une variante spécifique de produits et ne crée que ces variantes.\n    \n5.  Bien que les fabriques concrètes instancient des produits concrets, leurs méthodes de création ont une valeur de retour correspondant aux produits *abstraits*. Le code client qui sollicite une fabrique est ainsi isolé de la variante du produit obtenu. Le **client** peut travailler avec n’importe quelle variante de fabrique ou produit, tant qu’il interagit avec les interfaces abstraites.\n    \n\n## Pseudo-code\n\nCet exemple montre comment la **Fabrique abstraite** peut être utilisée pour créer des éléments d’une UI multiplateforme sans coupler le code client avec les classes concrètes de l’UI, tout en gardant une cohérence entre les éléments créés et le système d’exploitation sélectionné.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/example_183b183486524de08826bc72544798df.png\" class=\"jop-noMdConv\"\u003e\n\nExemple des classes d’une UI multiplateforme\n\nTous les éléments de l’UI d’une application multiplateforme sont censés avoir un comportement identique quel que soit le système d’exploitation, mais leur apparence peut légèrement varier. Vous devez faire en sorte que les éléments de l’interface correspondent bien au style du système d’exploitation. Vous ne voudriez pas vous retrouver avec des boutons macOS dans Windows.\n\nL’interface de la fabrique abstraite déclare un ensemble de méthodes de création que le code client peut utiliser pour produire différents types d’éléments de l’UI. Chaque fabrique concrète correspond à un système d’exploitation particulier et crée ses propres éléments de l’UI en fonction de ce système d’exploitation.\n\nLe fonctionnement est le suivant : lorsqu’une application est exécutée, elle vérifie le système d’exploitation utilisé et exploite cette information pour créer un objet de la fabrique qui y correspond. Cette fabrique est ensuite utilisée pour générer tout le reste des éléments de l’UI, ce qui évite les erreurs.\n\nGrâce à cette approche, tant qu’il utilise leurs interfaces abstraites, le code client ne dépend plus des classes concrètes de la fabrique et des éléments de l’UI. Cela lui permet également d’exploiter les nouveaux éléments de l’UI ou les fabriques que vous pourriez ajouter dans le futur.\n\nNous n’avons ainsi plus besoin de modifier le code client à chaque nouvel élément de l’interface utilisateur que vous voulez ajouter dans votre application. Vous devrez simplement créer une nouvelle classe fabrique produisant ces éléments et apporter quelques modifications au code d’initialisation afin qu’il choisisse la classe appropriée.\n\n```\n// L’interface de la fabrique abstraite déclare un ensemble de\n// méthodes qui retournent différents produits abstraits. Ces\n// produits font partie de ce que l’on appelle une famille et\n// sont reliés par un concept ou un thème de haut niveau. Les\n// produits d’une famille sont généralement capables de\n// collaborer les uns avec les autres. Une famille de produits\n// peut avoir plusieurs variantes, mais les produits d’une\n// variante ne sont pas compatibles avec les produits d’une\n// autre.\ninterface GUIFactory is\n    method createButton():Button\n    method createCheckbox():Checkbox\n\n\n// Les fabriques concrètes construisent une famille de produits\n// qui appartiennent à une seule variante. La fabrique garantit\n// la compatibilité des produits qui en sortent. Les signatures\n// des méthodes des fabriques concrètes renvoient un produit\n// abstrait, et à l’intérieur de la méthode, un produit concret\n// est instancié.\nclass WinFactory implements GUIFactory is\n    method createButton():Button is\n        return new WinButton()\n    method createCheckbox():Checkbox is\n        return new WinCheckbox()\n\n// Chaque fabrique concrète possède une variante de produit\n// correspondante.\nclass MacFactory implements GUIFactory is\n    method createButton():Button is\n        return new MacButton()\n    method createCheckbox():Checkbox is\n        return new MacCheckbox()\n\n\n// Chaque produit d’une famille de produits doit avoir une\n// interface de base. Toutes les variantes du produit doivent\n// implémenter cette interface.\ninterface Button is\n    method paint()\n\n// Les produits concrets sont créés par les fabriques concrètes\n// correspondantes.\nclass WinButton implements Button is\n    method paint() is\n        // Affiche un bouton avec le style Windows.\n\nclass MacButton implements Button is\n    method paint() is\n        // Affiche un bouton avec le style macOS.\n\n// Voici l’interface de base d’un autre produit. Tous les\n// produits peuvent interagir les uns avec les autres, mais les\n// interactions adéquates devraient être implémentées de\n// préférence entre les produits d’une même variante concrète.\ninterface Checkbox is\n    method paint()\n\nclass WinCheckbox implements Checkbox is\n    method paint() is\n        // Affiche une case à cocher avec le style Windows.\n\nclass MacCheckbox implements Checkbox is\n    method paint() is\n        // Affiche une case à cocher avec le style macOS.\n\n\n// Le code client travaille uniquement avec les types abstraits\n// des fabriques et des produits : FabriqueGUI, Bouton et\n// CaseÀCocher. Ceci vous permet d’envoyer n’importe quelle\n// sous-classe de fabrique ou de produit au code client sans\n// toucher à son code.\nclass Application is\n    private field factory: GUIFactory\n    private field button: Button\n    constructor Application(factory: GUIFactory) is\n        this.factory = factory\n    method createUI() is\n        this.button = factory.createButton()\n    method paint() is\n        button.paint()\n\n\n// L’application choisit le type de la fabrique en fonction de\n// la configuration actuelle ou des paramètres d’environnement,\n// et la crée à l’exécution (en général lors de la phase\n// d’initialisation).\nclass ApplicationConfigurator is\n    method main() is\n        config = readApplicationConfigFile()\n\n        if (config.OS == \"Windows\") then\n            factory = new WinFactory()\n        else if (config.OS == \"Mac\") then\n            factory = new MacFactory()\n        else\n            throw new Exception(\"Error! Unknown operating system.\")\n\n        Application app = new Application(factory)\n\n```\n\n## Possibilités d’application\n\nUtilisez la fabrique abstraite si votre code a besoin de manipuler des produits d’un même thème, mais que vous ne voulez pas qu’il dépende des classes concrètes de ces produits — soit vous ne les connaissez pas encore, soit vous voulez juste rendre votre code évolutif.\n\nLa fabrique abstraite fournit une interface qui permet de créer des objets pour chaque classe de la famille de produits. Tant que votre code utilise cette interface pour créer ses objets, il prendra systématiquement les bonnes variantes des produits disponibles dans votre application.\n\n- Étudiez la possibilité d’utiliser la fabrique abstraite lorsqu’une classe se retrouve avec un ensemble de patrons [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) qui occultent sa fonction principale.\n    \n- Dans un programme bien conçu *chaque classe n’a qu’une seule responsabilité*. Lorsqu’une classe gère plusieurs types de produits, déplacer les méthodes fabrique dans des fabriques individuelles ou dans une implémentation à part entière d’une fabrique abstraite est souvent plus pratique.\n    \n\n## Mise en œuvre\n\n1.  Établissez une matrice de vos différents types de produits et leurs variantes.\n    \n2.  Déclarez des interfaces abstraites pour tous vos types de produits. Mettez en place vos produits concrets dans des classes qui implémentent ces interfaces.\n    \n3.  Déclarez une interface abstraite de la fabrique avec un ensemble de méthodes de création pour tous les produits abstraits.\n    \n4.  Implémentez une classe fabrique concrète pour chaque variante des produits.\n    \n5.  Insérez le code de l’initialisation de la fabrique quelque part dans votre application. Il doit instancier une des fabriques concrètes en fonction de la configuration de l’application ou de l’environnement d’exécution. Passez cette fabrique à toutes les classes qui construisent des produits.\n    \n6.  Parcourez votre code et repérez tous les appels aux constructeurs des produits. Remplacez-les par des appels à la méthode de création appropriée de la fabrique.\n    \n\n## Avantages et inconvénients\n\n- Vous êtes assurés que les produits d’une fabrique sont compatibles entre eux.\n    \n- Vous découplez le code client des produits concrets.\n    \n- *Principe de responsabilité unique*. Vous pouvez déplacer tout le code de création des produits au même endroit, pour une meilleure maintenabilité.\n    \n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouvelles variantes de produits sans endommager l’existant.\n    \n- Le code peut devenir plus complexe que nécessaire, car ce patron de conception impose l’ajout de nouvelles classes et interfaces.\n    \n\n## Liens avec les autres patrons\n\n- La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est souvent utilisée dès le début de la conception (moins compliquée et plus personnalisée grâce aux sous-classes) et évolue vers la [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory), le [Prototype](https://refactoring.guru/fr/design-patterns/prototype), ou le [Monteur](https://refactoring.guru/fr/design-patterns/builder) (ce dernier étant plus flexible, mais plus compliqué).\n    \n- Le [Monteur](https://refactoring.guru/fr/design-patterns/builder) se concentre sur la construction d’objets complexes étape par étape. La [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) se spécialise dans la création de familles d’objets associés. La *fabrique abstraite* retourne le produit immédiatement, alors que le *monteur* vous permet de lancer des étapes supplémentaires avant de récupérer le produit.\n    \n- Les classes [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) sont souvent basées sur un ensemble de [Fabriques](https://refactoring.guru/fr/design-patterns/factory-method), mais vous pouvez également utiliser le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) pour écrire leurs méthodes.\n    \n- La [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) peut remplacer la [Façade](https://refactoring.guru/fr/design-patterns/facade) si vous voulez simplement cacher au code client la création des objets du sous-système.\n    \n- Vous pouvez utiliser la [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) avec le [Pont](https://refactoring.guru/fr/design-patterns/bridge). Ce couple est très utile quand les abstractions définies par le *pont* ne fonctionnent qu’avec certaines implémentations spécifiques. Dans ce cas, la *fabrique abstraite* peut encapsuler ces relations et cacher la complexité au code client.\n    \n- Les [Fabriques abstraites](https://refactoring.guru/fr/design-patterns/abstract-factory), [Monteurs](https://refactoring.guru/fr/design-patterns/builder) et [Prototypes](https://refactoring.guru/fr/design-patterns/prototype) peuvent tous être implémentés comme des [Singletons](https://refactoring.guru/fr/design-patterns/singleton).\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_6484e190e78d4f02bf2fde813a41c0fc.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/java/example \"Patrons de conception : Fabrique abstraite en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_6570c0a1dda74ede82de63f6d81e541f.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/csharp/example \"Patrons de conception : Fabrique abstraite en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_020869490e0a4f4a934ca702ef1412b1.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/cpp/example \"Patrons de conception : Fabrique abstraite en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_5b81defad14d4ff8bb0b0951aefc10c8.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/php/example \"Patrons de conception : Fabrique abstraite en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_e16527be71274dc89282f52e2b7f5764.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/python/example \"Patrons de conception : Fabrique abstraite en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_0ea3de41c7af4022bfca5b75c1203aff.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/ruby/example \"Patrons de conception : Fabrique abstraite en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_d90b59204f3a4a7293a77b01fd5569ff.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/swift/example \"Patrons de conception : Fabrique abstraite en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_759668b881a046e7883e80f949b3743b.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/typescript/example \"Patrons de conception : Fabrique abstraite en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_0c0910284e9c46438644811c640cb3c3.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/abstract-factory/go/example \"Patrons de conception : Fabrique abstraite en Go\")\n\n## Informations supplémentaires\n\n- Lisez notre [Comparaison des fabriques](https://refactoring.guru/fr/design-patterns/factory-comparison) pour en savoir plus sur la différence entre les divers patrons et concepts.\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_9f025e7f78904866ac03dc5e816.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Comparaison des fabriques](https://refactoring.guru/fr/design-patterns/factory-comparison)\n\n#### Retour\n\n[Fabrique](https://refactoring.guru/fr/design-patterns/factory-method)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_d607e2ca64e54a30ab7e1e2a93abff3f.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/abstract-factory \"English\") [Español](https://refactoring.guru/es/design-patterns/abstract-factory \"Español\") [Français](https://refactoring.guru/fr/design-patterns/abstract-factory \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/abstract-factory \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/abstract-factory \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/abstract-factory \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/abstract-factory \"Українська\") [中文](https://refactoringguru.cn/design-patterns/abstract-factory \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_c9f9ab409ae24cd19ab33160bea70e0d.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_b3fd1218723f48a68bd81bd9e65cd053.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n        - [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method)\n        - [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory)\n        - [Monteur](https://refactoring.guru/fr/design-patterns/builder)\n        - [Prototype](https://refactoring.guru/fr/design-patterns/prototype)\n        - [Singleton](https://refactoring.guru/fr/design-patterns/singleton)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n![Organization address](../../_resources/fa-building_284223436a504539866b7b608b9330a1.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Creation/Monteur":{"title":"Monteur / Builder","content":"\n**Monteur** permet de construire des objets complexes étape par étape. Il permet de produire différentes variations ou représentations d’un objet en utilisant le même code de construction.\n\n![Patron de conception monteur](../../_resources/builder-fr_10d1ceb31d404af3ae224e04d7fda26d.png)\n\n## Problème\n\nImaginez un objet complexe qui nécessite une initialisation fastidieuse, composée de plusieurs parties avec de nombreux champs et objets imbriqués. Le code d’initialisation va se retrouver dans un constructeur, enterré sous une pile monstrueuse de paramètres, ou encore pire : réparti un peu partout dans le code client.\n\n![Créer de nombreuses sous-classes entraîne un autre problème](../../_resources/problem1_f320e715ef8046dabe552ca09d117bd0.png)\n\nCréer une sous-classe pour chaque configuration possible d’un objet risque de rendre le programme trop complexe.\n\nRéfléchissons à la manière de modéliser un objet `Maison`. Pour fabriquer une maison de base, vous devez construire quatre murs et un sol, installer une porte, poser quelques fenêtres et bâtir un toit. Mais comment procéder si vous voulez une plus grande maison avec plus de lumière, un peu de terrain et autres commodités (un système de chauffage, de la plomberie et des câbles électriques) ?\n\nLa solution la plus simple est d’étendre la classe de base `Maison` et de créer un ensemble de sous-classes pour couvrir toutes les combinaisons de paramètres. Mais au bout d’un certain temps, vous allez vous retrouver avec un nombre considérable de sous-classes. Le moindre paramètre supplémentaire comme le style du porche par exemple, va encore plus développer la hiérarchie.\n\nVoici une autre approche qui n’implique pas de générer des sous-classes : vous pouvez créer un constructeur géant dans la classe de base `Maison` avec tous les paramètres contrôlant l’objet maison. Cette solution élimine le besoin de sous-classes, mais entraîne un autre problème.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/problem2_b38c713d6e9f48d0bb8bda43b205cb0c.png\" class=\"jop-noMdConv\"\u003e\n\nUn constructeur qui possède de nombreux paramètres a ses inconvénients : ces derniers ne sont pas toujours tous utilisés.\n\nDans la majorité des cas, la plupart des paramètres resteront inutilisés, rendant [l’appel au constructeur assez hideux](https://refactoring.guru/fr/smells/long-parameter-list \"Long Parameter List\"). Par exemple, le paramètre recensant les piscines se révèle inutile neuf fois sur dix, car peu de maisons en sont équipées.\n\n## Solution\n\nLe patron de conception monteur propose d’extraire le code du constructeur d’objet de sa classe et de le déplacer dans des objets distincts appelés *monteurs*.\n\n\u003cimg width=\"410\" height=\"0\" src=\"../../_resources/solution1_716647eda6ae425687c46e111b7a7325.png\" class=\"jop-noMdConv\"\u003e\n\nLe patron de conception monteur permet de construire des objets complexes étape par étape. Le monteur empêche les autres objets d’accéder au produit pendant sa construction.\n\nIl organise la construction de l’objet à l’aide d’une série d’étapes (`construireMurs`, `construirePorte`, etc.). Pour créer un objet, vous allez effectuer une séquence d’étapes dans un objet monteur. Le gros avantage, c’est que vous n’avez pas besoin d’appeler toutes les étapes, mais seulement celles nécessaires à la création de la configuration particulière d’un objet.\n\nCertaines étapes de la construction peuvent demander des implémentations variables en fonction des différentes représentations du produit. Par exemple, les murs d’une cabane peuvent être en bois, mais ceux d’un château seront en pierre.\n\nDans ce cas, vous pouvez créer plusieurs monteurs qui implémentent le même ensemble d’étapes de construction, mais d’une manière différente. Vous pouvez ensuite utiliser ces monteurs dans le processus de construction (c’est-à-dire une succession d’appels ordonnés des étapes) pour créer différents types d’objets.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/builder-comic-1-fr_d7817eed29244d6081d463e024f8d16.png\" class=\"jop-noMdConv\"\u003e\n\nCes monteurs exécutent la même tâche, mais de manière différente.\n\nPrenons un autre exemple : un premier monteur qui fabrique tout à partir de bois et de verre, un deuxième qui utilise de la pierre et du fer et un troisième qui se sert d’or et de diamants. En appelant les mêmes étapes, vous pouvez construire une maison avec le premier, un petit château avec le deuxième et un palais grâce au troisième. Mais tout ceci ne peut fonctionner que si le code client qui appelle les étapes de la construction peut interagir avec les monteurs via une interface commune.\n\n#### Directeur (Director)\n\nVous pouvez aller encore plus loin en prenant tous les appels aux étapes utilisées pour construire un produit, et en les mettant dans une classe séparée que l’on nomme *directeur*. La classe directeur va définir l’ordre d’exécution des différentes étapes et le monteur fournit les implémentations de ces étapes.\n\n\u003cimg width=\"343\" height=\"0\" src=\"../../_resources/builder-comic-2-fr_fe469a9751ad4dd58ac757b843c0f58.png\" class=\"jop-noMdConv\"\u003e\n\nLe directeur connait les étapes à suivre pour construire un produit fonctionnel.\n\nLa classe directeur n’est pas obligatoire. Vous pouvez toujours appeler les étapes de construction dans un ordre spécifique depuis le code client. Cependant, la classe directeur se révèle idéale pour y placer les routines de construction et pouvoir les réutiliser ensuite dans votre programme.\n\nDe plus, le directeur cache au client les détails de la construction du produit. Le client doit juste associer un monteur avec un directeur, lancer la construction via le directeur, puis récupérer le résultat auprès du monteur.\n\n## Structure\n\n\u003cimg width=\"460\" height=\"0\" src=\"../../_resources/structure_9a9475c8558c45eeaf8daf13b6eab4d3.png\" class=\"jop-noMdConv\"\u003e\n\n1.  L’interface du **Monteur** déclare les étapes communes de la construction du produit entre tous les monteurs.\n    \n2.  Les **Monteurs Concrets** fournissent différentes implémentations des étapes de la construction. Ils peuvent créer des produits qui ne reprennent pas l’interface commune.\n    \n3.  Les **Produits** sont les résultats retournés. Les produits construits par les différents monteurs ne sont pas obligés d’appartenir à la même hiérarchie de classes ni d’avoir la même interface.\n    \n4.  Le **Directeur** indique l’ordonnancement des étapes de construction et offre la possibilité de créer et de réutiliser des configurations spécifiques pour les produits.\n    \n5.  Le **Client** doit associer l’un des monteurs au directeur. En général cette association n’est réalisée qu’une seule fois, grâce aux paramètres du constructeur du directeur. Pour toute construction ultérieure, le directeur utilise l’objet monteur. En guise d’alternative, le client peut passer l’objet monteur à la méthode de production du directeur. Dans ce cas, vous pouvez utiliser un monteur différent chaque fois que vous lancez une production avec le directeur.\n    \n\n## Pseudo-code\n\nVoici un exemple qui montre comment un **Monteur** peut réutiliser le même code de construction d’objet pour assembler différents types de produits comme des voitures, et créer leurs manuels respectifs.\n\n\u003cimg width=\"500\" height=\"0\" src=\"../../_resources/example-fr_699f945931364654b111784029a1a2fc.png\" class=\"jop-noMdConv\"\u003e\n\nUn exemple de construction de voitures étape par étape et le manuel d’utilisation qui correspond à leur modèle.\n\nUne voiture est un objet complexe. Elle peut être fabriquée de cent manières différentes. Plutôt que d’encombrer la classe `Voiture` avec un énorme constructeur, nous avons extrait le code dans une classe monteur séparée pour la voiture. Cette classe est composée d’un ensemble de méthodes pour configurer les différentes parties d’une voiture.\n\nSi le code client veut assembler un modèle spécial de voiture bénéficiant d’un réglage de précision, il peut s’adresser directement au monteur. Il peut également déléguer l’assemblage à la classe directeur qui connait le processus de fabrication à indiquer au monteur pour les modèles de voitures les plus populaires.\n\nCe qui suit va peut-être vous choquer, mais chaque voiture doit posséder son propre manuel (franchement, qui les lit ?). Le manuel décrit toutes les fonctionnalités de la voiture et les détails vont varier selon les modèles. Il semble donc approprié de réutiliser un processus de construction existant pour les voitures et leurs manuels. Bien entendu, la création d’un manuel et d’une voiture sont deux procédés complètement différents et nous devons concevoir des monteurs spécialisés pour les manuels. Cette classe va implémenter les mêmes méthodes de construction que sa cousine assembleuse de voitures, mais au lieu de fabriquer des pièces de voitures, elle se contente de les décrire. Nous pouvons construire une voiture ou un manuel en passant ces monteurs au même objet directeur.\n\nL’étape finale consiste à récupérer l’objet qui en résulte. Même si une voiture en métal et un manuel en papier sont directement liés, ce sont deux choses complètement différentes. Nous ne pouvons pas insérer une méthode pour récupérer les résultats dans le directeur sans le coupler aux classes concrètes du produit. Par conséquent, c’est le monteur qui effectue le travail qui nous donne ensuite le résultat.\n\n```\n// L’utilisation du patron de conception monteur n’est\n// conseillée que si vos produits sont complexes et nécessitent\n// une configuration étendue. Bien qu’ils n’aient pas la même\n// interface, les deux produits suivants sont liés.\nclass Car is\n    // Une voiture est équipée d’un GPS, d’un ordinateur de bord\n    // et d'un certain nombre de sièges. Les différents modèles\n    // de voitures (sport, SUV, cabriolet) ont différentes\n    // fonctionnalités installées ou activées.\n\nclass Manual is\n    // Chaque voiture doit avoir un manuel d’utilisation qui\n    // correspond à sa configuration et décrit toutes ses\n    // fonctionnalités.\n\n// L’interface du monteur contient des méthodes spécialisées\n// pour créer les différentes parties des objets du produit.\ninterface Builder is\n    method reset()\n    method setSeats(...)\n    method setEngine(...)\n    method setTripComputer(...)\n    method setGPS(...)\n\n// Les classes concrètes du monteur suivent l’interface monteur\n// et procurent des implémentations spécifiques pour les étapes\n// de la fabrication. Votre programme peut contenir plusieurs\n// variantes de monteurs, chacune avec sa propre implémentation.\nclass CarBuilder implements Builder is\n    private field car:Car\n\n    // Une instance monteur fraichement créée doit contenir un\n    // objet produit vide qu’elle va ensuite assembler.\n    constructor CarBuilder() is\n        this.reset()\n\n    // La méthode reset nettoie l’objet qui est construit.\n    method reset() is\n        this.car = new Car()\n\n    // Toutes les étapes de la fabrication manipulent la même\n    // instance du produit.\n    method setSeats(...) is\n        // Configure le nombre de sièges dans la voiture.\n\n    method setEngine(...) is\n        // Installe un moteur donné.\n\n    method setTripComputer(...) is\n        // Installe un ordinateur de bord.\n\n    method setGPS(...) is\n        // Installe un système de géolocalisation.\n\n    // Les monteurs concrets sont censés fournir leurs propres\n    // méthodes pour récupérer les résultats. Ce fonctionnement\n    // permet aux différents types de monteurs de créer des\n    // produits entièrement différents qui ne suivent pas la\n    // même interface. Par conséquent, les méthodes ne peuvent\n    // pas être déclarées dans l’interface du monteur (en tout\n    // cas pas dans un langage de programmation doté d’un\n    // système de typage statique).\n    //\n    // En général, après avoir retourné le résultat final au\n    // client, une instance de monteur doit être prête à lancer\n    // la fabrication d’un autre produit. C’est pour cette\n    // raison que l’on appelle généralement la méthode reset à\n    // la fin du corps de la méthode `getProduct`. Mais ce\n    // comportement n’est pas obligatoire et votre monteur peut\n    // attendre que le code client lance un appel explicite à un\n    // reset pour vous débarrasser du résultat précédent.\n    method getProduct():Car is\n        product = this.car\n        this.reset()\n        return product\n\n// Contrairement aux autres patrons de création, le monteur vous\n// permet de fabriquer des produits qui ne suivent pas la même\n// interface.\nclass CarManualBuilder implements Builder is\n    private field manual:Manual\n\n    constructor CarManualBuilder() is\n        this.reset()\n\n    method reset() is\n        this.manual = new Manual()\n\n    method setSeats(...) is\n        // Fonctionnalités des sièges dans le manuel.\n\n    method setEngine(...) is\n        // Ajoute les informations concernant le moteur.\n\n    method setTripComputer(...) is\n        // Ajoute les instructions concernant l’ordinateur de\n        // bord.\n\n    method setGPS(...) is\n        // Ajoute les instructions concernant le GPS.\n\n    method getProduct():Manual is\n        // Retourne le manuel et remet à zéro le monteur\n        // (reset).\n\n// Le directeur a pour seule responsabilité l’ordonnancement des\n// étapes de la fabrication. Il se révèle utile lorsque vous\n// fabriquez des produits avec un ordre précis ou dans une\n// configuration particulière. À proprement parler, la classe\n// Directeur n’est pas obligatoire, car le client peut manipuler\n// les monteurs directement.\nclass Director is\n    private field builder:Builder\n\n    // Le directeur manipule n’importe quelle instance de\n    // monteur que le code client lui envoie. Ainsi, le code\n    // client peut modifier le type final du produit qui vient\n    // d’être assemblé.\n    method setBuilder(builder:Builder)\n        this.builder = builder\n\n    // Le directeur peut fabriquer plusieurs variantes de\n    // produits en utilisant les mêmes étapes de fabrication.\n    method constructSportsCar(builder: Builder) is\n        builder.reset()\n        builder.setSeats(2)\n        builder.setEngine(new SportEngine())\n        builder.setTripComputer(true)\n        builder.setGPS(true)\n\n    method constructSUV(builder: Builder) is\n        // ...\n\n// Le code client crée un objet monteur, le passe au directeur\n// et lance le processus de fabrication. Le résultat final est\n// récupéré dans l’objet monteur.\nclass Application is\n\n    method makeCar() is\n        director = new Director()\n\n        CarBuilder builder = new CarBuilder()\n        director.constructSportsCar(builder)\n        Car car = builder.getProduct()\n\n        CarManualBuilder builder = new CarManualBuilder()\n        director.constructSportsCar(builder)\n\n        // Le produit final est souvent récupéré depuis un objet\n        // monteur, car le directeur est indépendant des\n        // monteurs et des produits concrets et il ne les voit\n        // donc pas.\n        Manual manual = builder.getProduct()\n\n```\n\n## Possibilités d’application\n\nUtilisez le patron de conception monteur afin de vous débarrasser d’un « constructeur télescopique ».\n\nPrenons un constructeur avec dix paramètres facultatifs. Faire un appel à cette monstruosité n’est pas très pratique : vous surchargez le constructeur avec plusieurs petites versions, mais avec moins de paramètres. Ces constructeurs font toujours référence au constructeur principal en donnant des valeurs par défaut aux paramètres optionnels.\n\n```\nclass Pizza {\n    Pizza(int size) { ... }\n    Pizza(int size, boolean cheese) { ... }\n    Pizza(int size, boolean cheese, boolean pepperoni) { ... }\n    // ...\n\n```\n\nCette monstruosité ne peut être créée que dans certains langages qui permettent la surcharge tels que le C# ou le Java.\n\nLe monteur vous permet de créer des objets étape par étape, en utilisant uniquement celles qui sont nécessaires. Après avoir implémenté le patron, vous n’avez plus besoin d’entasser les paramètres dans vos constructeurs.\n\nUtilisez le monteur pour rendre votre code capable de créer différentes représentations de produits (par exemple des maisons en pierre et en bois).\n\nLe monteur est utile lorsque les étapes de la construction des différentes représentations du produit se ressemblent (seuls quelques détails diffèrent).\n\nL’interface de base du monteur définit toutes les étapes possibles de la construction. Les monteurs concrets implémentent les étapes pour construire les représentations particulières du produit. Le directeur quant à lui s’occupe de gérer l’ordonnancement des différentes étapes de construction.\n\nUtilisez le monteur afin de construire une arborescence [composite](https://refactoring.guru/fr/design-patterns/composite \"Composite\") ou d’autres objets complexes.\n\nLe monteur vous permet de construire des produits étape par étape. Vous pouvez déléguer l’exécution de certaines étapes sans endommager le produit final. Vous pouvez même appeler les étapes de manière récursive, ce qui est très pratique dans le cas de la construction d’un objet composite.\n\nLe monteur ne met pas à disposition le produit tant que les étapes de la construction ne sont pas terminées. Par conséquent, le code client ne récupèrera jamais un résultat incomplet.\n\n## Mise en œuvre\n\n1.  Assurez-vous de définir clairement les étapes communes de la construction pour toutes les représentations de produits disponibles, sinon vous ne pourrez pas mettre en place le patron.\n    \n2.  Déclarez ces étapes dans l’interface du monteur.\n    \n3.  Pour chaque représentation du produit, créez une classe concrète monteur puis implémentez ses étapes de construction.\n    \n    N’oubliez pas de mettre en place une méthode pour récupérer le résultat de la construction. Cette méthode ne peut pas être déclarée dans l’interface du monteur, car les différents monteurs peuvent fabriquer des produits qui n’ont pas forcément une interface commune. Nous ne pouvons pas connaitre à l’avance le type de retour d’une telle méthode. En revanche, si vos produits appartiennent à une hiérarchie unique, la méthode qui récupère le résultat peut être ajoutée à l’interface de base sans problème.\n    \n4.  Réfléchissez à la création d’une classe directeur. Elle peut encapsuler différents processus de construction d’un produit en utilisant le même objet monteur.\n    \n5.  Le code client crée les objets monteur et directeur. Le client doit passer un objet monteur au directeur avant le début de la construction. En général, il ne le fait qu’une seule fois, via les paramètres du constructeur du directeur. Le directeur utilise l’objet monteur pour toute construction ultérieure. Nous pourrions également passer le monteur directement à la méthode de construction du directeur.\n    \n6.  Le résultat de la construction peut être obtenu directement à partir du directeur, si tous les produits sont branchés sur la même interface. Sinon, le client doit aller directement chercher le résultat auprès du monteur.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez construire les objets étape par étape et les déléguer ou les exécuter récursivement.\n    \n- Vous pouvez réutiliser le même code de construction lorsque vous construisez différentes représentations des produits.\n    \n- *Principe de responsabilité unique*. Vous pouvez découpler le code complexe de la construction et la logique métier du produit.\n    \n- Le monteur nécessite de créer beaucoup nouvelles classes, ce qui accroit la complexité générale du code.\n    \n\n## Liens avec les autres patrons\n\n- La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est souvent utilisée dès le début de la conception (moins compliquée et plus personnalisée grâce aux sous-classes) et évolue vers la [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory), le [Prototype](https://refactoring.guru/fr/design-patterns/prototype), ou le [Monteur](https://refactoring.guru/fr/design-patterns/builder) (ce dernier étant plus flexible, mais plus compliqué).\n    \n- Le [Monteur](https://refactoring.guru/fr/design-patterns/builder) se concentre sur la construction d’objets complexes étape par étape. La [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) se spécialise dans la création de familles d’objets associés. La *fabrique abstraite* retourne le produit immédiatement, alors que le *monteur* vous permet de lancer des étapes supplémentaires avant de récupérer le produit.\n    \n- Vous pouvez utiliser le [Monteur](https://refactoring.guru/fr/design-patterns/builder) lorsque vous créez des arbres [Composites](https://refactoring.guru/fr/design-patterns/composite) complexes, car vous pouvez programmer les étapes de la construction récursivement.\n    \n- Vous pouvez combiner le [Monteur](https://refactoring.guru/fr/design-patterns/builder) avec le [Pont](https://refactoring.guru/fr/design-patterns/bridge) : la classe directeur joue le rôle de l’abstraction, et les différents *monteurs* prennent le rôle des implémentations.\n    \n- Les [Fabriques abstraites](https://refactoring.guru/fr/design-patterns/abstract-factory), [Monteurs](https://refactoring.guru/fr/design-patterns/builder) et [Prototypes](https://refactoring.guru/fr/design-patterns/prototype) peuvent tous être implémentés comme des [Singletons](https://refactoring.guru/fr/design-patterns/singleton).\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_0f47e41057bb416f98ac991ccca739a3.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/java/example \"Patrons de conception : Monteur en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_3ffe9aca15794347b14c5182c8823c9c.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/csharp/example \"Patrons de conception : Monteur en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_2f7c9eea44b146d494964d53541ef647.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/cpp/example \"Patrons de conception : Monteur en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_0a993845178545afacd302d7d4c2e1cd.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/php/example \"Patrons de conception : Monteur en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_950ae2abcde84b73b9285e3a8ba901b0.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/python/example \"Patrons de conception : Monteur en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_500743e86143432880da5a96c180da2b.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/ruby/example \"Patrons de conception : Monteur en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_435bdd3372354fa6aa84d2ec3dfbeb7a.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/swift/example \"Patrons de conception : Monteur en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_d734ace797204596b8111300818f6ef4.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/typescript/example \"Patrons de conception : Monteur en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_56d708ad4eac48aaa2cc604add11e5dc.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/builder/go/example \"Patrons de conception : Monteur en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_327d266b6c234d24a7ced48c2a5.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Prototype](https://refactoring.guru/fr/design-patterns/prototype)\n\n#### Retour\n\n[Comparaison des fabriques](https://refactoring.guru/fr/design-patterns/factory-comparison)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_b73e9ceda0934a518f4e61197c52c87a.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/builder \"English\") [Español](https://refactoring.guru/es/design-patterns/builder \"Español\") [Français](https://refactoring.guru/fr/design-patterns/builder \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/builder \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/builder \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/builder \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/builder \"Українська\") [中文](https://refactoringguru.cn/design-patterns/builder \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_284aa320ea0e42a89c326a0cd6478238.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_2d47179d59484ad29bc8a628bee27e7a.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n        - [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method)\n        - [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory)\n        - [Monteur](https://refactoring.guru/fr/design-patterns/builder)\n        - [Prototype](https://refactoring.guru/fr/design-patterns/prototype)\n        - [Singleton](https://refactoring.guru/fr/design-patterns/singleton)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n![Organization address](../../_resources/fa-building_ecc8c93279f142c49407d91ef3e63e50.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Creation/Prototype":{"title":"Prototype","content":"\n**Prototype** crée de nouveaux objets à partir d’objets existants sans rendre le code dépendant de leur classe.\n\n![Patron de conception prototype](../../_resources/prototype_6f91352eb56041039dfcda0dddb25f97.png)\n\n## Problème\n\nNous voulons une copie exacte d’un objet. Comment vous y prendriez-vous ? Tout d’abord, vous devez créer un nouvel objet de cette même classe. Ensuite, vous devez parcourir tous les attributs de l’objet d’origine et copier leurs valeurs dans le nouvel objet.\n\nSuper ! Mais il y a un hic. Certains objets ne peuvent pas être copiés ainsi, car leurs attributs peuvent être privés et ne pas être visibles en dehors de l’objet.\n\n![Ce qui peut mal tourner lorsque l’on construit un objet « depuis l’extérieur »](../../_resources/prototype-comic-1-fr_8dbe0f974a95480197f30256be021.png)\n\nCopier un objet « depuis l’extérieur » [n’est pas](https://refactoring.guru/cargo-cult) toujours possible.\n\nUn autre problème se profile avec l’approche directe. Étant donné que vous devez connaître la classe de l’objet pour le dupliquer, votre code devient dépendant de cette classe. Même si cette dépendance ne vous effraie pas, il y a un autre hic. Parfois, vous ne connaissez que l’interface implémentée par l’objet, mais pas sa classe concrète. Si le paramètre d’une méthode accepte tous les objets qui implémentent une interface donnée, vous pouvez rencontrer des problèmes.\n\n## Solution\n\nLe patron de conception prototype délègue le processus de clonage aux objets qui vont être copiés. Il déclare une interface commune pour tous les objets qui pourront être clonés. Cette interface vous permet de cloner un objet sans coupler votre code à la classe de cet objet. En général, une telle interface ne contient qu’une seule méthode `clone`.\n\nL’implémentation de cette méthode se ressemble dans toutes les classes. Elle crée un objet de la classe actuelle et reporte les valeurs des attributs de l’objet d’origine dans le nouveau. Vous pouvez également copier des attributs privés, car la plupart des langages de programmation autorisent l’accès à des objets d’une même classe.\n\nUn objet qui peut être cloné est appelé un *prototype*. Lorsque vos objets possèdent des dizaines d’attributs et des centaines de configurations possibles, le clonage est une alternative au sous-classage.\n\n\u003cimg width=\"343\" height=\"0\" src=\"../../_resources/prototype-comic-2-fr_26f400eae0ec4ddcbe1bf6f963983.png\" class=\"jop-noMdConv\"\u003e\n\nLes prototypes préconstruits sont une alternative au sous-classage.\n\nLeur fonctionnement est le suivant : vous créez un ensemble d’objets configurés différemment. Dès que vous avez besoin de l’un de ces objets, vous clonez un prototype plutôt que d’en construire un nouveau.\n\n## Analogie\n\nDans la vie réelle, des prototypes sont utilisés pour exécuter des tests avant de lancer les chaînes de production d’un produit. Dans ce cas toutefois, les prototypes ne font pas partie intégrante de la fabrication, ils ne jouent qu’un rôle passif.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/prototype-comic-3-fr_f4912030fde8454caa063fd0f3625.png\" class=\"jop-noMdConv\"\u003e\n\nLa division cellulaire.\n\nPuisque les prototypes industriels ne se clonent pas eux-mêmes, étudions le processus de la mitose d’une cellule (petit rappel de vos cours de biologie). Une fois la division mitotique terminée, une paire de cellules identiques est créée. La cellule originale sert de prototype et joue un rôle actif dans la création de la copie.\n\n## Structure\n\n#### Implémentation de base\n\n\u003cimg width=\"500\" height=\"0\" src=\"../../_resources/structure_485673edbf7f471a840dbf222bb1dc19.png\" class=\"jop-noMdConv\"\u003e\n\n1.  L’interface **Prototype** déclare les méthodes de clonage. Dans la majorité des cas, il n’y a qu’une seule méthode `clone`.\n    \n2.  La classe **Prototype Concret** implémente la méthode de clonage. En plus de copier les données de l’objet original dans le clone, cette méthode peut gérer des cas particuliers du processus de clonage, comme des objets imbriqués, démêler les dépendances récursives, etc.\n    \n3.  Le **Client** peut produire une copie de n’importe quel objet implémentant l’interface prototype.\n    \n\n#### Implémentation du registre de prototypes\n\n\u003cimg width=\"550\" height=\"0\" src=\"../../_resources/structure-prototype-cache_43603c8c5b524486bd04847b.png\" class=\"jop-noMdConv\"\u003e\n\n1.  Le **Registre de Prototypes** facilite l’accès aux prototypes fréquemment utilisés. Il stocke un ensemble d’objets préconstruits qui ont déjà été copiés. Le registre de prototypes le plus simple est une table de hachage (hash map) `nom → prototype`. Si vous voulez de meilleurs critères de recherche qu’un simple nom, construisez une version plus robuste du registre.\n\n## Pseudo-code\n\nDans cet exemple, le **Prototype** produit des copies exactes d’objets géométriques, sans coupler le code à leurs classes.\n\n\u003cimg width=\"470\" height=\"0\" src=\"../../_resources/example_69c0d1e1531f4466b2db3f71c2e209f8.png\" class=\"jop-noMdConv\"\u003e\n\nCloner un ensemble d’objets qui appartiennent à une hiérarchie de classes.\n\nToutes les formes implémentent la même interface, et cette dernière fournit une méthode de clonage. Une sous-classe peut appeler la méthode de clonage de son parent avant de copier les valeurs de ses propres attributs dans l’objet.\n\n```\n// Prototype de base.\nabstract class Shape is\n    field X: int\n    field Y: int\n    field color: string\n\n    // Un constructeur normal.\n    constructor Shape() is\n        // ...\n\n    // Le constructeur du prototype. Un nouvel objet est\n    // initialisé avec les valeurs de l’objet existant.\n    constructor Shape(source: Shape) is\n        this()\n        this.X = source.X\n        this.Y = source.Y\n        this.color = source.color\n\n    // Le traitement de clonage retourne l’une des sous-classes\n    // Forme (Shape)\n    abstract method clone():Shape\n\n// Prototype concret. La méthode de clonage crée un nouvel objet\n// et le passe au constructeur. Il garde une référence à un\n// nouveau clone tant que le constructeur n’a pas terminé. Il\n// est donc impossible de se retrouver avec un clone incomplet\n// et les résultats du clonage sont toujours fiables.\nclass Rectangle extends Shape is\n    field width: int\n    field height: int\n\n    constructor Rectangle(source: Rectangle) is\n        // Un appel au constructeur parent est requis pour\n        // copier les attributs privés définis dans la classe\n        // mère.\n        super(source)\n        this.width = source.width\n        this.height = source.height\n\n    method clone():Shape is\n        return new Rectangle(this)\n\nclass Circle extends Shape is\n    field radius: int\n\n    constructor Circle(source: Circle) is\n        super(source)\n        this.radius = source.radius\n\n    method clone():Shape is\n        return new Circle(this)\n\n// Quelque part dans le code client.\nclass Application is\n    field shapes: array of Shape\n\n    constructor Application() is\n        Circle circle = new Circle()\n        circle.X = 10\n        circle.Y = 10\n        circle.radius = 20\n        shapes.add(circle)\n\n        Circle anotherCircle = circle.clone()\n        shapes.add(anotherCircle)\n        // La variable `autreCercle` contient la copie exacte de\n        // l’objet `Cercle`.\n\n        Rectangle rectangle = new Rectangle()\n        rectangle.width = 10\n        rectangle.height = 20\n        shapes.add(rectangle)\n\n    method businessLogic() is\n        // Le prototype est très pratique, car il vous permet de\n        // créer une copie d’un objet en ignorant tout de son\n        // type.\n        Array shapesCopy = new Array of Shapes.\n\n        // Par exemple, nous ne savons pas exactement quels\n        // éléments figurent dans le tableau des formes. Nous\n        // savons juste que ce sont tous des formes. Grâce au\n        // polymorphisme, lorsque nous appelons la méthode\n        // `clone` sur une forme, le programme vérifie sa classe\n        // et lance la méthode clone appropriée de cette classe.\n        // C’est pour cela que nous fabriquons des clones,\n        // plutôt qu’un ensemble d’objets forme.\n        foreach (s in shapes) do\n            shapesCopy.add(s.clone())\n\n        // Le tableau `CopiesFormes` (shapesCopy) contient les\n        // copies exactes du tableau des `formes`.\n\n```\n\n## Possibilités d’application\n\nUtilisez le prototype si vous ne voulez pas que votre code dépende des classes concrètes des objets que vous clonez.\n\nVous rencontrerez ce cas si votre code manipule des objets obtenus via l’interface d’une application externe. Il arrive que votre code ne puisse pas se baser sur les classes concrètes de ces objets car elles sont inconnues.\n\nLe prototype procure une interface générale au code client et lui permet de travailler avec tous les objets clonables. Cette interface rend le code client indépendant des classes concrètes des objets qu’il clone.\n\nUtilisez ce patron si vous voulez réduire le nombre de sous-classes quand elles ne diffèrent que dans leur manière d’initialiser leurs objets respectifs. Ces sous-classes pourraient avoir été prévues pour créer des objets similaires dans des configurations spécifiques.\n\nLe patron de conception prototype vous permet d’utiliser un ensemble d’objets préconstruits (des prototypes) de différentes manières.\n\nPlutôt que d’instancier une sous-classe qui correspond à une configuration précise, le client peut se contenter de chercher le prototype approprié et de le cloner.\n\n## Mise en œuvre\n\n1.  Créez l’interface du prototype et déclarez-y la méthode `clone`, mais si vous avez une hiérarchie de classes existante, ajoutez juste la méthode à toutes ses classes.\n    \n2.  Une classe prototype doit définir un autre constructeur capable de prendre un objet de cette classe comme paramètre. Le constructeur doit copier les valeurs des attributs définis dans la classe de l’objet dans l’instance qui vient d’être créée. Si une sous-classe est concernée, vous devez appeler le constructeur du parent pour gérer le clonage de ses attributs privés.\n    \n    Si le langage de programmation que vous utilisez ne gère pas la surcharge, vous pouvez définir une méthode spéciale pour copier les données de l’objet. Faire tout ceci à l’intérieur du constructeur est plus pratique, car il retourne le résultat directement après avoir appelé l’opérateur `new`.\n    \n3.  La méthode de clonage ne contient qu’une seule ligne de code : un opérateur `new` avec la version prototype du constructeur. Notez bien que chaque classe doit redéfinir la méthode de clonage et utiliser le nom de sa propre classe avec l’opérateur `new`. Si vous ne le faites pas, la méthode de clonage sera capable de produire des objets de la classe mère.\n    \n4.  Vous pouvez également créer un registre centralisé des prototypes pour garder un catalogue de prototypes fréquemment utilisés.\n    \n    Ce registre peut être implémenté avec une classe fabrique, ou mis dans une classe prototype de base avec une méthode statique qui récupère le prototype. Cette méthode ira chercher un prototype en fonction du critère de recherche que le code client passe à la méthode. Ce critère peut être une chaîne de caractères ou un ensemble de paramètres de recherche. Dès que le prototype recherché est trouvé, le registre crée un clone et le retourne au client.\n    \n    Pour finir, remplacez tous les appels directs aux constructeurs des sous-classes par des appels à la méthode fabrique du registre de prototypes.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez cloner les objets sans les coupler avec leurs classes concrètes.\n    \n- Vous clonez des prototypes préconstruits et vous pouvez vous débarrasser du code d’initialisation redondant.\n    \n- Vous pouvez créer des objets complexes plus facilement.\n    \n- Vous obtenez une alternative à l’héritage pour gérer les modèles de configuration d’objets complexes.\n    \n- Cloner des objets complexes dotés de références circulaires peut se révéler très difficile.\n    \n\n## Liens avec les autres patrons\n\n- La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est souvent utilisée dès le début de la conception (moins compliquée et plus personnalisée grâce aux sous-classes) et évolue vers la [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory), le [Prototype](https://refactoring.guru/fr/design-patterns/prototype), ou le [Monteur](https://refactoring.guru/fr/design-patterns/builder) (ce dernier étant plus flexible, mais plus compliqué).\n    \n- Les classes [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) sont souvent basées sur un ensemble de [Fabriques](https://refactoring.guru/fr/design-patterns/factory-method), mais vous pouvez également utiliser le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) pour écrire leurs méthodes.\n    \n- Le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) se révèle utile lorsque vous voulez sauvegarder des copies de [Commandes](https://refactoring.guru/fr/design-patterns/command) dans l’historique.\n    \n- Les conceptions qui reposent énormément sur le [Composite](https://refactoring.guru/fr/design-patterns/composite) et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) tirent des avantages à utiliser le [Prototype](https://refactoring.guru/fr/design-patterns/prototype). Il vous permet de cloner les structures complexes plutôt que de les reconstruire à partir de rien.\n    \n- Le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) n’est pas basé sur l’héritage, il n’a donc pas ses désavantages. Mais le *prototype* requiert une initialisation compliquée pour l’objet cloné. La [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method) est basée sur l’héritage, mais n’a pas besoin d’une étape d’initialisation.\n    \n- Parfois le [Prototype](https://refactoring.guru/fr/design-patterns/prototype) peut venir remplacer le [Mémento](https://refactoring.guru/fr/design-patterns/memento) et proposer une solution plus simple. Cela n’est possible que si l’objet (l’état que vous voulez stocker dans l’historique) est assez direct et ne possède pas de liens vers des ressources externes, ou que les liens sont faciles à recréer.\n    \n- Les [Fabriques abstraites](https://refactoring.guru/fr/design-patterns/abstract-factory), [Monteurs](https://refactoring.guru/fr/design-patterns/builder) et [Prototypes](https://refactoring.guru/fr/design-patterns/prototype) peuvent tous être implémentés comme des [Singletons](https://refactoring.guru/fr/design-patterns/singleton).\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_c2b09c2022114d5892b15708c638c083.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/java/example \"Patrons de conception : Prototype en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_ec7ad2cb9f464827b5d909be3769f4c3.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/csharp/example \"Patrons de conception : Prototype en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_1e2c5ca244414ad89f2a6132c93d3f67.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/cpp/example \"Patrons de conception : Prototype en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_c1fe797d36c546b49f1a3aa96f5d29e6.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/php/example \"Patrons de conception : Prototype en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_7bf6c5526c5e465dae6477efd55ec5c0.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/python/example \"Patrons de conception : Prototype en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_bd61ac41674241b59960f6ebf06d0b64.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/ruby/example \"Patrons de conception : Prototype en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_bd68a943b14244a9ae4dcc718b0d817d.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/swift/example \"Patrons de conception : Prototype en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_36277facebfd4ff0b4b37f53b0b712a9.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/typescript/example \"Patrons de conception : Prototype en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_1f3ef7216c0242d5bfb13d223e4d73ca.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/prototype/go/example \"Patrons de conception : Prototype en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_9b6d79ff01ae47a9b0c94ef4a3c.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Singleton](https://refactoring.guru/fr/design-patterns/singleton)\n\n#### Retour\n\n[Monteur](https://refactoring.guru/fr/design-patterns/builder)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_d757fd6f86f249eaa256070c13526574.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/prototype \"English\") [Español](https://refactoring.guru/es/design-patterns/prototype \"Español\") [Français](https://refactoring.guru/fr/design-patterns/prototype \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/prototype \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/prototype \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/prototype \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/prototype \"Українська\") [中文](https://refactoringguru.cn/design-patterns/prototype \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_2ca4640891ab460392c35b3a5cdd6326.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_d7ab682aec5545b5af3b31577a4ca2e0.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n        - [Fabrique](https://refactoring.guru/fr/design-patterns/factory-method)\n        - [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory)\n        - [Monteur](https://refactoring.guru/fr/design-patterns/builder)\n        - [Prototype](https://refactoring.guru/fr/design-patterns/prototype)\n        - [Singleton](https://refactoring.guru/fr/design-patterns/singleton)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n![Organization address](../../_resources/fa-building_a61ea197b4a94a1e88cda3c8db312289.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Creation/Singleton":{"title":"Singleton","content":"\n**Singleton** qui garantit que l’instance d’une classe n’existe qu’en un seul exemplaire, tout en fournissant un point d’accès global à cette instance.\n\n![Patron de conception singleton](../../_resources/singleton_ba9b2561ee0d490aaadcb7303de061bb.png)\n\n## Problème\n\nLe singleton règle deux problèmes à la fois, mais ne respecte pas le *principe de responsabilité unique*.\n\n1.  **Il garantit l’unicité d’une instance pour une classe**. Pour quelle raison voudrait-on maîtriser le nombre d’instances d’une classe ? En général, cette situation se présente lorsque l’on veut contrôler l’accès à une ressource partagée — une base de données ou un fichier par exemple.\n    \n    Son fonctionnement est le suivant : vous créez un objet, mais après un certain temps, vous décidez d’en créer un autre. Plutôt que de vous retrouver avec un objet flambant neuf, vous récupérez celui qui existe déjà.\n    \n    Vous noterez qu’il est impossible d’implémenter ce comportement avec un constructeur normal, puisqu’un constructeur **doit** théoriquement toujours retourner un nouvel objet.\n    \n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/singleton-comic-1-fr_d60c6bbe8d704b20939216b206393.png\" class=\"jop-noMdConv\"\u003e\n\nLes clients ne se rendent pas forcément compte qu’ils travaillent toujours avec le même objet.\n\n2.  **Il fournit un point d’accès global à cette instance**. Vous rappelez-vous ces variables globales que vous (bon, d’accord : moi) avez utilisées pour stocker des objets essentiels ? Elles sont très pratiques mais peu fiables, puisque n’importe quelle partie du code peut potentiellement écraser leur contenu et faire planter l’application.\n    \n    Le singleton vous permet d’accéder à l’objet n’importe où dans le programme, telle une variable globale. Cependant, il protège son instance et l’empêche d’être modifiée.\n    \n    Un autre aspect majeur vient se glisser dans l’équation : le code qui résout le problème numéro 1 ne doit pas se retrouver éparpillé dans tout le programme. En effet, on préfèrera tout mettre dans une même classe, surtout si le reste du code repose dessus.\n    \n\nAujourd’hui, le singleton est devenu très populaire et le terme *singleton* est même parfois employé pour une entité ne résolvant qu’un seul des problèmes listés.\n\n## Solution\n\nToute mise en place d’un singleton est constituée des deux étapes suivantes :\n\n- Rendre le constructeur par défaut privé afin d’empêcher les autres objets d’utiliser l’opérateur `new` avec la classe du singleton.\n- Mettre en place une méthode de création statique qui se comporte comme un constructeur. En sous-main, cette méthode appelle le constructeur privé pour créer un objet et le sauvegarde dans un attribut statique. Tous les appels ultérieurs à cette méthode retournent l’objet en cache.\n\nSi votre code a accès à la classe du singleton, alors il peut appeler sa méthode statique. À chaque appel de cette méthode, c’est toujours le même objet qui est retourné.\n\n## Analogie\n\nPrenons le gouvernement, qui est un excellent exemple de singleton. Un pays ne peut avoir qu’un seul gouvernement officiel. Quels que soient les individus qui composent un gouvernement, l’appellation « Le gouvernement de X » est un point global d’accès qui identifie le groupe de personnes au pouvoir.\n\n## Structure\n\n\u003cimg width=\"430\" height=\"0\" src=\"../../_resources/structure-fr_0077d431ddc14bb68670192688424664.png\" class=\"jop-noMdConv\"\u003e\n\n1.  La classe **Singleton** déclare la méthode statique `getInstance` qui retourne la même instance de sa propre classe.\n    \n    Le code client ne doit pas avoir de visibilité sur le constructeur du singleton. Seule la méthode `getInstance` doit permettre l’accès à l’objet du singleton.\n    \n\n# Pseudo-code\n\nDans cet exemple, la classe de la connexion à la base de données est le **Singleton**. Cette classe n’a pas de constructeur public, vous ne pouvez y accéder que grâce à la méthode `getInstance`. Cette méthode met en cache le premier objet créé puis retourne ce même objet lors des appels ultérieurs.\n\n```\n// La classe baseDeDonnées définit la méthode `getInstance` qui\n// permet aux clients d’accéder à la même instance de la\n// connexion à la base de données dans tout le programme.\nclass Database is\n    // L’attribut qui stocke l’instance du singleton doit être\n    // ‘static’.\n    private static field instance: Database\n\n    // Le constructeur du singleton doit toujours être privé\n    // afin d’empêcher les appels à l’opérateur `new`.\n    private constructor Database() is\n        // Code d’initialisation (la connexion au serveur de la\n        // base de données par exemple).\n        // ...\n\n    // La méthode statique qui contrôle l’accès à l’instance du\n    // singleton.\n    public static method getInstance() is\n        if (Database.instance == null) then\n            acquireThreadLock() and then\n                // Ce thread attend la levée du verrou (lock) le\n                // temps de s’assurer que l’instance n’a pas\n                // déjà été initialisée dans un autre thread.\n                if (Database.instance == null) then\n                    Database.instance = new Database()\n        return Database.instance\n\n    // Pour finir, tout singleton doit définir de la logique\n    // métier qui peut être exécutée dans sa propre instance.\n    public method query(sql) is\n        // Par exemple, toutes les requêtes sur la base de\n        // données d’une application passent par cette méthode.\n        // Par conséquent, vous pouvez définir le code des\n        // limitations ou de la mise en cache ici.\n        // ...\n\nclass Application is\n    method main() is\n        Database foo = Database.getInstance()\n        foo.query(\"SELECT  ...\")\n        // ...\n        Database bar = Database.getInstance()\n        bar.query(\"SELECT  ...\")\n        // La variable `bar` contiendra le même objet que la\n        // variable `foo`.\n\n```\n\n# Possibilités d’application\n\nUtilisez le singleton lorsque l’une de vos classes ne doit fournir qu’une seule instance à tous ses clients. Par exemple, une base de données partagée entre toutes les parties d’un programme.\n\nLa méthode spéciale de création devient le seul moyen de fabriquer des objets pour la classe, car le singleton désactive les autres. Cette méthode crée un objet ou retourne l’objet existant s’il a déjà été créé.\n\nUtilisez le singleton lorsque vous voulez un contrôle absolu sur vos variables globales.\n\nContrairement aux variables globales, le singleton garantit l’unicité de l’instance de la classe. Seule la classe singleton peut remplacer l’instance mise en cache.\n\nVous pouvez moduler le nombre d’instances du singleton comme vous le voulez. Vous devez juste apporter une modification dans le corps de la méthode `getInstance`.\n\n## Mise en œuvre\n\n1.  Ajoutez un attribut statique à la classe pour stocker l’instance du singleton.\n    \n2.  Déclarez une méthode de création publique et statique pour récupérer l’instance du singleton.\n    \n3.  Implémentez une « instanciation paresseuse » (lazy initialization) à l’intérieur de la méthode statique. Elle devrait créer un nouvel objet lors du premier appel et le stocker dans l’attribut statique. La méthode doit retourner cette instance lors de tous les appels suivants.\n    \n4.  Rendez privé le constructeur de la classe. La méthode statique de la classe doit être la seule à pouvoir appeler le constructeur.\n    \n5.  Parcourez le code client et remplacez les appels directs au constructeur du singleton par des appels à la méthode statique.\n    \n\n## Avantages et inconvénients\n\n- Vous garantissez l’unicité de l’instance de la classe.\n    \n- Vous obtenez un point d’accès global à cette instance.\n    \n- l’objet du singleton est uniquement initialisé la première fois qu’il est appelé.\n    \n- Ne respecte pas le *principe de responsabilité unique*. Ce patron résout deux problèmes à la fois.\n    \n- Le singleton peut masquer une mauvaise conception ; il se peut, par exemple, que les composants aient trop de visibilité les uns envers les autres.\n    \n- Il doit bénéficier d’un traitement spécial pour fonctionner dans un environnement multithread afin que le singleton ne se retrouve pas en plusieurs exemplaires.\n    \n- Les tests unitaires du code client peuvent se révéler difficiles, car de nombreux frameworks reposent sur l’héritage lorsqu’ils créent des objets fictifs. Étant donné que le constructeur de la classe du singleton est privé et que redéfinir la méthode statique est impossible dans la majorité des langages, vous allez devoir être créatif pour reproduire un singleton fictif. Ou ne pas faire de tests. Ou ne pas utiliser de singleton.\n    \n\n## Liens avec les autres patrons\n\n- Une classe [Façade](https://refactoring.guru/fr/design-patterns/facade) peut souvent être transformée en [Singleton](https://refactoring.guru/fr/design-patterns/singleton), car un seul objet façade est en général suffisant.\n    \n- Le [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight) ressemble au [Singleton](https://refactoring.guru/fr/design-patterns/singleton) si vous parvenez à compiler tous les états partagés des objets en un seul objet poids mouche. Mais ces patrons de conception ont deux différences fondamentales :\n    \n    1.  Il ne devrait y avoir qu’une seule instance de singleton, mais une classe *poids mouche* peut avoir plusieurs instances avec différents états intrinsèques.\n    2.  L’objet *singleton* peut être modifiable alors que les objets poids mouche ne sont pas modifiables.\n- Les [Fabriques abstraites](https://refactoring.guru/fr/design-patterns/abstract-factory), [Monteurs](https://refactoring.guru/fr/design-patterns/builder) et [Prototypes](https://refactoring.guru/fr/design-patterns/prototype) peuvent tous être implémentés comme des [Singletons](https://refactoring.guru/fr/design-patterns/singleton).","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Creation/Sommaire":{"title":"","content":"| notebook | image | excerpt |\n\n| --- | --- | --- |\n\n|🎭Création|![](../_resources/factory-method-fr_9c56a2cdc750461b87b42d9376b693b6.png)|[Fabrique](Architecture/Design_Pattern/Creation/Fabrique.md) définit une interface pour créer des objets dans une classe mère, mais délègue le choix des types d’objets à créer aux sous-classes. Problème Imaginez que vous êtes en train de créer une appl...|\n\n|🎭Création|![](../_resources/abstract-factory-fr_d627b05adce64634b9de210dc74587.png)|[Fabrique Abstraite](Architecture/Design_Pattern/Creation/Fabrique_abstraite.md) permet de créer des familles d’objets apparentés sans préciser leur classe concrète. Problème Imaginons la création d’un simulateur pour un magasin de meubles. Votre code contient l...|\n\n|🎭Création|![](../_resources/singleton_ba9b2561ee0d490aaadcb7303de061bb.png)|[Singleton](Architecture/Design_Pattern/Creation/Singleton.md) qui garantit que l’instance d’une classe n’existe qu’en un seul exemplaire, tout en fournissant un point d’accès global à cette instance. Problème Le singleton règle deux problèmes à la fois...|\n\n|🎭Création|![](../_resources/prototype_6f91352eb56041039dfcda0dddb25f97.png)|[Prototype](Architecture/Design_Pattern/Creation/Prototype.md) crée de nouveaux objets à partir d’objets existants sans rendre le code dépendant de leur classe. Problème Nous voulons une copie exacte d’un objet. Comment vous y prendriez-vous ? Tout d’ab...|\n\n|🎭Création|![](../_resources/builder-fr_10d1ceb31d404af3ae224e04d7fda26d.png)|[Monteur](Architecture/Design_Pattern/Creation/Monteur.md) permet de construire des objets complexes étape par étape. Il permet de produire différentes variations ou représentations d’un objet en utilisant le même code de construction. Problème Imagin...|\n","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Sommaire":{"title":"","content":"# [Modèles de création](Architecture/Design_Pattern/Creation/Sommaire.md)\nCes modèles fournissent divers mécanismes de création d'objets, qui augmentent la flexibilité et la réutilisation du code existant.\n\n# [Modèles structurels](Architecture/Design_Pattern/Structurel/Sommaire.md)\nCes modèles expliquent comment assembler des objets et des classes dans des structures plus grandes tout en gardant ces structures flexibles et efficaces.\n\n# [Modèles comportementaux](Architecture/Design_Pattern/Behavioral/Sommaire.md)\nCes modèles concernent les algorithmes et l'attribution des responsabilités entre les objets.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Structurel/Composite":{"title":"Composite / Composite","content":"\n**Composite** permet d’agencer les objets dans des arborescences afin de pouvoir traiter celles-ci comme des objets individuels.\n\n![Patron de conception composite](../../_resources/composite_9d0fd2b82f3248b2a4bbbe88c8faff48.png)\n\n## Problème\n\nL’utilisation de ce patron doit être réservée aux applications dont la structure principale peut être représentée sous la forme d’une arborescence.\n\nPrenons les deux objets suivants : `Produits` et `Boîtes`. Une boîte peut contenir plusieurs produits ainsi qu’un certain nombre de boîtes plus petites. Ces petites boîtes peuvent également contenir quelques produits ou même d’autres boîtes encore plus petites, et ainsi de suite.\n\nVous décidez de mettre au point un système de commandes qui utilise ces classes. Les commandes peuvent être composées de produits simples sans emballage, d’autres boîtes remplies de produits… et d’autres boîtes. Comment allez-vous déterminer le coût total d’une telle commande ?\n\n\u003cimg width=\"370\" height=\"0\" src=\"../../_resources/problem-fr_580f92b2debd4408874c5dbd7277f3c2.png\" class=\"jop-noMdConv\"\u003e\n\nUne commande peut contenir divers produits empaquetés à l’intérieur de boîtes, elles-mêmes rangées dans de plus grosses boîtes, etc. La structure complète ressemble à un arbre inversé.\n\nVous pouvez tenter l’approche directe qui consiste à déballer toutes les boîtes, prendre chaque produit et en faire la somme pour obtenir le total. Ce mode de calcul peut facilement se mettre en place dans le monde réel mais dans un programme, ce n’est pas aussi simple que de créer une boucle. Il faut connaître à l’avance la classe des `Produits` et des `Boîtes` que l’on parcourt, le niveau d’imbrication des boîtes ainsi que d’autres détails. Tout ceci rend l’approche directe assez compliquée et même parfois impossible.\n\n## Solution\n\nLe patron de conception composite vous propose de manipuler les `Produits` et les `Boîtes` à l’aide d’une interface qui déclare une méthode de calcul du prix total.\n\nComment cette méthode peut-elle fonctionner ? Pour un produit, on retourne simplement son prix. Pour une boîte, on parcourt chacun de ses objets, on leur demande leur prix, puis on retourne un total pour la boîte. Si l’un de ces objets est une boîte plus petite, cette dernière va aussi parcourir son propre contenu et ainsi de suite, jusqu’à ce que tous les prix aient été calculés. Une boîte peut même ajouter des frais supplémentaires, comme le prix de l‘emballage.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/composite-comic-1-fr_b0e5f413de0e4ab6a74ea7bf76583.png\" class=\"jop-noMdConv\"\u003e\n\nLe patron de conception composite emploie une méthode récursive afin de parcourir tous les composants d’une arborescence.\n\nLa cerise sur le gâteau est que vous n’avez même pas besoin de connaître la classe concrète des objets de l’arborescence. Vous n’avez pas besoin de savoir si un objet est un produit tout simple ou une boîte sophistiquée, vous les manipulez de la même manière grâce à une interface commune. Lorsque vous faites appel à une méthode, les objets s’occupent de faire transiter la requête en descendant vers les feuilles de l’arbre.\n\n## Analogie\n\n\u003cimg width=\"280\" height=\"0\" src=\"../../_resources/live-example_80e4964736e14dd9a7650bd9726c82f3.png\" class=\"jop-noMdConv\"\u003e\n\nUn exemple de structure militaire.\n\nEn général, les armées d’un pays sont structurées en hiérarchies. Une armée comporte plusieurs divisions, une division est composée de brigades, une brigade est composée de compagnies, qui peuvent elles-mêmes être divisées en escouades. Pour finir, une escouade est un petit groupe de soldats. Les ordres sont donnés au sommet de la hiérarchie et passés au niveau directement inférieur à chaque soldat, qui sait quoi en faire.\n\n## Structure\n\n\u003cimg width=\"360\" height=\"0\" src=\"../../_resources/structure-fr_b1c7adcbd2c0414e90db59731cc46613.png\" class=\"jop-noMdConv\"\u003e\n\n1.  L’interface **Composant** décrit les opérations communes aux objets simples et complexes de l’arborescence.\n    \n2.  Une **Feuille** est un élément de base d’une branche qui n’a pas de sous-élément.\n    \n    En général les feuilles font le plus gros du travail, car elles n’ont personne à qui le déléguer.\n    \n3.  Le **Conteneur** (alias *composite*) est un élément composé de sous-éléments : des feuilles ou d’autres conteneurs. Un conteneur ne connait pas les classes de ses enfants. Il passe par l’interface composant pour interagir avec ses sous-éléments.\n    \n    Lorsqu’il reçoit une requête, un conteneur délègue la tâche à ses sous-éléments, traite les résultats intermédiaires, puis renvoie le résultat final au client.\n    \n4.  Le **Client** manipule les éléments depuis l’interface composant, ce qui lui permet de fonctionner de la même manière pour les éléments simples et complexes de l’arborescence.\n    \n\n## Pseudo-code\n\nDans cet exemple, le patron de conception **Composite** nous permet de gérer des imbrications de formes géométriques dans un éditeur graphique.\n\n\u003cimg width=\"370\" height=\"0\" src=\"../../_resources/example_34b02f2e13e44c3db158e38965b13a02.png\" class=\"jop-noMdConv\"\u003e\n\nExemple de l’éditeur des formes géométriques.\n\nLa classe `CompositionGraphique` est un conteneur doté d’un certain nombre de formes, incluant même des formes composées. Une forme composée possède les mêmes méthodes qu’une forme simple. Mais plutôt que de tout gérer toute seule, une forme composée envoie une requête récursive à tous ses enfants et « totalise » le résultat.\n\nLe code client manipule ces formes en passant par l’interface commune. De ce fait, le client ne sait jamais s’il est en train de manipuler une forme ou une composition. Le client peut manipuler des structures d’objets très complexes sans jamais être couplé avec les classes concrètes de cette structure.\n\n```\n// L’interface du composant déclare des opérations communes pour\n// les objets simples et complexes d’une composition.\ninterface Graphic is\n    method move(x, y)\n    method draw()\n\n// La classe feuille représente les objets finaux d’une\n// composition. Un objet feuille ne peut pas avoir de sous-\n// objets. En général, ce sont les feuilles qui lancent les\n// traitements. Les objets composite ne font que déléguer le\n// travail à leurs sous-composants.\nclass Dot implements Graphic is\n    field x, y\n\n    constructor Dot(x, y) { ... }\n\n    method move(x, y) is\n        this.x += x, this.y += y\n\n    method draw() is\n        // Dessine un point aux coordonnées X et Y.\n\n// Toutes les classes composant peuvent étendre d’autres\n// composants.\nclass Circle extends Dot is\n    field radius\n\n    constructor Circle(x, y, radius) { ... }\n\n    method draw() is\n        // Trace un cercle de rayon R aux coordonnées X et Y.\n\n// La classe composite représente les composants complexes qui\n// peuvent avoir des enfants. Les objets composite délèguent\n// généralement les tâches à leurs enfants et « additionnent »\n// ensuite le résultat.\nclass CompoundGraphic implements Graphic is\n    field children: array of Graphic\n\n    // Un composite peut ajouter ou retirer d’autres composants\n    // (simples ou complexes) de la liste de ses enfants.\n    method add(child: Graphic) is\n        // Ajoute un enfant au tableau d’enfants.\n\n    method remove(child: Graphic) is\n        // Retire un enfant du tableau d’enfants.\n\n    method move(x, y) is\n        foreach (child in children) do\n            child.move(x, y)\n\n    // Un composite exécute sa logique principale d’une certaine\n    // manière : il parcourt récursivement tous ses enfants,\n    // puis récupère et additionne leurs résultats. L’objet est\n    // entièrement parcouru, car les enfants du composite\n    // passent ces appels à leurs propres enfants et ainsi de\n    // suite.\n    method draw() is\n        // 1. Pour chaque composant enfant :\n        //     - Dessine le composant.\n        //     - Met à jour le rectangle de délimitation.\n        // 2. Dessine un rectangle en pointillé en utilisant les\n        // coordonnées de la délimitation.\n\n// Le code client manipule les composants grâce à leur interface\n// de base. Ainsi, le code client peut aussi bien prendre en\n// charge les composants simples que les complexes.\nclass ImageEditor is\n    field all: CompoundGraphic\n\n    method load() is\n        all = new CompoundGraphic()\n        all.add(new Dot(1, 2))\n        all.add(new Circle(5, 3, 10))\n        // ...\n\n    // Combine les composants sélectionnés en un seul composant\n    // complexe.\n    method groupSelected(components: array of Graphic) is\n        group = new CompoundGraphic()\n        foreach (component in components) do\n            group.add(component)\n            all.remove(component)\n        all.add(group)\n        // Tous les composants vont être dessinés.\n        all.draw()\n\n```\n\n## Possibilités d’application\n\nUtilisez le composite si vous devez gérer une structure d’objets qui ressemble à une arborescence.\n\nLe patron de conception composite vous propose deux éléments de base qui partagent la même interface : des feuilles simples et des conteneurs complexes. Un conteneur peut être composé de feuilles et d’autres conteneurs. Grâce à cela, vous pouvez construire une structure récursive composée d’objets imbriqués qui ressemble à un arbre.\n\nUtilisez ce patron si vous voulez que le client interagisse avec les éléments simples aussi bien que complexes de façon uniforme.\n\nTous les éléments définis dans le patron composite partagent une interface commune. En utilisant cette interface, le client n’a pas besoin de connaître la classe concrète des objets qu’il manipule.\n\n## Mise en œuvre\n\n1.  Assurez-vous que votre application possède bien la forme d’une arborescence. Décomposez-la en conteneurs et en éléments simples. Rappelez-vous que les conteneurs doivent pouvoir accueillir des éléments simples et d’autres conteneurs.\n    \n2.  Déclarez l’interface composant avec une liste de méthodes qui fonctionnent à la fois avec les composants simples et complexes.\n    \n3.  Créez une classe feuille pour représenter les éléments simples. Un même programme peut avoir plusieurs classes feuille différentes.\n    \n4.  Créez une classe conteneur pour représenter les éléments complexes. Fournissez un attribut de type tableau à cette classe, afin de stocker les références aux sous-éléments. Ce tableau doit pouvoir stocker les feuilles et les conteneurs, assurez-vous donc qu’il est bien déclaré avec le type d’interface du composant.\n    \n    Tout en implémentant les méthodes de l’interface composant, gardez en tête que les conteneurs sont censés déléguer la majeure partie du travail à leurs sous-éléments.\n    \n5.  Enfin, définissez des méthodes pour ajouter ou retirer des éléments enfants du conteneur.\n    \n    Elles peuvent être placées à l’intérieur de l’interface composant, mais ceci ne respecte pas le *principe de ségrégation des interfaces*, car la classe feuille contiendra des méthodes vides. L’avantage est que le client pourra traiter ces éléments uniformément, même lorsqu’il construit l’arborescence.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez travailler dans des structures arborescentes complexes plus facilement en utilisant les avantages du polymorphisme et de la récursivité.\n    \n- *Principe ouvert/fermé*. Vous pouvez introduire de nouveaux types d’éléments dans l’application qui pourront directement être intégrés dans l’arborescence, sans avoir à réécrire l’existant.\n    \n- Vous rencontrerez parfois des difficultés pour définir une interface commune à certaines classes dont les fonctionnalités sont trop différentes. Dans certains scénarios, vous devez créer une interface composant bien trop générique, rendant le fonctionnement difficile à comprendre.\n    \n\n## Liens avec les autres patrons\n\n- Vous pouvez utiliser le [Monteur](https://refactoring.guru/fr/design-patterns/builder) lorsque vous créez des arbres [Composites](https://refactoring.guru/fr/design-patterns/composite) complexes, car vous pouvez programmer les étapes de la construction récursivement.\n    \n- La [Chaîne de Responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility \"Chaîne de responsabilité\") est souvent utilisée en conjonction avec le [Composite](https://refactoring.guru/fr/design-patterns/composite). Dans ce cas, lorsqu’une feuille reçoit une demande, elle la passe le long de la chaîne de ses composants parent, jusqu’à la racine de l’arborescence.\n    \n- Vous pouvez utiliser les [Itérateurs](https://refactoring.guru/fr/design-patterns/iterator) pour parcourir des arbres [Composites](https://refactoring.guru/fr/design-patterns/composite).\n    \n- Vous pouvez utiliser le [Visiteur](https://refactoring.guru/fr/design-patterns/visitor) pour lancer une opération sur un arbre [Composite](https://refactoring.guru/fr/design-patterns/composite) entier.\n    \n- Vous pouvez transformer des nœuds de feuilles de l’arbre [Composite](https://refactoring.guru/fr/design-patterns/composite) en [Poids mouches](https://refactoring.guru/fr/design-patterns/flyweight) et les partager pour économiser de la RAM.\n    \n- Le [Composite](https://refactoring.guru/fr/design-patterns/composite) et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) ont des diagrammes de structure similaires puisqu’ils reposent sur la composition récursive pour organiser un nombre variable d’objets.\n    \n    Un *décorateur* est comme un *composite*, mais avec un seul composant enfant. Il y a une autre différence importante : Le *décorateur* ajoute des responsabilités supplémentaires à l’objet emballé, alors que le *composite* se contente d’« additionner » les résultats de ses enfants.\n    \n    Mais ces patrons de conception peuvent également coopérer : vous pouvez utiliser le *décorateur* pour étendre le comportement d’un objet spécifique d’un arbre *Composite*.\n    \n- Les conceptions qui reposent énormément sur le [Composite](https://refactoring.guru/fr/design-patterns/composite) et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) tirent des avantages à utiliser le [Prototype](https://refactoring.guru/fr/design-patterns/prototype). Il vous permet de cloner les structures complexes plutôt que de les reconstruire à partir de rien.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_cddd45c358d44950bc20aa720f3073e9.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/java/example \"Patrons de conception : Composite en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_9ee8f1ab64754c309327678c40a2eac6.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/csharp/example \"Patrons de conception : Composite en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_e109cacad19646fa97256bddbecca1ef.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/cpp/example \"Patrons de conception : Composite en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_f55a4a1644624ab190464f495b13fb46.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/php/example \"Patrons de conception : Composite en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_bf895152b2334ec5bee680903a241b88.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/python/example \"Patrons de conception : Composite en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_f43914161d714c68a3c23dcba231dbcb.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/ruby/example \"Patrons de conception : Composite en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_0ff1aa551f734f3486fa1e165415c235.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/swift/example \"Patrons de conception : Composite en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_e7a822d44f51485baa0f0b6732bd5973.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/typescript/example \"Patrons de conception : Composite en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_700610496e944b678f790fe980867e82.svg\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/composite/go/example \"Patrons de conception : Composite en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_b7186cc19bb1492aa7fbba8752e.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n\n#### Retour\n\n[Pont](https://refactoring.guru/fr/design-patterns/bridge)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_b0303e5e113d4c42a31c5869bb0afeba.png\" class=\"jop-noMdConv\"\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook **Plongée au cœur des PATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/composite \"English\") [Español](https://refactoring.guru/es/design-patterns/composite \"Español\") [Français](https://refactoring.guru/fr/design-patterns/composite \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/composite \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/composite \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/composite \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/composite \"Українська\") [中文](https://refactoringguru.cn/design-patterns/composite \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_9446b885daab426cb6a5aef9e562fd4a.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_631d205432054cf48d112ccb24ee09ea.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n        - [Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)\n        - [Pont](https://refactoring.guru/fr/design-patterns/bridge)\n        - [Composite](https://refactoring.guru/fr/design-patterns/composite)\n        - [Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n        - [Façade](https://refactoring.guru/fr/design-patterns/facade)\n        - [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n        - [Procuration](https://refactoring.guru/fr/design-patterns/proxy)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés. ![Organization address](../../_resources/fa-building_2ef73d2cc24c48378a5ecb3c7bd5cf91.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305 Email: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Structurel/Decorateur":{"title":"Décorateur / Decorator","content":"\n**Décorateur** permet d’affecter dynamiquement de nouveaux comportements à des objets en les plaçant dans des emballeurs qui implémentent ces comportements.\n\n![Patron de conception\u0026nbsp;décorateur](../../_resources/decorator_c5817e96250547319197fdb249dc05f0.png)\n\n## Problème\n\nImaginez que vous travaillez sur une librairie qui permet aux programmes d’envoyer des notifications à leurs utilisateurs lorsque des événements importants se produisent.\n\nLa version initiale de la librairie était basée sur la classe `Notificateur` qui n’avait que quelques attributs, un constructeur et une unique méthode `envoyer`. La méthode pouvait prendre un message en paramètre et l’envoyait à une liste d’e-mails à l’aide du constructeur du notificateur. Une application externe qui jouait le rôle du client devait créer et configurer l’objet notificateur une première fois, puis l’utiliser lorsqu’un événement important se produisait.\n\n\u003cimg width=\"540\" height=\"0\" src=\"../../_resources/problem1-fr_e2b56b5e3e5e48fca80dd93c589daf38.png\"/\u003e\n\nUn programme peut utiliser la classe notificateur afin d’envoyer des notifications au sujet d’événements importants à une liste prédéfinie d’adresses e-mail.\n\nAu bout d’un certain temps, vous vous rendez compte que les utilisateurs de la librairie veulent plus que les notifications qu’ils reçoivent sur leur boîte mail. Ils sont nombreux à vouloir recevoir des SMS lorsque leurs applications rencontrent des problèmes critiques. Certains voudraient être prévenus sur Facebook et les employés de certaines entreprises adoreraient recevoir des notifications Slack.\n\n\u003cimg width=\"440\" height=\"0\" src=\"../../_resources/problem2_2c28e16ffe874ed3bee4895a0eff7706.png\"/\u003e\n\nChaque type de notification est implémenté dans une sous-classe du notificateur.\n\nCela n’a pas l’air bien difficile ! Vous avez étendu la classe `Notificateur` et ajouté des méthodes de notification supplémentaires dans de nouvelles sous-classes. Le client devait instancier la classe de notification désirée et utiliser cette instance pour toutes les autres notifications, mais quelqu’un a remis en question ce fonctionnement en vous affirmant qu’il aimerait bien utiliser plusieurs types de notifications simultanément. Si votre maison prend feu, vous avez très certainement envie d’en être informé par tous les moyens possibles.\n\nVous avez tenté de résoudre ce problème en créant des sous-classes spéciales qui combinent plusieurs méthodes de notification dans une seule classe. Mais il s’avère que cette approche va non seulement gonfler le code de la librairie, mais aussi celui du client.\n\n\u003cimg width=\"630\" height=\"0\" src=\"../../_resources/problem3_3c2bd6bf9ffc4432ac07aedd4ba223d2.png\"/\u003e\n\nExplosion combinatoire des sous-classes.\n\nVous devez structurer vos classes de notification différemment pour ne pas trop les multiplier, sinon vous allez vous retrouver dans le livre Guinness des records.\n\n## Solution\n\nLa première chose qui nous vient à l’esprit lorsque l’on veut modifier le comportement d’un objet, c’est d’étendre sa classe. Cependant, voici quelques mises en garde concernant l’héritage :\n\n- L’héritage est statique. Vous ne pouvez pas modifier le comportement d’un objet au moment de l’exécution. Vous ne pouvez que remplacer la totalité de l’objet par un autre, généré grâce à une sous-classe différente.\n- Les sous-classes ne peuvent avoir qu’un seul parent. Dans la majorité des langages de programmation, vous ne pouvez hériter que d’une seule classe à la fois.\n\nUne des solutions pour contourner ce problème consiste à utiliser l’*aggrégation* ou la *composition*  à la place de l’*héritage*. Ces alternatives fonctionnent à peu près de la même façon : un objet *possède* une référence à un autre objet et lui délègue une partie de son travail. Avec l’héritage, l’objet *est* capable de faire le travail tout seul en héritant du comportement de sa classe mère.\n\nGrâce à cette nouvelle approche, il est facile de remplacer l’objet référencé par un autre, ce qui modifie le comportement du conteneur au moment de l’exécution. Un objet peut utiliser le comportement de diverses classes, posséder des références à de nombreux objets et leur déléguer toutes sortes de tâches. L’agrégation et la composition sont des principes clés dans le décorateur, tout comme dans de nombreux autres patrons. Sur ces belles paroles, revenons à nos moutons.\n\n\u003cimg width=\"550\" height=\"0\" src=\"../../_resources/solution1-fr_de236bc0b3cd46cc9231ee786533539d.png\"/\u003e\n\nHéritage contre Agrégation.\n\nLe décorateur est également appelé « emballeur » ou « empaqueteur ». Ces surnoms révèlent l’idée générale derrière le concept. Un *emballeur* est un objet qui peut être lié par un objet *cible*. L’emballeur possède le même ensemble de méthodes que la cible et lui délègue toutes les demandes qu’il reçoit. Il peut exécuter un traitement et modifier le résultat avant ou après avoir envoyé sa demande à la cible.\n\nÀ quel moment un emballeur devient-il réellement un décorateur ? Comme je l’ai déjà dit, un emballeur implémente la même interface que l’objet emballé. Du point de vue du client, ces objets sont identiques. L’attribut de la référence de l’emballeur doit pouvoir accueillir n’importe quel objet qui implémente cette interface. Vous pouvez ainsi utiliser plusieurs emballeurs sur un seul objet et lui attribuer les comportements de plusieurs emballeurs en même temps.\n\nReprenons notre exemple et mettons-y une notification par e-mail dans la classe de base `Notificateur`, mais transformons toutes les autres méthodes de notification en décorateurs.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/solution2_280d6d29f9ce4dc792d56d9f2f896ab8.png\"/\u003e\n\nDes méthodes de notification deviennent des décorateurs.\n\nLe code client doit emballer un objet basique Notificateur pour le transformer en un ensemble de décorateurs adapté aux préférences du client. Les objets qui en résultent sont empilés.\n\n\u003cimg width=\"300\" height=\"0\" src=\"../../_resources/solution3-fr_80fb3de812754d34915e7b091f9ccb6d.png\"/\u003e\n\nLes applications peuvent configurer des piles complexes de décorateurs pour les notifications.\n\nLe client traite le dernier objet de la pile. Les décorateurs implémentent tous la même interface (le notificateur de base). Le reste du code client manipule indifféremment l’objet notificateur original et l’objet décoré.\n\nNous pouvons utiliser cette technique pour tous les autres comportements, comme la mise en page des messages ou la création de la liste des destinataires. Le client peut décorer l’objet avec des décorateurs personnalisés tant qu’ils suivent la même interface que les autres.\n\n## Analogie\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/decorator-comic-1_cf35dd3e862545359b7ef71b080748ac.png\"/\u003e\n\nLes effets se cumulent si vous portez plusieurs couches de vêtements.\n\nPorter des vêtements est un bon exemple d’utilisation. Si vous avez froid, vous vous enroulez dans un pull. Si vous avez encore froid, vous pouvez porter un blouson par-dessus. S’il pleut, vous enfilez un imperméable. Tous ces vêtements « étendent » votre comportement de base mais ne font pas partie de vous, et vous pouvez facilement enlever un vêtement lorsque vous n’en avez plus besoin.\n\n## Structure\n\n\u003cimg width=\"480\" height=\"0\" src=\"../../_resources/structure_3eafb1b77d834dbda293ae65dc11e350.png\"/\u003e\n\n1.  Le **Composant** déclare l’interface commune pour les décorateurs et les objets décorés.\n    \n2.  Le **Composant Concret** est une classe contenant des objets qui vont être emballés. Il définit le comportement par défaut qui peut être modifié par les décorateurs.\n    \n3.  Le **Décorateur de Base** possède un attribut pour référencer un objet emballé. L’attribut doit être déclaré avec le type de l’interface du composant afin de contenir à la fois les composants concrets et les décorateurs. Le décorateur de base délègue toutes les opérations à l’objet emballé.\n    \n4.  Les **Décorateurs Concrets** définissent des comportements supplémentaires qui peuvent être ajoutés dynamiquement aux composants. Les décorateurs concrets redéfinissent les méthodes du décorateur de base et exécutent leur traitement avant ou après l’appel à la méthode du parent.\n    \n5.  Le **Client** peut emballer les composants dans plusieurs couches de décorateurs, tant qu’il manipule les objets à l’aide de l’interface du composant.\n    \n\n## Pseudo-code\n\nDans cet exemple, le **Décorateur** permet la compression et le chiffrage des données indépendamment du code qui les utilise.\n\n\u003cimg width=\"540\" height=\"0\" src=\"../../_resources/example_a160323bbb944584b0933bebcc01ba89.png\"/\u003e\n\nL’exemple de chiffrage et de compression utilisé.\n\nL’application emballe l’objet de la source de données à l’aide de deux décorateurs. Ils modifient la manière dont les données sont lues et écrites sur le disque :\n\n- Les décorateurs chiffrent et compressent les données juste avant qu’elles soient **écrites sur le disque**. La classe d’origine écrit les données chiffrées et protégées dans le fichier sans savoir qu’il y a eu une modification.\n    \n- Une fois que les données sont **lues depuis le disque**, elles repassent dans ces mêmes décorateurs qui les décompressent et les déchiffrent.\n    \n\nLes décorateurs et la classe de la source de données implémentent la même interface, ce qui les rend interchangeables aux yeux du code client.\n\n```\n// L’interface du composant définit les traitements qui peuvent\n// être modifiés par les décorateurs.\ninterface DataSource is\n    method writeData(data)\n    method readData():data\n\n// Les composants concrets fournissent des implémentations par\n// défaut pour les traitements. Plusieurs variantes de ces\n// classes peuvent se trouver dans un programme.\nclass FileDataSource implements DataSource is\n    constructor FileDataSource(filename) { ... }\n\n    method writeData(data) is\n        // Écrit les données dans le fichier.\n\n    method readData():data is\n        // Lit les données du fichier.\n\n// La classe de base du décorateur implémente la même interface\n// que les autres composants. Le but principal de cette classe\n// est de définir l’interface d’emballage pour tous les\n// décorateurs concrets. L’implémentation par défaut du code\n// d’emballage peut comprendre un attribut pour stocker un\n// composant emballé et tout le nécessaire pour l’initialiser.\nclass DataSourceDecorator implements DataSource is\n    protected field wrappee: DataSource\n\n    constructor DataSourceDecorator(source: DataSource) is\n        wrappee = source\n\n    // Le décorateur de base délègue tout le travail à l’objet\n    // emballé. Les comportements supplémentaires peuvent être\n    // ajoutés aux décorateurs concrets.\n    method writeData(data) is\n        wrappee.writeData(data)\n\n    // Les décorateurs concrets peuvent appeler l’implémentation\n    // parent du traitement plutôt que d’appeler l’objet emballé\n    // directement. Cette approche simplifie l’extension des\n    // classes décorateur.\n    method readData():data is\n        return wrappee.readData()\n\n// Les décorateurs concrets doivent appeler les méthodes de\n// l’objet emballé, mais ils peuvent ajouter quelque chose au\n// résultat. Les décorateurs peuvent exécuter ce comportement\n// supplémentaire avant ou après l’appel à l’objet emballé.\nclass EncryptionDecorator extends DataSourceDecorator is\n    method writeData(data) is\n        // 1. Chiffre les données passées.\n        // 2. Envoie les données chiffrées à la méthode emballée\n        // écrireDonnées\n\n    method readData():data is\n        // 1. Récupère les données de la méthode emballée\n        // lireDonnées.\n        // 2. La déchiffre si besoin.\n        // 3. Retourne le résultat.\n\n// Vous pouvez emballer les objets dans plusieurs couches de\n// décorateurs.\nclass CompressionDecorator extends DataSourceDecorator is\n    method writeData(data) is\n        // 1. Compresse les données passées.\n        // 2. Envoie les données compressées à la méthode\n        // emballée écrireDonnées\n\n    method readData():data is\n        // 1. Récupère les données de la méthode emballée\n        // lireDonnées.\n        // 2. La décompresse si besoin.\n        // 3. Retourne le résultat.\n\n// Option 1 : un exemple simple de l’assemblage d’un décorateur.\nclass Application is\n    method dumbUsageExample() is\n        source = new FileDataSource(\"somefile.dat\")\n        source.writeData(salaryRecords)\n        // Le fichier cible a été écrit avec des données brutes.\n\n        source = new CompressionDecorator(source)\n        source.writeData(salaryRecords)\n        // Le fichier cible a été écrit avec des données\n        // compressées.\n\n        source = new EncryptionDecorator(source)\n        // La variable source contient à présent :\n        // Chiffrage \u003e Compression \u003e FileDataSource.\n        source.writeData(salaryRecords)\n        // Le fichier cible a été écrit avec des données\n        // compressées et chiffrées.\n\n// Option 2 : un code client qui utilise une source de données\n// externe. Les objets responsablePaye (SalaryManager) ne\n// s’encombrent pas des détails concernant le stockage des\n// données. Ils utilisent une source de données pré configurée\n// reçue par le configurateur de l’application.\nclass SalaryManager is\n    field source: DataSource\n\n    constructor SalaryManager(source: DataSource) { ... }\n\n    method load() is\n        return source.readData()\n\n    method save() is\n        source.writeData(salaryRecords)\n    // ...d’autres méthodes utiles...\n\n// L’application peut assembler différentes piles de décorateurs\n// à l’exécution, en fonction de la configuration ou de\n// l’environnement.\nclass ApplicationConfigurator is\n    method configurationExample() is\n        source = new FileDataSource(\"salary.dat\")\n        if (enabledEncryption)\n            source = new EncryptionDecorator(source)\n        if (enabledCompression)\n            source = new CompressionDecorator(source)\n\n        logger = new SalaryManager(source)\n        salary = logger.load()\n    // ...\n\n```\n\n## Possibilités d’application\n\nUtilisez le décorateur si vous avez besoin d’ajouter des comportements supplémentaires au moment de l’exécution sans avoir à altérer le code source de ces objets.\n\nLe décorateur vous permet de structurer votre logique métier en couches, de créer un décorateur pour chacune de ces couches et de décorer les objets avec différentes combinaisons au moment de l’exécution. Le code client peut traiter les objets uniformément puisqu’ils implémentent la même interface.\n\nUtilisez ce patron si l’héritage est impossible ou peu logique pour étendre le comportement d’un objet.\n\nDe nombreux langages de programmation permettent l’utilisation du mot clé `final` pour interdire l’héritage une classe. Le seul moyen d’étendre le comportement d’une telle classe est de l’emballer en utilisant un décorateur.\n\n## Mise en œuvre\n\n1.  Assurez-vous que votre domaine peut être représenté sous la forme d’un composant principal recouvert par plusieurs couches facultatives.\n    \n2.  Déterminez les méthodes communes entre le composant principal et les couches facultatives. Créez l’interface du composant et déclarez-y ces méthodes.\n    \n3.  Créez une classe concrète pour le composant et définissez son comportement de base.\n    \n4.  Créez une classe de base décorateur. Elle doit inclure un attribut qui va permettre de stocker la référence à un objet emballé. Cet attribut doit être déclaré avec le type de l’interface du composant, afin de le relier aux composants concrets et aux décorateurs. Le décorateur de base doit déléguer tout le travail à l’objet emballé.\n    \n5.  Assurez-vous que les classes implémentent l’interface du composant.\n    \n6.  Créez des décorateurs concrets en les implémentant à partir du décorateur de base. Un décorateur concret doit exécuter son comportement avant ou après l’appel à la méthode de son parent (qui délègue toujours la tâche à l’objet emballé).\n    \n7.  Le code client doit être responsable de la création des décorateurs et de leur agencement en fonction des besoins du client.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez étendre le comportement d’un objet sans avoir recours à la création d’une nouvelle sous-classe.\n- Vous pouvez ajouter ou retirer dynamiquement des responsabilités à un objet au moment de l’exécution.\n- Vous pouvez combiner plusieurs comportements en emballant un objet dans plusieurs décorateurs.\n- *Principe de responsabilité unique*. Vous pouvez découper une classe monolithique qui implémente plusieurs comportements différents en plusieurs petits morceaux.\n\n- Retirer un emballeur spécifique de la pile n’est pas chose aisée.\n- Il n’est pas non plus aisé de mettre en place un décorateur dont le comportement ne varie pas en fonction de sa position dans la pile.\n- Le code de configuration initial des couches peut avoir l’air assez moche.\n\n## Liens avec les autres patrons\n\n- L’[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter) modifie l’interface d’un objet existant, alors que le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) améliore un objet sans toucher à son interface. De plus, le *décorateur* prend en charge la composition récursive, ce qui n’est pas possible avec l’*adaptateur*.\n    \n- L’[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter) procure une interface différente à l’objet emballé, la [Procuration](https://refactoring.guru/fr/design-patterns/proxy) lui fournit la même interface et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) lui met à disposition une interface améliorée.\n    \n- La [Chaîne de Responsabilité](https://refactoring.guru/fr/design-patterns/chain-of-responsibility \"Chaîne de responsabilité\") et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) ont des structures de classes très similaires. Ils reposent tous deux sur la composition récursive pour passer les appels à une suite d’objets. Ils possèdent cependant plusieurs différences majeures.\n    \n    Les handlers de la *chaîne de responsabilité* peuvent lancer des opérations arbitraires indépendantes l’une de l’autre. Ils peuvent également décider de ne pas propager la demande plus loin dans la chaîne. Les *décorateurs* quant à eux peuvent étendre le comportement de l’objet sans perturber leur fonctionnement avec l’interface de base. De plus, les décorateurs n’ont pas le droit d’interrompre la demande.\n    \n- Le [Composite](https://refactoring.guru/fr/design-patterns/composite) et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) ont des diagrammes de structure similaires puisqu’ils reposent sur la composition récursive pour organiser un nombre variable d’objets.\n    \n    Un *décorateur* est comme un *composite*, mais avec un seul composant enfant. Il y a une autre différence importante : Le *décorateur* ajoute des responsabilités supplémentaires à l’objet emballé, alors que le *composite* se contente d’« additionner » les résultats de ses enfants.\n    \n    Mais ces patrons de conception peuvent également coopérer : vous pouvez utiliser le *décorateur* pour étendre le comportement d’un objet spécifique d’un arbre *Composite*.\n    \n- Les conceptions qui reposent énormément sur le [Composite](https://refactoring.guru/fr/design-patterns/composite) et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) tirent des avantages à utiliser le [Prototype](https://refactoring.guru/fr/design-patterns/prototype). Il vous permet de cloner les structures complexes plutôt que de les reconstruire à partir de rien.\n    \n- Le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) vous permet de changer la peau d’un objet, alors que la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) vous permet de changer ses tripes.\n    \n- Le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) et la [Procuration](https://refactoring.guru/fr/design-patterns/proxy) ont des structures similaires, mais des intentions différentes. Ces deux patrons sont bâtis sur le principe de la composition, où un objet est censé déléguer certains traitements à un autre. La différence est qu’en principe, la *procuration* gère elle-même le cycle de vie de son objet service, alors que la composition des *décorateurs* est toujours contrôlée par le client.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_47a338e0c5584f0d92ef3b1f91ac57f5.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/java/example \"Patrons de conception : Décorateur en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_95db31896cd64afe9fcbcaf277b96b22.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/csharp/example \"Patrons de conception : Décorateur en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_9a2aa855c1a945b5ae581b4c29bef6d9.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/cpp/example \"Patrons de conception : Décorateur en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_71c737b109b345dc91c334179b50d316.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/php/example \"Patrons de conception : Décorateur en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_074b598eb7334282a5502b00820880d0.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/python/example \"Patrons de conception : Décorateur en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_1c1d03cb8f9e4133975fa053f9fc8f93.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/ruby/example \"Patrons de conception : Décorateur en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_c14ed9eb94024cc3ba08b56cffa5702f.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/swift/example \"Patrons de conception : Décorateur en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_073c75bda2f849a3ad22836fb2e9f26d.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/typescript/example \"Patrons de conception : Décorateur en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_92ab165b2cb74e578a06fff0b8d29abc.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/decorator/go/example \"Patrons de conception : Décorateur en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_dbad23c6d11548f9a4eab63fd65.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Façade](https://refactoring.guru/fr/design-patterns/facade)\n\n#### Retour\n\n[Composite](https://refactoring.guru/fr/design-patterns/composite)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_671dfe2ed7ad47daa093d29ef004f257.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/decorator \"English\") [Español](https://refactoring.guru/es/design-patterns/decorator \"Español\") [Français](https://refactoring.guru/fr/design-patterns/decorator \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/decorator \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/decorator \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/decorator \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/decorator \"Українська\") [中文](https://refactoringguru.cn/design-patterns/decorator \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_8b36ef8101444dd1aa9a0510768c2f2d.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_456ca67ec62948a79d470aab8418c0d3.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n        - [Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)\n        - [Pont](https://refactoring.guru/fr/design-patterns/bridge)\n        - [Composite](https://refactoring.guru/fr/design-patterns/composite)\n        - [Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n        - [Façade](https://refactoring.guru/fr/design-patterns/facade)\n        - [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n        - [Procuration](https://refactoring.guru/fr/design-patterns/proxy)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_417e1698716e4636bc1cd54c0297190b.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Structurel/Fa%C3%A7ade":{"title":"Façade / Facade","content":"\n**Façade** procure une interface offrant un accès simplifié à une librairie, un framework ou à n’importe quel ensemble complexe de classes.\n\n![Patron de conception\u0026nbsp;façade](../../_resources/facade_143c03590f2741a487e911c4f5b00333.png)\n\n## Problème\n\nImaginez que vous devez adapter votre code pour manipuler un ensemble d’objets qui appartiennent à une librairie ou à un framework assez sophistiqué. D’ordinaire, vous initialisez tous ces objets en premier, gardez la trace des dépendances et appelez les méthodes dans le bon ordre, etc.\n\nPar conséquent, la logique métier de vos classes devient fortement couplée avec les détails de l’implémentation des classes externes, rendant cette logique difficile à comprendre et à maintenir.\n\n## Solution\n\nUne façade est une classe qui procure une interface simple vers un sous-système complexe de parties mobiles. Les fonctionnalités proposées par la façade seront plus limitées que si vous interagissiez directement avec le sous-système, mais vous pouvez vous contenter de n’inclure que les fonctionnalités qui intéressent votre client.\n\nUne façade se révèle très pratique si votre application n’a besoin que d’une partie des fonctionnalités d’une librairie sophistiquée parmi les nombreuses qu’elle propose.\n\nPar exemple, une application qui envoie des petites vidéos de chats comiques sur des réseaux sociaux peut potentiellement utiliser une librairie de conversion vidéo professionnelle. Mais la seule chose dont vous ayez réellement besoin, c’est d’une classe dotée d’une méthode `encoder(fichier, format)`. Après avoir créé cette classe et intégré la librairie de conversion vidéo, votre façade est opérationnelle.\n\n## Analogie\n\n\u003cimg width=\"490\" height=\"0\" src=\"../../_resources/live-example-fr_a6d5d827c38a4dce96246b71fb5cd7dd.png\"/\u003e\n\nPasser une commande au téléphone.\n\nLorsque vous téléphonez à un magasin pour commander, un opérateur joue le rôle de la façade pour tous ses services. L’opérateur vous sert d’interface vocale avec le système de commandes, les moyens de paiement et les différents services de livraison.\n\n## Structure\n\n\u003cimg width=\"560\" height=\"0\" src=\"../../_resources/structure_36eb5b45f1d24866b7b0dca2920bebf6.png\"/\u003e\n\n1.  La **Façade** procure un accès pratique aux différentes parties des fonctionnalités du sous-système. Elle sait où diriger les requêtes du client et comment utiliser les différentes parties mobiles.\n    \n2.  Une classe **Façade Supplémentaire** peut être créée pour éviter de polluer une autre façade avec des fonctionnalités qui pourraient la rendre trop complexe. Les façades supplémentaires peuvent être utilisées à la fois par le client et par les autres façades.\n    \n3.  Le **Sous-système Complexe** est composé de dizaines d’objets variés. Pour leur donner une réelle utilité, vous devez plonger au cœur des détails de l’implémentation du sous-système, comme initialiser les objets dans le bon ordre et leur fournir les données dans le bon format.\n    \n    Les classes du sous-système ne sont pas conscientes de l’existence de la façade. Elles opèrent et interagissent directement à l’intérieur de leur propre système.\n    \n4.  Le **Client** passe par la façade plutôt que d’appeler les objets du sous-système directement.\n    \n\n## Pseudo-code\n\nDans cet exemple, la **Façade** simplifie l’interaction avec un framework complexe de conversion vidéo.\n\n\u003cimg width=\"570\" height=\"0\" src=\"../../_resources/example_881a40ce195e497ca1e3ce386048540e.png\"/\u003e\n\nUtilisation d’une classe façade dans un exemple d’isolation de dépendances multiples.\n\nPlutôt que d’adapter directement la base de votre code à des dizaines de classes, vous créez une façade qui permet d’encapsuler cette fonctionnalité et de la cacher du reste du code. Cette structure permet de minimiser le travail nécessaire aux futures évolutions du framework, ou au remplacement de ce dernier par un autre. Vous pouvez vous contenter de modifier l’implémentation des méthodes de la façade.\n\n```\n// Voici quelques classes d’un framework complexe de conversion\n// vidéo externe. Nous n’avons pas la main sur le code, nous ne\n// pouvons donc pas le simplifier.\nclass VideoFile\n// ...\n\nclass OggCompressionCodec\n// ...\n\nclass MPEG4CompressionCodec\n// ...\n\nclass CodecFactory\n// ...\n\nclass BitrateReader\n// ...\n\nclass AudioMixer\n// ...\n\n// Nous créons une classe façade pour cacher la complexité du\n// framework derrière une interface simple. C’est un compromis\n// entre fonctionnalité et simplicité.\nclass VideoConverter is\n    method convert(filename, format):File is\n        file = new VideoFile(filename)\n        sourceCodec = new CodecFactory.extract(file)\n        if (format == \"mp4\")\n            destinationCodec = new MPEG4CompressionCodec()\n        else\n            destinationCodec = new OggCompressionCodec()\n        buffer = BitrateReader.read(filename, sourceCodec)\n        result = BitrateReader.convert(buffer, destinationCodec)\n        result = (new AudioMixer()).fix(result)\n        return new File(result)\n\n// Les classes application ne dépendent pas d’un milliard de\n// classes fournies par un framework complexe. Si vous décidez\n// de changer de framework, vous avez seulement besoin de\n// réécrire la classe façade.\nclass Application is\n    method main() is\n        convertor = new VideoConverter()\n        mp4 = convertor.convert(\"funny-cats-video.ogg\", \"mp4\")\n        mp4.save()\n\n```\n\n## Possibilités d’application\n\nUtilisez la façade si vous avez besoin d’une interface limitée mais directe à un sous-système complexe.\n\nSouvent, les sous-systèmes gagnent en complexité avec le temps et mettre en place un patron de conception implique de créer de nouvelles classes. Dans de nombreux contextes, un sous-système peut se révéler plus souple et facile à réutiliser, mais la quantité de travail pour configurer et écrire le code de base ne fait que croitre. La façade tente de remédier à ce problème en fournissant un raccourci aux fonctionnalités du sous-système qui sont adaptées au besoin du client.\n\nUtilisez la façade si vous voulez structurer un sous-système en plusieurs couches.\n\nCréez des façades pour définir des points d’entrée à chaque niveau d’un sous-système. Vous pouvez réduire le couplage entre plusieurs sous-systèmes en les obligeant à communiquer au travers de façades.\n\nReprenons notre exemple de framework de conversion vidéo. Il peut être désassemblé en deux couches : tout ce qui concerne la vidéo d’un côté et l’audio de l’autre. Créez une façade pour chaque couche. Vous pouvez utiliser ce genre de façades pour faire communiquer les classes de ces couches ensemble. Cette approche peut fortement ressembler au patron de conception [Médiateur](https://refactoring.guru/fr/design-patterns/mediator).\n\n## Mise en œuvre\n\n1.  Vérifiez s’il est possible de fournir une interface plus simple que ce qu’un sous-système vous propose. Si cette interface peut découpler le code client des nombreuses classes du sous-système, vous êtes sur la bonne voie !\n    \n2.  Déclarez et implémentez cette interface en tant que nouvelle façade. Elle doit rediriger les appels du code client aux objets appropriés du sous-système. Elle doit également être responsable de l’initialisation du sous-système et gérer son cycle de vie, sauf si le code client s’en occupe déjà.\n    \n3.  Pour exploiter au maximum les avantages de la façade, toute communication du code client avec le sous-système doit passer par elle. Cette manipulation protège le code client de tout effet de bord que des modifications apportées au sous-système pourraient provoquer. Si un sous-système est mis à jour, vous n’aurez besoin que de modifier le code de la façade.\n    \n4.  Si la façade devient [trop grande](https://refactoring.guru/fr/smells/large-class \"Large Class\"), vous devriez envisager de transférer une partie de ses comportements vers une nouvelle façade plus spécialisée.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez isoler votre code de la complexité d’un sous-système.\n\n- Une façade peut devenir [un objet omniscient](https://refactoring.guru/fr/antipatterns/god-object) couplé à toutes les classes d’une application.\n\n## Liens avec les autres patrons\n\n- La [Façade](https://refactoring.guru/fr/design-patterns/facade) définit une nouvelle interface pour les objets existants, alors que l’[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter) essaye de rendre l’interface existante utilisable. L’*adaptateur* emballe généralement un seul objet alors que la *façade* s’utilise pour un sous-système complet d’objets.\n    \n- La [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) peut remplacer la [Façade](https://refactoring.guru/fr/design-patterns/facade) si vous voulez simplement cacher au code client la création des objets du sous-système.\n    \n- Le [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight) vous montre comment créer plein de petits objets alors que la [Façade](https://refactoring.guru/fr/design-patterns/facade) permet de créer un seul objet qui représente un sous-système complet.\n    \n- La [Façade](https://refactoring.guru/fr/design-patterns/facade) et le [Médiateur](https://refactoring.guru/fr/design-patterns/mediator) ont des rôles similaires : ils essayent de faire collaborer des classes étroitement liées.\n    \n    - La *façade* définit une interface simplifiée pour un sous-système d’objets, mais elle n’ajoute pas de nouvelles fonctionnalités. Le sous-système est conscient de l’existence de la façade. Les objets situés à l’intérieur du sous-système peuvent communiquer directement.\n    - Le *médiateur* centralise la communication entre les composants du système. Les composants ne voient que l’objet médiateur et ne communiquent pas directement.\n- Une classe [Façade](https://refactoring.guru/fr/design-patterns/facade) peut souvent être transformée en [Singleton](https://refactoring.guru/fr/design-patterns/singleton), car un seul objet façade est en général suffisant.\n    \n- La [Façade](https://refactoring.guru/fr/design-patterns/facade) et la [Procuration](https://refactoring.guru/fr/design-patterns/proxy) ont une similarité : ils mettent en tampon une entité complexe et l’initialisent individuellement. Contrairement à la *façade*, la *procuration* implémente la même interface que son objet service, ce qui les rend interchangeables.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_588fa6b18de0492b858fb924dd14f344.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/java/example \"Patrons de conception : Façade en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_26ffae48663d4e7499096da576bdf4ac.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/csharp/example \"Patrons de conception : Façade en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_1c7e286ed2b245f685d1ffd9e675c842.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/cpp/example \"Patrons de conception : Façade en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_b3dfd9d7530c4af8944636fe8439ae17.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/php/example \"Patrons de conception : Façade en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_5ac324b5665741d1b486505c63adfa93.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/python/example \"Patrons de conception : Façade en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_b8eec9bbdb4d4dc7a6a6d03adc107337.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/ruby/example \"Patrons de conception : Façade en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_9d31aa04ffad47c0ba69b61ea9aa9950.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/swift/example \"Patrons de conception : Façade en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_2db4468132b34304ab5ba714fe6907f2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/typescript/example \"Patrons de conception : Façade en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_7fbbdde1f7624969b85989461ae358d6.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/facade/go/example \"Patrons de conception : Façade en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_c86c2d3e8fc3498bad87237369a.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n\n#### Retour\n\n[Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_54258c924f3748efbd645dffafc5121f.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/facade \"English\") [Español](https://refactoring.guru/es/design-patterns/facade \"Español\") [Français](https://refactoring.guru/fr/design-patterns/facade \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/facade \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/facade \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/facade \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/facade \"Українська\") [中文](https://refactoringguru.cn/design-patterns/facade \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_687ab0139d9d489db6d1695ff8e9ec45.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_ddbf9237283d4d4f800b0db1f36c5cd3.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n        - [Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)\n        - [Pont](https://refactoring.guru/fr/design-patterns/bridge)\n        - [Composite](https://refactoring.guru/fr/design-patterns/composite)\n        - [Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n        - [Façade](https://refactoring.guru/fr/design-patterns/facade)\n        - [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n        - [Procuration](https://refactoring.guru/fr/design-patterns/proxy)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_b2849318c4f140f086e879eab5533745.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Structurel/Poids_mouche":{"title":"Poids mouche / Flyweight","content":"\n**Poids mouche** est un patron de conception structurel qui permet de stocker plus d’objets dans la RAM en partageant les états similaires entre de multiples objets, plutôt que de stocker les données dans chaque objet.\n\n![Patron de conception poids\u0026nbsp;mouche](../../_resources/flyweight_c8bc40aa58304950869a45a83a3e9bc0.png)\n\n## Problème\n\nPour vous détendre après de longues heures de travail, vous décidez de créer un jeu vidéo tout simple dans lequel les joueurs peuvent se déplacer sur une carte et se tirer dessus. Vous choisissez de mettre en place un système réaliste de particules et d’en faire l’une des caractéristiques les plus importantes du jeu. De grandes quantités de balles, missiles et shrapnels projetés par des explosions vont être envoyés dans toutes les directions et offrir au joueur une expérience palpitante.\n\nUne fois la programmation terminée, vous lancez le dernier commit, assemblez le jeu, puis l’envoyez à votre ami afin qu’il le teste. Le jeu fonctionnait parfaitement sur votre machine, mais votre ami n’a pas pu jouer bien longtemps : son ordinateur plante systématiquement au bout de quelques minutes. Après plusieurs heures à écumer les logs de debug, vous découvrez que le plantage survient à cause d’une quantité de RAM insuffisante. Il semblerait que la machine de votre ami soit bien moins puissante que la vôtre, le problème se produit donc rapidement sur sa machine.\n\nIl semblerait que le problème soit causé par votre système de particules. Chaque particule (une balle, un missile ou un morceau de shrapnel) est représentée par un objet séparé qui contient de nombreuses données. Lorsque l’action bat son plein sur l’écran du joueur, les nouvelles particules ne peuvent plus tenir dans la RAM et le programme plante.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/problem-fr_0b9ea17f0f8344aabe3d509afc15caa3.png\"/\u003e\n\n## Solution\n\nEn inspectant la classe `Particule` de plus près, vous pourrez remarquer que les attributs de couleur et de sprite consomment beaucoup plus de mémoire que les autres attributs. Le pire est que ces deux attributs stockent des données quasi identiques dans toutes les particules. Par exemple, toutes les balles ont la même couleur et le même sprite.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/solution1-fr_f748516ecfb243a79ec0b94ef327c240.png\"/\u003e\n\nCertaines parties de l’état d’une particule, comme les coordonnées, le mouvement vectoriel et la vitesse sont uniques pour chaque particule. Après tout, les valeurs de ces attributs changent constamment. Ces données représentent le contexte évolutif de la particule, alors que la couleur et le sprite restent constants.\n\nLes données constantes d’un objet forment ce qu’on appelle en général l’*état intrinsèque*. Elles vivent à l’intérieur de l’objet ; les autres objets peuvent seulement les lire, mais pas les modifier. Le reste des données de l’objet sont souvent modifiées « depuis l’extérieur » par d’autres objets et constituent l’*état extrinsèque*.\n\nLe patron de conception poids mouche propose de ne plus stocker tous les états extrinsèques à l’intérieur de l’objet. À la place, vous devriez passer cet état à des méthodes spécialisées qui en dépendent. Seul l’état intrinsèque va rester à l’intérieur de l’objet, vous permettant de le réutiliser dans différents contextes. Vous n’aurez besoin que de quelques-uns de ces objets, car ils diffèrent uniquement dans l’état intrinsèque. Ce dernier possède bien moins de variantes que l’état extrinsèque.\n\n\u003cimg width=\"424\" height=\"0\" src=\"../../_resources/solution3-fr_5c42624730354fae914929dc2d7f27a1.png\"/\u003e\n\nRevenons à notre jeu. Si nous extrayons l’état extrinsèque de notre classe particule, trois objets seraient suffisants pour représenter toutes les particules du jeu : une balle, un missile et un morceau de shrapnel. Vous l’avez probablement déjà deviné, un objet qui ne stocke que l’état intrinsèque est appelé poids mouche.\n\n#### Stockage d’état extrinsèque\n\nOù allons-nous pouvoir mettre l’état extrinsèque ? Il faut bien qu’une classe l’accueille, non ? En général, il se retrouve dans l’objet du contenant, celui qui agrège les objets avant la mise en place du patron.\n\nDans notre cas, c’est l’objet principal `Jeu` qui stocke toutes les particules dans l’attribut `particules`. Pour déplacer l’état extrinsèque dans cette classe, vous devez créer plusieurs attributs de type tableau pour stocker les coordonnées, les vecteurs et la vitesse de chaque particule. Mais ce n’est pas tout. Vous allez devoir utiliser un autre tableau pour stocker les références à un poids mouche spécifique qui représente la particule. Ces tableaux doivent être synchronisés afin de pouvoir accéder à toutes les données d’une particule en utilisant le même index.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/solution2-fr_97d4b69a189648b0965adfdcd92d7eb0.png\"/\u003e\n\nIl existe une solution plus élégante qui consiste à créer une classe contexte séparée, qui va stocker l’état extrinsèque avec une référence à l’objet poids mouche. Cette approche ne nécessite qu’un seul tableau dans la classe du contenant.\n\nAttendez une minute ! Au tout début, il y avait de nombreux objets contextuels, en avons-nous encore besoin ? Techniquement, oui. Mais ces objets sont bien plus petits qu’avant. Les attributs qui demandent le plus de mémoire ont été déplacés dans quelques objets poids mouche. À présent, des milliers de petits objets contextuels vont pouvoir réutiliser un seul gros objet poids mouche, plutôt que de stocker des milliers de copies de ses données.\n\n#### Poids mouche et objet immuable\n\nÉtant donné que le même objet poids mouche peut être utilisé dans différents contextes, vous devez vous assurer que son état ne peut pas être modifié. Un poids mouche doit initialiser son état une seule fois grâce aux paramètres de son constructeur. Il ne doit pas laisser les autres objets accéder à quelque setter ou attribut public que ce soit.\n\n#### Fabrique poids mouche\n\nPour accéder plus facilement aux différents poids mouches, vous pouvez créer une méthode fabrique qui gère une réserve d’objets poids mouche existants. La méthode prend en paramètre l’état intrinsèque du poids mouche demandé par le client, cherche s’il en existe un qui correspond à cet état, et le retourne s’il le trouve. Sinon, il crée un nouveau poids mouche et l’ajoute à la réserve.\n\nCette méthode peut être placée à différents endroits. Il parait logique de l’écrire dans le contenant du poids mouche, mais vous pouvez aussi bien créer une nouvelle classe fabrique. Vous pouvez également rendre la méthode fabrique statique et la mettre dans une classe poids mouche.\n\n## Structure\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/structure_1ef8e0366e1342d4b7a672c884e0fed5.png\"/\u003e\n\n1.  Le patron de conception poids mouche ne permet que de faire de l’optimisation. Avant de le mettre en place, assurez-vous que votre programme souffre bien d’un problème de RAM insuffisante lié à un nombre trop important d’objets similaires en mémoire, et que d’autres solutions ne sont pas envisageables.\n    \n2.  Le **Poids mouche** contient la part de l’état de l’objet original qui peut être partagée entre plusieurs objets. Le même objet poids mouche peut être utilisé dans de nombreux contextes. L’état stocké à l’intérieur d’un poids mouche est *intrinsèque*. L’état passé aux méthodes du poids mouche est *extrinsèque*.\n    \n3.  La classe **Contexte** détient l’état extrinsèque, qui est unique dans chaque objet original. Lorsqu’un contexte est relié avec un objet poids mouche, il est identique à l’objet original.\n    \n4.  En général, le comportement de l’objet original reste dans la classe poids mouche. Dans ce cas, tout appel à une méthode du poids mouche doit également passer en paramètre les parties de l’état extrinsèque appropriées. Vous pouvez déplacer le comportement dans la classe contexte, ce qui permet ensuite de manipuler le poids mouche associé comme n’importe quelles données d’un objet.\n    \n5.  Le **Client** calcule et stocke l’état extrinsèque des poids mouches. Du point de vue du client, un poids mouche est un objet modèle qui peut être configuré à l’exécution en passant des données contextuelles en paramètre de ses méthodes.\n    \n6.  La **Fabrique du Poids mouche** gère une réserve de poids mouche existants. Si une fabrique est présente, les clients ne créent pas de poids mouche directement. À la place, ils appellent la fabrique et lui passent les morceaux de l’état intrinsèque du poids mouche désiré. La fabrique parcourt les poids mouches existants et en retourne un s’il correspond aux critères de recherche. Elle en crée un nouveau si elle n’en a pas trouvé.\n    \n\n## Pseudo-code\n\nDans l’exemple suivant, le **Poids mouche** diminue l’utilisation de la mémoire lorsqu’il affiche les millions d’arbres d’un canevas.\n\n\u003cimg width=\"540\" height=\"0\" src=\"../../_resources/example_53b08473d2854a5aac2e6ae5655a2331.png\"/\u003e\n\nLe patron récupère l’état intrinsèque qui se répète dans une classe principale `Arbre` et la stocke dans une classe `TypeArbre`.\n\nÀ présent, on ne stocke plus les mêmes données dans différents objets. On les met dans quelques poids mouche et on les associe avec les `Arbres` correspondants qui jouent le rôle du contexte. Le code client crée de nouveaux objets arbre en utilisant la fabrique du poids mouche. Cette dernière encapsule la complexité de la recherche du bon objet et le réutilise si possible.\n\n```\n// La classe poids mouche contient une partie de l'état d’un\n// arbre. Ces attributs stockent des valeurs uniques pour chaque\n// arbre. Par exemple, vous n’y trouverez pas les coordonnées de\n// l’arbre, mais plutôt les textures et les couleurs partagées\n// entre plusieurs arbres. Comme ces données sont souvent très\n// GROSSES, vous gâcheriez beaucoup de mémoire en stockant\n// chacune d’entre elles dans chaque arbre. À la place, nous\n// pouvons extraire la texture, la couleur et d’autres données\n// redondantes dans un objet séparé que de nombreux arbres vont\n// référencer.\nclass TreeType is\n    field name\n    field color\n    field texture\n    constructor TreeType(name, color, texture) { ... }\n    method draw(canvas, x, y) is\n        // 1. Crée un bitmap d’une couleur, structure et d’un\n        // type donnés.\n        // 2. Dessine le bitmap sur le canevas aux coordonnées X\n        // et Y.\n\n// La fabrique de poids mouche décide si elle veut réutiliser un\n// poids mouche existant ou si elle veut en créer un nouveau.\nclass TreeFactory is\n    static field treeTypes: collection of tree types\n    static method getTreeType(name, color, texture) is\n        type = treeTypes.find(name, color, texture)\n        if (type == null)\n            type = new TreeType(name, color, texture)\n            treeTypes.add(type)\n        return type\n\n// L’objet contextuel contient la partie extrinsèque de l’état\n// de l’arbre. Une application peut en créer des milliards, car\n// ils sont petits : ils sont seulement constitués de deux\n// coordonnées entières et d’un attribut pour une référence.\nclass Tree is\n    field x,y\n    field type: TreeType\n    constructor Tree(x, y, type) { ... }\n    method draw(canvas) is\n        type.draw(canvas, this.x, this.y)\n\n// Les classes arbre et Forêt sont les clients du poids mouche.\n// Vous pouvez les fusionner si vous n’avez pas l’intention\n// d’ajouter d’autres évolutions à la classe arbre.\nclass Forest is\n    field trees: collection of Trees\n\n    method plantTree(x, y, name, color, texture) is\n        type = TreeFactory.getTreeType(name, color, texture)\n        tree = new Tree(x, y, type)\n        trees.add(tree)\n\n    method draw(canvas) is\n        foreach (tree in trees) do\n            tree.draw(canvas)\n\n```\n\n## Possibilités d’application\n\nUtilisez le poids mouche uniquement si votre programme génère de nombreux objets et consomme trop de RAM.\n\nLes bénéfices apportés par ce patron varient énormément en fonction de son utilisation et de son contexte. Il est surtout utile dans les cas suivants :\n\n- Votre application demande un grand nombre d’objets similaires.\n- La RAM de l’appareil ciblé est saturée.\n- Les objets contiennent des états identiques qui peuvent être extraits et partagés entre plusieurs objets.\n\n## Mise en œuvre\n\n1.  Divisez les attributs d’une classe en deux parties pour les transformer en poids mouche :\n    \n    - L’état intrinsèque : les attributs qui contiennent des données invariables, dupliquées dans de nombreux objets.\n    - L’état extrinsèque : les attributs qui contiennent des données contextuelles uniques à chaque objet.\n2.  Laissez les attributs de l’état intrinsèque dans la classe, mais empêchez leur modification. Leur valeur initiale ne doit être modifiable qu’à l’intérieur de leur constructeur.\n    \n3.  Parcourez toutes les méthodes qui utilisent les attributs de l’état extrinsèque. Pour chacun de ces attributs, introduisez un nouveau paramètre que vous utiliserez à la place.\n    \n4.  Il est envisageable de créer une fabrique pour gérer une réserve de poids mouches. Elle devra vérifier l’existence du poids mouche avant d’en créer un nouveau. Une fois que la fabrique est en place, les clients doivent obligatoirement passer par elle pour récupérer des poids mouches. Ils doivent donner une description du poids mouche désiré en passant leur état intrinsèque à la fabrique.\n    \n5.  Le client doit stocker ou calculer les valeurs de l’état extrinsèque (contexte) pour appeler des méthodes du poids mouche. Il est parfois plus pratique de déplacer l’état extrinsèque et l’attribut qui référence le poids mouche dans une classe contexte séparée.\n    \n\n## Avantages et inconvénients\n\n- Vous économisez beaucoup de RAM si votre programme est noyé par des tonnes d’objets similaires.\n\n- Vous allez gagner en RAM mais perdre en cycles microprocesseur (CPU) si les données du contexte sont recalculées lors de chaque appel d’une méthode poids mouche.\n- Le code devient beaucoup plus compliqué. Les développeurs qui rejoignent l’équipe vont se demander pourquoi les états d’une entité ont été séparés de cette manière.\n\n## Liens avec les autres patrons\n\n- Vous pouvez transformer des nœuds de feuilles de l’arbre [Composite](https://refactoring.guru/fr/design-patterns/composite) en [Poids mouches](https://refactoring.guru/fr/design-patterns/flyweight) et les partager pour économiser de la RAM.\n    \n- Le [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight) vous montre comment créer plein de petits objets alors que la [Façade](https://refactoring.guru/fr/design-patterns/facade) permet de créer un seul objet qui représente un sous-système complet.\n    \n- Le [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight) ressemble au [Singleton](https://refactoring.guru/fr/design-patterns/singleton) si vous parvenez à compiler tous les états partagés des objets en un seul objet poids mouche. Mais ces patrons de conception ont deux différences fondamentales :\n    \n    1.  Il ne devrait y avoir qu’une seule instance de singleton, mais une classe *poids mouche* peut avoir plusieurs instances avec différents états intrinsèques.\n    2.  L’objet *singleton* peut être modifiable alors que les objets poids mouche ne sont pas modifiables.\n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_e9d858a84b194c2a9a83a8995e761d29.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/java/example \"Patrons de conception : Poids mouche en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_d3af850393eb4de3897ef5aad8b08946.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/csharp/example \"Patrons de conception : Poids mouche en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_b3a300d3955a4bbe8b3636ecdf3a6416.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/cpp/example \"Patrons de conception : Poids mouche en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_ca79b324daa84ed0b1e30067d7a13a61.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/php/example \"Patrons de conception : Poids mouche en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_3fce858f863d4569be2413296b7e0ecc.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/python/example \"Patrons de conception : Poids mouche en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_31dce1f90c8e4fad86f9f1a7b7f37cb6.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/ruby/example \"Patrons de conception : Poids mouche en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_4594ce3315dc43ceb971e607b9678246.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/swift/example \"Patrons de conception : Poids mouche en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_244579f79b394543ba3a3893c4ee3f2b.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/typescript/example \"Patrons de conception : Poids mouche en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_614216b9b393425c939bdd24b565ad11.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/flyweight/go/example \"Patrons de conception : Poids mouche en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_b5944dfa764a447ba0c5ae013d4.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Procuration](https://refactoring.guru/fr/design-patterns/proxy)\n\n#### Retour\n\n[Façade](https://refactoring.guru/fr/design-patterns/facade)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_1dbea5775c2d4136859b71d03e0475a8.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/flyweight \"English\") [Español](https://refactoring.guru/es/design-patterns/flyweight \"Español\") [Français](https://refactoring.guru/fr/design-patterns/flyweight \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/flyweight \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/flyweight \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/flyweight \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/flyweight \"Українська\") [中文](https://refactoringguru.cn/design-patterns/flyweight \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_3c1a9fd9bb684a378f2ea3f39441e90b.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_43d568f378c24f2ea6adbb5483ce8b91.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n        - [Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)\n        - [Pont](https://refactoring.guru/fr/design-patterns/bridge)\n        - [Composite](https://refactoring.guru/fr/design-patterns/composite)\n        - [Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n        - [Façade](https://refactoring.guru/fr/design-patterns/facade)\n        - [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n        - [Procuration](https://refactoring.guru/fr/design-patterns/proxy)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_75107e158d754e5488a09c5cf96a2c13.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Structurel/Pont":{"title":"Pont / Bridge","content":"\nLe **Pont** permet de séparer une grosse classe ou un ensemble de classes connexes en deux hiérarchies — abstraction et implémentation — qui peuvent évoluer indépendamment l’une de l’autre.\n\n![Patron de conception\u0026nbsp;pont](../../_resources/bridge_6b7231fedc7a44ee8b33d9caa578d0dc.png)\n\n## Problème\n\n*Abstraction ?* *Implémentation ?* Ces termes vous donnent des frissons ? Rassurez-vous, nous allons prendre un exemple simple.\n\nPrenons une classe de `Forme` géométrique avec les sous-classes suivantes : `Cercle` et `Carré`. Vous voulez étendre cette hiérarchie de classes pour incorporer des couleurs, vous créez donc des sous-classes de formes : `Rouge` et `Bleu`. Mais vous avez déjà deux sous-classes, vous devez donc créer quatre combinaisons comme par exemple `CercleBleu` et `CarréRouge`.\n\n![Problème du patron de conception pont](../../_resources/problem-fr_356d24c91a8547fc8b7290e78051ca75.png)\n\nLe nombre de combinaisons augmente exponentiellement.\n\nAjouter de nouvelles formes et couleurs va augmenter la taille de la hiérarchie exponentiellement. Par exemple, pour ajouter une forme triangle, vous devez créer deux nouvelles sous-classes : une par couleur. Ensuite, ajouter une couleur demandera trois nouvelles sous-classes : une pour chaque forme. Si l’on continue ainsi, la situation ne fait qu’empirer.\n\n## Solution\n\nNous rencontrons ce problème, car nous essayons d’étendre les classes forme dans deux dimensions indépendantes : la forme et la couleur. C’est un problème classique causé par l’héritage.\n\nLe pont tente de résoudre ce problème en utilisant la composition à la place de l’héritage. Pour ce faire, vous insérez une des dimensions dans une hiérarchie de classes séparée afin que la classe originale puisse référencer un objet de cette nouvelle hiérarchie, plutôt que de réunir tous les états et comportements à l’intérieur d’une même classe.\n\n\u003cimg width=\"460\" height=\"0\" src=\"../../_resources/solution-fr_2dd2bd307d7a49238a90cc8a5c3f5b94.png\"/\u003e\n\nVous évitez l’explosion de la hiérarchie de classes en la transformant en plusieurs hiérarchies connexes.\n\nNous allons appliquer ce procédé et récupérer le code concernant les couleurs dans sa propre classe avec deux sous-classes : `Rouge` et `Bleu`. La classe `Forme` est ensuite dotée d’un attribut qui référence l’un des objets couleur. La forme peut maintenant déléguer tous les traitements concernant la couleur de l’objet. Cette référence agira comme un pont entre les classes `Forme` et `Couleur`. Dorénavant, l’ajout de nouvelles couleurs ne bouleversera plus la hiérarchie des formes et inversement.\n\n#### Abstraction et implémentation\n\nLe livre du GoF  ajoute les termes *abstraction* et *implémentation* à la définition du pont. Trop académiques, ces termes rendent le patron plus compliqué qu’il ne l’est en réalité. En gardant en tête l’exemple avec les formes et couleurs, déchiffrons la signification de ces termes barbares.\n\nL’*abstraction* (aussi appelée *interface*) est une couche de contrôle de haut niveau pour une entité. Cette couche n’est pas censée effectuer de traitements toute seule. Elle doit déléguer le travail à la couche *implémentation* (appelée également *plateforme*).\n\nNotez bien qu’il ne s’agit pas des *interfaces* ou des *classes abstraites* d’un langage de programmation.\n\nSi l’on prend un logiciel comme exemple concret, l’interface utilisateur graphique (GUI) prend le rôle de l’abstraction et le code du système d’exploitation (API) prend le rôle de l’implémentation que la couche GUI appelle en réponse aux interactions de l’utilisateur.\n\nD’une manière générale, vous pouvez développer un tel programme en deux parties indépendantes :\n\n- Disposer de plusieurs GUI différentes (on lance celle qui est adaptée à l’utilisateur, client ou admin).\n- Gérer plusieurs API différentes (pouvoir exécuter l’application sous Windows, Linux et macOS).\n\nDans le pire des cas, cette application pourrait ressembler à un énorme plat de spaghettis avec des centaines de conditions connectant différents types de GUI et d’API, réparties un peu partout à travers le code.\n\n\u003cimg width=\"600\" height=\"0\" src=\"../../_resources/bridge-3-fr_e243489ee97244ad80548abf97cad453.png\"/\u003e\n\nLa moindre modification dans une architecture monolithique peut se révéler compliquée, car vous devez comprendre *la totalité du code*. Vous pouvez facilement effectuer des modifications dans de plus petits modules bien définis.\n\nVous pouvez mettre de l’ordre dans ce chaos en rangeant le code concernant les combinaisons spécifiques de l’interface/plateforme dans des classes séparées, mais vous découvrirez rapidement que ces classes sont *nombreuses*. La hiérarchie des classes croît rapidement, car l’ajout d’une nouvelle GUI ou l’intégration d’une nouvelle API requièrent la création de classes supplémentaires.\n\nTentons de résoudre ce problème avec le pont. Il nous propose de mettre les classes dans deux hiérarchies :\n\n- Abstraction : la couche GUI de l’application.\n- Implémentation : les API des systèmes d’exploitation.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/bridge-2-fr_21db5a43d2d944e5ba4615554cc2aa7b.png\"/\u003e\n\nUne des techniques pour organiser une application multiplateforme.\n\nL’objet abstraction contrôle l’apparence de l’application et délègue la partie métier à l’objet d’implémentation correspondant. Les implémentations sont interchangeables tant qu’elles implémentent la même interface, ce qui permet à la même GUI de fonctionner aussi bien sous Windows que sous Linux.\n\nGrâce à cela, vous pouvez modifier les classes de la GUI sans toucher aux classes des API. De plus, adapter le code pour gérer un autre système d’exploitation ne requiert que l’ajout d’une sous-classe dans la hiérarchie de l’implémentation.\n\n## Structure\n\n\u003cimg width=\"560\" height=\"0\" src=\"../../_resources/structure-fr_dd8cf234254848ce8a937ca78c264f1d.png\"/\u003e\n\n1.  L’**Abstraction** offre une logique de contrôle de haut niveau. Elle compte sur l’objet de l’implémentation pour s’occuper des tâches de bas niveau.\n    \n2.  L’**Implémentation** déclare une interface commune pour toutes les implémentations concrètes. L’abstraction ne peut communiquer avec les objets de l’implémentation que grâce aux méthodes qui y sont déclarées.\n    \n    L’abstraction peut contenir les mêmes méthodes que l’implémentation, mais en général l’abstraction déclare des comportements complexes qui reposent sur une grande variété d’opérations primitives déclarées par l’implémentation.\n    \n3.  Les **Implémentations Concrètes** contiennent du code spécialisé pour les plateformes.\n    \n4.  L’**Abstraction Fine** procure des variantes pour la logique de contrôle. Tout comme leur parent, elles travaillent avec différentes implémentations en passant par l’interface d’implémentation principale.\n    \n5.  En général, le **Client** ne veut interagir qu’avec l’abstraction, mais c’est son rôle de faire correspondre l’objet d’abstraction avec un des objets d’implémentation.\n    \n\n## Pseudo-code\n\nCet exemple montre comment le **Pont** aide à diviser le code monolithique d’une application qui gère les appareils et leurs télécommandes. Les `Appareils` prennent le rôle de l’implémentation et les `Télécommandes` font office d’abstraction.\n\n\u003cimg width=\"640\" height=\"0\" src=\"../../_resources/example-fr_146a07f1bccb4967bcedf85e633dd453.png\"/\u003e\n\nLa hiérarchie de la classe originale est divisée en deux parties : appareils et télécommandes.\n\nLa classe de base télécommande déclare un attribut de référence qui la lie avec un objet appareil. Toutes les télécommandes utilisent l’interface principale des appareils, ce qui leur permet de fonctionner avec tous les types d’appareils.\n\nVous pouvez faire évoluer les télécommandes indépendamment des appareils, vous devez juste créer une nouvelle sous-classe de télécommande. Par exemple, une télécommande basique pourrait juste avoir deux boutons, mais vous pouvez lui rajouter des fonctionnalités comme une batterie supplémentaire ou un écran tactile.\n\nLe code client établit le lien entre le type de télécommande désiré et un appareil spécifique en passant par le constructeur de la télécommande.\n\n```\n// L’« abstraction » définit l’interface pour la partie\n// « télécommande » des deux hiérarchies de classes. Elle garde\n// une référence sur un objet de la hiérarchie de\n// l’« implémentation » et lui délègue les tâches.\nclass RemoteControl is\n    protected field device: Device\n    constructor RemoteControl(device: Device) is\n        this.device = device\n    method togglePower() is\n        if (device.isEnabled()) then\n            device.disable()\n        else\n            device.enable()\n    method volumeDown() is\n        device.setVolume(device.getVolume() - 10)\n    method volumeUp() is\n        device.setVolume(device.getVolume() + 10)\n    method channelDown() is\n        device.setChannel(device.getChannel() - 1)\n    method channelUp() is\n        device.setChannel(device.getChannel() + 1)\n\n// Vous pouvez étendre les classes de la hiérarchie de\n// l’abstraction indépendamment des classes appareil.\nclass AdvancedRemoteControl extends RemoteControl is\n    method mute() is\n        device.setVolume(0)\n\n// L’interface de l’implémentation déclare les méthodes communes\n// à toutes les classes concrètes de l’implémentation. Elle n’a\n// pas besoin de correspondre à l’interface de l’abstraction. En\n// fait, les deux interfaces peuvent être complètement\n// différentes. En général, l’interface de l’implémentation ne\n// fournit que des opérations primitives, alors que\n// l’abstraction définit des opérations de plus haut niveau\n// basées sur ces primitives.\ninterface Device is\n    method isEnabled()\n    method enable()\n    method disable()\n    method getVolume()\n    method setVolume(percent)\n    method getChannel()\n    method setChannel(channel)\n\n// Tous les appareils suivent la même interface.\nclass Tv implements Device is\n    // ...\n\nclass Radio implements Device is\n    // ...\n\n// Quelque part dans le code client.\ntv = new Tv()\nremote = new RemoteControl(tv)\nremote.togglePower()\n\nradio = new Radio()\nremote = new AdvancedRemoteControl(radio)\n\n```\n\n## Possibilités d’application\n\nUtilisez le pont dans les situations où vous souhaitez diviser et organiser une classe monolithique composée de plusieurs variantes d’une fonctionnalité (par exemple, si la classe fonctionne avec différents serveurs de base de données).\n\nPlus une classe grandit, plus il est difficile de comprendre son fonctionnement et plus les modifications prennent du temps. Les modifications apportées à l’une des variantes de la fonctionnalité vont demander des changements dans toute la classe, ce qui risque de créer des erreurs ou de provoquer des effets de bord critiques.\n\nLe pont vous permet de diviser la classe monolithique en plusieurs hiérarchies de classes. Ensuite, les classes d’une hiérarchie peuvent être modifiées indépendamment des classes des autres hiérarchies. La maintenance du code devient ainsi plus simple et minimise les risques de bugs.\n\nUtilisez le pont si vous voulez étendre une classe dans plusieurs dimensions orthogonales (indépendantes).\n\nLe pont vous propose de construire une hiérarchie de classes séparée pour chaque dimension. La classe d’origine délègue la tâche aux objets de ces hiérarchies plutôt que de tout faire par elle-même.\n\nUtilisez ce patron si vous voulez être en mesure de changer d’implémentation dès le lancement de l’application.\n\nGrâce à ce patron, l’objet de l’implémentation peut être déplacé à l’intérieur de l’abstraction. Cette manipulation n’est pas obligatoire, mais elle est aussi simple à mettre en place que de donner une valeur à un attribut.\n\n*J’en profite pour vous informer que ce dernier point pousse souvent les développeurs à confondre le pont et la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy). Rappelez-vous bien qu’un patron n’est pas seulement une manière de structurer vos classes, c’est aussi un moyen de communiquer votre intention ou de répondre à un problème.*\n\n## Mise en œuvre\n\n1.  Identifiez les dimensions orthogonales de vos classes. Ces concepts indépendants peuvent représenter les couples suivants : abstraction/plateforme, domaine/infrastructure, front-end/back-end, interface/implémentation.\n    \n2.  Déterminez les opérations que le client veut utiliser et définissez-les dans la classe d’abstraction de base.\n    \n3.  Établissez la liste des opérations disponibles sur toutes les plateformes. L’abstraction a besoin de certaines de ces opérations : déclarez-les dans l’interface de l’implémentation principale.\n    \n4.  Créez des classes d’implémentations concrètes pour chaque plateforme de votre domaine, et assurez-vous qu’elles implémentent l’interface de l’implémentation.\n    \n5.  Ajoutez un attribut de référence pour le type de l’implémentation à l’intérieur de la classe abstraction. Cette dernière délègue la majorité des tâches à l’objet implémentation référencé dans cet attribut.\n    \n6.  Si vous avez plusieurs variantes de logique de haut niveau, créez des abstractions fines pour chacune d’entre elles en étendant la classe de base abstraction.\n    \n7.  Le code client doit en principe passer un objet d’implémentation au constructeur de l’abstraction afin d’associer les deux. Ensuite, le client n’a plus besoin de s’occuper de l’implémentation et peut se contenter de travailler uniquement avec l’abstraction.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez créer des classes et des applications multiplateformes.\n- Le code client manipule des abstractions de haut niveau. Il n’est pas dépendant des détails de la plateforme.\n- *Principe ouvert/fermé*. Vous pouvez introduire de nouvelles abstractions et implémentations indépendamment les unes des autres.\n- *Principe de responsabilité unique*. Vous pouvez vous concentrer sur la logique de haut niveau dans l’abstraction, et sur les détails de la plateforme dans l’implémentation.\n\n- Le code va devenir plus compliqué si vous introduisez ce patron dans une classe très cohésive.\n\n## Liens avec les autres patrons\n\n- Le [Pont](https://refactoring.guru/fr/design-patterns/bridge) est habituellement mis en place durant la conception, ce qui vous permet de développer les différentes parties de l’application indépendamment. L’[adaptateur](https://refactoring.guru/fr/design-patterns/adapter \"Adaptateur\") quant à lui est plus souvent utilisé dans une application existante pour permettre à des classes normalement incompatibles de fonctionner ensemble.\n    \n- Le [Pont](https://refactoring.guru/fr/design-patterns/bridge), l’[État](https://refactoring.guru/fr/design-patterns/state), la [Stratégie](https://refactoring.guru/fr/design-patterns/strategy) (et dans une certaine mesure l’[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)) ont des structures très similaires. En effet, ces patrons sont basés sur la composition, qui délègue les tâches aux autres objets. Cependant, ils résolvent différents problèmes. Un patron n’est pas juste une recette qui vous aide à structurer votre code d’une certaine manière. C’est aussi une façon de communiquer aux autres développeurs le problème qu’il résout.\n    \n- Vous pouvez utiliser la [Fabrique abstraite](https://refactoring.guru/fr/design-patterns/abstract-factory) avec le [Pont](https://refactoring.guru/fr/design-patterns/bridge). Ce couple est très utile quand les abstractions définies par le *pont* ne fonctionnent qu’avec certaines implémentations spécifiques. Dans ce cas, la *fabrique abstraite* peut encapsuler ces relations et cacher la complexité au code client.\n    \n- Vous pouvez combiner le [Monteur](https://refactoring.guru/fr/design-patterns/builder) avec le [Pont](https://refactoring.guru/fr/design-patterns/bridge) : la classe directeur joue le rôle de l’abstraction, et les différents *monteurs* prennent le rôle des implémentations.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_88284675f6634983b71c9628038ef7d0.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/java/example \"Patrons de conception : Pont en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_75fec7f33720407f866a0f567be81fbe.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/csharp/example \"Patrons de conception : Pont en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_9ad5e3b4218f462883a58ec3b839c79a.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/cpp/example \"Patrons de conception : Pont en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_1c82a291f8734842a7dc11981fbe9fe2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/php/example \"Patrons de conception : Pont en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_41dcd88a6c774309b0fd54b8e92908cc.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/python/example \"Patrons de conception : Pont en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_21ff54f4b971456391669609a4314bda.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/ruby/example \"Patrons de conception : Pont en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_a648cd40c45946bab53c25afc2f37b11.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/swift/example \"Patrons de conception : Pont en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_6f99c29af76046a0b7a2a9d99e9906f9.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/typescript/example \"Patrons de conception : Pont en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_d411a44255c44bc18d460e491f50f8ae.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/bridge/go/example \"Patrons de conception : Pont en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_d73bc764a22842d190ea5abe8a7.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Composite](https://refactoring.guru/fr/design-patterns/composite)\n\n#### Retour\n\n[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_3a62d04615d94f1b818d3b62c3c84ed2.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/bridge \"English\") [Español](https://refactoring.guru/es/design-patterns/bridge \"Español\") [Français](https://refactoring.guru/fr/design-patterns/bridge \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/bridge \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/bridge \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/bridge \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/bridge \"Українська\") [中文](https://refactoringguru.cn/design-patterns/bridge \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_37fdb4217d414c6e832ce290b6e755f8.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_66a2aac616d0459d86ae9e809c23f5a4.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n        - [Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)\n        - [Pont](https://refactoring.guru/fr/design-patterns/bridge)\n        - [Composite](https://refactoring.guru/fr/design-patterns/composite)\n        - [Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n        - [Façade](https://refactoring.guru/fr/design-patterns/facade)\n        - [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n        - [Procuration](https://refactoring.guru/fr/design-patterns/proxy)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_d1ba702091d945298b65695c602e6d2d.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Structurel/Procuration":{"title":"Procuration / Proxy","content":"\nLa **Procuration** qui vous permet d’utiliser un substitut pour un objet. Elle donne le contrôle sur l’objet original, vous permettant d’effectuer des manipulations avant ou après que la demande ne lui parvienne.\n\n![Patron de conception\u0026nbsp;procuration](../../_resources/proxy_8bec69d3da76480da2d3e7595a0dd136.png)\n\n## Problème\n\nPourquoi vouloir maîtriser l’accès à un objet ? Voici un exemple : vous avez un énorme objet qui consomme beaucoup de ressources, mais vous n’en avez besoin que de temps en temps.\n\n![Problème résolu grâce au patron de conception procuration](../../_resources/problem-fr_4516c5a9474b418cb15ebc4ea43160bb.png)\n\nLes requêtes sur la base de données sont parfois très lentes.\n\nVous pouvez recourir à l’instanciation paresseuse : créer l’objet uniquement lorsque vous en avez besoin. Vous devrez implémenter une initialisation différée dans tous les clients pour l’objet concerné. Malheureusement, vous allez vous retrouver avec beaucoup de code dupliqué.\n\nDans le meilleur des mondes, nous voudrions mettre ce code directement dans la classe de l’objet, mais ce n’est pas toujours possible. La classe pourrait par exemple faire partie d’une application externe non modifiable.\n\n## Solution\n\nCe patron de conception vous propose de créer une classe procuration qui a la même interface que l’objet du service original. Vous passez ensuite l’objet procuration à tous les clients de l’objet original. Lors de la réception d’une demande d’un client, la procuration crée l’objet du service original et lui délègue la tâche.\n\n\u003cimg width=\"510\" height=\"0\" src=\"../../_resources/solution-fr_d108a79cf5f0490d9ebed8f7e2bfa2d3.png\"/\u003e\n\nLa procuration se déguise en objet base de données. Elle peut gérer l’instanciation paresseuse et mettre en cache le résultat sans que le client ou que l’objet de la base de données ne le remarque.\n\nMais quel est son intérêt ? Si vous voulez lancer un traitement avant ou après avoir appliqué la logique principale de la classe, la procuration peut intervenir sans modifier cette dernière. Elle implémente la même interface que la classe originale, et peut donc être passée en paramètre à n’importe quel client qui attend l’objet du service original.\n\n## Analogie\n\n\u003cimg width=\"540\" height=\"0\" src=\"../../_resources/live-example_9e4ab5179b8f478297bf488e9c063341.png\"/\u003e\n\nUne carte de crédit peut être utilisée au même titre que de l’argent liquide.\n\nUne carte de crédit est une procuration pour un compte bancaire, qui est une procuration pour une liasse de billets. Ils implémentent la même interface : tous deux peuvent être utilisés pour effectuer un paiement. Le consommateur apprécie grandement, car il n’a pas besoin de garder une grosse somme en liquide sur lui. Le commerçant est également très heureux, car les transactions sont versées électroniquement vers son compte en banque, sans courir le risque d’égarer son dépôt ou de se le faire voler sur le chemin de la banque.\n\n## Structure\n\n\u003cimg width=\"370\" height=\"0\" src=\"../../_resources/structure_7ec857c0c80941b8af769751a190a5dc.png\"/\u003e\n\n1.  L’**Interface Service** déclare l’interface du service. La procuration doit implémenter cette interface afin de pouvoir se déguiser en objet du service.\n    \n2.  Le **Service** est une classe qui fournit la logique métier dont vous voulez vous servir.\n    \n3.  La **Procuration** est une classe dotée d’un attribut qui pointe vers un objet service. Une fois que la procuration a lancé tous ses traitements (instanciation paresseuse, historisation des logs, vérification des droits, mise en cache, etc.), elle envoie la demande à l’objet du service.\n    \n    En général, les procurations gèrent le cycle de vie de leurs objets service.\n    \n4.  Le **Client** passe par la même interface pour travailler avec les services et les procurations. Il est ainsi possible de passer une procuration à n’importe quel code qui attend un objet service.\n    \n\n## Pseudo-code\n\nL’exemple suivant montre comment le patron de conception **Procuration** nous aide à utiliser l’instanciation paresseuse et la mise en cache pour intégrer une librairie YouTube externe.\n\n\u003cimg width=\"490\" height=\"0\" src=\"../../_resources/example_d6dd498295c04089bc59f6341952feb2.png\"/\u003e\n\nRésultats obtenus pour la mise en cache d’un service à l’aide d’une procuration.\n\nLa librairie nous fournit une classe pour télécharger des vidéos. Malheureusement, elle n’est pas très efficace. Si l’application client demande une même vidéo à plusieurs reprises, la librairie va la télécharger encore et encore, plutôt que de la mettre en cache après la première utilisation.\n\nLa classe procuration implémente la même interface que l’outil de téléchargement original et délègue tout le travail à ce dernier. En revanche, elle garde la trace de tous les fichiers téléchargés et retourne les données du cache lorsque l’application fait plusieurs fois appel à la même vidéo.\n\n```\n// L’interface d’un service distant\ninterface ThirdPartyYouTubeLib is\n    method listVideos()\n    method getVideoInfo(id)\n    method downloadVideo(id)\n\n// La méthode d’implémentation concrète d’un connecteur de\n// service. Les méthodes de cette classe peuvent demander des\n// informations à YouTube. La vitesse de la demande dépend de la\n// connexion Internet de l’utilisateur, ainsi que de celle de\n// YouTube. L’application sera plus lente si plusieurs demandes\n// sont envoyées en même temps, même si elles recherchent les\n// mêmes informations.\nclass ThirdPartyYouTubeClass implements ThirdPartyYouTubeLib is\n    method listVideos() is\n        // Envoie une demande via une API à YouTube.\n\n    method getVideoInfo(id) is\n        // Récupère les métadonnées d’une vidéo.\n\n    method downloadVideo(id) is\n        // Télécharge un fichier vidéo sur YouTube.\n\n// Pour économiser de la bande passante, nous pouvons mettre en\n// cache les résultats des demandes et les mettre de côté\n// temporairement. Mais vous n’allez pas forcément pouvoir\n// écrire ce code directement dans la classe du service. Elle\n// pourrait provenir d’une librairie externe ou avoir été\n// définie comme `final`. Pour cette raison, nous écrivons le\n// code de la mise en cache dans une nouvelle classe procuration\n// qui implémente la même interface que la classe du service.\n// Elle délègue les tâches à l’objet du service lorsque les\n// demandes doivent vraiment être envoyées.\nclass CachedYouTubeClass implements ThirdPartyYouTubeLib is\n    private field service: ThirdPartyYouTubeLib\n    private field listCache, videoCache\n    field needReset\n\n    constructor CachedYouTubeClass(service: ThirdPartyYouTubeLib) is\n        this.service = service\n\n    method listVideos() is\n        if (listCache == null || needReset)\n            listCache = service.listVideos()\n        return listCache\n\n    method getVideoInfo(id) is\n        if (videoCache == null || needReset)\n            videoCache = service.getVideoInfo(id)\n        return videoCache\n\n    method downloadVideo(id) is\n        if (!downloadExists(id) || needReset)\n            service.downloadVideo(id)\n\n// La classe GUI qui fonctionnait auparavant avec un objet\n// Service n’a pas besoin d’être modifiée tant qu’elle interagit\n// avec lui par le biais d’une interface. Nous pouvons passer en\n// toute sécurité un objet procuration à la place d’un objet du\n// service, car ils implémentent la même interface.\nclass YouTubeManager is\n    protected field service: ThirdPartyYouTubeLib\n\n    constructor YouTubeManager(service: ThirdPartyYouTubeLib) is\n        this.service = service\n\n    method renderVideoPage(id) is\n        info = service.getVideoInfo(id)\n        // Affiche la page de la vidéo.\n\n    method renderListPanel() is\n        list = service.listVideos()\n        // Affiche la liste des miniatures des vidéos.\n\n    method reactOnUserInput() is\n        renderVideoPage()\n        renderListPanel()\n\n// L’application peut configurer les procurations à la volée.\nclass Application is\n    method init() is\n        aYouTubeService = new ThirdPartyYouTubeClass()\n        aYouTubeProxy = new CachedYouTubeClass(aYouTubeService)\n        manager = new YouTubeManager(aYouTubeProxy)\n        manager.reactOnUserInput()\n\n```\n\n## Possibilités d’application\n\nLa procuration possède de nombreux usages. Passons en revue les plus populaires.\n\nInstanciation paresseuse (procuration virtuelle). À utiliser lorsque l’objet du service est très consommateur en ressources système car il est actif en permanence, mais vous n’en avez pas tout le temps besoin.\n\nVous pouvez différer l’initialisation de l’objet plutôt que de le créer au lancement de l’application.\n\nVérification des droits (procuration de protection). Si vous avez besoin de limiter l’accès de vos clients à l’objet du service, par exemple si vos objets sont des parties cruciales d’un système d’exploitation et que les clients sont différentes applications lancées (dont certaines sont malveillantes).\n\nLa procuration peut ne transmettre une demande à l’objet du service que si les identifiants du client remplissent certains critères.\n\nLancement local d’un service distant (procuration à distance). L’objet du service se situe sur un serveur distant.\n\nDans ce cas, la procuration envoie la demande par le réseau en s’occupant de gérer tous les détails compliqués de la gestion du réseau.\n\nDemande de logs (procuration de logs). Pour garder un historique des demandes passées auprès de l’objet du service.\n\nLa procuration peut garder la trace de toutes les demandes passées au service.\n\nMettre en cache les résultats des demandes (procuration de cache). Si vous voulez mettre en cache les résultats des demandes faites au client et gérer le cycle de vie de ce cache, principalement lorsque les résultats sont imposants.\n\nLa procuration peut gérer la mise en cache des demandes récurrentes qui retournent toujours le même résultat. Les paramètres des demandes peuvent servir de clé.\n\nRéférencement intelligent. Si vous voulez vous débarrasser d’un objet très consommateur en ressources lorsqu’aucun client ne l’utilise.\n\nLa procuration peut garder la trace des clients qui ont récupéré une référence vers l’objet du service ou vers ses résultats. De temps en temps, la procuration peut faire le tour des clients et vérifier s’ils sont toujours actifs. Si la liste des clients est vide, la procuration peut supprimer l’objet du service afin de libérer des ressources.\n\nElle peut également savoir si le client avait modifié l’objet du service. Les objets non modifiés peuvent ensuite être réutilisés par les autres clients.\n\n## Mise en œuvre\n\n1.  Si le service n’a pas encore d’interface, créez-en une pour rendre la procuration et les objets du service interchangeables. Il n’est pas toujours possible d’extraire l’interface de la classe du service, car vous devez effectuer des modifications pour que tous les clients du service utilisent cette interface. Heureusement, nous avons un plan B. Transformez la procuration en sous-classe de la classe service, afin qu’elle hérite de l’interface du service.\n    \n2.  Créez la classe procuration. Elle doit inclure un attribut qui stocke la référence au service. En général, les procurations créent et gèrent le cycle de vie de leurs services. En de rares occasions, un service est passé à la procuration par le biais d’un constructeur du client.\n    \n3.  Mettez en place les méthodes de la procuration et leur fonctionnement. Dans la plupart des cas, la procuration doit déléguer le travail à l’objet du service après avoir lancé ses traitements.\n    \n4.  Réfléchissez à l’implémentation d’une méthode de création qui décide si votre client doit utiliser directement le service ou passer par la procuration. Il peut s’agir d’une méthode statique toute simple ou d’une classe procuration avec une méthode fabrique complète.\n    \n5.  Envisagez également l’implémentation d’une instanciation paresseuse pour l’objet du service.\n    \n\n## Avantages et inconvénients\n\n- Vous pouvez contrôler l’objet du service sans que le client ne s’en aperçoive.\n- Vous pouvez gérer le cycle de vie de l’objet du service si les clients ne s’en occupent pas.\n- La procuration fonctionne même si l’objet du service n’est pas prêt ou pas disponible.\n- *Principe ouvert/fermé*. Vous pouvez ajouter de nouvelles procurations sans toucher au service ou aux clients.\n\n- Le code peut devenir plus complexe puisque vous devez y introduire de nombreuses classes.\n- La réponse du service peut mettre plus de temps à arriver.\n\n## Liens avec les autres patrons\n\n- L’[Adaptateur](https://refactoring.guru/fr/design-patterns/adapter) procure une interface différente à l’objet emballé, la [Procuration](https://refactoring.guru/fr/design-patterns/proxy) lui fournit la même interface et le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) lui met à disposition une interface améliorée.\n    \n- La [Façade](https://refactoring.guru/fr/design-patterns/facade) et la [Procuration](https://refactoring.guru/fr/design-patterns/proxy) ont une similarité : ils mettent en tampon une entité complexe et l’initialisent individuellement. Contrairement à la *façade*, la *procuration* implémente la même interface que son objet service, ce qui les rend interchangeables.\n    \n- Le [Décorateur](https://refactoring.guru/fr/design-patterns/decorator) et la [Procuration](https://refactoring.guru/fr/design-patterns/proxy) ont des structures similaires, mais des intentions différentes. Ces deux patrons sont bâtis sur le principe de la composition, où un objet est censé déléguer certains traitements à un autre. La différence est qu’en principe, la *procuration* gère elle-même le cycle de vie de son objet service, alors que la composition des *décorateurs* est toujours contrôlée par le client.\n    \n\n## Exemples de code\n\n[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/java_a0eb42f5aebc48258309a769bd3f2ca8.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/java/example \"Patrons de conception : Procuration en Java\") [\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/csharp_f77b5e322a7a4c45bad3ce31c72ce495.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/csharp/example \"Patrons de conception : Procuration en C#\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/cpp_fb7eaa54ec944f68b19b6f01db34d95f.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/cpp/example \"Patrons de conception : Procuration en C++\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/php_66efd986b0f74c009b4526e2dd8e97e2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/php/example \"Patrons de conception : Procuration en PHP\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/python_b5ac4f08505047139db5727df5ad4b41.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/python/example \"Patrons de conception : Procuration en Python\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/ruby_efbb5e27b6f44d13a093639471f4fa94.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/ruby/example \"Patrons de conception : Procuration en Ruby\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/swift_b7df4c4b325f4b8da153de520e4f1fc2.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/swift/example \"Patrons de conception : Procuration en Swift\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/typescript_931dfe2231594fe099522d266bbe80c7.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/typescript/example \"Patrons de conception : Procuration en TypeScript\")[\u003cimg width=\"43\" height=\"56\" src=\"../../_resources/go_6ac91ff300584d2b910e5f723d5eb211.svg\"/\u003e](https://refactoring.guru/fr/design-patterns/proxy/go/example \"Patrons de conception : Procuration en Go\")\n\n[\u003cimg width=\"200\" height=\"200\" src=\"../../_resources/patterns-book-banner-3_6aaf8bfa7dfc4b79989512b18a2.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\n### Soutenez notre site gratuit et obtenez l’ebook !\n\n- 22 patrons de conception et 8 principes expliqués en profondeur.\n- 444 pages de vulgarisation, bien structurées et faciles à lire.\n- 225 illustrations et diagrammes clairs pour aider à la compréhension.\n- Une archive avec des exemples de code dans 9 langages.\n- Tous les appareils sont pris en charge : formats PDF/EPUB/MOBI/KFX.\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\n#### Suivant\n\n[Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n\n#### Retour\n\n[Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n\n[\u003cimg width=\"245\" height=\"375\" src=\"../../_resources/web-cover-fr_8732287de86e489a9a66f92c20e1acbe.png\"/\u003e](https://refactoring.guru/fr/design-patterns/book)\n\nCet article est tiré de notre ebook\n**Plongée au cœur des\nPATRONS DE CONCEPTION**\n\n[En savoir plus…](https://refactoring.guru/fr/design-patterns/book)\n\nFacebook\n\nTwitter\n\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true \"Nous contacter\")\n- [Connexion](https://refactoring.guru/fr/login \"Connexion\")\n\n[English](https://refactoring.guru/design-patterns/proxy \"English\") [Español](https://refactoring.guru/es/design-patterns/proxy \"Español\") [Français](https://refactoring.guru/fr/design-patterns/proxy \"Français\") [Polski](https://refactoring.guru/pl/design-patterns/proxy \"Polski\") [Português-Br](https://refactoring.guru/pt-br/design-patterns/proxy \"Português Brasileiro\") [Русский](https://refactoring.guru/ru/design-patterns/proxy \"Русский\") [Українська](https://refactoring.guru/uk/design-patterns/proxy \"Українська\") [中文](https://refactoringguru.cn/design-patterns/proxy \"中文\")\n\n[![Refactoring.Guru](../../_resources/logo-covid-winter_859d0ab064004adeafcbffedc354ade3.png)](https://refactoring.guru/fr)\n\n![](../../_resources/winter-hat_a1e60a23c42c4a59be2f8b6a407293ff.png)\n\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n    - [Introduction](https://refactoring.guru/fr/design-patterns/what-is-pattern)\n    - [Catalogue](https://refactoring.guru/fr/design-patterns/catalog)\n    - [Patrons de création](https://refactoring.guru/fr/design-patterns/creational-patterns)\n    - [Patrons structurels](https://refactoring.guru/fr/design-patterns/structural-patterns)\n        - [Adaptateur](https://refactoring.guru/fr/design-patterns/adapter)\n        - [Pont](https://refactoring.guru/fr/design-patterns/bridge)\n        - [Composite](https://refactoring.guru/fr/design-patterns/composite)\n        - [Décorateur](https://refactoring.guru/fr/design-patterns/decorator)\n        - [Façade](https://refactoring.guru/fr/design-patterns/facade)\n        - [Poids mouche](https://refactoring.guru/fr/design-patterns/flyweight)\n        - [Procuration](https://refactoring.guru/fr/design-patterns/proxy)\n    - [Patrons comportementaux](https://refactoring.guru/fr/design-patterns/behavioral-patterns)\n    - [Exemples de code](https://refactoring.guru/fr/design-patterns/examples)\n- [Refactorisation (commenter bientôt)](https://refactoring.guru/fr/refactoring)\n\n[Connexion](https://refactoring.guru/fr/login \"Connexion\") [Nous contacter](https://feedback.refactoring.guru/?lang=en \"Commentaires\")\n\n- [Accueil](https://refactoring.guru/fr)\n- [Refactorisation](https://refactoring.guru/fr/refactoring)\n- [Patrons de conception](https://refactoring.guru/fr/design-patterns)\n- [Contenu premium](https://refactoring.guru/fr/store)\n- [Forum](https://feedback.refactoring.guru/?lang=en)\n- [Nous contacter](https://feedback.refactoring.guru/?lang=en\u0026show_feedback_form_private=true)\n\n2014-2021 [Refactoring.Guru](https://refactoring.guru/fr). Tous droits réservés.\n ![Organization address](../../_resources/fa-building_87bf62543bf64cdc9482b81a7c692725.svg) Khmelnitske shosse 19 / 27, Kamianets-Podilskyi, Ukraine, 32305\nEmail: support@refactoring.guru\n\nIllustrations par [Dmitry Zhart](http://zhart.us/)\n\n- [Termes et conditions](https://refactoring.guru/fr/terms)\n- [Politique de protection de la vie privée](https://refactoring.guru/fr/privacy-policy)\n- [Politique de l’utilisation des données](https://refactoring.guru/fr/content-usage-policy)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Architecture/Design_Pattern/Structurel/Sommaire":{"title":"","content":"| notebook | image | excerpt |\n\n| --- | --- | --- |\n\n|🏦Structurel|![](../_resources/composite_9d0fd2b82f3248b2a4bbbe88c8faff48.png)|[Composite](Architecture/Design_Pattern/Structurel/Composite.md) permet d’agencer les objets dans des arborescences afin de pouvoir traiter celles-ci comme des objets individuels. Problème L’utilisation de ce patron doit être réservée aux applications don...|\n\n|🏦Structurel|![Patron de conception\u0026nbsp;décorateur](../_resources/decorator_c5817e96250547319197fdb249dc05f0.png)|[Décorateur](Architecture/Design_Pattern/Structurel/Decorateur.md) permet d’affecter dynamiquement de nouveaux comportements à des objets en les plaçant dans des emballeurs qui implémentent ces comportements. Problème Imaginez que vous travaillez sur une l...|\n\n|🏦Structurel|![](../_resources/facade_143c03590f2741a487e911c4f5b00333.png)|[Façade](Architecture/Design_Pattern/Structurel/Façade.md) procure une interface offrant un accès simplifié à une librairie, un framework ou à n’importe quel ensemble complexe de classes. Problème Imaginez que vous devez adapter votre code pour manipul...|\n\n|🏦Structurel|![](../_resources/bridge_6b7231fedc7a44ee8b33d9caa578d0dc.png)|[Pont](Architecture/Design_Pattern/Structurel/Pont.md) permet de séparer une grosse classe ou un ensemble de classes connexes en deux hiérarchies — abstraction et implémentation — qui peuvent évoluer indépendamment l’une de l’autre. Problème Abstr...|\n\n|🏦Structurel|![](../_resources/proxy_8bec69d3da76480da2d3e7595a0dd136.png)|[Procuration](Architecture/Design_Pattern/Structurel/Procuration.md) qui vous permet d’utiliser un substitut pour un objet. Elle donne le contrôle sur l’objet original, vous permettant d’effectuer des manipulations avant ou après que la demande ne lui pa...|\n\n|🏦Structurel|![](../_resources/flyweight_c8bc40aa58304950869a45a83a3e9bc0.png)|[Poids_mouche](Architecture/Design_Pattern/Structurel/Poids_mouche.md) est un patron de conception structurel qui permet de stocker plus d’objets dans la RAM en partageant les états similaires entre de multiples objets, plutôt que de stocker les données dans...|\n\n|👀Behavioral|![](../_resources/chain-of-responsibility_e3977af6b53c43cb91ac291e68.png)|[Chaîne_de_responsabilité](Architecture/Design_Pattern/Behavioral/Chaine_de_responsabilite.md) permet de faire circuler des demandes dans une chaîne de handlers. Lorsqu’un handler reçoit une demande, il décide de la traiter ou de l’envoyer au handler suivant de la chaîn...|\n","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Datas":{"title":"","content":"[Generative vs Discriminative](MLIA/Generative%20vs%20Discriminative.md)  \n\n[[Apprentissage supervisé]]\n\n\n[Apprentissage non-supervisé](Apprentissage%20non-supervisé.md)  \n\n[[Stats]] \n\n[[Reduction de dimension]]  \n\n[[MLIA/Réduction_dimension/Introduction]]","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Links":{"title":"","content":"# Usefull links\n-   [http://cs229.stanford.edu/summer2019/cs229-notes1.pdf](http://cs229.stanford.edu/summer2019/cs229-notes1.pdf)\n    \n-   [http://cs229.stanford.edu/summer2019/cs229-notes2.pdf](http://cs229.stanford.edu/summer2019/cs229-notes2.pdf)\n    \n-   [http://cs229.stanford.edu/summer2019/cs229-notes3.pdf](http://cs229.stanford.edu/summer2019/cs229-notes3.pdf)\n    \n-   [http://cs229.stanford.edu/summer2019/cs229-notes4.pdf](http://cs229.stanford.edu/summer2019/cs229-notes4.pdf)\n    \n-   [http://cs229.stanford.edu/summer2019/cs229-notes5.pdf](http://cs229.stanford.edu/summer2019/cs229-notes5.pdf)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Classification/Bayes":{"title":"","content":"# Bayes Law\n$$\n\\underbrace{\\mathbb{P}(Y \\mid X)}_{\\text {Posterior probability }}=\\frac{\\overbrace{\\mathbb{P}(Y)}^{\\text {Prior probability}} \\cdot \\overbrace{\\mathbb{P}(X \\mid Y)}^{\\text {Likelihood}}}{\\mathbb{P}(X)}\n$$\nthe denominator is given by\n$\\mathbb{P}(X) = {\\mathbb{P}(X|Y=\\mathbf{1})}\\mathbb{P}(Y=1)+{\\mathbb{P}(X|Y=\\mathbf{0})}\\mathbb{P}(Y=0)$  \nthen we don’t actually need to calculate\nthe denominator, since\n$$\n\\begin{aligned}\n\\arg \\max _{y} p(y \\mid x) \u0026=\\arg \\max _{y} \\frac{p(x \\mid y) p(y)}{p(x)} \\\\\n\u0026=\\arg \\max _{y} p(x \\mid y) p(y)\n\\end{aligned}\n$$\n# Naive Bayes\n## Assuptions\n\n### independence assumption\n\n$$\nP(x|y=c)=\\prod\\_{d=1}^D P(x\\_d | y=c)\n$$\n\ni.e., given the label, all features are independent.\n\n### la probabilité $\\mathbb{P}\\left(X^{j}=x^{j} \\mid Y=y\\right)$ suit une loi normale (gaussienne) [Gaussian](MLIA/Stats/Gaussian.md)\n$$\n\\mathbb{P}\\left(X^{j}=x^{j} \\mid Y=y\\right) \\sim \\mathcal{N}\\left(\\mu_{y}^{j}, \\sigma_{y}^{j^{2}}\\right)\n$$\n- la probabilité $\\mathbb{P}\\left(X^{j}=x^{j} \\mid Y=y\\right)$ suit une loi normale (gaussienne) de moyenne $\\mu_{y}^{j}$ et de variance $\\sigma_{y}^{j^{2}}$\n- $\\mu_{y}^{j}\\left(\\sigma_{y}^{j^{2}}\\right)$ est la moyenne (variance) des valeurs prises par les données d'apprentissage appartenant à la classe $y$ pour la $j$-ième variable explicative\n$$\n\\mathbb{P}\\left(X^{j}=x^{j} \\mid Y=y\\right)=\\frac{1}{\\sqrt{2 \\pi} \\cdot \\sigma_{y}^{j}} e^{-\\frac{1}{2 \\sigma_{y}^{j^{2}}}\\left(x^{j}-\\mu_{y}^{j}\\right)^{2}}\n$$\n\n## Prédiction\nPour une nouvelle observation $x$, on prédit sa classe $\\hat{y}$ tel que :\n$$\n\\begin{aligned}\n\\hat{y} \u0026=\\underset{y}{\\operatorname{argmax}} \\mathbb{P}(Y=y \\mid X=\\mathbf{x}) \\\\\n\u0026=\\underset{y}{\\operatorname{argmax}} \\mathbb{P}(Y=y) \\cdot \\prod_{j=1}^{d} \\mathbb{P}\\left(X^{j}=x^{j} \\mid Y=y\\right)\n\\end{aligned}\n$$\n\n# LDA\nAnalyse discriminante linéaire ou Linear Discriminant Analysis (LDA)\n- est un algorithme génératif\n- $\\mathbb{P}(Y=y)=\\frac{m_{y}}{m}$ comme le classifieur bayésien naif\n- $\\mathbb{P}(X=\\mathbf{x} \\mid Y=y)$ est modélisé par une loi de distribution normale multivariée\n$$\n\\begin{aligned}\n\\mathbb{P}(X=\\mathbf{x} \\mid Y=y) \u0026 \\sim \\mathcal{N}\\left(\\boldsymbol{\\mu}_{y}, \\boldsymbol{\\Sigma}\\right) \n\u0026=\\frac{1}{(2 \\pi)^{\\frac{d}{2}}|\\boldsymbol{\\Sigma}|^{\\frac{1}{2}}} e^{-\\frac{1}{2}\\left(\\mathbf{x}-\\boldsymbol{\\mu}_{y}\\right)^{T} \\boldsymbol{\\Sigma}^{-1}\\left(\\mathbf{x}-\\boldsymbol{\\mu}_{y}\\right)}\n\\end{aligned}\n$$\navec\n- $\\boldsymbol{\\mu}_{y} \\in \\mathbb{R}^{d}$ le vecteur moyenne pour les $d$ variables explicatives pour les données d'apprentissage qui appartiennent à la classe $y$\n- $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{d \\times d}$ la matrice de covariance calculée à partir de toutes les données d'apprentissage (indépendamment de leur classe)\n- |. le déterminant\n\n# QDA \nAnalyse discriminante linéaire ou Linear Discriminant Analysis (LDA)\n- est un algorithme génératif\n- $\\mathbb{P}(Y=y)=\\frac{m_{y}}{m}$ comme le classifieur bayésien naif\n- $\\mathbb{P}(X=\\mathbf{x} \\mid Y=y)$ est modélisé par une loi de distribution normale multivariée\n$$\n\\begin{aligned}\n\\mathbb{P}(X=\\mathbf{x} \\mid Y=y) \u0026 \\sim \\mathcal{N}\\left(\\boldsymbol{\\mu}_{y}, \\boldsymbol{\\Sigma}\\right) \\\\\n\u0026=\\frac{1}{(2 \\pi)^{\\frac{d}{2}}|\\boldsymbol{\\Sigma}|^{\\frac{1}{2}}} e^{-\\frac{1}{2}\\left(\\mathbf{x}-\\boldsymbol{\\mu}_{y}\\right)^{T} \\boldsymbol{\\Sigma}^{-1}\\left(\\mathbf{x}-\\boldsymbol{\\mu}_{y}\\right)}\n\\end{aligned}\n$$\navec\n- $\\boldsymbol{\\mu}_{y} \\in \\mathbb{R}^{d}$ le vecteur moyenne pour les $d$ variables explicatives pour les données d'apprentissage qui appartiennent à la classe $y$\n- $\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{d \\times d}$ la matrice de covariance calculée à partir de toutes les données d'apprentissage (indépendamment de leur classe)\n- |. le déterminant\n![](Pasted%20image%2020220704160714.png)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Classification/Evaluation":{"title":"","content":"","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Classification/KNN":{"title":"","content":"","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Clustering/Introduction":{"title":"","content":"Organiser les par groupes.\n$\\left\\{\\mathbf{x}_{i}\\right\\}_{i=1}^{n} \\rightarrow\\left\\{\\hat{y}_{i}\\right\\}_{i=1}^{n}$ \n\t$\\hat{y} \\in \\mathcal{Y}$ représente un cluster \n\n![[Pasted image 20220406111839.png]]\n- k-means ( $k$-moyennes).\n- Mélange de gaussiennes\n- Clustering hiérarchique","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Clustering/Kmeans":{"title":"","content":"# Kmeans\n- centroïde \n\t$\\boldsymbol{\\mu}=\\frac{1}{m} \\sum_{i}^{m} \\mathbf{x}_{i}$\n- inertie $\\mathcal{I}_{T}=\\sum_{\\mathbf{x}_{i}}\\left\\|\\mathbf{x}_{i}-\\boldsymbol{\\mu}\\right\\|^{2}$\n![](https://miro.medium.com/max/700/1*5oS5b3j47zvCe43HuyUiUg.gif)\n\n![[Pasted image 20220406110758.png]]\n## Inertie\nL'inertie $\\mathcal{I}_{T}$ d'un nuage des points est représentée par la distance au carré des points à leur centroïde\n$$\\sum_{\\mathbf{x}_{i}}\\left\\|\\mathbf{x}_{i}-\\boldsymbol{\\mu}\\right\\|^{2}=\\sum_{c=1} m_{c}\\left\\|\\boldsymbol{\\mu}_{c}-\\boldsymbol{\\mu}\\right\\|^{2} \\quad+\\sum_{c=1} \\sum_{\\mathbf{x}_{i} \\mid \\hat{y}_{i}=c}\\left\\|\\mathbf{x}_{i}-\\boldsymbol{\\mu}_{c}\\right\\|^{2}\n$$\n\n**théorème de Huygens** \nInertie totale = Inertie inter-classe + Inertie intra-classe\n$$\\mathcal{I}_{T}=\\mathcal{I}_{B}+\\mathcal{I}_{W}\n$$\n\n## Eviter un minimum local\n## choix du nombre de cluster","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Generative-vs-Discriminative":{"title":"","content":"Generative v.s. Discriminative Models\n[Apprentissage non-supervisé](Apprentissage%20non-supervisé.md)\n## What's Generative or Discriminative model?\n\nLet's say you have input data x and you want to classify the data into labels y. A **generative model** learns the joint probability distribution $$p(x,y)$$ and a **discriminative model** learns the conditional probability distribution $$p(y|x)$$ - which you should read as \"the probability of $y$ given $x$\n\nGenerative algorithms model p(x,y), which can be tranformed into p(y|x) by applying Bayes rule and then used for classification.\n\nThe overall gist is that discriminative models generally outperform generative models in classification tasks.\n\nA generative algorithm models how the data was generated in order to categorize a signal. It asks the question: based on my generation assumptions, which category is most likely to generate this signal? A discriminative algorithm does not care about how the data was generated, it simply categorizes a given signal.\n![](Pasted%20image%2020220704120136.png)\n## Example\n\nLet's say you have input data `x` and you want to classify the data into labels `y`. A generative model learns the **joint** probability distribution `p(x,y)` and a discriminative model learns the **conditional** probability distribution `p(y|x)` - which you should read as _\"the probability of `y` given `x`\"_.\n\nHere's a really simple example. Suppose you have the following data in the form `(x,y)`:\n\n`(1,0), (1,0), (2,0), (2, 1)`\n\n`p(x,y)` is\n\n```\n      y=0   y=1\n     -----------\nx=1 | 1/2   0\nx=2 | 1/4   1/4\n```\n\n`p(y|x)` is\n\n```\n      y=0   y=1\n     -----------\nx=1 | 1     0\nx=2 | 1/2   1/2\n```\n\nIf you take a few minutes to stare at those two matrices, you will understand the difference between the two probability distributions.\n\nThe distribution `p(y|x)` is the natural distribution for classifying a given example `x` into a class `y`, which is why algorithms that model this directly are called discriminative algorithms. Generative algorithms model `p(x,y)`, which can be transformed into `p(y|x)` by applying Bayes rule and then used for classification. However, the distribution `p(x,y)` can also be used for other purposes. For example, you could use `p(x,y)` to _generate_ likely `(x,y)` pairs.\n\nFrom the description above, you might be thinking that generative models are more generally useful and therefore better, but it's not as simple as that. [This paper](http://papers.nips.cc/paper/2020-on-discriminative-vs-generative-classifiers-a-comparison-of-logistic-regression-and-naive-bayes.pdf) is a very popular reference on the subject of discriminative vs. generative classifiers, but it's pretty heavy going. The overall gist is that discriminative models generally outperform generative models in classification tasks.\n\n[1] [https://stackoverflow.com/questions/879432/what-is-the-difference-between-a-generative-and-discriminative-algorithm](https://stackoverflow.com/questions/879432/what-is-the-difference-between-a-generative-and-discriminative-algorithm)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Generative-vs-Discriminative++":{"title":"","content":"### [Note] Variations on supervised and unsupervised Model ?\n - Semi-Supervised Learning:\n   - we have a bunch of pairs (**x**1,**y**1), (**x**2,**y**2), ...(**x**_i,**y**_i), and then we are additionally given more x values such as x_i+1, x_i+2,..up to x_n. Our task is to predict `y_i+1`, `y_i+2`,..up to `y_n`.\n - Reinforcement Learning:\n   - Investigate the \"reward/loss\"(long/short term payoff) associated with a certain action or state..\n### [Note] PGM ?\nIf you are keen on studying generative models and delving deeper into them, I would say concepts and thorough knowledge on Probabilistic graphical models is essential. If your focus is on Discriminative models or planning to use deep learning as a blackbox then you can get away without PGM and its probably not very essential. But if you are planning for a research either in implicit or explicit generative models or especially deep generative models, then I strongly recommend PGM as a course. Its a valuable tool for sure\n\n# Generative VS Discriminative Model\nMachine Learning models can be typically divided into two types. Discriminative and Generative models. Discriminative models deal with classification or categorization of the data, examples include SVMs, linear/logistic regression, CRFs etc. Generative approaches model how the data is generated and various other tasks can be further addressed with this generative information, examples include HMMs, GMM, Boltzman machines. Deep learning models such as DBMs, Variational AutoEncoders are again generative models.\n - __[A]. Generative algorithm:__ learning each structure, and then classifying it using the knowledge you just gained.\n   - A generative model is a statistical model of the joint probability distribution on `P(X,Y)` and Classifiers are computed using probablistic models.\n   - Generative modeling means building a model that can generate new examples that come from the same distribution as the training data (or that can look at an input example and report the likelihood of it being generated by that distribution). This means generative modeling is a kind of unsupervised learning.\n   - A generative algorithm models uses the data to create a **`probabilities`**, and how the data was \"generated\", so you ask it \"what's the likelihood this or that class generated this instance?\" and pick the one with the **better probability**. \n     - Estimate joint probability ### P(Y, X) = P(Y|X)f(X) = f(X|Y)P(Y) \n       - where Y is label(class), `f() is pdf` and `P() is class marginal probability`.\n       - `f(X|Y)P(Y)` : first choose a class, then given the class, we choose(generate) the point X. \n       - P(Y|X)f(X) : first choose the point X, then given the point, we choose a class. This is discriminative though. \n     - Estimates not only probability of labels but also the features\n     - Once model is fit, can be used to generate data, but often works worse, particularly when assumptions are violated\n   - Linear Generative Dimensionality Reduction Algorithm\n     - LDA, QDA, PCA, Naive Bayes, etc.\n   - Nonlinear Generative Dimensionality Reduction Algorithm\n     - AutoEncoder, Variational AutoEncoder, etc.\n   \n - __[B]. Discriminative algorithm:__ determining the difference in the each without learning the structure, and then classifying the data_point.\n   - A discriminative model is a statistical model of the conditional probability distribution on `P(Y|X=x)` and Classifiers computed **without using a probability model** are also referred to loosely as \"discriminative\".\n   - A discriminative algorithm uses the data to create a **`decision boundary`**, so you ask it \"what side of the decision boundary is this instance on?\" So it doesn't create a model of how the data was generated, it makes a model of what it thinks the boundary between classes looks like.\n\nSince **discriminative** cares `P(Y|X)` only, while **generative** cares `P(X,Y) and P(X)` at the same time, in order to predict **P(Y|X)** well, the generative model has **`less degree of freedom`** in the model compared to discriminative model. So generative model is more robust, less prone to overfitting while discriminative is the other way around. So **discriminative models** usually tend to do better if you have `lots of data`; **generative models** may be better if you have some extra `unlabeled or missing data`(the generative model has its own advantages such as the capability of dealing with missing data). \n![](Pasted%20image%2020220704120136.png)\n\n\n\n\n\n\n\n\n\n\n## A\u003e Generative Analysis\n\n---------------------------------------------------------------------------------------------------------------------\n## 1. Linear Discriminant Analysis\n - As a **Supervised method**, labels are used to learn the `data structure` which allows the **classification** of future observations.\n\n# `P(g|x)`\n - Predict the membership of the given vector `x`. \n - We have a dataset containing lots of vector observations(rows) and their labels. \n - What's the probability that the new vector observation `x` belongs to the Grp `g`? (p is the dimension of the vector x).\n - This probabilities come from a certain **likelihood distribution of Grp**(with different parametrization)...in detail, \n \u003cimg src=\"https://user-images.githubusercontent.com/31917400/52278515-2156c280-294f-11e9-9bc2-6e40c4563b8f.jpg\" /\u003e\n\n - So let's figure out the Likelihood distribution `P(x|g)`. This is the distribution of data points in each group. If we know the **distribution of x in each Grp: `P(x|g)`**, we can classify the new p-dimensional data points given in the future...so done and dusted. What if choosing the Grp_feature distribution `P(x|g)` as **multivariate Gaussian** ? (Of course, in the multivariate version, `µ` is a mean vector and σ is replaced by a covariance matrix `Σ`).\n \u003cimg src=\"https://user-images.githubusercontent.com/31917400/52270233-3d9b3500-2938-11e9-9585-63ef137328a4.jpg\" /\u003e\n\n# two functions to maximize `P(g|x)`.\n - Assumption: **all Grp share the equal `Σ` matrix**(in QDA, the equal covariance assumption does not hold, thus you cannot drop `-0.5log(|Σ|)` term).  \n - Which 'g' has the highest probability of owning the new p-dimensional datapoint? \n   - Eventually, Min/Max depends on the unique parameter(`µ,Σ`) of each Grp. \n   - When you plug in x vector, `µ,Σ` that minimizing **Mahalonobis Distance**, is telling you the membership of the vector `x`.  \n   \u003cimg src=\"https://user-images.githubusercontent.com/31917400/52273637-57417a00-2942-11e9-8881-f7279ec947d4.jpg\" /\u003e\n   \n   - When you plug in x vector, `µ,Σ` that maximizing **LD-function**, is telling you the membership of the vector `x`.\n   \u003cimg src=\"https://user-images.githubusercontent.com/31917400/52273639-59a3d400-2942-11e9-900e-077ceabfb0b9.jpg\" /\u003e\n \n \u003e In practice,\n \u003cimg src=\"https://user-images.githubusercontent.com/31917400/52275738-4dbb1080-2948-11e9-9768-3da4a0c5c773.jpg\" /\u003e\n\n \u003e **Log Odd Ratio** and `Linear Decision Boundary`\n   - What if the Grp membership probability of 'g1', 'g2' are the same? \n   - Then we can say that the given vector point is the part of `Linear Decision Boundary` !!!\n   \u003cimg src=\"https://user-images.githubusercontent.com/31917400/52283578-a2678700-295a-11e9-98ae-817a9f91afdc.jpg\" /\u003e\n\n \u003e LDA and Logistic regression\n   - LDA is Generative while LogisticRegression is discriminative.\n   - LDA operates by maximizing the log-likelihood based on an assumption of normality and homogeneity while Logistic regression makes no assumption about P(X), and estimates the parameters of P(g|x) by maximizing the conditional likelihood. \n   - logistic regression would presumably be more robust if LDA’s distributional assumptions (Gaussian?) are violated. \n   - In principle, LDA should perform poorly when outliers are present, as these usually cause problems when assuming normality. \n   - In LDA, the log-membership odd between Grps are **linear functions** of the vector data x. This is due to the assumption of `Gaussian densities` and `common covariance matrices`.\n   - In LogisticRegression, the log-membership odd between Grps are **linear functions** of the vector data x as well. \n   \u003cimg src=\"https://user-images.githubusercontent.com/31917400/52282688-e6f22300-2958-11e9-923a-5be3e22e8de9.jpg\" /\u003e\n\n## 2. Latent Dirichlet Allocation\nThe finite Dirichlet distribution is a distribution over distributions, namely over multinomial distributions. That means if you draw a sample from it, you get a random distribution. A loaded die can be described by a `multinomial distribution`. A machine that makes biased die with some random error can be described by a `Dirichlet distribution`. Suppose there are boxes with chocolates, with some portion of dark and sweet chocolates. You pick at random one of the boxes(perhaps some kinds of boxes can be more common than others. Then, you can pick at random one of the chocolates. So you have a distribution (a collection of boxes) of distributions (chocolates in a box). \n - Just as the beta distribution is the conjugate prior for a binomial likelihood, the Dirichlet distribution is the conjugate prior for the multinomial likelihood. It can be thought of as a **multivariate beta distribution** for a collection of probabilities (that must sum to 1). \n   \nLDA is a “generative probabilistic model” of a collection of **composites made up of parts**. \n - The composites are `documents`.\n - The **topics** are Latent Variable. \n - The parts are `words`  \n - `Document` is a distribution over `topics`. \n - `Topic` is a distribution of `words`.\n\u003cimg src=\"https://user-images.githubusercontent.com/31917400/67500637-e7635300-f67a-11e9-93f5-ff72ffa0a04b.jpg\" /\u003e\n\nThe probabilistic topic model estimated by LDA consists of two tables (matrices):\n - 1st table: the probability of selecting a particular `part(word)` when sampling a particular **topic(category)**.\n - 2nd table: the probability of selecting a particular **topic(category)** when sampling a particular `document`.\n\u003cimg src=\"https://user-images.githubusercontent.com/31917400/52525957-842abf80-2ca9-11e9-8465-b36a9e1d2d4e.jpg\" /\u003e\n\n - \u003e In the chart above, every topic is given the same alpha value. Each dot represents some distribution or mixture of the three topics like (1.0, 0.0, 0.0) or (0.4, 0.3, 0.3). Remember that each sample has to add up to one. At low alpha values (less than one), most of the topic distribution samples are in the corners (near the topics). For really low alpha values, it’s likely you’ll end up sampling (1.0, 0.0, 0.0), (0.0, 1.0, 0.0), or (0.0, 0.0, 1.0). This would mean that a document would only ever have one topic if we were building a three topic probabilistic topic model from scratch.\n - \u003e At alpha equal to one, any space on the surface of the triangle (2-simplex) is fair game (uniformly distributed). You could equally likely end up with a sample favoring only one topic, a sample that gives an even mixture of all the topics, or something in between. For alpha values greater than one, the samples start to congregate to the center. This means that as alpha gets bigger, your samples will more likely be uniform or an even mixture of all the topics.\n \n - WTF? __Simplest Generative Procedure:__\n \u003cimg src=\"https://user-images.githubusercontent.com/31917400/67502548-ebdd3b00-f67d-11e9-9ac6-c015878416be.jpg\" /\u003e\n\n   - Pick your unique set of WORDS.\n   - Pick how many DOCUMENTS you want.\n   - Pick how many WORDS you want per each DOCUMENT (sample from a Poisson distribution).\n   - Pick how many `topics`(categories or label) you want.\n   - Pick a number between not zero and positive infinity and call it **alpha**.\n   - Pick a number between not zero and positive infinity and call it **beta**.\n   - Build the `**WORDS** VS **topics** table`. \n     - For each column, draw a sample(spin the wheel) from a Dirichlet distribution using **beta** as the input. The Dirichlet distribution takes a number called **beta** for each `topic` (or category). \n     - Each sample will fill out each column in the table, sum to one, and give the probability of each part per `topic`(column).\n   - Build the `**DOCUMENTS** VS **topics** table`. \n     - For each row, draw a sample from a Dirichlet distribution using **alpha** as the input. The Dirichlet distribution takes a number called alpha for each `topic` (or category).\n     - Each sample will fill out each row in the table, sum to one, and give the probability of each `topic` (column) per DOCUMENT.\n   - Build the actual DOCUMENTS. For each DOCUMENT:\n     - Step_1) look up its **row** in the `**DOCUMENT** VS **topics** table`, \n     - Step_2) sample a `topic` based on the probabilities in the row, \n     - Step_3) go to the `**WORDS** VS **topics** table`, \n     - Step_4) look up the `topic` sampled, \n     - Step_5) sample a **WORD** based on the probabilities in the column, \n     - Step_6) repeat from step 2 until you’ve reached how many WORDS this DOCUMENT was set to have.\n\n\n---------------------------------------------------------------------------------------------------------------------\n## 3. AutoEncoder\n - As a **Unsupervised method**,\n\n### Variational Inference + Neural Network = Scalable VI\n10 years ago, people used to think that Bayesian methods are mostly suited for small datasets because it's computationally expensive. In the era of Big data, our Bayesian methods met deep learning, and people started to make some mixture models that has neural networks inside of a probabilistic model. \n\nHow to scale Bayesian methods to `large datasets`? The situation has changed with the development of **stochastic Variational Inference**, trying to solve the inference problem exactly without the help of sampling. \n\n---------------------------------------------------------------------------------------------------------------------------------------\n## \u003e Background Knowledge: \nLet's say we have a trouble with EM in GMM...saying that we cannot calculate the `MLE value` of the soft clusters???\n\nThis is the useful story when you cannot calculate the MLE value in the EM algorithm..\n\u003cimg src=\"https://user-images.githubusercontent.com/31917400/86541806-ce988600-bf07-11ea-8dc6-9da63e6ee9f3.jpg\"/\u003e\nWhen MLE does not work for the original margin of log-likelihood, then we try to get a **lower bound** with the function that we can easily optimize?  Instead of maximizing the original margin of log-likelihood, we can maximize its **lower bound**!!\n\n## Now, Let's find the Lower Bound to estimate the `MLE value`!\n\u003e [note] But it's just a lower bound.. there is no guarantee that it gives us the correct parameter estimation! \n - Perhaps we can try...a **family of lower bounds**?? i.e. try **many different lower bounds**!\n - ## Let me introduce `q(t)` as the variational distribution of the `alpha coefficient` (mixing coefficient: probability of the hidden membership `t`= c). Here, `q(t)` are not fingers any more like in the typical Variational Inference.  Jansen's \"lower boundsss\" are fingers. Any distribution can be estimated by such a bunch of \"lower bounds\"!!!\n - Develop a bunch of different `lower bounds`:\n   - Use (0)`Hidden \"t\" value`, and (1)`Alpha Coefficient: q(t)`, (2) **log(**`p(x, t)/q(t)`**)**\n   - **min{** `q(t)`*log[`p(x,t)/q(t)`] **}** ...KL-Divergence.. This is the Jensen's lower bound? Let's re-express our `log marginal` with KL-Divergence elements!\n   - Imagine each finger(Jansen's lower bound) is a cluster ???\n \u003cimg src=\"https://user-images.githubusercontent.com/31917400/86539994-1fed4900-bef9-11ea-8817-ed6243b4bcbb.jpg\"/\u003e\n\nGeneral EM-Algorithm\n\u003cimg src=\"https://user-images.githubusercontent.com/31917400/71264565-458b7a00-233c-11ea-88d6-e3316d5fef5b.jpg\"/\u003e\nWe built a lower bound on the local likelihood which depends both on the theta to maximize the local likelihood and the parameter q which is the variational distribution value, and it suggests we can optimize this lower bound in iterations by repeating the two steps until convergence. On the E-step, fix theta and maximize the lower bound with respect to q. And on the M-step, fix q and maximize the lower bound with respect of theta. So this is the general view of the expectation maximization. \n## Is it just coincidence that `Jansen's lower bound` looks like `KL-Divergence`? \n## Now we just found the first Jansen's bound as a finger. How many more fingers to go? \n\n------------------------------------------------------------------------------------------------------------------------\n# Variational Autoencoder and Generative model: \nHow can we perform efficient inference and learning in directed probabilistic models, in the presence of **continuous latent variables** with **intractable posterior distributions**, and **large datasets**? \n\nIn contrast to the plain autoencoders, it has `sampling inside` and has `variational approximations`. \n - for Dimensionality Reduction\n - for Information Retrieval\n   \n\u003e [INTRO]: Why fitting a certain distribution into the disgusting DATA (**why do you want to model it**)?\n - If you have super complicated objects like natural images, you may want to build a probability distribution such as \"GMM\" based on the dataset of your natural images then try to generate **new complicated data**...\n - Application?\n   - __Detect anomalies, sth suspicious__ \n     - ex\u003e For example, you have a bank and you have a sequence of transactions, and then, if you fit your probabilistic model into this sequence of transactions, for a new transaction you can predict how probable this transaction is according to our model, our current training data-set, and if this particular transaction is not very probable, then we may say that it's kind of suspicious and we may ask humans to check it.\n     - ex\u003e For example, if you have security camera footage, you can train the model on your normal day security camera, and then, if something suspicious happens then you can detect that by seeing that some images from your cameras have a low probability of your image according to your model. \n   - __Deal with N/A__\n     - ex\u003e For example, you have some images with obscured parts, and you want to do predictions. In this case, if you have P(X) - probability distribution of your data -, it will help you greatly to deal with it. \n   - __Represent highly structured data in low dimensional embeddings__\n     - ex\u003e For example, people sometimes build these kind of latent codes for molecules and then try to discover new drugs by exploring this space of molecules in this latent space.....?? \n\n## Let's model the image `P(x)` ! Yes, it's about damn large sample size with high dimensionality..in the context of Unsupervised Learning.\n\u003cimg src=\"https://user-images.githubusercontent.com/31917400/71101742-24495300-21af-11ea-9821-a14e07c54148.jpg\"/\u003e\n\n - [1.CNN]: Let's say that **CNN** will actually return your **logarithm of probability**. \n   - The problem with this approach is that you have to normalize your distribution. You have to make your distribution to sum up to one, with respect to sum according to all possible images in the world, and there are billions of them. So, this normalization constant is very expensive to compute, and you have to compute it to do the training or inference in the proper manner. HOW? You can use the chain rule. `Any probabilistic distribution can be decomposed into a product of some conditional distributions`, then we build these kind of conditional probability models to model our `overall joint probability`. \n - [2.RNN]: how to represent these `conditional probabilities` is with **RNN** which basically will read your image pixel by pixel, and then outputs your prediction for the next pixel - Using proximity, Prediction for brightness for next pixel for example! And this approach makes modeling much easier because now normalization constant has to think only about 1D distribution.\n   - The problem with this approach is that you have to generate your new images one pixel at a time. So, if you want to generate a new image you have to first generate X1 from the marginal distribution X1, then you will feed this into the RNN, and it will output your distribution on the next pixel and etc. So, no matter how many computers you have, one high resolution image can take like minutes which is really long...\n - ### [3. Our pick is pdf] This is very important. Let's find the density model of our data (predictive distribution)!\n   - We believe `x ~ Gaussian`\n   - **CNN with Infinite continuous GMM:** In short, we can try **`infinite mixture of Gaussians` which can represent any probability distribution!** Let's say if each object (image X) has a corresponding **latent variable `t`**, and the image X is caused by this **`t`**, then we can marginalize out w.r.t **`t`**, and the conditional distribution `P(X|t)` is Gaussian. We can have a mixture of infinitely many Gaussians, for each value of **\"t\"**(membership?). \n     - Then we mix these Gaussian with **weights**(mixing coefficients). Yes. We are trying to use Neural Network (a.k.a weighting machine) inside this model at the end... \n     - First, we should define the **prior** `P(t)` and the **likelihood** `P(x|t)`  to model `P(x)` which is the Sum( `P(x,t)`: **the un-normalized posterior** )\n       - (1)`Prior` for the latent variable **t**: `P(t) = N(0, I)`.. oh yeah..the membership `t` around 0 ... **Done and Dusted**. \n       - (2)`Likelihood` for the data **x**: `P(x|t) = N( μ(t), Σ(t) )`...it can be a gaussian with parameters relying on `t`... **This is tricky**! \n         - `μ(t)` = W*`t` + b  (Of course, each component's location would be subject to the membership `t`)\n         - `Σ(t)` = ![formula](https://render.githubusercontent.com/render/math?math=\\Sigma_0) (Of course, each component's size would be subject to the membership `t`) \n         - REALLY???? Here we are skeptical about the above linearity of the parameterization..\n           - `μ(t)` = ![formula](https://render.githubusercontent.com/render/math?math=CNN_1(t))..if you input `t`, this CNN outputs the mean? blurry? `image vector`!\n           - `Σ(t)` = ![formula](https://render.githubusercontent.com/render/math?math=CNN_2(t))..if you input `t`, this CNN outputs the `Cov matirx`\n           - `CNN` generate weights `w`...at the end..CNN is just giving you a bunch of weights to your likelihood..like a weighting machine. Let's say the `w` is another parameter...it's like...**mixing coefficient**?  \n             - ![formula](https://render.githubusercontent.com/render/math?math=CNN_1(t)) -\u003e `μ(t|w)`\n             - ![formula](https://render.githubusercontent.com/render/math?math=CNN_2(t)) -\u003e `Σ(t|w)`... problem is that this is too huge...\n               - How about Let CNN ignores other covariance values except \"diag(![formula](https://render.githubusercontent.com/render/math?math=\\sigma^2(t,w)))\" \n                 - `Σ(t|w)` -\u003e \"diag(![formula](https://render.githubusercontent.com/render/math?math=\\sigma^2(t,w)))\" \n     - Now, let's train our model! Find the partameters - `t`, `w`\n       - `MLE`: Can you get some probability values for each datapoint? Let's maximize the density of our data given the parameters - `w`,`t` ? What is important is that the mixing coefficient `w` depends on `t`. If we have a latent variable, it's natural to go with Generalized EM-Algorithm, building `Jansen's bounds` on the MLE and maximize the sum of those bounds! But...you cannot imagine the analytical form of the likelihood `P(x|t)` = N( ![formula](https://render.githubusercontent.com/render/math?math=CNN_1(t,w)), ![formula](https://render.githubusercontent.com/render/math?math=CNN_2(t,w)) ). So..we can't get Sum of joints ???\n         - SUM(**`log[P(x|w)]`** per each observation`x`)..so try to come up with another \"SUM\" caused by the latent variable `t`. \n       - `MCMC`? `VI`? ... ok, then can we obtain the un-normalized posterior:`P(x,t)`? Although knowing the prior `P(t)`, you cannot imagine the analytical form of the likelihood `P(x|t)` = N( ![formula](https://render.githubusercontent.com/render/math?math=CNN_1(t,w)), ![formula](https://render.githubusercontent.com/render/math?math=CNN_2(t,w)) ). So..we can't get Sum of joints???\n       - Anyway, we decide our predictive null model - mean(x) - is explained by Neural Network.... \n       - Then how to train? How to find the parameter - `t`,`w` - in the first place?\n       \n## You know what? we are start off with Decoder ?\nOnly if we have `hidden variables`...\n   \u003cimg src=\"https://user-images.githubusercontent.com/31917400/72342676-f3344380-36c4-11ea-90a2-ea05caf2e11a.jpg\"/\u003e\n \n   - ## Overview: get some variational distribution `q(t)` or `LB(t)` ?\n   \u003cimg src=\"https://user-images.githubusercontent.com/31917400/86674224-5bb70a00-bff0-11ea-91d6-c6907d62ae6a.jpeg\"/\u003e\n   \n   - *In VI, the **KL-Divergence** (where each `q(z)` is a `finger`) should be **`minimized`**. In VI, the **MLE estimator** is the joint of all `q(z)`,\n   - *In VAE, the `Jansen's lower bound` as a **KL-Divergence** needs to be **`maximized`**..(where `q(z)` is a mixing coefficient for GMM form with `log(p/q)` as a Gaussian cluster) and each Jansen's lower bound is a `finger`. In VAE, the **MLE estimator** is the sum of a bunch of `Jansen's lower bound`ssss. \n   \n   - *In VAE, the latent space will have highly compressed patterns that were learned from the data. Anomalies will not \"fit\" into the scheme of the latent vector and the abnormal part will get lost when generating the output. \n     - That means not only will the Input-Output difference in VAE be larger than with that in AE, you will also be able to locate the abnormal part in a single sample.\n     - As for Anomaly detection task, you can compare the data with the latent spaces not the outputs, thus we won’t need the reconstruction part of the network? \n   \n   - __[Story]:__ `**Encoding**: Discover the latent parameter from our dataset` -\u003e `**Decoding**: Generate new data based on the latent memberships`\n     - Ok, let's do some reverse enigineering. **Back to the question. How to train?** How to find the parameter in the first place?\n     - ## `t` and `w` is the key!\n       - Let's try **`Variational Inference`**. Assuming each **q(![formula](https://render.githubusercontent.com/render/math?math=t_i))** as the Exponential family function = N(![formula](https://render.githubusercontent.com/render/math?math=m_i), ![formula](https://render.githubusercontent.com/render/math?math=s_i^2)), so each `q(t)` is different Gaussian...and the value is probability as a mixing coefficient. Then we can **maximize the Jansen's Lower Bound** w.r.t `q`, `m`, `s^2`. But it's so complicated..Is there other way? -\u003e VAE... \n       - Both `t`,`w` are parameters for Decoding...our final predictive model. \n       - The solution is \"Encoding\" since it returns the distribution of `t`. Remember? `w`(NN weighting) relies on `t`(membership). \n       - Hey, so we first want to obtain the latent variable space! We are conjuring the **Encoder** that outputs the latent parameter `t` space since `w` results from `t`. Let's find the posterior `P(t|x)` from an Encoder..then we would someday get our final `P(x|t)` from a Decoder. \n         - __[Find `t`]__ **Bring up the \"factorized\" variational distribution `q(t)`** and let NN return (![formula](https://render.githubusercontent.com/render/math?math=m_i), ![formula](https://render.githubusercontent.com/render/math?math=s_i^2)) that explains the distribution of `t` **which is a Gaussian** and we call it `q(t)` function ... we can say that the latent variable `t` follows Gaussian.    \n           -: Let's make `q(t)`= N(m, s^2) flexible. If assume all **q(![formula](https://render.githubusercontent.com/render/math?math=t_i))** = N( ![formula](https://render.githubusercontent.com/render/math?math=CNN_1(t))=`m(x_i, φ)`, ![formula](https://render.githubusercontent.com/render/math?math=CNN_2(t))=`s^2(x_i, φ)` ), then the training get much easier. Since we already have the original input data `x`, we can simply ask CNN to produce weight `φ`.\n           \u003cimg src=\"https://user-images.githubusercontent.com/31917400/86669433-7dfa5900-bfeb-11ea-9160-c33cde0b9c08.jpg\"/\u003e\n           \n           -: Once we pass our initial data `x` through our [first neural network] as an encoder with parameters`φ`, it returns `m`,`s^2` which are parameters of `q(t)`. How `t` are distributed? Normally...\n             - ## We found `q(t)` = `P(t|x)` = `N(m, s^2)` which is an unique mixing coefficient function...Interestingly, we forget about the mixing coefficient and simply do MonteCarlo Sampling from this distribution`q(t)` to get random data pt `t`.  \n         - __[Find `w`]__ Now, we know `t` so we can get `w`! Let's pass this sampled vector `T` into the `second neural network` to get parameters`w`. \n           -: It outputs us the distribution that are as close to the input data as possible.\n           \u003cimg src=\"https://user-images.githubusercontent.com/31917400/86837661-1d285a80-c097-11ea-936f-8dbafdce6945.jpg\"/\u003e\n\n[note] **`Latent variable distribution: q(t)` is useful!** Anomaly Detection for a new image which the network never saw, of some suspicious behavior or something else, our conditional neural network of the encoder can output your **latent variable distribution** as far away from the Gaussian. By looking at the distance between the variational distribution `q(t)` and the standard Gaussian, you can understand how anomalistic a certain point is ... wait. `P(t)` is Standard Normal?   \n\u003cimg src=\"https://user-images.githubusercontent.com/31917400/72226852-bca7dd00-358d-11ea-98d6-20965d0dce46.jpg\"/\u003e\n\n## Next, how to define the CNN's weighting mechanism for `Φ` and `w` ? : Keep maximizing `Jensen's Lower bound` via each gradient calculation in CNN! \n - Jensen's LB is the **objective function** in VAE (like.. MSE lost function in LM) \n - __Gradient of Encoder:__ Make an Expected Value ?\n   - we're passing our image through our Encoder, and compute the **usual gradient** of this first neural network with respect to its parameters `Φ` to get the parameters(Φ) of the variation distribution `q(t|Φ)`. We use **\"log derivitive trick\"** to approximate the gradient (make the form of expected value?) but it has some problem: `the variance of this stochastic approximation will be so high that you will have to use lots and lots of gradients to approximate this thing accurately`. How can we estimate this gradient with a much **smaller variance estimate**?  \n - __Gradient of Decoder:__ Make an Expected Value ?\n   - we sample `t` from the variation distribution `q(t|Φ)` and put this `point` as input to the Decoder with parameters `w`. And then we just compute the **usual gradient** of this second neural network with respect to its parameters `w`.  \n   \u003cimg src=\"https://user-images.githubusercontent.com/31917400/72433990-7a9bb880-3792-11ea-8cfd-f3e6778fa8ad.jpg\"/\u003e\n   \n   - __Issues of gradient of Encoder:__ 허벌창 그라디언트여? How can we better estimate this varying gradient with a much **smaller variance estimate**?  \n     - 왜 허벌창? our input data (x) is 이미지니깐...\n     - when sampling `t`, **\"reparameterization trick\"** of our latent variable makes the a Jensen's lower bound estimator easy to be optimized using standard stochastic gradient.\n     - so..you just sample from a identity matrix...All works will be done by `m` and `s^2`..\n     \u003cimg src=\"https://user-images.githubusercontent.com/31917400/73176973-afe6c580-4105-11ea-8822-49b2d202c156.jpg\"/\u003e\n\n------------------------------------------------------------------------------------------------------------------------------------\n### General Learning with latent priors\nWe first pick a fake? posterior `q(z|v)` as a **family of distributions** over the `latent variables` with **its own variational parameters**`v`. KL-divergence method helps us to minimize the distance between `P(z)` and `q(z)`, and in its optimization process, we can use `mini-batching` training strategy(since its likelihood can be split into many pieces of log sum), which means we don't need to compute the whole training of the likelihood. `ELBO supports mini-batching`.    \n - We can use MonteCarlo estimates for computing stochastic gradient, which is especially useful when the reparameterization trick for `q(z|v)` is applicable. \n\u003cimg src=\"https://user-images.githubusercontent.com/31917400/69436481-5b0b8500-0d39-11ea-8e3d-1d565674042e.jpg\"/\u003e\n\n### Variational Dropout and Scalable BNN\nCompress NN, then fight severe overfitting on some complicated datasets.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/R%C3%A9duction_dimension/ACP":{"title":"","content":"\n# Objectif\nCondenser l’information de la matrice des donn´ees afin d’en retirer les relations caractéristiques (ressemblances entre observations et liaisons entre variables) tout en limitant la perte d’information.\n\n# Inertie\nUtilisation de l'inertie $\\mathcal{I}$ : somme des distances au carré entre les $m$ observations et leur centre de gravité $\\boldsymbol{\\mu} \\in \\mathbb{R}^{d}$ :\n$$\n\\begin{aligned}\n\\mathcal{I} \u0026=\\sum_{j=1}^{d} \\sum_{i=1}^{m} p_{i}\\left(x_{i j}-\\mu_{j}\\right)^{2} \\\\\n\u0026=\\sum_{j=1}^{d} s_{j}^{2}\n\\end{aligned}\n$$\navec $s_{j}^{2}$ la valeur de la variance (carré de l'écart-type) pour la $j$-ème variable $\\left(X_{j}\\right)$.\nEn d'autres termes,\n- L'inertie est une généralisation de la notion de variance au cadre multivarié. C'est la somme des variances pour les $d$ variables, i.e., la somme des éléments diagonaux de la matrice de variance-covariance\n- L'inertie est une information du nuage des observations.\n- Si les données sont centrées-réduites : $\\mathcal{I}=\\sum_{j=1}^{d} s_{j}^{2}=\\sum_{j=1}^{d} 1=d$","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/R%C3%A9duction_dimension/Covariances-et-corr%C3%A9lations":{"title":"","content":"# Covariance et Corrélations\n- Matrice des variances-covariances\n$$\n\\begin{aligned}\nS=\\operatorname{Var}(\\mathbf{X}) \u0026=\\left[\\begin{array}{ccccc}\n\\operatorname{Var}\\left(X_{1}\\right) \u0026 \\operatorname{Cov}\\left(X_{1}, X_{2}\\right) \u0026 \\cdots \u0026 \\operatorname{Cov}\\left(X_{1}, X_{d}\\right) \\\\\n\\operatorname{Cov}\\left(X_{2}, X_{1}\\right) \u0026 \\ddots \u0026 \\cdots \u0026 \\operatorname{Cov}\\left(X_{2}, X_{d}\\right) \\\\\n\\vdots \u0026 \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\\\\n\\operatorname{Cov}\\left(X_{d}, X_{1}\\right) \u0026 \\operatorname{Cov}\\left(X_{d}, X_{2}\\right) \u0026 \\cdots \u0026 \\operatorname{Var}\\left(X_{d}\\right)\n\\end{array}\\right] \\\\\n\u0026=\\left[\\begin{array}{cccc}\ns_{X_{1}}^{2} \u0026 s_{X_{1}, X_{2}}^{2} \u0026 \\cdots \u0026 s_{X_{1}, X_{d}}^{2} \\\\\ns_{X_{2}, X_{1}}^{2} \u0026 \\ddots \u0026 \\cdots \u0026 s_{X_{2}, X_{d}}^{2} \\\\\n\\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\\\\ns_{X_{d}, X_{1}}^{2} \u0026 s_{X_{d}, X_{2}}^{2} \u0026 \\cdots \u0026 s_{X_{d}}^{2}\n\\end{array}\\right]\n\\end{aligned}\n$$\navec $s_{j, j^{\\prime}}^{2}$ la covariance entre les variables $X_{j}$ et $X_{j^{\\prime}}$, tel que\n$$\ns_{X_{j}, X_{j^{\\prime}}}^{2}=\\sum_{i=1}^{m} p_{i}\\left(x_{i j}-\\mu_{j}\\right)\\left(x_{i j^{\\prime}}-\\mu_{j^{\\prime}}\\right)\n$$\nLa covariance mesure la liaison linéaire qui peut exister entre un couple de variables quantitatives.\n\n$$\n\\operatorname{Cor}(\\mathbf{X})=\\left[\\begin{array}{cccc}1 \u0026 \\operatorname{Cor}\\left(X_{1}, X_{2}\\right) \u0026 \\cdots \u0026 \\operatorname{Cor}\\left(X_{1}, X_{d}\\right) \\ \\operatorname{Cor}\\left(X_{2}, X_{1}\\right) \u0026 \\ddots \u0026 \\cdots \u0026 \\vdots \\ \\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\ \\operatorname{Cor}\\left(X_{d}, X_{1}\\right) \u0026 \\cdots \u0026 \\cdots \u0026 1\\end{array}\\right]=\\left[\\begin{array}{cccc}1 \u0026 \\frac{s_{X_{1}, X_{2}}^{2}}{s_{X_{1}}{ }{X} X{2}} \u0026 \\cdots \u0026 \\frac{s_{X_{1}, X_{d}}^{2}}{s_{X_{1}}{ }^{s} X_{d}} \\ \\frac{s_{X_{2}}^{2}, X_{1}}{s_{X_{2}}{ }^{s} X_{1}} \u0026 \\ddots \u0026 \\cdots \u0026 \\frac{s_{X_{2}}^{2}, X_{d}}{s_{X_{2}}{ }^{s} X_{d}} \\ \\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\ \\frac{s_{X_{d}, X_{1}}^{2}}{s_{X_{d}}{ }^{s} X_{1}} \u0026 \\frac{s_{X_{d}, X_{2}}^{2}}{ X_{d}{ }^{s} X_{2}} \u0026 \\cdots \u0026 1\\end{array}\\right]\n$$","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/R%C3%A9duction_dimension/Introduction":{"title":"","content":"# Comment décrire les données ?\n\n## Approche 1\neffectuer une analyse descriptive multidimensionelle\n⊖ trop longue et souvent trop complexe\n\n## Approche 2 : \nutiliser des méthodes d’analyse des données\nex: les méthodes factorielles comme l’Analyse en Composantes Principales (ACP) \n• **Synthèse :** réduire la dimension du problème tout en restituant le maximum d’information \n• **Descriptif** et exploratoire : visualisation des données (production de graphiques simples)\n\n### Etude des observations\nmise en évidence de ressemblances entre les observations \n\t• quand peut-on dire de deux observations qu’elles sont similaires ? \n\t• s’il y a beaucoup d’observations, est-il possible de faire un bilan des ressemblances ?\n\n### Etude des variables\nrecherche de liaisons entre les variables \n• on s’intéresse généralement aux liaisons linéaires qui sont simples, très fréquentes et résument de nombreuses liaisons ⇒ étude des corrélations\n\n### Lien entre l'étude des observations et celle des variables\nressemblances entre les observations caractérisées par les variables\n\n# Conclusion \nProjeter les données dans un espace de faible dimension.\n$\\left\\{\\mathbf{x}_{i} \\in \\mathbb{R}^{d}\\right\\}_{i=1}^{n} \\Rightarrow\\left\\{\\tilde{\\mathbf{x}}_{i} \\in \\mathbb{R}^{d^{\\prime}}\\right\\}_{i=1}^{n}$ \n\t$d^{\\prime} \\ll d$ (souvent 2 ).\n- Paramètres :\n\t- Type de projection.\n\t- Mesure de similarité.\n![[Pasted image 20220406112402.png]]\n\nMéthodes\n- Sélection de variables.\n- Analyse en composantes principales (ACP, PCA).\n- Réduction non-linéaire.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Regression/Batch-vs-stohastic":{"title":"","content":"# Batch vs Stochastic\n![](Pasted%20image%2020220701233150.png)\n\n# Batch Gradient Descent\n\n\u003e BGD is a variation of the gradient descent algorithm that calculates the error for each eg in the training datasets, but only updates the model after all training examples have been evaluated.\n\n![](https://miro.medium.com/max/640/1*Ouc8p_YbjY5m2mMIzOgnLw.png)\n\nOne cycle through entire training datasets is called a training epoch. Therefore, it is often said that BGD performs model updates at the end of each training epoch.\n\n**_Advantages_**:\n\n-   It is more computationally efficient.\n-   It is a learnable parameter : whenever we are trying to calculate a new weight, we are trying to consider all the data which is available to us based on the summation of the loss. So, we are trying to find out or derive the new value of the weight / bias , which is a learnable parameter.\n\n**_Disadvantages_**:\n\n-   **Memory consumption is too high**\n-   If memory consumption is too high, we can say that thr computation will be high and calculation will be very slow and so the optimization will be slower as compared to any other optimizer.\n\n# Mini Batch Gradient descent (MGD)\n\n\u003e MGD is a variation of the gradient descent algorithm that splits the training datasets into small batches that are used to calculate model error and update model coefficients.\n![](https://miro.medium.com/max/671/1*_ctmL9Ya0DpppDFbiYa7VQ.png)\n\n**_Advantages_**:\n\n-   The model update frequency is higher than BGD: In MGD, we are not waiting for entire data, we are just passing 50 records or 200 or 100 or 256, then we are passing for optimization.\n-   The batching allows both efficiency of not having all training data in memory and algorithms implementations. We are controlling memory consumption as well to store losses for each and every datasets.\n-   The batches updates provide a computationally more efficient process than SGD.\n\n**_Disadvantages_**:\n\n-   No guarantee of convergence of a error in a better way.\n-   Since the 50 sample records we take , are not representing the properties (or variance) of entire datasets. Do, this is the reason that we will not be able to get an convergence i.e., we won’t get absolute global or local minima at any point of a time.\n-   While using MGD, since we are taking records in batches, so, it might happen that in some batches, we get some error and in dome other batches, we get some other error. So, we will have to control the learning rate by ourself , whenever we use MGD. If learning rate is very low, so the convergence rate will also fall. If learning rate is too high, we won’t get an absolute global or local minima. So we need to control the learning rate.\n\n**Note**:If the batch size = total no. of data, then in this case, BGD = MGD.\n\n# Stochastic Gradient Descent\n\n\u003e SGD is a variation of the gradient descent that calculates the error and updates the model for each record in the training datasets.\n\n\n**_Points_**: Since, in SGD records are send one by one so, if talking about minima, we will be able to get multiple minima points as there will be minima for each records and it will look like this as shown below:\n\n![](https://miro.medium.com/max/700/1*tLTWgad8BUisFKtXB8MgCQ.png)\n\nIt keeps on fluctuating. And we will fall inside a local minima at any point of time.\n\n\n**_Advantages_**:\n\n-   For every record, we are updating the weights, so we are learning\n-   Weight updates is faster.\n-   Loss function is not suppose to wait for the entire datasets to calculate itself.\n-   Even optimizer is not suppose to wait for entire datasets to calculate itself.\n-   Memory consumptions will also be low.\n-   SGD is faster than MGD and BGD.\n\n\n\n**_Disadvantages_**:\n\n-   It is having huge oscillation. So, SGD will always vary from one point to another for each and every datasets. Hence, its tough to get an absolute minima. And we will end up getting a multiple minima points.\n-   We need to control the learning rate: if learning rate is too high, it may be possible that some other dataset may not show you the same properties, again, learning rate effect in SGD will be little but lesser as compare to the BGD and MGD.\n\n# Comparison \nIf we compare all three optimizer, then every optimizer has its own advantages and disadvantages ,we can’t come to conclusions which optimizer is best, it totally depends on datasets.\n\n\n![](https://miro.medium.com/max/700/1*9calCrrqS9opiytuA--7AA.png)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Regression/Linear-Regression":{"title":"","content":"# Regression linéaire\nDonnées d'apprentissage : $\\lbrace\\mathbf{x}\\_{i}, y\\_{i} \\rbrace\\_{i=1}^{m}$  \nobservations (entrées) $: \\mathbf{x}_{i} \\in \\mathbb{R}^{d}$  \n\nmesure d'intérêt (sortie à prédire) : $y_{i} \\in \\mathcal{Y}$\n\nFonction de prédiction : $f: \\mathbb{R}^{d} \\mapsto \\mathcal{Y}$  \n## Paramètre\n$$\\vec{(\\beta)}^T = (\\beta\\_0,\\beta\\_1,...,\\beta\\_n) \\in \\mathbb{R}^{d+1}$$\n\n## Modèle\n$$ f\\_\\beta(x) = \\beta\\_0 + \\Sigma_{i=1}^m(\\beta\\_ix\\_i)$$\n\n- Notation matricielle :\n$$\nf_{\\boldsymbol{\\beta}}(\\mathbf{X}) \\approx \\tilde{\\mathbf{X}} \\boldsymbol{\\beta}\n$$\n$$\n\\left(\\begin{array}{c}\ny_{1} \\\\\ny_{2} \\\\\n\\vdots \\\\\ny_{m}\n\\end{array}\\right) \\approx\\left(\\begin{array}{ccccc}\n1 \u0026 x_{11} \u0026 x_{12} \u0026 \\ldots \u0026 x_{1 d} \\\\\n1 \u0026 x_{21} \u0026 x_{22} \u0026 \\ldots \u0026 x_{2 d} \\\\\n\\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\\\\n1 \u0026 x_{m 1} \u0026 x_{m 2} \u0026 \\ldots \u0026 x_{m d}\n\\end{array}\\right) \\quad\\left(\\begin{array}{c}\n\\beta_{0} \\\\\n\\beta_{1} \\\\\n\\vdots \\\\\n\\beta_{d}\n\\end{array}\\right)\n$$\n$$\\mathbf{X} \\in \\mathbb{R}^{m \\times d}, \\tilde{\\mathbf{X}} \\in \\mathbb{R}^{m \\times(d+1)} \\space \\space \\space \\space  \\space \\boldsymbol{\\beta} \\in \\mathbb{R}^{d+1}$$\n\n## coût \n- fonction qu'on va chercher à minimiser (ou maximiser)\n- On veut $\\boldsymbol{\\beta}$ tel que $f_{\\boldsymbol{\\beta}}(\\mathbf{x})$ soit proche de $y$ pour toutes les données d'apprentissage $\\lbrace{x}\\_{i}, {y}\\_{i}\\rbrace\\_{i=1}^{m}$ :\n$$\n\\hat{y}\\_{i}=f\\_{\\boldsymbol{\\beta}}\\left(\\mathbf{x}\\_{i}\\right) \\approx y\\_{i} \\quad \\forall i \\in\\{1, \\cdots, m\\}\n$$\n- Trouver le meilleur vecteur $\\vec{\\beta}$ équivaut à minimiser le coût (quadratique) global des erreurs :\n$$\n\\mathbf{J}(\\boldsymbol{\\beta})=\\frac{1}{2 m} \\sum\\_{i=1}^{m}\\left(f\\_{\\boldsymbol{\\beta}}\\left(\\mathbf{x}\\_{i}\\right)-y\\_{i}\\right)^{2}\n$$\n\n$$\n➡ \\space \\underset{\\boldsymbol{\\beta}}{\\operatorname{argmin}}(\\mathbf{J}(\\boldsymbol{\\beta}))\n$$\nParmi toutes les droites possibles, on cherche la droite pour laquelle la somme des carrés des écarts verticaux des points à la droite est minimale.\n![](Pasted%20image%2020220630221441.png)\n\n# Descente de gradient\n- Objectif : trouver le minimum d'une fonction-coût  \n\u003cbr/\u003e\n\n1. initialisation : $\\boldsymbol{\\beta}^{(0)}$\n2. à chaque étape $k$, modifier $\\boldsymbol{\\beta}^{(k-1)}$ pour faire $\\operatorname{diminuer} \\mathbf{J}\\left(\\boldsymbol{\\beta}^{(k)}\\right)$\n3. arrêt lorsque le minimum est atteint\n\nPour chaque variable $\\beta_{j}$ :\n$$\n\\beta_{j}^{(k)}:=\\beta\\_{j}^{(k-1)}-\\alpha \\frac{1}{m} \\sum\\_{i=1}^{m}\\left(f\\_{\\boldsymbol{\\beta}(k-1)}\\left(\\mathbf{x}\\_{i}\\right)-y\\_{i}\\right) x\\_{i j}\n$$\nRemarque $: \\forall i, x_{i 0}=1$\n- $\\alpha$ : pas d'apprentissage\n![](Pasted%20image%2020220701115156.png)\n\n# Locally weighted linear regression\nAs evident from the image below, this algorithm cannot be used for making predictions when there exists a non-linear relationship between X and Y. In such cases, locally weighted linear regression is used.\n\n![](https://media.geeksforgeeks.org/wp-content/uploads/Linear-Regression-on-non-linear-data.png)\n\n### Locally Weighted Linear Regression:\n\nThe modified cost function is:\n$$\n\\mathbf{J}(\\boldsymbol{\\beta})= \\sum\\_{i=1}^{m}w^{(i)}\\left(f\\_{\\boldsymbol{\\beta}}\\left(\\mathbf{x}\\_{i}\\right)-y\\_{i}\\right)^{2}\n$$","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Regression/Logistic-Regression":{"title":"","content":"","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Regression/Perceptron":{"title":"","content":"","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/MLIA/Stats/Gaussian":{"title":"","content":"# Loi normale\nEn théorie des probabilités et en statistique, les lois normales sont parmi les lois de probabilité les plus utilisées pour modéliser des phénomènes naturels issus de plusieurs événements aléatoires. Elles sont en lien avec de nombreux objets mathématiques dont le mouvement brownien, le bruit blan gaussien ou d'autres lois de probabilité. Elles sont également appelées lois gaussiennes, lois de Gauss ou lois de Laplace-Gauss des noms de Laplace (1749-1827) et Gauss (1777-1855), deux mathématiciens, astronomes et physiciens qui l'ont étudiée.\n\nPlus formellement, une loi normale est une loi de probabilité absolument continue qui dépend de deux paramètres : son espérance, un nombre réel noté $\\mu$, et son écart type, un nombre réel positif noté $\\sigma$. La densité de probabilité de la loi normale d'espérance $\\mu$, et d'écart type $\\sigma$ est donnée par :\n$$\nf(x)=\\frac{1}{\\sigma \\sqrt{2 \\pi}} \\mathrm{e}^{-\\frac{1}{2}\\left(\\frac{x-\\mu}{\\sigma}\\right)^{2}}\n$$\nLa courbe de cette densité est appelée courbe de Gauss ou courbe en cloche, entre autres. C'est la représentation la plus connue de ces lois. Lorsqu'une variable aléatoire $X$ suit une loi normale, elle es dite gaussienne ou normale et il est habituel d'utiliser la notation avec la variance $\\sigma^{2}$ :\n$$\nX \\sim \\mathcal{N}\\left(\\mu, \\sigma^{2}\\right) .\n$$\nLa loi normale de moyenne nulle et d'écart type unitaire, $\\mathcal{N}(0,1)$, est appelée loi normale centrée réduite ou loi normale standard.\nParmi les lois de probabilité, les lois normales prennent une place particulière grâce au théorème central limite. En effet, elles correspondent au comportement, sous certaines conditions, d'une suite d'expériences aléatoires similaires et indépendantes lorsque le nombre d'expériences est très élevé. Grâce à cette propriété, une loi normale permet d'approcher d'autres lois et ainsi de modéliser de nombreuses études scientifiques comme des mesures d'erreurs ou des tests statistiques, en utilisant par exemple les tables de la loi normale centrée réduite.\n\n# Loi normale multivariée\n$$\n\\begin{aligned}\n\u0026Z \\sim \\mathcal{N}\\left(\\underbrace{\\mu}\\_\\mathbb{R^n}, \\underbrace{\\Sigma}\\_\\mathbb{R^{n*n}}\\right),  z\\in \\mathbb{R^n}\\\\\n\u0026E[z]=\\mu \\\\\n\u0026\\operatorname{Cov}(z)=E\\left[(z-\\mu)(z-\\mu)^{\\top}\\right]\\\\\n\u0026E[z]=E_{z}=E_{z} z^{\\top}-\\left(E_{z}\\right)\\left(E_{z}\\right)^{\\top}\n\\end{aligned}\n$$\n\n![](Pasted%20image%2020220704151359.png)\n\n![](Pasted%20image%2020220704151154.png)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master":{"title":"","content":"# Semestre1\n\n## Concurrence dans les systèmes\n[Concurrence](Master/Concurrence.md)\n\n## Droit\n[Droit](Master/Droit.md)\n\n## Graphisme\n[Graphisme](Master/Graphisme.md)\n\n## Paradigmes - Java et Scala\n[paradigmes](Master/paradigmes.md)\n\n\n","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence":{"title":"","content":"[Consomme](Master/Concurrence%20dans%20les%20systèmes/C/Consomme.md)\n[Reader_writer](Master/Concurrence%20dans%20les%20systèmes/C/Reader_writer.md)\n[Reader Writer](Master/Concurrence%20dans%20les%20systèmes/Java/Reader%20Writer.md)\n[ReentrantLock](Master/Concurrence%20dans%20les%20systèmes/Java/ReentrantLock.md)\n[1.  Ordonnancement des Processus](Master/Concurrence%20dans%20les%20systèmes/1.%20%20Ordonnancement%20des%20Processus.md)\n[geeksForgeeksleS](Master/Concurrence%20dans%20les%20systèmes/geeksForgeeksleS.md)\n[Linux Process States and Signals](Master/Concurrence%20dans%20les%20systèmes/Linux%20Process%20States%20and%20Signals.md)\n[Synthese](Master/Concurrence%20dans%20les%20systèmes/Synthese.md)\n[Understanding Processes on Linux](Master/Concurrence%20dans%20les%20systèmes/Understanding%20Processes%20on%20Linux.md)\n[Understanding Threads in Java](Master/Concurrence%20dans%20les%20systèmes/Understanding%20Threads%20in%20Java.md)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/1.-Ordonnancement-des-Processus":{"title":"1.  Ordonnancement des Processus","content":"\n# Definition\n\nUn processus est un programme en exécution, un fichier binaire chargé et lancé. Lors de l’exécution chaque processus est associé à un contexte d’exécution. Celui-ci contient au moins :\n\n- Le compteur ordinal (le numéro de la case mémoire contenant la prochaine instruction à exécuter)\n- un ensemble de registres dont l’accumulateur\n- position dans la pile d’exécution\n- adresse des espaces mémoires\n\n# la commutation de contexte\n\nLe processeur commute de processus en processus.\n\n- sauvegarde le contexte du processus courant\n- élection d’un nouveau processus\n- chargement du contexte du processus\n- exécution des instructions du processus à partir de son compteur ordinal\n\nLa partie du code qui élit un processus est l’ordonnanceur. “scheduler”\n\n\u003cimg src=\"../../../_resources/d77a73a8bb28804570f533cc45ffc577.png\" alt=\"d77a73a8bb28804570f533cc45ffc577.png\" width=\"410\" height=\"258\" class=\"jop-noMdConv\"\u003e\n\nLe système gère une table des processus. La table contient :\n\n- l ’état du processus\n- son contexte d’éxecution\n- des stats (temps dans le cpu, age …) Ces infos servent à l’ordonnanceur pour sa politique d’élection.\n\n# Politique d’ordonnancement\n\nLe Round-Robin (tourniquet) Le système gère une file d’attente de processus prêts .\n\nLe premier de la liste est celui en execution. A la fin de son quantum, l’ordonnanceur met le processus en fin de liste et charge le premier de la liste.\n\nL’ajout de nouveau processus prêt s’effectue en fin de liste\n\nUn processus en cours d ’exécution demandant une ressource sort de cette liste des prêts\n\n# L ’ordonnanceur : implémentation BSD\n\nL ’ordonnancement des processus s’effectue en temps partagé avec différentes files. Une partie des processus noyau sont non-intéruptibles. Il n ’y a pas de temps partagé pour eux. Ce sont eux qui rendent explicitement la main à l’ordonnanceur. Si un événement apparaît qui met un de ces processus noyau à l’état prêt, le processus utilisateur courant est arrêté, même si il n’a pas terminé sur quantum de temps. L ’ordonnanceur donne alors la main au processus noyau. (Le processus utilisateur est dit préempté)\n\nLes processus utilisateurs sont mis dans des files de bas niveau.\n\nUn processus ne peut s’exécuter que si il n’a aucun processus de plus haut niveau dans les files.\n\nAu sein d’une même file, le système utilise une politique de round robin.\n\nLe système recalcule les priorités des processus pour faire remonter des vieux processus de plus faible prioritaire.\n\n![accafc1482cc6254ab0df8e6155df7dc.png](../../../_resources/accafc1482cc6254ab0df8e6155df7dc.png)\n\n## Problème de famine.\n\nPour ne pas pénaliser les processus moins prioritaires, le système recalcule le numéro de file d’un processus régulièrement.\n\nLa table des processus\n\n\u003e \\\u003e ps x -o pid,pcpu,user,args,psr\n\u003e \n\u003e PID %CPU USER COMMAND PSR\n\u003e \n\u003e 2143 0.0 courtrai /lib/systemd/systemd --user 2 2144 0.0 courtrai (sd-pam) 1 2422 0.0 courtrai /usr/bin/pulseaudio --start 3 2426 0.0 courtrai /usr/lib/pulseaudio/pulse/g 3 11746 0.0 courtrai /usr/bin/gnome-keyring-daem 0 11748 0.0 courtrai /sbin/upstart --user 3 11831 0.0 courtrai upstart-udev-bridge --daemo 3\n\nchaque entrée contient :\n\n- état\n- adresses (4 segments … maps )\n- UID\n- PID,PPID\n- un descripteur d’événement lorsque le processus est endormi\n- Priorité\n- vecteur des interruptions (ensemble de signaux reçus mais pas encore traités par le processus\n- divers : compteur CPU p-cpu\n- la zone u (utilisée lorsque le processus est dans la CPU) \n\n## la zone u (utilisée lorque le processus est dans le CPU)\n\n- uid et gid effectif\n- compteur de temps (user et system)\n- terminal associé\n- erreur (dernier code d’erreur dans les appels système)\n- retour (code de retour du dernier appel système)\n- E/S adresses de buffer\n- . et /\n- limites de taille de fichier et mémoire (ulimit CSH ou SH)\n- umask\n\n## Les interruptions\n\nUne interruption est un événement produit par :\n\n- le matériel (E/S, tty , horloge)\n- un déroutement d’erreur du processeur (débordement calcul, division par zéro, violation de segment (produit un fichier core), image du processus en mémoire)\n- un appel système demande E/S bloquante\n\nL’interruption produit un signal qui est détecté par le système.\n\nIl y a en général un changement de contexte par le système. Le processus courant est préempté, le système prend en compte l’interuption, éventuellement change l’état d’un processus et l’ordonnanceur élit un nouveau processus.\n\nIl y a différents niveaux d’interruption (0 horloge,1 disque, 2 console,3 autre périphérique, 4 appel système, 5 autre).","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/C/Consomme":{"title":"Consomme","content":"\n```C\n#include \u003cunistd.h\u003e // appel systeme fork\n#include \u003cfcntl.h\u003e  // appel system unix ES\n#include \u003cstdio.h\u003e // librairie standard C\n#include \u003cstdlib.h\u003e // exit\n#include \u003csched.h\u003e  // sche_yield\n#include \u003csys/types.h\u003e\n#include \u003csys/sem.h\u003e // semaphore IPC\n#include \u003csys/ipc.h\u003e // services IPC\n#include \u003csys/wait.h\u003e // wait\n#define MUTEX 0\n#define PLACE 1\n#define ARTICLE 2\n\nkey_t cle; /* cle ipc */\nint semid; /* nom local de l'ensemble des semaphores */\n\n#define MAX 10 // taille du buffer\n\nint objet_value = 0;\nint nombre_objets = 0;\nint tableau_articles[MAX];\nint chiffre = 0;\n\n\n\nvoid produire(int * objet) \n{\n    //TODO: créer l'objet\n//   *objet = objet_value;\n//   objet_value++;\n}\n\n\nvoid deposer(int objet) \n{\n    //TODO: déposer l'objet dans le tableau et écrire sur le fichier\n  //déposer l'objet dans le tableau et écrire sur le fichier\n//   fic2tab(\"db.txt\",tableau_articles,sizeof(tableau_articles));\n//   nombre_objets = tableau_articles[0];\n//   tableau_articles[nombre_objets+1] = objet;\n//   nombre_objets++;\n//   tableau_articles[0] = nombre_objets;\n//   printf(\"je depose %d en %d\\n\", objet, nombre_objets);\n//   tab2fic(\"db.txt\",tableau_articles,sizeof(tableau_articles));\n//   print_array(tableau_articles,sizeof(tableau_articles));\n}\n\n\n\nvoid extraire(int * objet)\n{\n    //TODO: extraire \n//   fic2tab(\"db.txt\",tableau_articles,sizeof(tableau_articles)); \n//   nombre_objets = tableau_articles[0];\n//   if (nombre_objets \u003e 0) {\n//       *objet = tableau_articles[1];\n//       for (int i = 1; i \u003c 9; i++) {\n//           tableau_articles[i] = tableau_articles[i+1];\n//       }\n//        nombre_objets--;\n//        tableau_articles[0] = nombre_objets;\n//        tab2fic(\"db.txt\",tableau_articles,sizeof(tableau_articles));\n//   }\n\n}\n\n\n\nvoid consommer(int objet) {\n    //TODO: consommer l'objet\n    printf(\"je consomme %d\\n\",objet);\n}\n\nvoid producteur(void){\n//producteur\n    int i = 0;\n    int objet = 0;\n    while (i \u003c 10){\n        produire(\u0026objet);\n        struct sembuf op; // operation sur un semaphore    \n        /*P(\u0026places); on demande une place pour pouvoir déposer l'objet*/\n        op.sem_num=PLACE;op.sem_op=-1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n\n        /*P(\u0026mutex); on demande l'accès au MUTEX */\n        op.sem_num=MUTEX;op.sem_op=-1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n        \n        //TODO: deposer(objet);\n\n        /*V(\u0026mutex); on libère le MUTEX*/\n        op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n        /*V(\u0026atricles); on ajoute un article*/\n        op.sem_num=ARTICLE;op.sem_op=1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\t\n        usleep(10000);\n        i++;\n    }\n\n}\n\n\nvoid consommateur(void){\n//consommateur\n    int i = 0;\n    int objet = 0;\n    while (i \u003c= 10){\n        struct sembuf op; // operation sur un semaphore\n        /*P(\u0026articles); on veut obtenir un article */\n        op.sem_num=ARTICLE;op.sem_op=-1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n        /*P(\u0026mutex); on demande l'accès au MUTEX */\n        op.sem_num=MUTEX;op.sem_op=-1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n\n        //TODO: extraire(\u0026objet);\n\n        /*V(\u0026mutex); on demande l'accès au MUTEX */\n        op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\t\n        /*V(\u0026place); on ajoute une place vu que l'article est récupéré*/\n        op.sem_num=PLACE;op.sem_op=1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n\n        //TODO: consommer(objet);\n        i++;\n        usleep(10000);\n    }\n}\n\n// programme principal\nint main ( int argc , char **argv ) {\n    int pid; // numero des fils\n    ushort init_sem[3]={1,MAX,0}; //initialise le semaphore mutex\n   \n   // creation d'une cle IPC en fonction du nom du programme\n    if ((cle=ftok(argv[0],'0')) == -1 ) {\n        fprintf(stderr,\"Probleme sur ftoks\\n\");\n        exit(1);\n    }\n   // demande un ensemble de semaphore (ici un seul mutex)\n    if ((semid=semget(cle,3,IPC_CREAT|0666))==-1) {\n        fprintf(stderr,\"Probleme sur semget\\n\");\n        exit(2);\n    } \n   // initialise l'ensemble\n    if (semctl(semid,3,SETALL,init_sem)==-1) { \n        fprintf(stderr,\"Probleme sur semctl SETALL\\n\");\n        exit(3);\n    }\n    //TODO: initialiser le tableau\n    // \tsystem(\"echo \"\" \u003e db.txt \"); \n    // print_array(tableau_articles,sizeof(tableau_articles));\n    // tab2fic(\"db.txt\",tableau_articles,sizeof(tableau_articles));\n    if (fork() == 0) { \n        producteur();\n        exit(0);\n    }\n    if (fork() == 0) { \n        consommateur();\n        exit(0);\n    }\n\n    int i = 1;\n    for (i=1 ;i \u003c argc; i++){\n        int message;\n        pid=wait(\u0026message);\n    } \n    semctl(semid,0,IPC_RMID,0); // supprime le semaphore\n}\n```","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/C/Reader_writer":{"title":"Reader/writer","content":"\n```C\n#include \u003cunistd.h\u003e // appel systeme fork\n#include \u003cfcntl.h\u003e  // appel system unix ES\n#include \u003cstdio.h\u003e // librairie standard C\n#include \u003cstdlib.h\u003e // exit\n#include \u003csched.h\u003e  // sche_yield\n#include \u003csys/types.h\u003e\n#include \u003csys/sem.h\u003e // semaphore IPC\n#include \u003csys/ipc.h\u003e // services IPC\n#include \u003csys/wait.h\u003e // wait\n#include\u003csignal.h\u003e // signal\n#include\u003csys/time.h\u003e\n#include \u003csys/shm.h\u003e // segment partage IPC\nvoid tueurDeRoulette(int sig) {\n    fin = 1;\n    return;\n}\n\n#define MUTEX 0\n#define READER 1\n#define WRITER 2\n\nkey_t cle; /* cle ipc */\nint semid; /* nom de l'ensemble des semaphores */\nint shmid; /* nom du segment partage */\nshort fin; \nint lecteur;\nint demandeLecteur;\nint redacteur;\nint demandeRedacteur;\n\n\nvoid lecteurs(int nbRouleau, int*tab) {\n//reader\n    int i = 0;\n    while(!fin) {\n        struct sembuf op; // operation sur un semaphore\n        //P(\u0026MUTEX);\n        op.sem_num=MUTEX;op.sem_op=-1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n        if (redacteur || demandeRedacteur) {\n            demandeLecteur++;\n            //V(\u0026MUTEX);\n            op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n            semop(semid,\u0026op,1);\n            //P(\u0026LECTEUR)\n            op.sem_num=READER;op.sem_op=-1;op.sem_flg=0;\n            semop(semid,\u0026op,1);\n            //P(\u0026MUTEX);\n            op.sem_num=MUTEX;op.sem_op=-1;op.sem_flg=0;\n            semop(semid,\u0026op,1);\n            demandeLecteur--;\n\n        }\n        lecteur++;\n        //V(\u0026MUTEX);\n        op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n\n        // TODO: acces à la ressource\n        // for (int i = 0; i \u003c nbRouleau; i++)\n        //     printf(\"%d\",tab[i]);\n        // printf(\"\\r\");\n        // fflush(stdout);\n\n\n        //P(\u0026MUTEX);\n        op.sem_num=MUTEX;op.sem_op=-1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n        lecteur--;\n        if (lecteur == 0 \u0026\u0026 demandeLecteur) {\n            //V(\u0026REDACTEUR);\n            op.sem_num=WRITER;op.sem_op=1;op.sem_flg=0;\n            semop(semid,\u0026op,1);\n        }\n        //V(\u0026MUTEX);\n        op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n        semop(semid,\u0026op,1);\n        i++;\n        sleep(1);\n    }\n    \n    exit(0);\n}\n\nint main ( int argc , char **argv ) {\n    if( argc ==1){\n        fprintf(stderr,\"usage : %s  nombredeFils \\n\"),argv[0];\n        exit(1);\n    }\n    lecteur=0;\n    demandeLecteur=0;\n    redacteur=0;\n    demandeRedacteur =0;\n    //TODO: initialisation des variables\n    // int nbRouleau = atoi(argv[1]);\n    // int* tab = (int*)malloc(nbRouleau*sizeof(int));\n    // for (int i = 0; i \u003c nbRouleau; i++) {\n    //     tab[i] = rand() % 10;\n    // }\n\n   // creation d'une cle IPC en fonction de argv[0]\n    if ((cle=ftok(argv[0],'0')) == -1 ) {\n        fprintf(stderr,\"Probleme sur ftoks\\n\");\n        exit(1);\n    }\n    short init_sem[3]={3};\n    // demande un ensemble de semaphore (ici un)\n    if ((semid=semget(cle,3,IPC_CREAT|0666))==-1) {\n        fprintf(stderr,\"Probleme sur semget\\n\");\n        exit(2);\n    } \n    // initialise l'ensemble\n    if (semctl(semid,2,SETALL,init_sem)==-1) { \n        fprintf(stderr,\"Probleme sur semctl SETALL\\n\");\n        exit(3);\n    }\n\n    // CREE ET INITALISE  LE SEGMENT PARTAGE\n    // recupère le segment partagée\n    if ((shmid = shmget(cle, 4096, IPC_CREAT|0644)) == -1) {\n        fprintf(stderr, \"Probleme sur shmget\\n\");\n        exit(2);\n    }\n    // attache et s'empoisone au segment partagée\n    // shmat permet de récupérer l'adresse du segment partagé\n    if ((tab=(int*)shmat(shmid,NULL,0))==(int*)-1){\n        perror(\"shmat \");\n        fprintf(stderr, \"Probleme sur shmat\\n\");\n        exit(3);\n    }\n\n    struct sigaction actions;\n    int rc;\n    sigset_t set,oset;\n    sigemptyset (\u0026set);\n    sigaddset (\u0026set, SIGUSR1);\n    sigprocmask (SIGUSR1, \u0026set, \u0026oset);\n    sigemptyset(\u0026actions.sa_mask);\n    actions.sa_flags = 0;\n    actions.sa_handler = tueurDeRoulette; // fonction a lancer \n    rc = sigaction(SIGUSR1,\u0026actions,NULL);\n\n    // for (int i=0; i \u003c 10; i++)\n    pid_t pidLecteur[10];\n    for (int i = 0; i \u003c 10; i++) {\n        if (pidLecteur[i] = fork() == 0) {\n            lecteurs(nbRouleau, tab);\n        }\n    }\n\n\n    pid_t pid[nbRouleau];\n    for (int i = 0; i \u003c nbRouleau; i++) {  \n        pid[i] = fork();\n        if (pid[i] == 0) {\n            //arme le signal\n            struct sembuf op; // operation sur un semaphore\n            int res = tab[i];\n            while (fin != 1) {\n                sigprocmask (SIGUSR1, \u0026oset, NULL);\n                //P(\u0026MUTEX);\n                op.sem_num=1;op.sem_op=-1;op.sem_flg=0;\n                if (lecteur || redacteur || demandeRedacteur) {\n                    demandeRedacteur++;\n                    //V(\u0026MUTEX);\n                    op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n                    semop(semid,\u0026op,1);\n                    //P(\u0026REDACTEUR)\n                    op.sem_num=WRITER;op.sem_op=-1;op.sem_flg=0;\n                    semop(semid,\u0026op,1);\n                    //P(\u0026MUTEX);\n                    op.sem_num=MUTEX;op.sem_op=-1;op.sem_flg=0;\n                    semop(semid,\u0026op,1);\n                    demandeRedacteur--;\n                }\n                redacteur++;\n                //V(\u0026MUTEX);\n                op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n                semop(semid,\u0026op,1);\n                res++;\n                tab[i] = res%10;\n                //P(\u0026MUTEX);\n                op.sem_num=MUTEX;op.sem_op=-1;op.sem_flg=0;\n                semop(semid,\u0026op,1);\n                redacteur--;\n                if (demandeRedacteur) {\n                    //V(\u0026REDACTEUR);\n                    op.sem_num=WRITER;op.sem_op=1;op.sem_flg=0;\n                    semop(semid,\u0026op,1);\n                }\n                else if (demandeLecteur) {//V(\u0026LECTEUR);\n                    int nb;\n                    for (nb=0; nb \u003c demandeLecteur; nb++) {\n                        //V(\u0026READER)\n                        op.sem_num=READER;op.sem_op=1;op.sem_flg=0;\n                        semop(semid,\u0026op,1);\n                    }\n                    //V(\u0026MUTEX);\n                    op.sem_num=MUTEX;op.sem_op=1;op.sem_flg=0;\n                    semop(semid,\u0026op,1);\n                }\n                sigprocmask (SIGUSR1, \u0026set, NULL);\n                usleep(100000);\n            }\n\n            shmdt(tab);\n            exit(0);\n        }\n    }\n\n    for (int i = 0; i \u003c nbRouleau; i++) {\n        // printf(\"La roue n°%d tourne, appuyez sur une touche pour l'arreter\\n\",i+1);\n        getchar();\n        kill(pid[i],SIGUSR1);\n    }\n    for (int i = 0; i \u003c 10; i++) {\n       kill(pidLecteur[i],SIGUSR1);\n    }\n    \n    printf(\"numero des roulettes : \");\n    for (int i = 0; i \u003c nbRouleau; i++){\n        printf(\"%d \",tab[i]);\n    }\n\n\n    int valuesArray[10] = {0};\n    for (int i = 0; i \u003c nbRouleau; i++) {\n        valuesArray[tab[i]]++;\n    }\n    int nbSameMax = 0;\n    for (int i = 0; i \u003c 10; i++) {\n        if (valuesArray[i] \u003e nbSameMax) {\n            nbSameMax = valuesArray[i];\n        }\n    }\n\n    printf(\"\\n\");\n    if (nbSameMax \u003e= nbRouleau-1) printf(\"Gagné !\\n\");\n    else printf(\"Perdu !\\n\");\n\n    /* liberation du semaphore */\n    semctl(semid,0,IPC_RMID,0);\n    /* liberation du segment */\n    semctl(shmid,0,IPC_RMID,0);\n}\n```","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/Java/Reader-Writer":{"title":"Reader Writer","content":"\nProducer.\n\n```Java\npublic class Producer implements Runnable {\n    private Message msg;\n    \n    public Producer(Message msg) {\n        this.msg = msg;\n    }\n\n\n    @Override\n    public void run() {\n        String name = Thread.currentThread().getName();\n        System.out.println(name + \": started\");\n        try {\n            Thread.sleep(1000);\n            synchronized (msg) \n            {\n                msg.setMsg(\"hello world!\");\n                System.out.println(name+\": message is updated at: \" + LocalDateTime.now().toString());\n                msg.notify();\n                //msg.notifyAll();\n            }\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\nConsumer.\n\n```Java\npublic class Consumer implements Runnable{\n    private Message msg;\n \n    public Consumer(Message msg){\n        this.msg = msg;\n    }\n \n    @Override\n    public void run() {\n        String name = Thread.currentThread().getName();\n        synchronized (msg) {\n            try{\n                System.out.println(name+\": waiting to get notified at: \" + LocalDateTime.now().toString());\n                msg.wait();\n            }\n            catch(InterruptedException e){\n                e.printStackTrace();\n            }\n            System.out.println(name+\": got notified at: \" + LocalDateTime.now().toString());\n            //process the message now\n            System.out.println(name+\": message[\" + msg.getMsg() + \"] is processed.\");\n        }\n    }\n}\n```","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/Java/ReentrantLock":{"title":"ReentrantLock","content":"\n```java\nclass ReentrantLock {\n    private final Object sync = new Object(); // private monitor\n    private Thread lockedBy = null;  // null =\u003e unlocked \n    private int lockCount = 0;\n\n    public void lock() throws InterruptedException {\n        synchronized (sync) {\n            while (lockedBy != null \u0026\u0026 lockedBy != Thread.currentThread();)\n                wait();\n            lockedBy = callingThread; // (re)locked! \n            lockCount++;\n        }\n    }\n\n    public void unlock() {\n        synchronized (sync) {\n            if (Thread.currentThread() == lockedBy)\n                if (--lockCount == 0) {\n                    lockedBy = null;      // unlocked! \n                    notify();\n                }\n        }\n    }\n}\n```\n\npour le fifo, fo une LinkedBlockingQueue émércé","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/Linux-Process-States-and-Signals":{"title":"Linux Process States and Signals","content":"\n# Linux Process States and Signals\n\nWhen troubleshooting a system, it’s important to understand the process life-cycle and how the scheduler divides the CPU cores between the running processes and how the kernel communicates with process and how the processes communicate among themselves.\n\nTo see the system process states, you can look for the column S of `top` output (or column STAT of `ps x` output):\n\n\u003cimg width=\"692\" height=\"267\" src=\"../../../_resources/1_7BY0ifR6ufcn3zhxhRfQzw_9190c8d7f6c644c9ad8f9ec59.png\" class=\"jop-noMdConv\"\u003e\n\ntop command output, the process state is the column “s”\n\nLinux has basically 5 states:\n\n- **Running/Runnable :** running processes are processes using a CPU core right now, a runnable process is a process that has everything to run and is just waiting for a CPU core slot.\n- **Sleeping:** a sleeping process is a process waiting for a resource to be available (for example, a I/O operation to complete) or an event to happen (like a certain amount of time to pass). The difference between process in **Interruptible Sleep (S)** state and **Uninterruptible Sleep (D)** is that the former will wake up to handle signals while the former won’t. We’ll talk about signals in a moment, but let’s suppose that a process is waiting for a I/O operation to complete before wake up. If in the meantime, it receives a signal to terminate (**SIGKILL**), it will terminate before having the chance to handle the requested data. That’s why I/O operations *normally* go to uninterruptible sleep while waiting for the result: they will wake up with when the operation is ready, handle the result and, only then, check for any pending signal to handle. Processes that can be terminated before the wake up condition is fulfilled without any consequence usually go to interruptible sleep instead.\n- **Stopped (T):** a process becomes stopped when it receives the **SIGSTOP** signal (not unlike when you press `\u003cctrl\u003e+z` in the shell, although `\u003cctrl\u003e+z` sends a **SIGTSTP** instead). When stopped, the process execution is suspended and the only signals it will handle are **SIGKILL** and **SIGCONT**. The former will remove the process permanently, while the later will put the process back to the *Running/Runnable* state (like when you run `fg` or `bg` after pressing `\u003cctrl\u003e+z` in the shell).\n- **Zombie (Z):** we briefly talked about zombie processes when we discussed [system calls](https://medium.com/@cloudchef/linux-system-calls-c2867c7c30c1). When a process finishes with `exit()` system call, its state needs to be “reaped” by its parent (calling `wait()`); in the meantime, the child process remains in *zombie* state (not alive nor dead).\n\nThe diagram below helps understand the transition between process states:\n\n![](../../../_resources/1_IaPYYJt9tXFvDnLeWNuVbw_6f83373cc02840518dd69cbb1.png)\n\n# Signals\n\nSignals are one of the ways process communicate among themselves and with the kernel. They can be sent using the system call [**kill**](http://www.tutorialspoint.com/unix_system_calls/kill.htm) (despite the name, it can send any signal, not only **SIGKILL**) and the commands `kill` and `killall`.\n\nWhen receiving a signal, a process can chose to take one of the following actions:\n\n- execute the signal default action\n- block the signal setting a signal mask (this is done using the system call [**sigmask**](http://www.tutorialspoint.com/unix_system_calls/sigprocmask.htm))\n- assign a custom handler to the signal, executing a custom action (using the system call [**signal**](http://www.tutorialspoint.com/unix_system_calls/signal.htm))\n\nExceptionally, **SIGKILL** and **SIGSTOP** signals cannot be handled or blocked.\n\nThe list of the most commonly used signals follow:\n\n- **SIGTERM:** surprisingly, the default signal sent by `kill` command. Asks the process to terminate voluntarily.\n- **SIGKILL:** unlike **SIGTERM,** forces the process to terminate. Can’t be blocked or handled.\n- **SIGSTOP:** suspend the process execution, putting it in *stopped* state. In this state, the process will do nothing but accept **SIGKILL** and **SIGCONT** signals. Can’t be blocked or handled.\n- **SIGTSTP:** almost identical to **SIGSTOP**; the only difference is it can be blocked or handled. This is the signal sent when you type `\u003cctrl\u003e+z` in the terminal.\n- **SIGCONT:** if a process is in stopped state, it will put it back in the *running/runnable* state and resume it execution. If the process is in any other state, it’s silently ignored.\n- **SIGINT:** generated when the user type `\u003cctrl\u003e+c` in the terminal. It interrupts the current command processing and wait for user’s next command.\n- **SIGQUIT:** generated when the user type `\u003cctrl\u003e+\\` in the terminal. Normally, it will force the process to produce a [core dump](https://en.wikipedia.org/wiki/Core_dump) and terminate.\n- **SIGALRM:** signal used to wake up sleeping process, normally scheduled by [**alarm**](http://www.tutorialspoint.com/unix_system_calls/alarm.htm) system call.\n- **SIGCHLD:** signal send from a child process to its parent process when its state changes . The system call [**wait**](http://www.tutorialspoint.com/unix_system_calls/wait.htm) creates a signal handler for **SIGCHLD** in the parent process; by default it will trigger only when the child calls [**exit**](http://www.tutorialspoint.com/unix_system_calls/exit.htm), but it can be configured to be triggered by another state transitions as well.\n- **SIGWINCH:** generated when the terminal detects a change on its size. For full-screen terminal applications, it can trigger a refresh, otherwise can be safely ignored.\n- **SIGHUP:** this signal indicates the terminal handling the process has been disconnected and/or the parent process terminated. If you want to run a process that won’t terminate when the terminal disconnects, you can start it using the `nohup` command. Some daemons repurpose this signal to trigger a configuration reload without stopping its execution.\n- **SIGUSR1, SIGUSR2:** these signals are reserved for implementing custom actions.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/Synthese":{"title":"Synthese","content":"\n![17c966a53aca2680748797987a3f5f3f.png](../../../_resources/17c966a53aca2680748797987a3f5f3f.png)","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/Understanding-Processes-on-Linux":{"title":"Understanding Processes on Linux","content":"\n# \u003ca id=\"Linux_Processes_Basics\"\u003e\u003c/a\u003eLinux Processes Basics\n\nIn short, **processes are running programs on your Linux host** that perform operations such as writing to a disk, writing to a file, or running a web server for example.\n\nProcess have a **owner** and they are identified by a **process ID** (also called **PID**)\n\n![Process Identifier on Linux](../../../_resources/process-identity_9e08338194484bfea0ab2ec0b5780677.png)\n\nOn the other hand, **programs** are lines or code or lines of machine instructions stored on a persistent data storage.\n\nThey can just sit on your data storage, or they can be in execution, i.e running as processes.\n\n\u003cimg width=\"780\" height=\"350\" src=\"../../../_resources/program-process_2ebfb8dc46c54bc0acf6e899021d5d6d.png\"/\u003e\n\nIn order to perform the operations they are assigned to, processes need **resources** : **CPU time**, **memory** (such as **RAM** or **disk space**), but also virtual memory such as **swap space** in case your process gets too greedy.\n\nObviously, processes can be **started**, **stopped**, **interrupted** and even **killed**.\n\nBefore issuing any commands, let’s see how processes are created and managed by the kernel itself.\n\n## \u003ca id=\"Process_Initialization_on_Linux\"\u003e\u003c/a\u003eProcess Initialization on Linux\n\nAs we already stated, processes are **managed by the Kernel** on Linux.\n\nHowever, there is a core concept that you need to understand in order to know how Linux creates processes.\n\nBy default, when you boot a Linux system, your Linux kernel is loaded into memory, it is given a virtual filesystem in the RAM (also called **initramfs**) and the initial commands are executed.\n\nOne of those commands starts **the very first process on Linux.**\n\nHistorically, this process was called the [init process](https://en.wikipedia.org/wiki/Init) but it got replaced by the [systemd initialization process](https://en.wikipedia.org/wiki/Systemd) on many recent Linux distributions.\n\nTo prove it, run the following command on your host\n\n```\n$ ps -aux | head -n 2\n```\n\n\u003cimg width=\"780\" height=\"80\" src=\"../../../_resources/systemd_e397c788c4be43d69a5322411ae38665.png\"/\u003e\n\nAs you can see, the systemd process has **a PID of 1.**\n\nIf you were to print all processes on your system, using a tree display, you would find that all processes are children of the systemd one.\n\n```\n$ pstree\n```\n\n![Listing processes as a tree on Linux](../../../_resources/pstree_f8b96a2797534a7aa602060412e2ce6e.png)\n\nIt is noteworthy to underline the fact that all those initialization steps (except for the launch of the initial process) are done in a reserved space called **the kernel space.**\n\nThe kernel space is **a space reserved to the Kernel** in order for it to run essential system tools properly and to make sure that your entire host is running in a consistent way.\n\nOn the other hand, **user space is reserved for processes** launched by the user and managed by the kernel itself.\n\n\u003cimg width=\"780\" height=\"372\" src=\"../../../_resources/user-kernel-space_c52325429baa4dd7a68767bc1379d08c.png\"/\u003e\n\nAs a consequence, the systemd process is the very first process launched in the user space.\n\n## \u003ca id=\"Process_Creation_using_Fork_and_Exec\"\u003e\u003c/a\u003eProcess Creation using Fork and Exec\n\nWhen you are creating and running a program on Linux, it generally involves two main steps : **fork** and **execute**.\n\n### \u003ca id=\"Fork_operation\"\u003e\u003c/a\u003eFork operation\n\n[Fork](http://man7.org/linux/man-pages/man2/fork.2.html) is a clone operation, it takes the current process, also called the parent process, and it clones it in a new process with a brand new process ID.\n\nWhen forking, everything is copied from the parent process : **the stack**, **the heap**, but also the file descriptors meaning **the standard input, the standard output and the standard error.**\n\nIt means that if my parent process was writing to the current shell console, the child process will also write to the shell console.\n\n\u003cimg width=\"780\" height=\"735\" src=\"../../../_resources/fork_7bb5c5408b814ecd9705276dc6bc559a.png\"/\u003e\n\nThe execution of the cloned process will also start **at the same instruction as the parent process.**\n\n### \u003ca id=\"Execute_operation\"\u003e\u003c/a\u003eExecute operation\n\nThe execute operation is used on Linux **to replace the current process image with the image from another process.**\n\nOn the previous diagram, we saw that the stack of the parent process contained three instructions left.\n\nAs a consequence, the instructions were copied to the new process but they are not relevant to what we want to execute.\n\nThe [exec](http://man7.org/linux/man-pages/man3/exec.3.html) operation will replace the process image (i.e the set of instructions that need to be executed) by another one.\n\n\u003cimg width=\"780\" height=\"531\" src=\"../../../_resources/exec_587944a2a3b44172b5aceb9bbd4d0ec4.png\"/\u003e\n\nIf you were for example to execute the exec command in your bash terminal, your shell would terminate as soon as the command is completed as your current process image (your bash interpreter) would be replaced with the context of the command you are trying to launch.\n\n```\n$ exec ls -l\n```\n\nIf you were to trace the system calls done when creating a process, you would find that the first C command called is the exec one.\n\n![Strace process on Linux](../../../_resources/strace-linux_76af78a5711b4d2eb63d322830e31d8e.png)\n\n### \u003ca id=\"Creating_processes_from_a_shell_environment\"\u003e\u003c/a\u003eCreating processes from a shell environment\n\nWhen you are launching a shell console, the exact same principles apply when you are launching a command.\n\nA shell console is a process that waits for input from the user.\n\nIt also launches a bash interpreter when you hit Enter and it provides an environment for your commands to run.\n\nBut the shell follows the steps we described earlier.\n\nWhen you hit enter, **the shell is forked to a child process** that will be responsible for running your command. The shell will wait patiently until the execution of the child process finishes.\n\nOn the other hand, **the child process is linked to the same file descriptors** and it may share variables that were declared on a global scope.\n\nThe child process executes the “**exec**” command in order to replace the current process image (which is the shell process image) in the process image of the command you are trying to run.\n\nThe child process will eventually finish and it will print its result to the standard output it inherited from the parent process, in this case the shell console itself.\n\n\u003cimg width=\"780\" height=\"635\" src=\"../../../_resources/shell-execution_317473d9724b43ac81342e9117ecf762.png\"/\u003e\n\nNow that you have some basics about how processes are created in your Linux environment, let’s see some details about processes and how they can be identified easily.\n\n## \u003ca id=\"Identifying_running_processes_on_Linux\"\u003e\u003c/a\u003eIdentifying running processes on Linux\n\nThe easiest way to identify running processes on Linux is to run the **ps** command.\n\n```\n$ ps\n```\n\n![Listing processes on Linux using ps](../../../_resources/ps-command_fd50a5d8d0e54f1c9283ae08874b314e.png)\n\nBy default, the ps command will show you the list of the current running processes owned by the current user.\n\nIn this case, only two processes are running for my user : **the bash interpreter** and the **ps command** I have run into it.\n\nThe important part here is that processes have **owners**, most of the time the user who run them in the first place.\n\nTo illustrate this, let’s have a listing of the first ten processes on your Linux operating system, with a different display format.\n\n```\n$ ps -ef | head -n 10\n```\n\n\u003cimg width=\"780\" height=\"190\" src=\"../../../_resources/ps-ef_3517a481daa74e698d8f13d20908d949.png\"/\u003e\n\nAs you can see here, the top ten processes are owned by the user “**root**“.\n\nThis information will be particularly important when it comes to interacting with processes with signals.\n\nTo display the processes that are owned and executed by the current connected user, run the following command\n\n```\n$ ps u\n```\n\n\u003cimg width=\"780\" height=\"178\" src=\"../../../_resources/ps-u_f981c147cbec408493dff8fafc9d584f.png\"/\u003e\n\nThere are plenty of different options for the ps command, and they can be seen by running the manual command.\n\n```\n$ man ps\n```\n\nFrom experience, the two most important commands in order to see running processes are\n\n```\nps aux\n\nUSER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND\n```\n\nThat corresponds to a **BSD-style process listing**, where the following command\n\n```\nps -ef\n\nUID  PID  PPID C STIME TTY  TIME CMD\n```\n\nCorresponds to a **POSIX-style process listing**.\n\nThey are both representing current running processes on a system, but the first one has the “u” option for “user oriented” which makes it easier to read process metrics.\n\n\u003cimg width=\"780\" height=\"179\" src=\"../../../_resources/ps-aux_6603779b8edc40c696dfd61a6854361e.png\"/\u003e\n\nNow that you have seen what processes are and how they can be listed, let’s see what background and foreground processes are on your host.\n\n# \u003ca id=\"Background_and_foreground_processes\"\u003e\u003c/a\u003eBackground and foreground processes\n\nThe definition of background and foreground processes are pretty self-explanatory.\n\n## \u003ca id=\"Jobs_and_processes_in_the_current_shell\"\u003e\u003c/a\u003eJobs and processes in the current shell\n\n**A background process on Linux is a process that runs in the background, meaning that it is not actively managed by a user through a shell for example.**\n\nOn the opposite side, **a foreground process is a process that can be interacted with via direct user input.**\n\nLet’s say for example that you have opened a shell terminal, and that you typed the following command in your console.\n\n```\n$ sleep 10000\n```\n\nAs you probably noticed, your terminal will hang until the termination of the sleep process. As a consequence, the process is not executed in the background, it is executed in the foreground.\n\nI am able to interact with it. If I press Ctrl + Z, it will directly send a stop signal to the process for example.\n\n![Sleep process in bash shell](../../../_resources/foreground_a57153f72fa14098a64951fc1f4ec59c.png)\n\nHowever, there is a way to execute the process in the background.\n\nTo execute a process in the background, simply put a “**\u0026**” sign at the end of your command.\n\n```\n$ sleep 10000 \u0026\n```\n\nAs you can see, the control was directly given back to the user and the process started executing in the background\n\n![Executing a process in the background on Linux](../../../_resources/background_6cc108d8bfc147d3a6f5544896c455b2.png)\n\nTo see your process running, in the context of the current shell, you can execute the jobs command\n\n```\n$ jobs\n```\n\n![Listing jobs on the shell](../../../_resources/jobs_c7fae9f3f75b4800bc1fb3c1350f6d0a.png)\n\nJobs are a list of processes that were started in the context of the current shell and that may still be running in the background.\n\nAs you can see in the example above, I have two processes currently running in the background.\n\nThe different columns from left to right represent the the **job ID, the process state** (that you will discover in the next section), and **the command executed.**\n\n## \u003ca id=\"Using_the_bg_and_fg_commands\"\u003e\u003c/a\u003eUsing the bg and fg commands\n\nIn order to interact with jobs, you have two commands available : **bg** and **fg**.\n\n**The bg command is used on Linux in order to send a process to the background** and the syntax is as follows\n\n```\n$ bg %\u003cjob_id\u003e\n```\n\nSimilarly, in order to send a process to the foreground, you can use the **fg** in the same fashion\n\n```\n$ fg %\u003cjob_id\u003e\n```\n\nIf we go back to the list of jobs of our previous example, if I want to bring the job 3 to the foreground, meaning to the current shell window, I would execute the following command\n\n```\n$ fg %3\n```\n\n![Sending a process to the foreground on Linux](../../../_resources/fg-1_3251249fed57481095751cde8d83d5e8.png)\n\nBy issuing a Ctrl + Z command, I am able to stop the process. I can link it with a bg command in order to send it to the background.\n\n![Sending a process to the background on Linux](../../../_resources/bg-1_222dbdff777d4b7bacb1b8332c951592.png)\n\nNow that you have a better idea of what background and foreground processes are, let’s see how it is possible for you to interact with process using signals.\n\n# \u003ca id=\"Interacting_with_processes_using_signals\"\u003e\u003c/a\u003eInteracting with processes using signals\n\nOn Linux, signals are a form of **interprocess communication** (also called **IPC**) that creates and sends asynchronous notifications to running processes about the occurrence of a specific event.\n\nSignals are often used in order to **send a kill** or a **termination command** to a process in order to shut it down (also called kill signal).\n\nIn order to send a signal to a process, you have to use the **kill** command.\n\n```\n$ kill -\u003csignal number\u003e \u003cpid\u003e|\u003cprocess_name\u003e\n```\n\nFor example, in order to force a HTTPD process (PID = 123) to terminate (without a clean shutdown), you would run the following command\n\n```\n$ kill -9 123\n```\n\n## \u003ca id=\"Signals_categories_explained\"\u003e\u003c/a\u003eSignals categories explained\n\nAs explained, there are many signals that one can send in order to notify a specific process.\n\nHere is the list of the most common used ones :\n\n- **SIGINT** : short for signal interrupt is a signal used in order to interrupt a running process. It is also the signal that is being sent when a user pressed Ctrl + C on a terminal;\n- **SIGHUP** : short for signal hangup is the signal sent by your terminal when it is closed. Similarly to a SIGINT, the process terminates;\n- **SIGKILL** : signal used in order to force a process to stop whether it can be gracefully stopped or not. This signal can not be ignored except for the init process (or the systemd one on recent distributions);\n\n- **SIGQUIT** : specific signal sent when a user wants to quit or to exit the current process. It can be invoked by pressing Ctrl + D and it is often used in terminal shells or in SSH sessions;\n- **SIGUSR1, SIGUSR2** : those signals are used purely for communication purposes and they can be used in programs in order to implement custom handlers;\n- **SIGSTOP** : instructs the process to stop its execution without terminating the process. The process is then waiting to be continued or to be killed completely;\n- **SIGCONT** : if the process is marked as stopped, it instructs the process to start its execution again.\n\nIn order to see the full list of all signals available, you can run the following command\n\n```\n$ kill -l\n\n 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL\n 5) SIGTRAP      6) SIGABRT      7) SIGBUS       8) SIGFPE\n 9) SIGKILL     10) SIGUSR1     11) SIGSEGV     12) SIGUSR2\n13) SIGPIPE     14) SIGALRM     15) SIGTERM     16) SIGSTKFLT\n17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP\n21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU\n25) SIGXFSZ     26) SIGVTALRM   27) SIGPROF     28) SIGWINCH\n29) SIGIO       30) SIGPWR      31) SIGSYS      34) SIGRTMIN\n35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3  38) SIGRTMIN+4\n39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8\n43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12\n47) SIGRTMIN+13 48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14\n51) SIGRTMAX-13 52) SIGRTMAX-12 53) SIGRTMAX-11 54) SIGRTMAX-10\n55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7  58) SIGRTMAX-6\n59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2\n63) SIGRTMAX-1  64) SIGRTMAX\n```\n\n## \u003ca id=\"Signals_and_Processes_States\"\u003e\u003c/a\u003eSignals and Processes States\n\nNow that you know that it is possible to interrupt, kill or stop processes, it is time for you to learn about processes states.\n\nProcesses have many different states, they can be :\n\n- **Running** : processes running are the ones using some computational power (such as CPU time) in the current time. A process can also be called “runnable” if all running conditions are met, and it is waiting for some CPU time by the CPU scheduler.\n- **Stopped** : a signal is stopped is linked to the SIGSTOP signal or to the Ctrl + Z keyboard shortcut. The process execution is suspended and it is either waiting for a SIGCONT or for a SIGKILL.\n- **Sleeping** : a sleeping process is a process waiting for some event or for a resource (like a disk) to be available.\n\nHere is a diagram that represents the different process states linked to the signals you may send to them.\n\n\u003cimg width=\"780\" height=\"578\" src=\"../../../_resources/process-states_d46dc2a8bdba400ebdfe454727607d60.png\"/\u003e\n\nNow that you know a bit more about process states, let’s have a look at the pgrep and pkill commands.\n\n# \u003ca id=\"Manipulating_process_with_pgrep_and_pkill\"\u003e\u003c/a\u003eManipulating process with pgrep and pkill\n\nOn Linux, there is already a lot that you can do by simply using the ps command.\n\nYou can narrow down your search to one particular process, and you can use the PID in order to kill it completely.\n\nHowever, there are two commands that were designed in order for your commands to be even shorter : **pgrep and pkill**\n\n## \u003ca id=\"Using_the_pgrep_command\"\u003e\u003c/a\u003eUsing the pgrep command\n\nThe **pgrep** command is a shortcut for using the ps command piped with the grep command.\n\n**The pgrep command will search for all the occurrences for a specific process using a name or a defined pattern.**\n\nThe syntax of the pgrep command is the following one\n\n```\n$ pgrep \u003coptions\u003e \u003cpattern\u003e\n```\n\nFor example, if you were to search for all processes named “bash” on your host, you would run the following command\n\n```\n$ pgrep bash\n```\n\nThe pgrep command is not restricted to the processes owned by the current user by default.\n\nIf another user was to run the bash command, it would appear in the output of the pgrep command.\n\n![Searching for processes using pgrep on Linux](../../../_resources/pgrep_976100396f8d4735885da94c52cf88f1.png)\n\nIt is also possible to search for processes using [globbing characters.](https://en.wikipedia.org/wiki/Glob_%28programming%29)\n\n![Using globbing characters with pgrep](../../../_resources/pgrep-globbing_6f0a4a2cef1b48ff8538d7485058ac17.png)\n\n## \u003ca id=\"Using_the_pkill_command\"\u003e\u003c/a\u003eUsing the pkill command\n\nOn the other hand, the pkill command is also a shortcut for the ps command used with the kill command.\n\nThe pkill command is used in order to send signal to processes based on their IDs or their names.\n\nThe syntax of the pkill command is as follows\n\n```\n$ pkill \u003coptions\u003e \u003cpattern\u003e\n```\n\nFor example, if you want to kill all Firefox windows on your host, you would run the following command\n\n```\n$ pkill firefox\n```\n\nSimilarly to the pgrep command, you have the option to narrow down your results by specifying a user with the -u option.\n\nTo kill all processes starting with “fire” and owned by the current user and root, you would run the following command\n\n```\n$ pkill user,root fire*\n```\n\nIf you don’t have the rights to stop a process, you will get a permission denied error message to your standard output.\n\n![](../../../_resources/permission-denied-1_857780e2ee74434f9ecd810a87ddd2.png)\n\nYou also have the option to send specific signals by specifying the signal number in the pkill command\n\nFor example, in order to stop Firefox with a SIGSTOP signal, you would run the following command\n\n```\n$ pkill -19 firefox\n```\n\n# \u003ca id=\"Adjusting_process_priority_using_nice_and_renice\"\u003e\u003c/a\u003eAdjusting process priority using nice and renice\n\nOn Linux, not all processes are given the same priority when it comes to the CPU time.\n\nSome processes, such as very important processes run by root, are given a higher priority in order for the operating system to work on tasks that truly matter to the system.\n\n**Process priority on Linux is called the nice level.**\n\nThe nice level is a priority scale going from **-20 to 19.**\n\nThe lower you go on the niceness scale, the higher the priority will be.\n\nSimilarly, the higher you are on the niceness scale, the lower your priority will be.\n\nIn order to remember it, you can remember the fact that **“the nicer you are, the more you are willing to share resources with others”.**\n\n\u003cimg width=\"780\" height=\"323\" src=\"../../../_resources/nice_c279a4ea19404e509e57ade59bdd69f7.png\"/\u003e\n\nIn order to start a certain program or process with a given nice level, you will run the following command\n\n```\n$ nice -n \u003clevel\u003e \u003ccommand\u003e\n```\n\nFor example, in order to run the tar command with a custom tar level, you would run the following command\n\n```\n$ nice -n 19 tar -cvf test.tar file\n```\n\nSimilarly, you can use the renice command in order to set the nice level of a running process to a given value.\n\n```\n$ renice -n \u003cpriority\u003e \u003cpid\u003e\n```\n\nFor example, if I have a running process with the PID 123, I can use the renice command in order to set its priority to a given value.\n\n```\n$ renice -n 18 123\n```\n\n## \u003ca id=\"Niceness_and_permissions\"\u003e\u003c/a\u003eNiceness and permissions\n\nIf you are not a member of the sudo group (or a member of the wheel group on Red Hat based distributions), there are some restrictions when it comes to what you can with the nice command.\n\nTo illustrate it, try to run the following command as a non-sudo user\n\n```\n$ nice -n -1 tar -cvf test.tar file\n\nnice: cannot set niceness: Permission denied\n```\n\n![Permission denied on nice command](../../../_resources/nice-permissions_cb4805aadb2a4ccf9dad16a09102b252.png)\n\nWhen it comes to niceness, there is one rule that you need to know :\n\n**As a non-root (or sudo) user, you won’t be able to set a nice level lower than the default assigned one (which is zero), and you won’t be able to renice a running process to a lower level than the current one.**\n\nTo illustrate the last point, launch a sleep command in the background with a nice value of 2.\n\n```\n$ nice -n 2 sleep 10000 \u0026\n```\n\nNext, identify the process ID of the process you just created.\n\n![searching for a sleep process on Linux using ps](../../../_resources/sleep-10000_bf4e5eb51bc34b05bb65486bec2fd566.png)\n\nNow, try to set the nice level of your process to a value lower to the one you specified in the first place.\n\n```\n$ renice -n 1 8363\n```\n\n![Using renice to change process priority on Linux](../../../_resources/renice_c8357ae2878645d2978acb05d5c7c443.png)\n\nAs you probably noticed, you won’t be able to set the niceness level to 1, but only to a value higher than the one you specified.\n\nNow if you choose to execute the command as sudo, you will be able to set the nice level to a lower value.\n\n![Forcing renice on Linux](../../../_resources/sudo-rence_6e2bd1c55ce249be8991b805f9bc3257.png)\n\nNow that you have a clear idea of the nice and renice commands, let’s see how you can monitor your processes in real time on Linux.\n\n# \u003ca id=\"Monitoring_processes_on_Linux_using_top_and_htop\"\u003e\u003c/a\u003eMonitoring processes on Linux using top and htop\n\nIn a previous article, we discussed how it is possible to build a complete monitoring pipeline in order to [monitor Linux processes in real time.](https://devconnected.com/monitoring-linux-processes-using-prometheus-and-grafana/)\n\n## \u003ca id=\"Using_top_on_Linux\"\u003e\u003c/a\u003eUsing top on Linux\n\n**Top is an interactive command that any user can run in order to have a complete and ordered listing of all processes running on a Linux host.**\n\nTo run top, simply execute it without any arguments.\n\nTop will run in interactive mode.\n\n```\n$ top\n```\n\nIf you want to run top for a custom number of iterations, run the following command\n\n```\n$ top -n \u003cnumber\u003e\n```\n\n\u003cimg width=\"780\" height=\"292\" src=\"../../../_resources/top_2a990386526b4826808beea8d8fa36d0.png\"/\u003e\n\nThe top command will first show recap statistics about your system at the top, for example the number of tasks running, the percentage of CPU used or the memory consumption.\n\nRight below it, you have access to a live list of all processes running or sleeping on your host.\n\nThis view will refresh every three seconds, but you can obviously tweak this parameter.\n\nTo increase the refresh rate in the top command, press the “d” command and choose a new refresh rate\n\n![Changing top refresh rate](../../../_resources/refresh-rate_43c9ebfc7b0342b3bba2c2eedc1006e0.png)\n\nSimilarly, you can change the nice value of a running process live by pressing the “r” key on your keyboard.\n\nThe same permissions rules apply if you want to modify processes to a value lower to the one they are already assigned.\n\nAs a consequence, you may need to run the command as sudo.\n\n![Changing process priority on top](../../../_resources/renice-top_b0160f9b42d1420fa6210c3ecf0a9cc3.png)\n\n## \u003ca id=\"Using_htop_on_Linux\"\u003e\u003c/a\u003eUsing htop on Linux\n\nAlternatively, if you are looking for a nicer way to visualize processes on your Linux host, you can use the htop command.\n\nBy default, the htop command is not available on most distributions, so you will need to install it with the following instructions.\n\n```\n$ sudo apt-get update\n$ sudo apt-get install htop\n```\n\nIf you are running a Red Hat based distribution, run the following commands.\n\n```\n$ sudo yum -y install epel-release\n$ sudo yum -y update\n$ sudo yum -y install htop\n```\n\nFinally, to run the htop command, simply run it without any arguments.\n\n```\n$ htop\n```\n\n\u003cimg width=\"780\" height=\"472\" src=\"../../../_resources/htop_57f62cd884634cc294953e8acd04ebde.png\"/\u003e\n\nAs you can see, the output is very similar except that it showcases information in a more human friendly output.\n\n# \u003ca id=\"Conclusion\"\u003e\u003c/a\u003eConclusion\n\nIn this tutorial, you learnt many concepts about processes : how they are created, how they can be managed and how they can be monitored effectively.\n\nIf you are looking for more tutorials related to Linux system administration, we have a complete section dedicated to it on the website, so make sure to check it out.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/Understanding-Threads-in-Java":{"title":"Understanding Threads in Java.","content":"\n# Thread Life Cycle\n\n\u003cimg width=\"692\" height=\"566\" src=\"../../../_resources/1_kNkBnKP2QAqNsGnlqkJhHw_b8ee10d38f85426781f67b55b.jpeg\" class=\"jop-noMdConv\"\u003e\n\n(image:baeldung.com)\n\nIn the life cycle, there are 7 states. lets discuss about them,\n\n## New\n\nThis the state where the thread is created.\n\n## Ready/Runnable\n\nWhen the `start()` method is invoked to a particular thread, it will switch state from **New** to **Ready or Runnable** state\n\n## Running\n\nThe Thread will switch to Running state when `run()` method is invoked. which means when the process is executing. But it may go back to Ready/Runnable state and come back to Running state and this can happen again and again also.\n\n## Blocked\n\nThis is the state where one thread blocked on the lock because other thread has already acquired this lock.\n\n## Waiting\n\nIn this state, the thread will wait forever until if there is any interruption. Usually the invocation of `join()` or `wait()` method will put the thread in waiting state.\n\n## Timed Waiting\n\nWhen `sleep()` method or `join()` or `wait()` methods with timeout are invoked, that state is known as **Timed Waiting.** Name itself explains that the the thread will wait for a certain given time.\n\n## Dead\n\nThis state represents the completion of process.\n\n# how to create a Thread in Java ?\n\nIn Java, there are two ways to create a thread and they are,\n\n- By Extend Thread class\n- By Implement Runnable Interface\n\nlets check it one by one,\n\n## Extending Thread class\n\nIn here I am going to use 2 classes. So to create a Thread, we need to extend the Printer class with the Thread class as shown in the code below.\n\nNow to run the thread, we have to create an instance of the Thread class in the main method of the Application class and invoke that `start()` to that instance as I mentioned in the code below.\n\nSo If I run the application I will get the output as,\n\n```\n\u003ca id=\"7cde\"\u003e\u003c/a\u003eMain thread is running....\nChild thread is running....\n```\n\n## Facts about creating thread by Extending Thread class,\n\n- It is not must to override the run method in Thread class. Lets see why, when I call the `start()` it will check the Printer thread. Since I don’t have the `start()`method there, it will check the parent class witch is Thread class. In Thread class there will be a `start()` and that invokes `run()` method. So when calling run method it will the printer Thread class, since it doesn’t has the `run()` method, it will check the Thread class and it doesn’t do anything. Inside that run method, if the target is set then it will execute `target.run()` method. In our case we don’t have any target so it’s just don’t do anything. thats the reason it worked. So If we are not overriding the run method which means we are not doing any tasks, because all the process of threads have to go to `run()` method. This is only valid when we are Extend the Thread class. But when we implement the runnable interface, java program will force you to override the `run()` method. Because thats the behavior of the runnable interface which we are going to look next.\n- As you can see from the above code snippet, even though the `start()` method invoked(in line number 7 on the Application class) before printing the sentence in the main thread, it was printed after the main thread prints. which means, there is no guarantee that invoking `start()` method will immediately run the thread and it is entirely depend on the JRE(based on the OS). In the previous point, I mentioned about `target` which is a runnable object. In our case printer object, so if it has `run()` method then it will execute it and if not it will got the super class and execute the `run()` method as I said before. lets see some example,\n\nso in this child thread this should print from 1 to 10.\n\nand in the main thread this should print from 1 to 100\n\nSo I run this program several time to test the result. (I have taken only first few lines of the output to avoid too many unwanted spaces in the article)\n\n\u003e 1st time output\n\n```\n\u003ca id=\"dbf5\"\u003e\u003c/a\u003eMain thread is running....\nChild thread is running....\nmain 0\nchild 0\nchild 1\nmain 1\nmain 2\nmain 3\nchild 2\nmain 4\nchild 3\nmain 5\nchild 4\nmain 6\n.\n.\n```\n\n\u003e 2nd time output\n\n```\n\u003ca id=\"37eb\"\u003e\u003c/a\u003eMain thread is running....\nChild thread is running....\nchild 0\nmain 0\nmain 1\nmain 2\nchild 1\nmain 3\nchild 2\nmain 4\nchild 3\nmain 5\nchild 4\nmain 6\n.\n.\n```\n\n\u003e 3rd time output\n\n```\n\u003ca id=\"8c85\"\u003e\u003c/a\u003eMain thread is running....\nChild thread is running....\nchild 0\nmain 0\nchild 1\nmain 1\nchild 2\nmain 2\nchild 3\nmain 3\nchild 4\nmain 4\nchild 5\nmain 5\nchild 6\nmain 6\n.\n.\n```\n\nSo from the above results, each execution has different orders, so this gave a conclusion, that there is no guarantee the thread will start immediate whenever the `start()` method is invoked. Its because of the **Thread Scheduler** and this decides which thread should run (order) and its entirely depends on JRE (OS based) as I mentioned above.\n\n- What will happen if we invoke `run()` method without the `start()` method ? lets find out,\n\nSo when I run the above program, I got the output as follows,\n\n```\n\u003ca id=\"0493\"\u003e\u003c/a\u003eMain thread is running....\nChild thread is running....\nmain main 0\nchild Thread-0 0\nmain main 1\nchild Thread-0 1\nmain main 2\nchild Thread-0 2\nmain main 3\nchild Thread-0 3\nmain main 4\nchild Thread-0 4\nmain main 5\nchild Thread-0 5\nmain main 6\nmain main 7\nmain main 8\nmain main 9\nmain main 10\nchild Thread-0 6\nchild Thread-0 7\nchild Thread-0 8\nchild Thread-0 9\nmain main 11\nmain main 12\nmain main 13\nmain main 14\nmain main 15\nmain main 16\nmain main 17\nmain main 18\nmain main 19\nmain main 20\n.\n.\n.\nmain main 99\n```\n\nSo as you can see from the above output, I got the thread names because in the code, I have invoked `getName()` for the current threads. So lets see,\n\nas you can see I have removed the start method and used only run method and I got output as follows,\n\n```\n\u003ca id=\"22ee\"\u003e\u003c/a\u003eChild thread is running....\nchild main 0\nchild main 1\nchild main 2\nchild main 3\nchild main 4\nchild main 5\nchild main 6\nchild main 7\nchild main 8\nchild main 9\nMain thread is running....\nmain main 0\nmain main 1\nmain main 2\nmain main 3\nmain main 4\nmain main 5\n.\n.\n.\nmain main 99\n```\n\nSo as you can the from the output, it execute the child before executing the main because the `run()` method is not giving chance to create a threat which means we only have one thread in this scenario. So as a result it execute as a normal method call. So `start()` method is necessary because whenever this method is called, the JVM will handle lot of things such as, check whether the thread is already exist or not, whether the thread is ready to run and then it will register on the registers and add it to the thread pool and finally it will invoke the `run()` method. So if we invoke `run()` method without `start()` method then it won’t be a multi-threading scenario.\n\n- What will happen if we override the `start()` method in the Thread class? Yes, but lets say we are invoking `start()` method in `Printer class`, what it does is, it will look for the immediate class and it has the method so it will run and it won’t go to the super class to create a thread. So is there any way to create the thread even overriding the `start()` method? answer is yes we can, by simply putting `super.start()` inside the `start()` method of the Printer class.\n- What will happen if we overload the `run()` method? Yes, but Thread classes’ start method always invoke with the no arguments.\n- Most of the programmers think that the java program will terminate once the main thread terminates. But in reality its not a daemon thread so the child thread can actually continue. what we can do is, we can change the printer thread object to a daemon thread by giving `printer.setDaemon(true);` in the main class. At this point when you run the program, when the main thread ends the child thread also suppose to end but you may notice that the child thread will run for a certain period of time even after the main thread ends because at the moment when the main thread printing the last line, the child thread already processed up to certain values and the delay is occurred because of the time taken to print.\n- The main disadvantage of this method is, we will loose the hierarchy of the classes when we extend Thread class to that particular class because Java does not support multiple inheritances.\n\n![](../../../_resources/1_MpLGv4eK0oMbUncxGz6IHw_ff0f795e28904e10867d7529a.jpeg)\n\n## Implement Runnable Interface\n\nIn the above code we have used implements Runnable instead of extending from Thread class.\n\nRunnable interface is a **SAM (Single Abstract Method)** it has a single method called run and thats it. In this case we don’t have intermediate Thread class so we don’t have someone to implement the `run()` method. So what we did here is, We create an instance from a Thread class (which means we can pass Runnable instance to that as I mentioned in the previous thread creating method and also to give thread behavior) called `thread` and I pass the object `printer` as the parameter to the thread instance. Now `printer` is a **Runnable class**. That is why I invoked the start method from thread instance. And I got the output as follows,\n\n```\n\u003ca id=\"7eea\"\u003e\u003c/a\u003eMain thread is running....\nChild thread is running....\nmain main 0\nchild  0\nmain main 1\nchild  1\nmain main 2\nchild  2\nmain main 3\nchild  3\nchild  4\nchild  5\nmain main 4\nchild  6\nmain main 5\nchild  7\nmain main 6\nchild  8\nmain main 7\nchild  9\nmain main 8\nchild  10\nmain main 9\nchild  11\nMain thread Ends here\nchild  12\nchild  13\nchild  14\nchild  15\nchild  16\nchild  17\nchild  18\nchild  19\n===========================\n```\n\nSo this the method of creating thread in the second approach.\n\nThere are eight constructors in the Thread class such as,\n\n- Thread()\n\n```\n\u003ca id=\"c9bd\"\u003e\u003c/a\u003eThread T1 = new Thread();\n```\n\n- Thread(Runnable target)\n\n```\n\u003ca id=\"3567\"\u003e\u003c/a\u003eThread T2 = new Thread(printer);\n```\n\n- Thread(String name)\n\n```\n\u003ca id=\"03a2\"\u003e\u003c/a\u003eThread T3 = new Thread(name:\"printerThread\");\n```\n\n- Threat(Runnable target, String name)\n\n```\n\u003ca id=\"4184\"\u003e\u003c/a\u003eThread T4 = new Thread(printer, name:\"printerThread\");\n```\n\n- Thread(ThreadGroup group, String name)\n\n```\n\u003ca id=\"d26c\"\u003e\u003c/a\u003eThread T5 = new Thread(new ThreadGroup(),name:\"printerThread\");\n```\n\n- Thread(ThreadGroup group, Runnable target)\n\n```\n\u003ca id=\"b8bf\"\u003e\u003c/a\u003eThread T6 = new Thread(new ThreadGroup(),printer);\n```\n\n- Thread(ThreadGroup group, Runnable target, String name)\n\n```\n\u003ca id=\"5afd\"\u003e\u003c/a\u003eThread T7 = new Thread(new ThreadGroup(),printer,name:\"printerThread\");\n```\n\n- Thread(ThreadGroup group, Runnable target, String name, long stack size)\n\n# Thread Priority\n\nEvery thread has a thread priority and it will run according to the priority. and I to 10 is the Range of thread priority in Java. Basically 10 is the highest priority, 1 is the lowest and 5 is the normal priority.\n\nLets see how to set the Thread Priority to the previous example,\n\nSo to set the priority we have to invoke setPriority method to the thread. In our case the name of the thread is `thread`. So I invoked the method as in the above code (line number 9) and set it as a lowest priority thread.\n\n## Facts about the Thread Priority\n\n- Most of the programmers think that 5 is the default priority for every threads but that is not the case. Lets say there are two threads T1(main) and T2(child) and the thread priority is set to 5 for both threads. In reality there will be no changes. There is actually a rule in Thread Priority which is Main thread’s default priority value s 5 because it was created by the system. thereafter any thread that are created will inherit the parent thread priority value. So when creating the T1, the priority will be 5 and once we create T2 from T1, it will also take the same value even we didn’t set anything. But later we can set the priority by invoking the `setPriority()` method to the particular thread.\n- What will happen when we give priority value which are not in the range like 11 then what will happen ? I’ve tried to run a program by giving the thread priority to 11 and I got the output as follows,\n\n```\n\u003ca id=\"3b01\"\u003e\u003c/a\u003eException in thread \"main\" java.lang.IllegalArgumentException\n    at java.base/java.lang.Thread.setPriority(Thread.java:1137)\n    at threadSample.Application.main(Application.java:9)\n```\n\nas you can see I got an error saying `IllegalArgumentException`. So there is no chance it will automatically set to 10.\n\n- What will happen when we give priority value 1 and 10 for threads T1 and T2 respectively? most of the time there won’t be any big difference in the order of execution. Yes, the JVM will listen to the priority but we can’t be so sure that JVM will do accordingly. So if you want to see how it works, we have to implement this in the real project and there is way we can take the **Thread dump** and see. In there status of all threads will be recorded.\n\n# Other Methods in Thread\n\n## Join Method\n\nLets say there are two threads T1 and T2. T1 wants to wait for T2 to complete the task, then T1 should call the join method on T2 thread. We also can set time for T1 to wait. lets see what are those ways to call join method.\n\n`T2.join()` — this will wait forever or until T2 dies\n\n`T2.join(long millis)` —this will wait `millis` milliseconds for this thread to die.\n\n`T2.join(long millis,int nanos)` — this will wait `millis` milliseconds plus `nanos` nanoseconds for this thread to die.\n\nSo whenever the join method is called, the thread will go to waiting state from Running state. In this example T1 thread will go to waiting state. Lets see on what case the T1 will go back to the running state,\n\n1.  T2 complete its process\n2.  Timeout (only if the time is set)\n3.  When it is interrupted\n\n## Yield Method\n\nWhen the `yield()` method is invoked, then it will send a hint to the scheduler that the current thread is willing to yield its current use of a processor. It is a native method because it not implemented in Java. Lets say there are three threads T1,T2 and T3. So once the T1 calls the `yield()` method, the scheduler will give chance to other threads and it is not sure that T2 or T3 give get the chance immediately. Lets say T2 is getting the chance and once it completes at that moment also we can’t say that the scheduler will give the chance to T1. Its totally depend on the process called **Primitive Scheduling** and if the platform doesn’t support this process so you won’t able to see these kind of execution.\n\n## Sleep Method\n\nwhen this method is called, it can wait for a certain amount of time. In here there are two different approach to call this method such as,\n\n1.  `sleep(long millis)` method which is a native method and simply we can give the sleep time in the parameter.\n2.  `sleep(long millis,int nanos)` method which is not a native method(implemented in Java).\n\nSo if the sleep time finishes or if there is any interruption then the thread will go back to the running state.\n\n## Interrupt Method\n\nWhen this method is invoked, the particular thread will comeback to the ready state from the waiting state. That is why when calling a sleep method we should include try catch method as follows,\n\n```\n\u003ca id=\"f78d\"\u003e\u003c/a\u003etry {\n     Thread.sleep(1000);\n} catch (InterruptedException e) {\n    // TODO Auto-generated catch block\n    e.printStackTrace();\n}\n```\n\nso to interrupt the thread we have to call the method as follows,\n\n```\n\u003ca id=\"7e07\"\u003e\u003c/a\u003ethread.interrupt();\n```\n\nIn our example lets say`thread` is sleeping for 5000 ms and once we call the above method it will come back to the ready state. Important note here is one interrupt will only work for one sleep method. What if we call this method on the `thread` which is not sleeping. This will wait and execute the `interrupt()` method once the `sleep()` method is invoked until that it won’t do anything.\n\nThe **Synchronization** part will be discussed in a separate article.\n\n# References\n\nI have referred the following YouTube playlist to write this article, which was made by\n\n[Krishantha Dinesh](https://medium.com/u/26403c4bd160?source=post_page-----1f5a074d5753-----------------------------------)\n\n.\n\nAnd I also referred the following to complete this article,\n\n[\\## Thread (Java Platform SE 7 )\u003cbr\u003e\\### Every thread has a priority. Threads with higher priority are executed in preference to threads with lower priority…\u003cbr\u003edocs.oracle.com](https://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html)\n\n[\\## Life Cycle of a Thread in Java | Baeldung\u003cbr\u003e\\### In this article, we’ll discuss in detail a core concept in Java - the lifecycle of a thread. We’ll use a quick…\u003cbr\u003ewww.baeldung.com](https://www.baeldung.com/java-thread-lifecycle)\n\n## Sign up for NFT Weekly Digest\n\n### By Nerd For Tech\n\nSubscribe to our weekly News Letter to receive top stories from the Industry Professionals around the world [Take a look.](https://medium.com/nerd-for-tech/newsletters/nft-weekly-digest?source=newsletter_v3_promo--------------------------newsletter_v3_promo--------------)\n\nBy signing up, you will create a Medium account if you don’t already have one. Review our [Privacy Policy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=newsletter_v3_promo--------------------------newsletter_v3_promo--------------) for more information about our privacy practices.\n\n## [More from Nerd For Tech](https://medium.com/nerd-for-tech?source=post_page-----1f5a074d5753-----------------------------------)\n\nNFT is an Educational Media House. Our mission is to bring the invaluable knowledge and experiences of experts from all over the world to the novice. To know more about us, visit https://www.nerdfortech.org/.\n\n![Ramsunthar Sivasankar](../../../_resources/0_GSwtgEg-SbPpbCjc_c71d1aa93609450b94e21801ca57df1.jpg)\n\n[Ramsunthar Sivasankar](https://medium.com/@ramsunthar?source=post_page-----1f5a074d5753----0-------------------------------)\n\n[·May 15, 2021](https://medium.com/nerd-for-tech/introduction-to-git-and-github-for-beginners-cb52d3ac7d6f?source=post_page-----1f5a074d5753----0-------------------------------)\n\n[\\## Introduction to GIT and GitHub for Beginners\u003cbr\u003eIf you’re totally new to Git, this guide will walk you through getting started with Git, knowing what it’s for, and some basic principles you’ll need to know. What is Version Control ? The method of storing and controlling changes to software code is known as version control, sometimes known as source control. …](https://medium.com/nerd-for-tech/introduction-to-git-and-github-for-beginners-cb52d3ac7d6f?source=post_page-----1f5a074d5753----0-------------------------------)\n\n[Git](https://medium.com/tag/git?source=post_page-----1f5a074d5753---------------git--------------------)\n\n[8 min read](https://medium.com/nerd-for-tech/introduction-to-git-and-github-for-beginners-cb52d3ac7d6f?source=post_page-----1f5a074d5753----0-------------------------------)\n\n[\u003cimg width=\"112\" height=\"112\" src=\"../../../_resources/1_Jl2VDHVzFBDdXggRprziUg_f60de1697703420ab549794e2.png\" class=\"jop-noMdConv\"\u003e](https://medium.com/nerd-for-tech/introduction-to-git-and-github-for-beginners-cb52d3ac7d6f?source=post_page-----1f5a074d5753----0-------------------------------)\n\n* * *\n\nShare your ideas with millions of readers.\n\n[Write on Medium](https://medium.com/new-story?source=post_page_footer_cta_write----------------------------------------)\n\n* * *\n\n![Ramsunthar Sivasankar](../../../_resources/0_GSwtgEg-SbPpbCjc_c71d1aa93609450b94e21801ca57df1.jpg)\n\n[Ramsunthar Sivasankar](https://medium.com/@ramsunthar?source=post_page-----1f5a074d5753----1-------------------------------)\n\n[·May 15, 2021](https://medium.com/nerd-for-tech/floating-point-rounding-problem-in-programming-world-86c5639c102c?source=post_page-----1f5a074d5753----1-------------------------------)\n\n[\\## Floating Point Rounding problem in Programming World\u003cbr\u003eBefore starting anything, Look at the following java program, What do you think of this code, will it end when i hits 0 ?. lets look at the output, 10.0…](https://medium.com/nerd-for-tech/floating-point-rounding-problem-in-programming-world-86c5639c102c?source=post_page-----1f5a074d5753----1-------------------------------)\n\n[Java](https://medium.com/tag/java?source=post_page-----1f5a074d5753---------------java--------------------)\n\n[5 min read](https://medium.com/nerd-for-tech/floating-point-rounding-problem-in-programming-world-86c5639c102c?source=post_page-----1f5a074d5753----1-------------------------------)\n\n[![Floating Point Rounding problem in Programming World](../../../_resources/0_JHz0PqvwkU1XUJ1d_354adecee9da4f6c9329d9f2b5cd906.png)](https://medium.com/nerd-for-tech/floating-point-rounding-problem-in-programming-world-86c5639c102c?source=post_page-----1f5a074d5753----1-------------------------------)\n\n* * *\n\n![Rufat Khaslarov](../../../_resources/1_PuxdEbc0FA5hv0KgRpGvrA_7ba8e3d014594d2d96102ea72.jpeg)\n\n[Rufat Khaslarov](https://medium.com/@rufat-khaslarov?source=post_page-----1f5a074d5753----2-------------------------------)\n\n[·May 15, 2021](https://medium.com/nerd-for-tech/my-name-is-typescript-and-im-the-strictest-tool-on-earth-fce8fe41b353?source=post_page-----1f5a074d5753----2-------------------------------)\n\n[\\## My Name Is TypeScript, and I’m the Strictest Tool on Earth.\u003cbr\u003eAbout 2 million NPM downloads per month. More than 50% of developers use it on a daily basis. Almost 80% of the new projects are started with it out of the box. Last year, it has surged in popularity, leaving Python in 3rd place on Stack Overflow Trends. …](https://medium.com/nerd-for-tech/my-name-is-typescript-and-im-the-strictest-tool-on-earth-fce8fe41b353?source=post_page-----1f5a074d5753----2-------------------------------)\n\n[Typescript](https://medium.com/tag/typescript?source=post_page-----1f5a074d5753---------------typescript--------------------)\n\n[4 min read](https://medium.com/nerd-for-tech/my-name-is-typescript-and-im-the-strictest-tool-on-earth-fce8fe41b353?source=post_page-----1f5a074d5753----2-------------------------------)\n\n[\u003cimg width=\"112\" height=\"112\" src=\"../../../_resources/1_5YCL6C6hYyGirwY74_zhFg_533cb3bc7b154733b607415b5.jpeg\" class=\"jop-noMdConv\"\u003e](https://medium.com/nerd-for-tech/my-name-is-typescript-and-im-the-strictest-tool-on-earth-fce8fe41b353?source=post_page-----1f5a074d5753----2-------------------------------)\n\n* * *\n\n![Amit Singh Rathore](../../../_resources/2_xN2CPzDQO9CYNDC8I9Sg1w_1e76da101b1c41dda7684f0dd.jpeg)\n\n[Amit Singh Rathore](https://medium.com/@asrathore08?source=post_page-----1f5a074d5753----3-------------------------------)\n\n[·May 15, 2021](https://medium.com/nerd-for-tech/valid-number-daily-challenge-may-bb469d04ceb0?source=post_page-----1f5a074d5753----3-------------------------------)\n\n[\\## Valid Number — Daily Challenge May\u003cbr\u003eToday’s question is from Daily Leetcode Coding Challenge — May Edition. It is a Hard-tagged question. Let us look into the problem statement. 65. Valid Number A valid number can be split up into these components (in order): 1. A decimal number or an integer. 2.(Optional) …](https://medium.com/nerd-for-tech/valid-number-daily-challenge-may-bb469d04ceb0?source=post_page-----1f5a074d5753----3-------------------------------)\n\n[Python](https://medium.com/tag/python?source=post_page-----1f5a074d5753---------------python--------------------)\n\n[2 min read](https://medium.com/nerd-for-tech/valid-number-daily-challenge-may-bb469d04ceb0?source=post_page-----1f5a074d5753----3-------------------------------)\n\n[\u003cimg width=\"36\" height=\"19\" src=\"../../../_resources/1_Jm2pgdUBpBcKMoRG17FglQ_e942a6c049954569a8caeb462.jpeg\" class=\"jop-noMdConv\"\u003e](https://medium.com/nerd-for-tech/valid-number-daily-challenge-may-bb469d04ceb0?source=post_page-----1f5a074d5753----3-------------------------------)\n\n* * *\n\n\u003cimg width=\"24\" height=\"24\" src=\"../../../_resources/1_4ZQgRPwzxhgWyrRUFdh2vg_a74b6b9bcb3d4e22a900f7cb6.jpeg\" class=\"jop-noMdConv\"\u003e\n\n[Christopher Elias](https://medium.com/@christopher-elias?source=post_page-----1f5a074d5753----4-------------------------------)\n\n[·May 15, 2021](https://medium.com/nerd-for-tech/safe-retrofit-calls-extension-with-kotlin-coroutines-for-android-in-2021-part-ii-fd55842951cf?source=post_page-----1f5a074d5753----4-------------------------------)\n\n[\\## Safe Retrofit calls extension with kotlin Coroutines for Android in 2021 — Part II\u003cbr\u003eHello again 👋, this is the second part of the series. If you haven’t read the first part, I encourage you to do it in order to understand all the things we are going to do now. Safe Retrofit calls extension with kotlin Coroutines for Android in 2021 — Part I christopher-elias.medium.com Now that we know how do we have to handle exceptions with coroutines…](https://medium.com/nerd-for-tech/safe-retrofit-calls-extension-with-kotlin-coroutines-for-android-in-2021-part-ii-fd55842951cf?source=post_page-----1f5a074d5753----4-------------------------------)\n\n[Android App Development](https://medium.com/tag/android-app-development?source=post_page-----1f5a074d5753---------------android_app_development--------------------)\n\n[3 min read](https://medium.com/nerd-for-tech/safe-retrofit-calls-extension-with-kotlin-coroutines-for-android-in-2021-part-ii-fd55842951cf?source=post_page-----1f5a074d5753----4-------------------------------)\n\n[![Safe Retrofit calls extension with kotlin Coroutines for Android in 2021 — Part II](../../../_resources/0_OXju1fJY1LAZYizK_8c08878f91f44c55b90a3b7f3be60bc.jpg)](https://medium.com/nerd-for-tech/safe-retrofit-calls-extension-with-kotlin-coroutines-for-android-in-2021-part-ii-fd55842951cf?source=post_page-----1f5a074d5753----4-------------------------------)\n\n* * *\n\n[Read more from Nerd For Tech](https://medium.com/nerd-for-tech?source=post_page-----1f5a074d5753-----------------------------------)\n\n## More from Medium\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_h4S5qtDKMN6S2uFVJ3oB6g_d431bcbcd9984ba9bbffc4725.jpeg\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eA Glitch in the Matrix\u003cbr\u003eMaintenance, glitches and acronyms galore.](https://medium.com/@chescarobertson/a-glitch-in-the-matrix-bea962130cd9?source=post_internal_links---------0-------------------------------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_SABnYfT-DtAuwGOgkqs79g_bf5e22ca10a44400bf983b6c7.jpeg\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eCross-account data migration using AWS Database Migration Service](https://medium.com/@ivarb/cross-account-data-migration-using-aws-database-migration-service-d0c5a54b6caf?source=post_internal_links---------1-------------------------------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_eijebHTf3Tzw35tJD8fdQg_e433c13ddceb4282a2ded4161.png\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eBulk Operations in MongoDB\u003cbr\u003eLike most databases, mongoDB has mechanisms for bulk operations. Using these effectively is critical to optimal database performance](https://medium.com/mongodb-performance-tuning/bulk-operations-in-mongodb-fbc308acc332?source=post_internal_links---------2-------------------------------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_dl_sKg3pDfBtAE1uOKiUeQ_bc7c20833633493fb5a03ac62.png\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eAdventures in Cardano Stake Pool Operation Pt. 1](https://medium.com/@snowingada/adventures-in-cardano-stake-pool-operation-pt-1-497a674e5f28?source=post_internal_links---------3-------------------------------)\n\n[Java Interface and Abstract Class\u003cbr\u003eAbstract class and interface both are used to achieve abstraction where we can declare the abstract methods.](https://medium.com/@sanashamanji/java-interface-and-abstract-class-c629b80abe95?source=post_internal_links---------4-------------------------------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/0_xt2bufniUFIf36eS_a2f872b830364401ad0f46d65572314.jpg\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eHow To Create an Aurora UI Using CSS\u003cbr\u003eA look at the new UI design trend from a developer’s point of view](https://medium.com/better-programming/how-to-create-an-aurora-ui-using-css-eb27d674b69?source=post_internal_links---------5-------------------------------)\n\n[Automated deployment of Laravel Application to shared hosting (hostinger.com)](https://medium.com/@sebastian_kut/automated-deployment-of-laravel-application-to-shared-hosting-hostinger-com-b00121168b38?source=post_internal_links---------6-------------------------------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_q9uOess1x3l-lja1Es3tyA_2x_2a1f6094495148279b8b94.jpeg\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eWhat To Expect In StaFi In The Second Quarter of 2021](https://medium.com/@stretch0996/what-to-expect-in-stafi-in-the-second-quarter-of-2021-e4d820cedaef?source=post_internal_links---------7-------------------------------)\n\n[Sign In](https://medium.com/m/signin?operation=login\u0026redirect=https%3A%2F%2Fmedium.com%2Fnerd-for-tech%2Funderstanding-threads-in-java-1f5a074d5753\u0026source=--------------------------nav_reg--------------)\n\n[\u003cimg width=\"88\" height=\"88\" src=\"../../../_resources/0_GSwtgEg-SbPpbCjc_e810bc966db0440fbe41c9a9587023c.jpg\" class=\"jop-noMdConv\"\u003e](https://medium.com/@ramsunthar)\n\n[\\## Ramsunthar Sivasankar](https://medium.com/@ramsunthar)\n\nAssociate Software Engineer at Virtusa\n\n## Related\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_8gukzCgXD1aMWg_ULhFLQQ_cedf64e9ee724e03aaaf1afa3.png\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eWhy you Should use Spring as a Java Developer](https://medium.com/@liu-111/why-you-should-use-spring-as-a-java-developer-3300ee6e401b?source=read_next_recirc---------0---------------------234d0aa7_c574_4112_9d62_76907adcef81----------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_s4XHbw-1tciwVVpE2s3Yag_b2652178632b47b7a56848017.png\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eCollections in Java\u003cbr\u003eThe most dominant and crucial resource in the digital world is Data, with the access and storage of this entity anyone of us can lead…](https://medium.com/@pranay120398/collections-in-java-a21eb6fdfb0c?source=read_next_recirc---------1---------------------234d0aa7_c574_4112_9d62_76907adcef81----------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_iQPTq0gFlZ1MzXSCAjZEEg_3f1533d8da6541929fa930681.png\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eMy first ever experience in building servlet REST API.](https://medium.com/@pasindusri/my-first-ever-experience-in-building-servlet-rest-api-78782280842a?source=read_next_recirc---------2---------------------234d0aa7_c574_4112_9d62_76907adcef81----------)\n\n[\u003cimg width=\"58\" height=\"58\" src=\"../../../_resources/1_XBvCfESsMSN8LFGPpURVUQ_4ac9d4726fc24fef9be2b66ad.png\" class=\"jop-noMdConv\"\u003e\u003cbr\u003eEnums in JAVA\u003cbr\u003eJava enum is a special type of class that we can use to represent constant variables.  Usually, we can write a constant value by using a…](https://medium.com/nerd-for-tech/enums-in-java-f70b155b443e?source=read_next_recirc---------3---------------------234d0aa7_c574_4112_9d62_76907adcef81----------)\n\n[Help](https://help.medium.com/hc/en-us)\n\n[Status](https://medium.statuspage.io)\n\n[Writers](https://about.medium.com/creators/)\n\n[Blog](https://blog.medium.com)\n\n[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e)\n\n[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9)\n\n[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f)\n\n[About](https://medium.com/about?autoplay=1)\n\n[Knowable](https://knowable.fyi)\n\nTo make Medium work, we log user data. By using Medium, you agree to our [Privacy Policy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9), including cookie policy.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Concurrence-dans-les-syst%C3%A8mes/geeksForgeeksleS":{"title":"geeksForgeeksleS","content":"\nhttps://www.geeksforgeeks.org/introduction-of-process-synchronization/?ref=lbp\n\ny’a trop de pages pr moi","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Droit":{"title":"","content":"[Bases de données _ quelles protections _](Master/Droit/Bases%20de%20données%20_%20quelles%20protections%20_.md)\n[Droit d_auteur et protection des créations numériq](Master/Droit/Droit%20d_auteur%20et%20protection%20des%20créations%20numériq.md)\n[GNU, Linux et les logiciels libres](Master/Droit/GNU,%20Linux%20et%20les%20logiciels%20libres.md)\n[Les types d_entreprises](Master/Droit/Les%20types%20d_entreprises.md)\n","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Droit/Bases-de-donn%C3%A9es-_-quelles-protections-_":{"title":"Bases de données : quelles protections ?","content":"\n# La protection du contenu de la base de données\n\nOutre la structure de la base de données, son contenu peut également faire l’objet d’une protection particulière, *sui generis*, par le droit de la propriété intellectuelle. Le producteur de la base de données est défini par le \u003cins\u003e**[Code de la propriété intellectuelle](https://www.legifrance.gouv.fr/affichCode.do?idArticle=LEGIARTI000006279245\u0026idSectionTA=LEGISCTA000006161660\u0026cidTexte=LEGITEXT000006069414\u0026dateTexte=20161213#LEGIARTI000006279245)**\u003c/ins\u003e comme « *la personne qui prend l’initiative \\[de la base de données\\] et le risque des investissements correspondants* ».\n\nAfin que la base de données soit protégée par ce régime spécifique, il est nécessaire qu’un investissement financier, matériel ou humain ait été réalisé pour la constitution, la vérification ou la présentation du contenu de la base de données. Cet investissement doit être substantiel. \u003cins\u003e**[Selon la Cour de justice de l’Union Européenne](http://eur-lex.europa.eu/legal-content/FR/TXT/HTML/?uri=CELEX:62002CJ0203\u0026from=FR)**\u003c/ins\u003e, ces investissements recouvrent les moyens consacrés à la recherche d’éléments existants et à leur rassemblement dans la base de données, ainsi que ceux consacrés à la fiabilité de l’information contenue dans la base et au contrôle de leur exactitude tant lors de la constitution de la base que lors de son fonctionnement.\n\nLorsque cette condition est respectée, le producteur de la base de données dispose de plusieurs prérogatives, définies par l’\u003cins\u003e**[article L.342-1 du Code de la propriété intellectuelle](https://www.legifrance.gouv.fr/affichCode.do;jsessionid=0874BF60A10854836460BB813CEC0A58.tpdila13v_2?idSectionTA=LEGISCTA000006161661\u0026cidTexte=LEGITEXT000006069414\u0026dateTexte=20161213)**\u003c/ins\u003e. Il peut alors **interdire** l’extraction et la réutilisation de la totalité ou d’une partie qualitativement ou quantitativement substantielle du contenu de la base de données. Selon la Cour de justice de l’Union européenne, la notion de « *partie quantitativement substantielle* » se réfère au volume de données extrait ou réutilisé par rapport au volume total des données contenues dans la base. La notion de « *partie qualitativement substantielle* » quant à elle vise les investissements liés à l’obtention, à la vérification ou à la présentation de la base de données.\n\n![bases de données](http://www.avocats-mathias.com/wp-content/uploads/2016/12/Bases-de-donn%C3%A9es-garance-mathias.png)\n\n\u003e Ces deux régimes de protection sont autonomes, chacun répondant à des critères spécifiques. Par ailleurs, aucun dépôt n’est exigé pour bénéficier de l’une ou l’autre des protections !","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Droit/Droit-d_auteur-et-protection-des-cr%C3%A9ations-num%C3%A9riq":{"title":"Droit d'auteur et protection des créations numériques","content":"\n## Œuvres protégées :\n\nLa protection par droit d’auteur s’applique à toutes les œuvres de l’esprit quels qu’en soient le genre, la forme d’expression, le mérite ou la destination : œuvres littéraires, musicales, audiovisuelles, publicitaires, photographiques, mais aussi bases de données, sites Internet (=site web), blogs.\n\n## Condition de la protection du droit d’auteur :\n\nUne œuvre est un bien immatériel qu’aucune loi ne définit. La jurisprudence dégage 3 critères principaux pour qu’une œuvre soit protégée. Oeuvre :\n\n- **de création** : ce qui suppose une intervention humaine consciente qui a pour intention de créer quelque chose qui n’existait pas.\n- **originale** : l’œuvre doit être nouvelle et exprimer la personnalité de son auteur.\n- œuvre se manifestant par une expression ou une forme tangible\n\nCes critères sont une condition nécessaire et suffisante pour bénéficier de la protection du droit d’auteur : Le bénéfice de la protection n’est pas subordonné à l’accomplissement de formalités (à la différence des DPI tels que brevets, marques, dessins et modèles). L’existence d’un dépôt (ex. : notaire) peut cependant faciliter la preuve de la paternité et de la date de la création de l’œuvre.\n\n## Bénéficiaires de la protection :\n\nL’auteur : la qualité d’auteur appartient à la ou aux personnes qui ont réalisé la création intellectuelle de l’œuvre et les co-auteurs éventuels. Les ayants-droit (héritiers par ex.) également.\n\n## Droits exclusifs conférés à l’auteur d’une œuvre de l’esprit :\n\n–\\\u003e **moraux** servent à protéger la personnalité de l’auteur à travers son œuvre (art L 121-1 du CPI)\n\n–\\\u003e **patrimoniaux** : autoriser l’exploitation de son œuvre et en tirer un profit pécuniaire (art LI 23-1 du CPI)\n\n![protection des créations numériques](../../../_resources/image_680f63c2a34a4fdf8b7a6e44cd1bcb44.png)\n\n## Durée de la protection\n\n–\\\u003e Le droit moral est perpétuel.\n\n–\\\u003e Les droits patrimoniaux : L’auteur jouit, sa vie durant, du droit exclusif d’exploiter son œuvre sous quelque forme que ce soit et d’en tirer un profit pécuniaire. La protection persiste au profit de ses héritiers pendant les70 ans qui suivent son décès, puis l’œuvre tombe dans le domaine public sous réserve du respect du droit moral.\n\nCes droits peuvent être cédés à la condition que cette autorisation soit expresse.\n\n# Une nécessaire adaptation au monde numérique\n\n- #### **Dans l’univers numérique, le droit d’auteur s’applique : droit moral et droits patrimoniaux**\n    \n\nToutes les œuvres sont protégées, quels que soient leur genre, leur forme d’expression, leur mérite ou leur destination (article L. 112-1 CPI). Les supports numériques n’ont rien changé à cette disposition. Les droits d’auteur contèrent des droits moraux (art. L 121.1 du CPI) et des droits patrimoniaux (art. L 122.1 du CPI) à leur auteur. La protection d’une production immatérielle au titre du droit d’auteur s’applique sur le contenu, l’architecture (le fond et la forme) à condition que cette création soit originale.\n\n- #### Cependant il existe quelques dérogations légales aux droits exclusifs de l’auteur : art. L 122.5 du CPI) :\n    \n\nCes exceptions sont à appliquer strictement car elles ne doivent pas porter préjudice aux intérêts de l’auteur.\n\nSont tolérées :\n\n- Les copies ou reproductions réservées à l’usage privé du copiste et non destinées à un usage collectif. La copie ne doit pas porter préjudice économique à l’auteur (de quoi vivra-t-il ?) ni porter atteinte à l’exploitation normale de l’œuvre (toute copie illicite de DVD supprime des ventes et empêche l’amortissement des coûts de production).\n    \n- Les courtes citations, revues de presse quand sont indiqués clairement le nom de l’auteur et la source\n    \n- La reproduction d’un logiciel à des fins de conservation (copie de sauvegarde)\n    \n- La reproduction et la représentation d’extraits d’œuvre dans le cadre de l’enseignement et de la recherche (sauf partitions musicales et ouvrages conçus à des fins pédagogiques)\n    \n\n# Cependant ces droits sont de plus en plus difficiles à protéger :\n\n- développement des réseaux numériques à l’échelle mondiale\n    \n- facilité de reproduction, de conservation, de consultation des œuvres numériques – faible coût de la reproduction numérique\n    \n- facilité de modifier l’œuvre grâce à des logiciels appropriés\n    \n- possible anonymat des infractions\n    \n- avancées technologiques qui permettent de contourner les lois nationales, etc.\n    \n\n### La protection juridique des droits d’auteurs en univers numérique\n\n2 types de protection : l’une technique, l’autre légale.\n\n#### La défense technique et ses limites juridiques\n\nL’OMPI (organisation mondiale de la propriété intellectuelle), la directive européenne sur les droits d’auteur (2001), la loi DADVSI (droits d’auteurs et droits voisins dans la société de l’information) autorisent les mesures techniques de protection.\n\nLes DRM (Digital Rights Management Systems) sont un système de protection technique des œuvres diffusées en numérique. Ils permettent d’identifier l’utilisateur de l’œuvre, d’établir des statistiques sur les utilisations d’œuvres protégées et de s’assurer du respect des licences d’utilisation. Des DRM sont ainsi intégrés dans les DVD et dans les fichiers numériques, qu’ils soient diffusés en streaming (flux vidéo) ou téléchargeables. En quelque sorte, ce sont des « tatouages » ou « scellés numériques » qui permettent de tracer l’œuvre. Ils doivent être portés à la connaissance du public.\n\nLe contournement et la suppression de ces mesures techniques de protection représentent une infraction (3750 €).\n\nCette protection technique est controversée. Elle peut être jugée comme présentant un danger pour la vie privée des utilisateurs, rendant difficilement compatible le droit d’auteur avec le droit du propriétaire du support. Pour certains tribunaux, elle est analysé comme un vice caché créant une restriction d’usage qui rend le produit impropre à l’usage auquel on peut légitimement s’attendre.\n\n#### La défense légale des droits d’auteur\n\nLe droit d’auteur naît de sa seule création. Puisqu’il n’y a pas de dépôt pour bénéficier de protection, c’est le fait juridique de la création qui permet la naissance du droit d’auteur. Le dépôt légal existe, mais il est sansinfluence sur le droit d’auteur. Il apporte la preuve de la date de création en cas de recours puisque la présomption de la qualité d’ auteur/créateur est une présomption simple.\n\nLe droit d’auteur est légalement protégé par l’action en contrefaçon, l’action en concurrence déloyale et la loi Hadopi.\n\n- #### La loi »HADOPI »\n    \n\nLes pouvoirs publies ont voulu protéger la propriété littéraire et artistique en créant un dispositif pour protéger les droits des auteurs dans l’univers numérique et lutter contre les téléchargements illégaux.\n\nComme le piratage est aujourd’hui un piratage de masse et domestique, qui n’a rien à voir avec la contrefaçon professionnelle et très lucrative, il a fallu adapter la loi sur le délit de contrefaçon en conséquence.\n\nAu terme de péripéties juridiques, la loi dite HADOPI 2″ a été promulguée le 28.10.2009. C’est la loi relative la protection pénale de la propriété littéraire et artistique sur Internet. C’est une loi qui crée un dispositif qui se veut **pédagogique et gradué**.\n\nVoici les principaux dispositifs :\n\n- Création de la HADOPI (haute autorité pour la diffusion des œuvres et la protection des droits sur internet).\n\nC’est une AAI qui veille à l’application des dispositions législatives. Elle promeut les offres légales d’œuvres numériques.\n\n- \\*\\*Action contre l’abonné qui ne remplit pas son obligation de surveillance (ou de veille) : \\*\\*\n\nIl commet une contravention de négligence caractérisée dans la sécurisation de l’accès à Internet. C’est une infraction pénale moins importante que le délit (l’abonné n’a pas veillé à ce que son accès ne soit pas utilisé pour commettre un acte de contrefaçon).\n\nLe dispositif prévu contre lui est appelé « riposte graduée ». Il prévoit 2 avertissements successifs avant la sanction prononcée par le juge.\n\n- #### L’action en contrefaçon = action contre le contrefacteur (le pirate)\n    \n\nLa contrefaçon est une atteinte aux droits de l’auteur, et plus particulièrement à ses droits patrimoniaux. La contrefaçon est un délit civil qui se définit comme une atteinte aux droits de reproduction et de représentation ou d’exploitation d’une oeuvre sans l’accord de l’auteur, indépendamment de toute faute ou mauvaise foi. Les sanctions civiles encourues sont la réparation par versement de d\u0026i et la cessation de l’acte de contrefaçon. Le tribunal compétent est un tribunal civil (TI Ou TGI) ou le Tribunal de commerce.\n\nC’est aussi un délit pénal qui présente un caractère intentionnel. Le délit de contrefaçon suppose la volonté et la conscience de porter atteinte aux intérêts de l’auteur (volonté de nuire). Le pirate commet un « acte de contrefaçon au moyen d’un service de communication au public en ligne » (nouvel art. L 335-7 du CPI).Peu importe le moyen technique d’échange et de diffusion numérique; la technologie est neutre.\n\nLe délinquant encourt comme sanction principale 3 ans de prison et 300 000 € d’amende (multipliée par 5 s’il s’agit d’une Personne Morale). Et comme sanction complémentaire une suspension à l’accès à Internet d’1 an maximum (nouvel art L335-7 du CPI). Le juge tiendra compte du profil du délinquant (gravité de l’infraction, personnalité, activité professionnelle). Cette peine ne sera pas inscrite au casier judiciaire.\n\n\u003cimg width=\"750\" height=\"330\" src=\"../../../_resources/photographer-2751460_1280-1024x4_af0cb33ec6da4bc09.jpg\" class=\"jop-noMdConv\"\u003e\n\n## La protection des créations numériques\n\n### La base de données\n\n- #### Notion\n    \n\nUne base de données est un « recueil d’œuvres, de données ou d’autres éléments indépendants, disposés de manière systématique ou méthodique et individuellement accessible par des moyens électroniques ou par tout autre moyen » (art. L. 112-3 al. 2 CPI).\n\nUn dictionnaire ou un annuaire sont des bases de données.\n\n- #### Les informations qui y figurent sont de différents statuts :\n    \n\nLa banque de données est une **Œuvre composite**.\n\n- Certaines informations sont librement enregistrables : Données produites par le concepteur, œuvres tombées dans le domaine public (sous réserve de respecter le droit moral de leur auteur), données d’actualités.\n    \n- Les autres (données à caractère personnel, œuvres de l’esprit encore protégées) sont soumises à autorisation. Le créateur d’une base de données doit veiller à ne pas porter atteinte des droits juridiquement protégés.\n    \n- #### Protection juridique de la base de données\n    \n\nLes bases de données font l’objet d’une protection au titre du droit d’auteur et au titre d’un droit « sui generis » pour les producteurs de bases de données, indépendant du droit d’auteur.\n\n–\\\u003e La protection par le droit d’auteur\n\nElle demeure la propriété de son auteur, sous réserve des droits de l’auteur de l’œuvre préexistante (article L. CPI).\n\nElle est accordée s’il y a une originalité car les bases de données constituent des créations intellectuelles notamment du fait des choix de disposition et d’organisation qui sont effectués par les auteurs ; une simple compilation ne peut donc pas bénéficier de la protection.\n\nCette protection confère à l’auteur de la base de données les droits moraux et patrimoniaux classiques sur une oeuvre de l’esprit : droit exclusif de divulgation, droit à l’intégrité de l’œuvre, droit de s’opposer notamment à toute représentation ou reproduction, intégrale ou partielle, sans son autorisation. Il en est de même pour la traduction, l’adaptation ou la transformation de la base de données.\n\n### Le site Internet\n\n- #### Notion\n    \n\nUn site Internet (site Web) est un ensemble de pages constituées de textes, d’images, de sons, de vidéos… ces pages sont consultables en suivant des liens hypertextes (hyperliens) ; ces pages sont mises en ligne à une adresse Web (Internet) correspondant à un nom de domaine qu’il faut réserver.\n\nChaque site Web a un propriétaire (entreprise, administration, association, particulier. …). Lorsque le site est créé par un particulier, on parle de blog.\n\n- #### Protection\n    \n\nLa protection du site Internet, dès lors qu’il présente un caractère d’originalité, est assurée globalement par le droit d’auteur car il constitue, en tant qu’œuvre multimédia, une œuvre de l’esprit. Cette protection confère les droits moraux et patrimoniaux classiques. Inversement, le titulaire d’un site Internet ne doit pas porter atteinte à des droits juridiquement protégés.\n\nLa protection d’un site Internet peut aussi être assurée en protégeant les différents éléments du site.\n\n- Le nom de domaine peut être protégé par :\n\n–\\\u003e le droit d’auteur si le nom du site a un caractère original,\n\n–\\\u003e l’action en concurrence déloyale en tant que nom commercial si le nom de domaine est effectivement utilisé, et pas seulement réservé,\n\n–\\\u003e par le droit des marques si le nom de domaine est déposé en tant que marque auprès de l’INPI. (Inversement, le créateur du site web doit s’assurer que le nom de domaine qu’il choisit n’est pas une marque protégée, ni la raison sociale d’une société, ni un patronyme connu).\n\n–\\\u003e La présentation du site (c’est-à-dire page écran, graphisme, animation, arborescence d’un site) peut être protégée par le droit d’auteur (condition d’originalité) ; inversement, le créateur du site web doit veiller à ne pas porter atteinte à des droits juridiquement protégés. L’aspect graphique peut aussi être protégé par dépôt de dessin et modèle auprès de l’INPI.\n\n–\\\u003e Les bases de données par le droit d’auteur et le droit du producteur.\n\n- #### Responsabilité civile et pénale des différents acteurs de l’internet (fournisseurs de contenu, d’hébergement, d’accès et transporteur)\n    \n\n**Le régime de responsabilité des fournisseurs de contenus** (éditeurs de contenus). L’éditeur d’un site Internet est la personne physique ou morale qui met à la disposition du public, à titre professionnel ou non, des pages d’informations sur Internet. Il peut être assimilé à un responsable de publication, et est responsable de tous les contenus figurant sur son site. Il est présumé responsable non seulement de ce qu’il écrit personnellement mais aussi des commentaires édités sur son site.\n\nAttention : *L’éditeur d’un blog à caractère personnel a une obligation de surveillance des contenus figurant sur son site. Le Forum des droits sur l’Internet recommande aux blogueurs « qui laissent la possibilité de poster des commentaires de prendre soin de consulter très régulièrement leur blog ».*\n\n** Le régime de responsabilité des fournisseurs d’hébergement** (hébergeurs de contenus).\n\nL’hébergeur assure le stockage direct et permanent d’images, d’écrits, de sons ou de messages pour le mettre à la disposition du public. Il permet donc aux auteurs de mettre en ligne des contenus dont il n’est pas l’éditeur. Il fournit les logiciels pour créer des pages Web et l’hébergement de ces pages sur des serveurs connectés à Internet (article 6-1-2 de la loi du 21 juin 2004).\n\nL’hébergeur n’est pas soumis à une obligation générale de surveillance des contenus qu’il héberge, selon l’article 6-1-2 et 6-1-3 de la loi du 21 juin 2014 (LCEN). Sa responsabilité civile et pénale ne peut être engagée du fait des contenus qu’il stocke, sauf s’il avait effectivement une connaissance de leur caractère illicite ou de faits et circonstances faisant apparaître ce caractère illicite, ou si, dès le moment ou il en a eu connaissance, il n’a pas agi avec promptitude pour retirer ces données ou en rendre l’accès impossible.\n\n**Attention**: on peut être à la fois hébergeur et éditeur pour un forum de discussion.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Droit/GNU-Linux-et-les-logiciels-libres":{"title":"","content":"# Les logiciels libres et la Free Software Foundation\n\nLa Free Software Foundation est une organisation dont le but est de développer des logiciels libres. Le terme de « libre » signifie clairement que chacun peut faire ce qu’il veut du logiciel, y compris le modifier. La vente n’est absolument pas interdite, et il faut donc faire la distinction entre libre et gratuit. Cela étant dit, les logiciels libres sont souvent de facto gratuits, car ils sont librement redistribuables par quiconque en possède une copie.\n\nLa liberté de modifier les logiciels libres implique naturellement que leur code source, c’est à dire le texte de leur programme tel qu’il a été saisi par ses auteurs, soit librement accessible et modifiable. Les logiciels libres sont donc qualifiés de logiciels « Open Source », ce qui signifie en anglais que les sources du programme sont disponibles. Attention cependant, tous les logiciels Open Source ne sont pas forcément libres, car il n’est pas toujours possible de modifier ce code source et de le redistribuer librement (éventuellement gratuitement). Ainsi, nombre d’éditeurs de logiciels propriétaires publient leur code source sans pour autant donner de droits supplémentaires à ceux qui les lisent. Certains d’entre eux jouent d’ailleurs explicitement sur cette confusion. De plus, la plupart des journalistes anglo-saxons font cette confusion et, de ce fait, occultent tous les avantages des logiciels libres. Vous trouverez de plus amples informations sur la notion de code source dans le [Chapitre 7](http://casteyde.christian.free.fr/system/linux/guide/online/c6934.html).\n\n# Le projet GNU et Linux\n\nLa licence GPL a été écrite initialement pour le projet GNU de la Free Software Foundation, dont le but est de réaliser un système Unix libre et indépendant des Unix commerciaux. Précisons ici que le terme « Unix » caractérise un ensemble de systèmes d’exploitation, qui disposent tous à peu près des mêmes fonctionnalités et proposent d’y accéder de la même manière.\n\nLe projet GNU est toujours en cours, puisque la Free Software Foundation a déjà écrit la plupart des utilitaires Unix, mais que le cœur du système (ce que l’on appelle le noyau) est toujours en cours de réalisation. Pour information, ce noyau se nomme « Hurd ».\n\nCependant, d’autres noyaux sont disponibles, avec lesquels les commandes GNU peuvent être utilisées. Parmi ces noyaux, il existe bien entendu Linux, qui a été écrit par le Finlandais Linus Torvalds lorsqu’il était étudiant, et amélioré par des programmeurs du monde entier sur Internet. Linux est un noyau parmi tant d’autres, à ceci près qu’il est, lui aussi, distribué sous la licence GPL, bien que n’ayant rien avoir avec la Free Software Foundation.\n\nCela signifie qu’il serait en fait plus exact de parler du système « GNU/Linux » que de « Linux » tout court. Sous cette dénomination, il est clair que ce système est constitué des outils GNU fonctionnant sur le noyau Linux. C’est donc un ensemble de logiciels libres provenant de plusieurs sources distinctes. Cependant, il est très courant d’entendre parler de « Linux » tout court, par abus de langage et par souci de simplicité. Bien entendu, cette dénomination est proscrite sur les sites Internet de la Free Software Foundation, qui devient très susceptible à ce sujet.\n\nPour information, le terme « GNU » est l’abréviation de l’anglais « GNU’s Not Unix ». Cette curieuse phrase rappelle que le projet GNU est de réaliser un système Unix différent des autres. Vous remarquerez que cette définition est récursive, c’est-à-dire qu’elle utilise le mot « GNU » elle-même. Cela doit être attribué au goût des développeurs de la Free Software Foundation pour ce genre de définition infiniment récursive. Vous ne saurez sans doute jamais les raisons qui les ont poussés à choisir la lettre ‘G’ dans leur définition. Cela étant, « GNU » se prononce « gnou » en anglais, et vous trouverez donc souvent la représentation d’un gnou sur les sites Internet de GNU.\n\n# Droits d’auteurs et la licence GPL\n\nIl faut bien comprendre que le fait de diffuser un logiciel sous une licence libre ne prive absolument pas son auteur de ses droits. Il en reste l’auteur et, en tant que tel, conserve les droits d’auteurs sur son travail. Il ne fait que concéder la liberté d’exploiter ce travail aux autres. C’est en cela que les logiciels libres se démarquent du domaine publique, dont les logiciels ne sont plus soumis à aucun droit.\n\nAfin de protéger les logiciels libres et leurs auteurs, la Free Software Foundation a rédigé la licence GPL (abréviation de l’anglais « General Public License »). Cette licence stipule que le logiciel libre peut être redistribué, utilisé, modifié librement, pourvu que celui qui en bénéficie accorde les mêmes droits à ceux à qui il fournit les copies du logiciel, qu’il l’ait modifié ou non. En d’autre termes, elle garantit que la liberté des uns s’arrête là où commence celle des autres.\n\nCette licence empêche donc l’aliénation du logiciel et sa transformation en logiciel propriétaire, de quelque manière que ce soit. Cela implique que tout logiciel libre sous licence GPL modifié par une autre personne que son auteur reste libre, et le restera à jamais. Ainsi, il est impossible qu’une société commerciale puisse un jour s’approprier un logiciel libre, même si elle l’améliore. Si vous désirez lire la licence GPL, vous pouvez en trouver une copie dans le fichier /usr/src/linux/COPYING une fois que vous aurez installé Linux.\n\nLa FSF a également rédigé d’autres licences plus adaptées aux bibliothèques de programmes et aux documentations libres. Ainsi, la licence LGPL (« Lesser General Public License ») permet d’utiliser les bibliothèques de programmes dans des programmes propriétaires, et la licence FDL (« Free Documentation License ») permet de diffuser des documentations libres. À titre d’exemple, ce guide est distribué sous licence FDL, dont vous trouverez une tradution française [en annexe](http://casteyde.christian.free.fr/system/linux/guide/online/a17511.html).\n\nPrécisons que la licence GPL n’est pas la seule licence permettant de distribuer des logiciels libres. Il existe d’autres licences, dont les termes sont à peu près similaires. Par exemple, la licence BSD (un autre système Unix libre) exige également la distribution des sources, mais permet l’appropriation des sources par des sociétés commerciales. De même, la licence X, sous laquelle est diffusée l’environnement graphique X11 qu’utilise Linux, est une licence libre. Quelques outils fournis avec Linux sont distribués avec d’autres licences plus rares.\n\n# Avantages et inconvénients des logiciels libres\n\nLes logiciels libres disposent d’avantages indéniables par rapport aux logiciels « propriétaires » ou « fermés ». Je vais tenter de donner ici une liste non exhaustive de ces avantages :\n\n- Les programmes distribués sous licence libre ont souvent été écrits par des passionnés du domaine applicatif auquel ils appartiennent. Les logiciels libres disposent donc souvent des dernières fonctionnalités à la mode et sont donc généralement extrêmement compétitifs sur ce plan.\n    \n- Du fait du grand nombre possible d’intervenants sur les sources des logiciels libres, un grand nombre de possibilités techniques peuvent être explorées, et c’est souvent la meilleure qui est sélectionnée. C’est une forme de sélection naturelle de la meilleure solution. Ainsi, sur le long terme, les logiciels libres sont les plus efficaces en terme de performances.\n    \n- Toujours du fait du grand nombre d’intervenants, et surtout de par la possibilité de consulter et de modifier librement le code source, le cycle de détection/identification/correction des bogues est très court. Les logiciels libres sont donc parmi les plus fiables qui se font. On peut considérer qu’un logiciel libre utilisé par un grand nombre de personnes est virtuellement « sans bogue » connu, puisque si tel était le cas il serait immédiatement corrigé.\n    \n- La possibilité de repartir d’une base de source existante permet de réaliser des développements beaucoup plus rapidement que dans un modèle fermé. Les logiciels libres sont donc également ceux qui se développent le plus rapidement à coût fixe, et sont certainement les plus rentables en terme de coût global pour la collectivité.\n    \n- Afin de garantir l’interopérabilité entre les différents intervenants du monde du logiciel libre, chacun s’évertue à respecter les standards. Les logiciels libres sont donc les plus ouverts, non seulement en terme de code source, mais également au niveau des formats de fichiers et des protocoles de communication. Cela garantie une interopérabilité optimale et l’absence de mauvaise surprise.\n    \n- Professionnellement parlant, la disponibilité du code source fournit une garantie de fonctionnement que l’on ne peut pas retrouver ailleurs. En cas de problème, il est toujours possible de s’en sortir, éventuellement en recourant à des compétences externes pour adapter le logiciel à ses propres besoins.\n    \n- Enfin, la disponibilité du code source garantit une pérennité absolue du logiciel, ce qu’aucune société commerciale vendant des logiciels propriétaires ne peut ou ne veut faire.\n    \n\nPour être honnête, il faut admettre que les logiciels libres ont également des inconvénients. La liste suivante en présente quelques-uns :\n\n- La diversité des logiciels libres a également un revers. L’utilisateur peut avoir à choisir entre plusieurs logiciels, ce qui ne simplifie pas forcément l’apprentissage ou la communication entre les différents utilisateurs de logiciels libres. Prenez par exemple ce guide : il fait la présentation de l’installation de trois distributions Linux, qu’il a fallu choisir parmi les centaines de distributions existantes… De plus, ce n’est pas le seul document traitant du sujet de l’installation et de la configuration de Linux (mais c’est sans doute le plus meilleur, n’est-ce pas ?). Cela ne simplifie pas les choses pour l’utilisateur.\n    \n- La diversité des bibliothèques et des outils, ainsi que le nombre d’applications susceptibles de communiquer entre elles, implique une complexité accrue dans le travail d’intégration de tous ces logiciels. Les distributions s’assurent que les logiciels qu’elles fournissent fonctionnent bien ensemble, mais la redondance existe malgré tout et a un coût non négligeable au final, aussi bien pour les distributions que les programmeurs et les éditeurs de logiciels. La description de l’installation de trois distributions dans ce document a également un coût pour son auteur (pfff !). Enfin, même l’utilisation simultanée de plusieurs logiciels peut amener à charger en mémoire de nombreuses bibliothèques ayant pourtant la même fonction, alourdissant le système inutilement.\n    \n- Certaines fonctions des logiciels ne seront pas forcément implémentées, si ses auteurs n’y voient pas d’intérêt. Si le logiciel est développé par une seule personne ou une petite équipe, ils peuvent ne pas en avoir les moyens financiers ou temporels. Toutefois, si un nombre suffisant d’utilisateurs la réclament, il est probable qu’une personne ayant les compétences nécessaires pour ajouter la fonctionnalité se manifeste. Mais il est également possible qu’un autre projet soit démarré, ajoutant encore une fois un élément à la complexité de l’écosystème des logiciels libres. Il n’est donc pas rare d’avoir plusieurs logiciels réalisant la même chose, mais qu’aucun ne soit complet !\n    \n- Du fait que les logiciels libres sont justement développés par des passionnés ou par des sociétés qui ne peuvent pas en tirer un bénéfice direct, certains domaines ne sont pas couverts par les logiciels libres. Ainsi, vous ne trouverez pas toujours une alternative libre à un logiciel propriétaire, soit parce que le sujet n’intéresse personne, soit parce que les coûts de développement dépassent les capacités des organisations de développeurs de logiciels libres.\n    \n- Plus spécifiquement, le marché monopolistique de Windows est beaucoup plus grand que celui de Linux. De ce fait, même les éditeurs de logiciels propriétaires rechignent à faire l’effort du portage de leurs logiciels pour Unix/Linux. Ainsi, la logithèque pour les systèmes libres s’en trouve d’autant plus réduite. Cela est particulièrement vrai pour les jeux et les logiciels professionnels, et malheureusement également pour les pilotes de périphériques de certains constructeurs de matériel.\n    \n- Quand bien même les éditeurs de logiciels voudraient publier leurs logiciels sous licence libre, ils n’en ont pas toujours le droit, en raison d’accords de licence avec des tiers ou de brevets qu’ils utilisent, et parfois même en raison de la réglementation locale de certains pays (comme la France, depuis la loi DADVSI, pour tout les logiciels de lecture de films protégés par exemple). De même, les vendeurs de matériel ne peuvent pas toujours fournir de pilotes libres, ni même d’informations ou de spécifications sur le matériel.\n    \n\n# La motivation des auteurs et le financement des logiciels libres\n\nBien que cela ne se situe pas au même niveau philosophique, la question de la motivation des auteurs de logiciel libres et, pour les entreprises, de leur financement, se pose également de manière récurrente. Il n’est en effet pas évident, en première analyse, de déterminer les raisons qui poussent un auteur ou une entreprise à rendre ainsi public son savoir-faire, au risque de se le faire tout simplement voler.\n\nPour ce qui est des auteurs bénévoles, la motivation provient généralement de l’amusement qu’ils ont à développer ces logiciels et à les partager avec la communauté du logiciel libre. Cette communauté, constituée de l’ensemble des auteurs et des utilisateurs des logiciels libres, leur apporte en général la reconnaissance, des rapports de bogues ou des idées d’amélioration de leur logiciel, des conseils ou même de l’aide sur des sujets qu’ils ne maîtrisent pas (traduction, nouvelles fonctionnalités, etc.).\n\nDe plus, en s’intégrant à la communauté du logiciel libre, les programmeurs amateurs peuvent également récupérer des bibliothèques de programme ou des morceaux complets d’autres programmes, et ainsi voir leur logiciel progresser plus vite. Certains peuvent même se distinguer des autres et se voir approcher par une entreprise pour un emploi sur le logiciel qui leur servait à l’origine de passe-temps ! Il est toujours plus agréable de travailler sur quelque chose qui nous plaît…\n\nLes sociétés quant à elles peuvent financer le développement des logiciels libres qu’elles éditent ou auxquels elles contribuent de plusieurs manières. Quelques sociétés vivent de manière dérivée des logiciels libres qu’elles développent (par vente de produits dérivés, de contrat de support, ou de services complémentaires). C’est notamment le cas des sociétés qui éditent des distribution Linux et des sociétés de service en logiciel libre. D’autres sociétés proposent une double licence, constituée d’une licence libre telle que la GPL pour bénéficier des avantages des logiciels libres, et d’une licence propriétaire, permettant d’obtenir une rémunération de la part des clients qui ne veulent pas se plier aux exigences de la GPL (obligation de redistribution des sources en particulier).\n\nEnfin, de nombreuses sociétés contribuent à des logiciels libres tout simplement parce qu’elles en ont besoin. Il est en effet souvent préférable d’adapter un logiciel libre qui satisfait ses besoins à 80% et de développer les 20% restants, quitte à redistribuer les modifications et améliorations qui y sont apportées, que de redévelopper l’intégralité d’un logiciel équivalent ou d’en financer le développement par une société tiers. Le coût total de développement d’une solution complètement propriétaire est en effet généralement beaucoup plus élevé. On voit bien que dans ce cas, les développeurs de logiciels libres sont avant tout leurs propres utilisateurs…\n\nCela dit, il faut être clair sur ce sujet : le logiciel libre rapporte moins que le logiciel propriétaire, tout simplement parce qu’il n’est pas question de monopole ici et qu’on ne peut pas pressurer le client aussi facilement qu’avec une offre logicielle fermée.\n\nComme on le voit, le logiciel libre est très loin d’être l’apanage de quelques fanatiques, et les mauvaises langues qui considèrent ce modèle économique comme du communisme n’ont assurément rien compris. Bien au contraire, il s’agit là de capitaliser les développement et de réduire les coûts, deux objectifs fondamentaux dans une économie de marché et très souvent mal appliqués à l’informatique ! Quant à ceux qui prétendent que les logiciels libres constituent une forme de dumping dans le domaine informatique, ils devraient plutôt analyser la pertinence de ce modèle économique et voir si, finalement, ce n’est pas tout simplement un modèle plus rentable sur le long terme que le modèle propriétaire. Il suffit de considérer le temps consacré, et le coût probablement pharaonique, du développement de Windows Vista, pour constater que le rapport qualité/prix est loin d’être reluisant, même par rapport son aîné Windows XP…","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Droit/Les-types-d_entreprises":{"title":"Les types d'entreprises","content":"\n# a) L’entreprise individuelle\n\n**Son existence en droit repose** sur la personnalité juridique du propriétaire : l’entrepreneur individuel.\nLe patrimoine de l’entrepreneur et celui de l’entreprise se confondent.\n\nEn général, ce sont de **petites entreprises familiales**. Les formalités de création s’effectuent dans les **centres de formalités des entreprises** (CFE).\n\n L’entrepreneur prend toutes les décisions concernant son entreprise sans rendre compte à quiconque. Il peut investir, embaucher, licencier.\n\n**Il doit tenir une comptabilité** et respecter les règles juridiques du droit des affaires et du droit du travail. Les bénéfices de l’entreprise constituent le revenu de l’entrepreneur.\nIl sera soumis à **l’impôt sur le revenu** dans la rubrique des bénéfices industriels et commerciaux (BIC), des bénéfices non commerciaux (BNC), ou des bénéfices agricoles (BA). Il est **redevable d’autres impôts** : contribution économique territoriale, taxe d’apprentissage, taxe sur les salaires, taxe foncière sur les immeubles affectés aux exploitations.\n\n**L’entrepreneur individuel** est considéré comme un **travailleur  indépendant** à l’instar des artisans et professions libérales. Dans ces conditions, il est redevable de plusieurs cotisations (maladies, vieillesse, allocations familiales et CSG). \nL’entreprise individuelle fait partie du patrimoine de l’entrepreneur qui supporte personnellement les **dettes de son exploitation**.\n\nSi **l’entrepreneur marié** a choisi le régime de la communauté d’acquêts, les biens formant la masse des biens communs peuvent être saisis en cas de dettes. La plupart du temps, les entrepreneurs individuels choisissent le régime matrimonial de la **séparation de biens**. Dans ce cas, seuls ses biens propres seront saisis. Lors de la cession de l’entreprise, seuls les biens professionnels peuvent être vendus. Les **dettes restent personnelles** à l’entrepreneur.\n\n**Aujourd’hui, l’entrepreneur individuel a la possibilité de protéger** l’ensemble de ses biens fonciers bâtis ou non bâtis (immeubles, bâtiment)  qu’il n’a pas affecté à son usage professionnel. Il peut s’agir de biens immobiliers propres à l’entrepreneur ou communs aux époux. La **déclaration d’insaisissabilité** doit être établie devant un notaire.\n\nIl peut ainsi protéger son patrimoine. Le domicile personnel de l’entrepreneur individuel est désormais insaisissable en cas de dettes de l’entreprise. Il bénéficie également de la possibilité de devenir un entrepreneur individuel à responsabilité limitée en créant une entreprise  individuelle à responsabilité limitée (EIRL).\n\n# b) L’entreprise sociétaire\n\n**La formation du contrat de société** comprend des **conditions de droit commun** (consentement, capacité, objet, cause) et des **conditions spécifiques** (apports, participation aux résultats et aux pertes, *affectio societatis* ou volonté de collaborer).\n\nUne fois le contrat signé par les associés, des formalités sont à réaliser dans un centre de formalités des entreprises :\n\n- **Libération des apports** et dépôt des sommes versées sur un compte spécial dans une banque, chez un notaire ou à la Caisse des dépôts ;\n- **Insertion d’un avis** dans un journal d’annonces légales du département du siège social ;\n- **Enregistrement** à l’hôtel des impôts ;\n- **Dépôt des actes** constitutifs au greffe du tribunat de commerce ;\n- **dossier envoyé** à l’URSSAF ;\n- **immatriculation au Registre du commerce et des sociétés** (RCS), ce qui permet à la société d’obtenir la personnalité juridique, ainsi qu’un numéro d’immatriculation, publicité à la diligence du greffier au Bulletin officiel des annonces civiles et  commerciales (BODACC).\n\n**La société s’identifie par plusieurs éléments** : une dénomination sociale, un siège social, une nationalité. La société bénéficiant d’une **identité juridique** (personne morale), elle détient un patrimoine qui ne se confond pas avec celui des associés. La société est titulaire d’une capacité de **jouissance** limitée à son objet social.\n\nSa capacité d’exercice relève de l’action des dirigeants (mandataires  sociaux). Comme toute personne juridique, la société engage sa responsabilité civile (dommages-intérêts) ainsi que pénale (amendes) depuis 1994.\n\n**Les dirigeants des sociétés** peuvent prendre plusieurs dénominations :  gérant, président, président-directeur général, directoire. Ils sont nommés et révoqués par les associés lors des assemblées générales.\n\n**Les associés se retrouvent** chaque année dans l’assemblée générale  obligatoire (AGO) qui se tient une fois par an dans les six mois qui suivent la clôture de l’exercice pour approuver les comptes, donner certaines autorisations, nommer et révoquer les dirigeants, et dans lesquelles les décisions se prennent à la majorité des voix (50 % des voix plus une).\n\nIl existe également des assemblées générales extraordinaires (AGE) pour la modification des statuts ou la majorité des deux tiers des voix requises pour prendre une décision.\n\nPlusieurs raisons peuvent entraîner la dissolution des sociétés : volonté des associés, liquidation, fusion.\n\n# c) Les différentes structures de société\n\n## La SA (société anonyme)\n\nCes sociétés permettent de gérer des grandes entreprises. La société anonyme nécessite un apport minimum de 37 000 €.\nLe nombre d’associés est de deux. Il est porté à sept lorsqu’il s’agit d’une société anonyme pour les sociétés dont les titres sont admis aux négociations sur un marché réglementé comme la Bourse.\nDans cette société, la responsabilité des associés est limitée à leur apport, qui donne droit à des actions et à voter lors des assemblées. La société anonyme peut être dirigée par un conseil d’administration, un président et un directeur général ou par un directoire et un conseil de surveillance.\n\n## La SARL (société à responsabilité limitée)\n\nCes sociétés permettent de gérer les petites et moyennes entreprises. Il n’y a pas de capital minimum. Le nombre d’associés peut aller de 2 à 100. La responsabilité des associés est limitée à leurs apports, qui donnent droit à des parts sociales. Les SARL sont dirigées par un ou plusieurs gérants.\n\n## L’EURL (entreprise unipersonnelle à responsabilité  limitée)\n\nIl s’agit d’une SARL n’ayant qu’un associé dont la responsabilité est limitée à ses apports, un capital minimum n’étant pas obligatoire. La gestion est assurée par l’associé unique ou par un gérant extérieur. Lorsque le gérant n’est pas le propriétaire, des assemblées générales doivent se tenir.\n\n## La SAS (société par actions simplifiée)\n\nC’est une formule juridique souple. Elle peut être constituée par un seul fondateur, devenant alors une société par actions simplifiée unipersonnelle (SASU). Ce type de société ne réclame pas de capital minimum.\n\n**Sa gestion relève** d’un président unique qui représente la société vis-à-vis des tiers. Elle peut être gérée par un organe collégial si les associés le  souhaitent. Investi des pouvoirs les plus étendus, le président peut agir au nom de la société dans la limite de l’objet social.\n\n**Le fonctionnement de la SAS** est prévu par les statuts. La loi n’impose aucune contrainte excepté la tenue d’une assemblée générale ordinaire annuelle d’approbation des comptes. Des clauses restrictives concernant l’entrée et la sortie des associés peuvent être insérées dans les statuts. Si elle ne peut pas être introduite en Bourse, elle peut** émettre des obligations** dans le cadre d’un placement privé.","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Droit/Untitled":{"title":"","content":"","lastmodified":"2022-08-03T10:31:04.473738547Z","tags":null},"/Master/Graphisme":{"title":"","content":"[Introduction](Master/Graphisme/Introduction.md)\n[Drawing 2D primitives](Master/Graphisme/Drawing%202D%20primitives.md)\n[2D Drawing](Master/Graphisme/2D%20Drawing.md)\n[2D TRANSFORMATIONS AND MATRICES](Master/Graphisme/2D%20TRANSFORMATIONS%20AND%20MATRICES.md)\n[Three-Dimensional Graphics](Master/Graphisme/Three-Dimensional%20Graphics.md)\n[3D VIewing](Master/Graphisme/3D%20VIewing.md)\n[Viewing in 3D](Master/Graphisme/Viewing%20in%203D.md)\n[Surface Model](Master/Graphisme/Surface%20Model.md)\n[Rendering Pipeline Overview](Master/Graphisme/Rendering%20Pipeline%20Overview.md)\n[Rendering Pipeline](Master/Graphisme/Rendering%20Pipeline.md)\n[Lighting](Master/Graphisme/Lighting.md)\n[Exercices](Master/Graphisme/Exercices.md)\n[Tutoriel _ Les shaders en GLSL](Master/Graphisme/Tutoriel%20_%20Les%20shaders%20en%20GLSL.md)","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/2D-Drawing":{"title":"2.1 2D Drawing","content":"\n# LINE DRAWING\n\nGiven the specification for a straight line, find the collection of addressable pixels which most closely approximates this line.\n\n##  Goals: \n-  Straight lines should appear straight.\n- Lines should start and end accurately, matching endpoints with connecting lines.\n- Lines should have constant brightness.\n- Lines should be drawn as rapidly as possible.\n(not all of them are achievable with the discrete space of a raster device)\n- **Problem**: How do we determine which pixels to illuminate to satisfy the above goals?\n\n- Vertical, horizontal, and lines with slope = +/- 1 easy.\n- Others create problems - staircasing/ jaggies - aliasing\n\n![Basic Line Drawing Problem Diagram](../../../_resources/ch2_line1_611ee186e9814a2d913330c179a17788.gif)\n\nWhat we are going to look at are algorithms to choose which pixels to illuminate.\n\n* * *\n\n## SOLUTION METHODS\n\n### Direct Solution:\n\n- Solve y=mx+b where (0,b) is the y-intercept and m is the slope.\n\n- Go from x0 to x1 calculate round(y) from the equation.\n\n- In the above example, b=1 and m = 3/5.\n\n```\n          If     x=1, y= 2\n                 x=2, y= 2\n                 x=3, y= 3\n                 x=4, y= 3\n                 x=5, y= 4.0\n```\n\n- Why not use this?\n\n- \\* and / are expensive\n- round function needed\n- Can get gaps in the line (if slope \u003e 1)\n\nExample:\n\ny=10x+2\n\nx=1, y=12\n\nx=2, y=22\n\n* * *\n\n### DDA - Digital Difference Analyzer\n\n- Incremental Algorithm.\n\n- Based on y = (y1-y0)/(x1-x0) x + b\n\n- Assume x1 \u003e x0 and |dx| \u003e |dy| (can be easily modified for the other cases.)\n\n- The Algorithm:\n\n```\n        dx = x1-x0\n        dy = y1 -y0\n        m = dy/dx\n        y=y0\n        for (x=x0 to x1)\n            draw_point (x, round(y))\n            y=y+m\n        end for\n```\n\n- Problems:\n\nStill uses floating point and round() inside the loop.\n\n- How can we get rid of these?\n\n* * *\n\n \n\n### 📍MIDPOINT LINE ALGORITHM\n\n- Incremental Algorithm\n- Given the choice of the current pixel, which one do we choose next (Assume first octant)\n- E or NE?\n\n![Which Pixel to Choose?](../../../_resources/ch2_line2_22cb97da99ef40f280fd3ca54358c05c.jpg)\n\n```\n        x       = x0\n        y       = y0\n        dy      = y1-y0\n        dx      = x1 -x0\n        d       = 2dy -dx\n        deltaE = 2dy\n        deltaNE = 2(dy -dx)\n\n        PlotPoint(x,y)\n\n        while (x \u003c= x1)\n\n          if d \u003c=0    /* Choose E */\n            d = d +deltaE\n          else        /* Choose NE */\n            d = d+ deltaNE\n            y = y+1\n\n          x = x+1\n          PlotPoint(x,y)\n\n        end while\n```\n\n***\n\n# CIRCLE DRAWING\n\n- Only considers circles centered at the origin with integer radii. Can apply translations to get non-origin centered circles.\n\n- Explicit equation: y = +/- sqrt(R2 - x2)\n\n- Implicit equation: F(x,y)= x2 + y2 - R2 =0\nNote: Implicit equations used extensively for advanced modeling (e.g., liquid metal creature from \"Terminator 2\")\n\n- Use of Symmetry: Only need to calculate one octant, can get points in the other 7 as follows:\n\n```\n        Draw_circle(x,y)\n                Plotpoint (x,y)\n                Plotpoint (x,-y)\n                Plotpoint (-x,y)\n                Plotpoint (-x, -y)\n                Plotpoint (y,x)\n                Plotpoint (y, -x)\n                Plotpoint (-y, x)\n                Plotpoint ( -y, -x)\n```\n\n1.  Direct Solution -\n\n- draw 2nd octant by incrementing x from 0 to R/sqrt(2)\n- at each step solve y = + sqrt(r2 - x2)\n\n3.  Midpoint Algorithm -\n\n- Just like before, we will find if the midpoint is above or below the curve.\n\n## MIDPOINT CIRCLE ALGORITHM\n\n- Will calculate for the second octant. \n    \n- Use above procedure to calculate the rest.\n\n- Now will choose between pixel S and SE.\n\n\u003cimg width=\"422\" height=\"312\" src=\"../../../_resources/ch2_fig4_9f1152694dc44179ae50ce398d9e7813.gif\"/\u003e\n\n###The Midpoint Circle algorithm: (Version 1)\n\n```\n        x=0\n        y=R\n        h = 1 - R\n        DrawCircle(x,y)\n        while (y \u003e x)\n           if h \u003c 0         /* select E */\n               h = h + 2x + 3\n           else             /* select SE *\n               h =h + 2(x-y) +5\n               y = y -1\n           x = x +1\n           DrawCircle(x,y)\n        end_while\n```\n\n- Problems with this?\n\n- Requires at least 1 multiply and 3 adds per pixel. Why? because deltaE and deltaSE are linear functions not constants.\n- Can we do better?\n\n- Sure we can.\n\n- All we have to do is calculate the differences for deltaE and deltaSE (these will be constants) : deltadeltaE and deltadeltaSE.\n\n- If we chose E, the we calculate deltadeltaE and deltadeltaSE based on this, same if we chose SE.\n\n- If we chose E, go from (x\u003csub\u003ep\u003c/sub\u003e, y\u003csub\u003ep\u003c/sub\u003e) to (x\u003csub\u003ep\u003c/sub\u003e+1, y\u003csub\u003ep\u003c/sub\u003e)\n\n* * *\n\n## 📍 The MidPoint Circle Algorithm (Version 2):\n\n```\n        x=0\n        y=radius\n        h= 1 -R\n        deltaE=3\n        deltaSE=(-2 *R +5)\n        DrawCircle(x,y)\n        while (y \u003e x)\n           if h \u003c 0      /* select E */\n              h = h +deltaE\n              deltaE= deltaE + 2\n              deltaSE= deltaSE + 2 \n           else         /* select SE */\n              h = h + deltaSE\n              deltaE= deltaE + 2\n              deltaSE= deltaSE + 4\n              y = y -1\n           x = x+1\n           DrawCircle(x,y)\n         end_while\n```","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/2D-TRANSFORMATIONS-AND-MATRICES":{"title":"3. 2D TRANSFORMATIONS AND MATRICES","content":"\n# Special cases of 2D Transformations:\n\n## Scale matrix\n\n|     |     |     |\n| --- | --- | --- |\n| sx  | 0   | 0   |\n| 0   | sy  | 0   |\n| 0   | 0   | 1   |\n\nWhat if sx and/ or sy \u003c 0 ? *get reflections through an axis or plane*\n\n\u003cimg src=\"../../../_resources/ch3_scale_ex_1da7d7a32d444d4c9e0152120924f877.gif\" alt=\"Scaling Example\" width=\"444\" height=\"267\" class=\"jop-noMdConv\"\u003e\n\n* * *\n\n## Off diagonal terms: Shearing\n\n|     |     |     |\n| --- | --- | --- |\n| 1   | x   | 0   |\n| 0   | 1   | 0   |\n| 0   | 0   | 1   |\n\n![Shearing \u0026 Reflection example](../../../_resources/ch3_shear_ex_cc8c74dbc3b24ac0872d4bb863905156.gif)\n\n* * *\n\n## ROTATION\n\n![Rotation Diagram](../../../_resources/ch3_rot1_e306853ab303410d9bd8d78f529e8943.gif)\n\n|     |     |     |\n| --- | --- | --- |\n| cos(q) | sin(q) | 0   |\n| sin(q) | cos(q) | 0   |\n| 0   | 0   | 1   |\n\n- Positive Rotations: **counter clockwise** about the origin\n- For rotations, det|T| = 1 and |T|\u003csup\u003eT\u003c/sup\u003e = |T|\u003csup\u003e-1\u003c/sup\u003e\n\n![Rotation Example](../../../_resources/ch3_rot_ex_7f8db1315a8447338a10b7ff7e0ab426.gif)\n\n* * *\n\n## Translations\n\n|     |     |     |\n| --- | --- | --- |\n| 1   | 0   | dx  |\n| 0   | 1   | dy  |\n| 0   | 0   | 1   |\n\n* * *\n\n# HOMOGENEOUS COORDINATES\n\n- Use a 3 x 3 matrix:\n\n```\n                |x'| | a c tx|  |x|\n                |y'| = | b d ty|*|y|\n                |z'| | 0 0 1 |  |1|\n```\n\n- - W=0, are the points at infinity.\n\n![Homogeneous Coordinate Diagram](../../../_resources/ch3_homg_bd12740ccc484b839c02e601a94aaf20.gif)\n\n* * *\n\n# COMPOSITION OF TRANSFORMATIONS\n\n## Translations\n\nTranslate the points by tx1, ty1, then by tx2, ty2:\n\n```\n        | 1 0 (tx1+tx2) |\n        | 0 1 (tx1+tx2) |\n        | 0 0 1 |\n```\n\n- Scaling: Similar to translations\n\n* * *\n\n## Rotations\n\n![Rotation about an arbitrary point](../../../_resources/ch3_rot_arb_30f10fb5b8134a0a8c6d4b0794a67dae.gif)\n\n```\n  = | 1  0  Px | | cos(q)  -sin( q) 0 | | 1  0  -Px |\n    | 0  1  Py | * | sin(q)   cos( q) 0 | * | 0  1  -Py |\n    | 0  0  1 | | 0        0       1 | | 0  0   1 |\n                \n                        \n    | cosq      -sinq   Px*(1-cosq)+Py*sinq |\n  = | sinq       cosq   Py*(1-cosq)-Px*sinq |\n    | 0           0        1 |\n```\n\n* * *\n\n## Scaling about an arbitrary point in Space\n\n- Translate P to the origin\n    \n- Scale\n    \n- Translate P back\n    \n- **T = T1(Px,Py)* T2(sx, sy)*T3(-Px, -Py)**\n    \n- T =\n    \n\n```\n    | sx  0   Px*(1-sx) |\n    | 0   sy  Py*(1-sy) |\n    | 0   0   1 |\n```\n\n* * *\n\n## Commutivity of Transformations\n\n- If we scale , then translate to the origin, then translate back, is that equivalent to translate to origin, scale, translate back?\n- When is the order of matrix multiplications unimportant?\n- When does T1\\*T2 = T2\\*T1?\n- Cases where T1\\*T2 = T2\\*T1:\n\n```\n        T1      T2         \n        translation     translation\n        scale           scale         rotation        rotation\n        scale(uniform)  rotation\n```\n\n![c6788b27fbab5d94584ac5c4712f6a44.png](../../../_resources/c6788b27fbab5d94584ac5c4712f6a44.png)\n\n* * *\n\n# COORDINATE SYSTEMS\n\nScreen Coordinates: The coordinate system used to address the screen ( device coordinates)\n\nWorld Coordinates: A user-defined application specific coordinate system\n\nhaving its own units of measure, axis,origin, etc.\n\nWindow: The rectangular region of the world that is visible.\n\nViewport: The rectangular region of the screen space that is used to display the\n\nwindow.\n\n\u003e ![](../../../_resources/ch3_fig3_299c20f195eb441087e94ffca176d63d.gif)\n\n* * *\n\n# WINDOW TO VIEWPORT TRANSFORMATION\n\n- Want to find the transformation matrix that maps the window in world coordinates to the viewport in screen coordinates.\n- Viewport: (u, v space) denoted by u\u003csub\u003emin\u003c/sub\u003e, v\u003csub\u003emin\u003c/sub\u003e ,u\u003csub\u003emax\u003c/sub\u003e, v\u003csub\u003emax\u003c/sub\u003e\n- Window: ( x, y space) denoted by x\u003csub\u003emin\u003c/sub\u003e, y\u003csub\u003emin\u003c/sub\u003e,x\u003csub\u003emax\u003c/sub\u003e, y\u003csub\u003emax\u003c/sub\u003e\n- The transformation:\n\n1.  1.  Translate the window to the origin\n    2.  Scale it to the size of the viewport\n    3.  Translate it to the viewport location\n\n```\n M\u003csub\u003eWV\u003c/sub\u003e =  T(u\u003csub\u003emin\u003c/sub\u003e, v\u003csub\u003emin\u003c/sub\u003e)*S(S\u003csub\u003ex\u003c/sub\u003e, S\u003csub\u003ey\u003c/sub\u003e)*T(-x\u003csub\u003emin\u003c/sub\u003e, -y\u003csub\u003emin\u003c/sub\u003e)\n\n     S\u003csub\u003ex\u003c/sub\u003e = (u\u003csub\u003emax\u003c/sub\u003e -u\u003csub\u003emin\u003c/sub\u003e)/(x\u003csub\u003emax\u003c/sub\u003e-x\u003csub\u003emin\u003c/sub\u003e)\n     S\u003csub\u003ey\u003c/sub\u003e = (v\u003csub\u003emax\u003c/sub\u003e -v\u003csub\u003emin\u003c/sub\u003e)/(y\u003csub\u003emax\u003c/sub\u003e-y\u003csub\u003emin\u003c/sub\u003e)\n\n M\u003csub\u003eWV\u003c/sub\u003e = \n\n          | S\u003csub\u003ex \u003c/sub\u003e 0       -x\u003csub\u003emin\u003c/sub\u003e*S\u003csub\u003ex\u003c/sub\u003e+ u\u003csub\u003emin\u003c/sub\u003e |\n          | 0   S\u003csub\u003ey\u003c/sub\u003e      -y\u003csub\u003emin\u003c/sub\u003e*S\u003csub\u003ey\u003c/sub\u003e+ v\u003csub\u003emin\u003c/sub\u003e |\n          | 0   0              1       |\n```\n\n![a9645887a85778c19d9356cf15cc2da7.png](../../../_resources/a9645887a85778c19d9356cf15cc2da7.png)","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/3D-VIewing":{"title":"","content":"# Specification of a View Volume\n\n### View Plane (projection plane) is defined by :\n\n- VRP = View Reference Point\n    \n- VPN = View Plane Normal\n    \n- Window on the View Plane: To specify a min \u0026 max value for 2 orthogonal directions on the view plane, we introduce the Viewing Reference Coordinate(VRC) System.\n    \n- then define umin, umax, vmin,vmax\n    \n\n### View Reference Coord. system(VRC):\n\n- Origin = VRP\n- n axis: VPN\n- v axis: Projection of View Up Vector (VUP) onto the View Plane\n- u axis: an axis mutually orthogonal to n \u0026 v to make a RH coordinate system\n\n\u003cimg width=\"548\" height=\"244\" src=\"../../../_resources/ch7_view1_490a22058b94405d810e78bdd6078041.jpg\" class=\"jop-noMdConv\"\u003e\n\nProjection:\n\n\u003cimg src=\"../../../_resources/ch7_view2_9cdf242f0ae343898a5a6a7fe7f0d649.jpg\" alt=\"\" width=\"561\" height=\"217\" class=\"jop-noMdConv\"\u003e\n\n- Center of Window (CW)\n    \n- Projection Reference Point (PRP) - defines the center of projection and the direction of projection (also called COP)\n    \n- specified in VRC, not world coordinates\n    \n\n\\- Projection type\n\n- Perspective Projection:\n\n![](../../../_resources/ch7_view3_d4b5d262cd01495ea100a0fef1f75316.jpg)\n\n- Parallel Projection:\n\n![](../../../_resources/ch7_view3_2_60557f3281df43c5a0c5f85463e073f0.jpg)\n\n* * *\n\n- The View Volume is then the portion of the world that is to be projected onto the projection plane and then transformed to the viewport.\n    \n- Perspective View volume: truncated pyramid with apex at the PRP (COP) and the edges passing through the corners of the window.\n    \n- Introduce  hither(front) and yon(back) clipping planes to give a finite view volume.\n    \n\n![](../../../_resources/ch7_view4_e1531327fe98480885f2abdee50b4c88.jpg)\n\n- Reasons for doing this:\n    \n- Clip away objects that are too close to the PRP and would make the rest of the scene hard to understand.\n    \n- Clip away objects that are very far away and won’t add any useful information to the final scene. This will reduce the computational expense of computing the final image.\n    \n\n* * *\n\n- Default Viewing parameters in Normalized Projection coordinates(NC) or WC:\n\nVRP(WC)=(0,0,0),VUP(wc)=y,VPN(wc)=Z, PRP(nc)= (.5, .5, 1)\n\n\u003cimg width=\"749\" height=\"538\" src=\"../../../_resources/ch7_view5_ec4af3f94401458fbbed433abd92978b.jpg\" class=\"jop-noMdConv\"\u003e\n\n- (a) The Default Viewing Specification\n- (b) Default Parallel Projection View Volume\n- © Defaul Perspective Projection View Volume\n\n* * *\n\n# Viewing Transfomations\n\nBasic Case\n\n- Assume VP is normal to  the Z axis\n    \n- PRP=(0,0,0)\n    \n- The projection plane is at z=d ![](../../../_resources/ch7_view6_ba97ac0cabd347299098442f81d3bde9.jpg)\n    \n\n\\- By Similar triangles,\n\nX\u003csub\u003ep\u003c/sub\u003e/d = x/z        Y\u003csub\u003ep\u003c/sub\u003e/d = y/z\n\nXp = x/ (z/d)   Yp = y/(z/d)\n\nIn a 4x4 Matrix, this becomes\n\n| 1  0     0    0 | Mper= | 0  1     0    0 |       | 0  0     1    0 |       | 0  0    1/d   0 |\n\n\\[X Y Z W\\]\u003csup\u003eT\u003c/sup\u003e = Mper * \\[x y z 1\\]\u003csup\u003eT\u003c/sup\u003e = \\[ x y z z/d\\]\n\nNow projecting back to 3 space (divide by w)\n\n\\[ x/(z/d)  y/(z/d) d\\].\n\n* * *\n\nProjections and the Canonical View Volume\n\n- The canonical perspective view volume:\n\n![](../../../_resources/ch7_view7_45ed9bb4d0dd4be78b45185c42084b70.jpg)\n\n- 6 clipping planes:\n\nx=z, x= -z, y=z, y=-z, z=z\u003csub\u003emin\u003c/sub\u003e,  z= -1\n\n- Why clip against this?\n\n\u003e - Easier\n\u003e     \n\u003e - Suitable for perspective\n\u003e     \n\n- So, we need to find the transformation that takes our perspective view volume and\n\ntransforms it to the canonical view volume\n\n- In Summary,\n\n3D Viewing Process\n\n![](../../../_resources/ch7_view8_a47a67a8a2154a02aea2b2f7246b00d4.jpg)\n\n* * *\n\n# 3D Clipping\n\n- We will look at entending Sutherland-Hodgman to 3D.\n    \n- Others can be extended just as easily.\n    \n- For perspective canonical view volume, the  tests are real simple:\n    \n\nInside if:\n\nLeft:   x \u003e z Right:  x \u0026lt; -z Bottom: y \u0026gt; z Top:    y \u0026lt; -z Back:   z \u0026gt; -1 Front:  z \u003c zmin\n\nSample Intersection Calculation:\n\nuse parametric representation of the line:\n\nx = x0 + t (x1-x0)      (1) y = y0 + t (y1-y0)      (2) z = z0 + t (z1-z0)      (3)\n\ny=z plane:\n\nequation 2=equation 3 gives t = (z0 - y0) /((y1- y0) - (z1 -z0)) plug back into equations 1 \u0026 2 to get x \u0026 y, know z=y.\n\n* * *\n\n# BackFace Removal (culling)\n\n- Assume we have outward pointing polygon normals ( \u0026 they are normalized).\n\nTake cross product of first edge with last edge , since polygons defined clockwise.\n\n(P0-\u003eP1 x Pn P0).\n\n- Form the eye vector (PRP -P0 ) \u0026 normalize.\n    \n- If we take N · E, this gives us the cosine of  the angle between them (* magnitude of each vector =1).\n    \n- The polygon is facing us if the angle is \u003c= 90 degrees.\n    \n- Reject as a backface if N · E  \u003c 0.\n    \n- What will this do for us?\n    \n- It gets rid of polygons that we won’t see in closed opaque objects.\n    \n- In wireframes of a convex polyhedron, it does hidden line removal.\n    \n- In shaded rendering of a closed polyhedron, it does hidden surface removal.\n    \n\n\\- How much computation should this save?\n\n* * *\n\nNote: Most of the figures in this chapter are scanned from and copyrighted in *Introduction to Computer Graphics* by Foley, Van Dam, Feiner, Hughes, and Phillips, Addison Wesley 1994.\n\n* * *","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Drawing-2D-primitives":{"title":"2. Drawing 2D primitives","content":"\n- Models are mathematical descriptions of geometric elements called primitives\n    - lines and segments\n        \n    - polygons: quads (2 triangles), triangles, ...\n        \n    - circles\n        \n    - polyhedrons\n        \n    - polygonal meshes : connected triangles\n        \n\n**Rasterization**\n\n- Raster screen (or image) is a screen (or image) discretised in pixels\n- Rasterization is the process of taking geometric shapes (defined by vertices and their coordinates) and converting them into an array of pixels stored in the framebuffer to be displayed (b\u0026w or color)\n\n**Scan Conversion**\n\n- Scan conversion is the final step of rasterization (end of the rendering pipeline)\n- Takes place after clipping\n- Takes triangles (or higher-order primitives) and maps them to pixels on screen\n- For 3D rendering also takes into account other processes, like lighting and shading\n\n# 📍Scan Converting Lines\n\n- Slope-intercept form\n    - f(x) = y = m ⋅ x + b\n- Point-slope form\n    - y − y0 = m(x − x0)\n- Implicit form\n    - f(x, y) = ax + by + c = 0\n    - Avoids infinite slopes\n    - Provides symmetry between x and y\n\n```c++\nvoid MidpointLine(int x0, int y0, int x1, int y1)\n{\n    int dx = (x1 - x0), dy = (y1 - y0);\n    int d = 2 * dy - dx;\n    int incrE = 2 * dy;\n    int incrNE = 2 * (dy - dx);\n    int x = x0, y = y0;\n    WritePixel(x, y);\n    while (x \u003c x1) {\n        if (d \u003c= 0) d += incrE; // East Case\n        else { d += incrNE; ++y; } // NorthEast Case\n        ++x;\n        WritePixel(x, y);\n    }\n}\n```\n\n# 📍Scan Converting Circles\n\n- Explicit equation:\n    - R² = x²+ y²\n- Parametric equation:\n    - x = R * cos(α) + xcenter\n    - y = R * sin(α) + ycenter\n    - α : angle from 0 to 2π\n- Implicit equation: f(x, y) = x² + y² − R² = 0\n    - f(x, y) = 0 : on circle\n    - f(x, y) \u003c 0 : inside\n    - f(x, y) \u003e 0 : outside\n\n```c++\nx = x0 + a;\ny = y0 + b;\nvoid CirclePoints(float x, float y)\n{\n    WritePixel(x, y);\n    WritePixel(x, -y);\n    WritePixel(-x, y);\n    WritePixel(-x, -y);\n    WritePixel(y, x);\n    WritePixel(y, -x);\n    WritePixel(-y, x);\n    WritePixel(-y, -x);\n}\n```\n\n```c++\nMidpointCircle(R)\n{ /* the entire circle with radius R */\n    int x = 0, y = R;\n    int deltaE = 2 * x + 3; // = 3\n    int deltaSE = 2 * (x - y) + 5; // = 5 - 2R\n    float decision = 5.0/4 – R;\n    CirclePoints(x, y);\n    while ( y \u003e x ) {\n        if (decision \u003c 0)\n        { // Move East\n        x++;\n        decision += deltaE;\n        deltaE += 2; deltaSE += 2; // Update deltas\n    } else { // Move SouthEast\n        y--; x++;\n        decision += deltaSE;\n        deltaE += 2; deltaSE += 4; // Update deltas\n    }\n        CirclePoints(x, y);\n    }\n}\n```\n\n# Filling with Patterns\n\nPatterns can be cosmetic or geometric\n\n- **Cosmetic**: texture applied after projection transformations\n    \u003cimg src=\"../../../_resources/9ec947623f14806e716bc88ef59c2972.png\" alt=\"9ec947623f14806e716bc88ef59c2972.png\" width=\"144\" height=\"97\" class=\"jop-noMdConv\"\u003e\n- **Geometric**: texture applied onto geometry, before projection transformation (perspectivized / filtered)\n    \u003cimg src=\"../../../_resources/8a0aabf9bbb1c350c767f33835122061.png\" alt=\"8a0aabf9bbb1c350c767f33835122061.png\" width=\"151\" height=\"99\" class=\"jop-noMdConv\"\u003e\n\n# 📍Clipping\n\n- Clipping a rectangle gives a rectangle\n    \n- Clipping a convex polygon gives a convex polygon\n    \n- Clipping a concave polygon can lead to several concave polygons\n    \n- Clipping a circle can create up to 4 arcs\n    \n    ```\n    ComputeOutCode(x0, y0, outcode0); ComputeOutCode(x1, y1, outcode1);\n    Repeat\n        Check for trivial reject or trivial accept;\n        Pick a point (x0,y0) or (x1,y1) that is outside the clip rectangle;\n        if TOP then\n            x = x0 + (x1 - x0) * (ymax - y0) / (y1 - y0);\n            y = ymax;\n        else if BOTTOM then\n            x = x0 + (x1 - x0) * (ymin - y0) / (y1 - y0);\n            y = ymin;\n        else if RIGHT then\n            y = y0 + (y1 - y0) * (xmax - x0) / (x1 - x0);\n            x = xmax;\n        else if LEFT then\n            y = y0 + (y1 - y0) * (xmin - x0) / (x1 - x0);\n            x = xmin;\n        if (x0,y0) was chosen\n            x0 = x; y0 = y; ComputeOutCode(x0, y0, outcode0);\n        else\n            x1 = x; y1 = y; ComputeOutCode(x1, y1, outcode1);\n    Until done\n    ```","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Exercices":{"title":"Exercices","content":"\n# Concepts you should understand and be able to explain\n\n## Chapitre 0 - Introduction\n\n- Computer graphics\n- Animation\n- Modeling\n- Rendering\n- Graphics system\n- Primitives\n- Object/local coordinates\n- World coordinates\n- Screen coordinates\n- Hierarchical scene modeling\n- Scenegraph\n\n## Chapitre 1 - Drawing 2D Primitives\n\n- Rasterization\n- Scan conversion\n- Clipping (Cohen-Sutherland)\n- Aliasing\n- Parametric equations of a line\n- Cosmetic pattern\n- Geometric pattern\n\n## Chapitre 2 - Geometrical Transformations\n\n- Vector, unit vector\n- Vector dot product\n- Vector cross product\n- Matrix multiplication\n- Matrix inversion\n- 2D and 3D Homogeneous coordinates\n- (Affine) Transformations\n- Translation/Rotation/Scale/Shear\n- Composite transformations\n- Fixed-point transformations\n- Transformation of points\n- Transformation of coordinate systems\n- Rotation about an arbitrary axis\n\n## Chapitre 3 - Viewing in 3D\n\n- Modeling transformation\n- Viewing transformation\n- Projection transformation\n- Window-to-viewport transformation\n- Aspect ratio\n- Parallel vs. perspective projections\n- Oblique vs. orthographic parallel views\n- Vanishing point\n\n## Chapitre 4 - Surface Models\n\n- Polygonal surfaces\n- Voxels\n- Parametric surfaces / Patches\n- Spline / parametric curve: interpolating, approximating\n- Spline properties: normality, positivity, regularity, locality, continuity (C and G)\n- Convex hull\n- Bezier, NURBS, B-Splines, Hermite\n- Subdivision surfaces\n- Subdivision mask\n- Implicit surfaces\n- The blob tree\n- Skeletal implicit surface\n- Marching cubes / triangles / quads\n- Polygon soup\n\n## Chapitre 5 - Rendering\n\n- Local illumination\n- Global illumination\n- Rendering pipeline\n- Depth test\n- Directional light\n- Point light\n- Spot light\n- Ambient material / light coefficient\n- Diffuse material / light coefficient\n- Specular material / light coefficient\n- Emissive material\n- Shininess\n- Lighting (ambient, diffuse reflexion / Lambert, specular reflexion / Phong)\n- Shading (flat, smooth / per vertex / Gouraud, per pixel / Phong)\n- BRDF\n- Texture\n- Vertex shader\n- Fragment shader\n- Varying variable\n- Uniform variable\n- Attribute variable\n\n# Short answer questions\n\n1.  1.  What are homogeneous coordinates, and why are they used in computer graphics?\n        \n    2.  Define “primitive” as it relates to graphics programming. Why might a graphics package provide only low-level primitives? Give an example of a higher-level primitive not available in most packages, and when such a primitive might be useful.\n        \n    3.  What is a shear transformation? Give a matrix for a general 2D y-shear, and explain why that matrix produces the desired result.\n        \n    4.  Explain the concept of looking at transformations as a change in coordinate system, rather than as a change in the object. Give an example of a situation where looking at transformations as a change in coordinate system might be useful.\n        \n    5.  What is an application model? How is it distinguished from the graphics that are rendered on the screen? What is the name of the process that implements a mapping between the application model space and screen space? How does this process work?\n        \n    6.  Suppose we have a GLUT interface window that is 400x300 pixels, and that we make the following function calls: gluOrtho2D(-4,4,-3,3) and glViewport(0,0,200,150). Draw a picture and use it to explain how these function calls set up the window-viewport transformation.\n        \n    7.  In the z-buffer algorithm, is the order of rendering for polygons important? Why or why not?\n        \n    8.  Define linear interpolation. In the z-buffer algorithm, is linear interpolation an exact reflection of reality or an approximation? Why?\n        \n    9.  Define back-face culling. Why is this not a general-purpose solution to the hidden surface problem?\n        \n    10. What is ambient illumination? What does it approximate from physical reality?\n        \n    11. Which term in the Phong illumination model does NOT use the material (color) properties of the object being illuminated? Why?\n        \n    12. Why is texture mapping so important for real-time rendering?\n        \n    13. Describe the process of determining a pixel’s color when rendering a polygon with a texture map.\n        \n    14. Define the following terms from ray-tracing: primary ray, shadow ray, reflection ray.\n        \n    15. Describe the algorithm used to determine whether a ray intersects a polygon.\n        \n    16. Why are parametric equations often used to represent curves?\n        \n    17. How are Bézier and Hermite curves related? What property do Bézier curves have due to the use of the constant 3 in this relationship?\n        \n    18. Describe a basic algorithm for rendering parametric cubic curves.\n        \n    19. Explain the concept of a blending function. How does one obtain the blending functions for a family of curves?\n        \n    20. Why is it possible to build a 3D polygonal model without using the process of 3D polygonal modeling?\n        \n    21. Describe one method to manage the speed-realism tradeoff using level of detail (LOD).\n        \n    22. What are programmable shaders? How does the shader concept differ from traditional graphics processing techniques?\n        \n    23. What is the difference between a vertex shader and a fragment shader?\n        \n    24. Give an example of a situation where you might use a vertex shader. What computations would the vertex shader program do in this case?\n        \n    25. Give an example of a situation where you might use a fragment shader. What computations would the fragment shader program do in this case?\n        \n\n# Problems\n\nWork each problem, showing intermediate steps and explaining when necessary.\n\n**Exercice 1** Two endpoints A(13, 11) and B(4,15) describe the line segment AB.\n\n1.  Give the equation of the line in parametric form.\n2.  Assume that AB is a polygon edge. Find the intersection of this edge with the scanline y=13.\n\n**Exercice 2** A line segment is given by its two endpoints (10,10) and (32,15).\n\n1.  What is the point-slope formula for this line?\n2.  What is the parametric equation for this line?\n3.  Suppose we have a window with lower left corner (8,12), width of 20 pixels and height of 20 pixels. Find the intersections of this line with the edges of the window, and specify the new clipped vertices.\n\n**Exercice 3** Quadrilateral ABCD has vertices at (0,0), (0,75), (30,60), and (20,-10). What are the vertices after ABCD has been clipped to a window 50 units wide and 140 units high, centered at the origin?\n\n**Exercice 4** Derive the equation of the plane for the plane containing the points (0,0,0), (5,0,0) and (10,10,10).\n\n**Exercice 5**\n\nGive the 2D homogeneous matrix for each of the transformations in parts 1-3. Leave composite transformations in factored form:\n\n1.  Scale in the x-dimension by 2 and the y-dimension by 3 with fixed point (4,2)\n    \n2.  Rotate by –30 degrees about the point (-2, 3)\n    \n3.  Reflect about the line y = -5\n    \n4.  Check your work on question 3 by applying the resulting matrix to the line segment from (1,3) to (6,2). What are the new endpoints?\n    \n\n**Exercice 6**\n\nTriangle ABC has vertices at (1,1), (2,3), and (3,1). Find the matrix that performs a scale of this triangle by 2 in the x direction while keeping vertex (2,3) fixed. Apply this matrix to the vertices and find the new vertices of ABC.\n\n**Exercice 7**\n\nGive the 3D homogeneous coordinate transformation that rotates a point about the line:\n\n```\n     x(t) = 0\n     y(t) = t\n     z(t) = t\n\n```\n\nby d degrees. Leave matrices in factored form. (Hint: draw a picture of the line)\n\n**Exercice 8**\n\nGive a matrix transformation for a rotation about the line through the points (0,10,0) and (0,10,10). (The transformation may be written out as a product of simple matrix transformations.)\n\n**Exercice 9**\n\nThe following questions refer to the projection of 3D points onto the viewplane given by x = -10. Assume that the up vector is (0, 1, 0).\n\n1.  Given an arbitrary point (x,y,z) what is the corresponding 2D projected point on the viewplane using a parallel projection (the direction of projection is (1,0,0))?\n    \n2.  Given an arbitrary point (x,y,z), what is the corresponding 2D projected point on the viewplane using a perspective projection with the center of projection (CoP) at (a,b,c)?\n    \n\n**Exercice 10** Given a View Plane Normal, VPN = \\[4, 0, -7\\] and a View Up Vector, Vup = \\[2, 0, 0\\], calculate the u, v, and n vectors that define the x, y, and z axes of the Viewing Reference Coordinate System relative to the World Reference Coordinate System.\n\n**Exercice** 11 Given the BSP-tree shown below and an eyepoint at (0, 10, -5), in what order would the polygons A, B, C, D, E, F, G be rendered? Note that the equation for the plane that each polygon lies in is given and that the front side of each node is marked with a +.\n\n\u003e **Exercice 12** Two triangles, A and B, have been projected onto a window centered at the origin that is 3 units wide and 2 units high. The projected vertices for A are: (0,0), (1.4, 1.4), and (1.4, 0). The projected vertices for B are: (0.2, 0.9), (0.2, -0.9), and (-2, 0).\n\u003e \n\u003e a. Find the locations of these vertices after mapping them to a viewport whose origin is at the lower-left corner, and which is 60 pixels wide by 60 pixels high. b. What are the new screen coordinate vertices for triangle B after clipping? c. The 2 triangles overlap at pixel (30,30). Given depth values for triangle A of –1, –1, and –1 for each of its vertices, respectively, and depth for triangle B of –1.5, 0, and –0.5 for each of its vertices, respectively, which triangle’s color should be drawn for pixel (30,30)?\n\u003e \n\u003e **Exercice 13** Assume a Gouraud shading model for the triangle below. Pixel A has been assigned the color (100,100,100), pixel B is color (80, 50, 50) and pixel C is (70, 90, 70). What color should be assigned to pixel D?\n\u003e \n\u003e \u003cimg src=\"../../../_resources/9ae53836b491b858c0f4bf8478174dc8.png\" alt=\"9ae53836b491b858c0f4bf8478174dc8.png\" width=\"132\" height=\"71\" class=\"jop-noMdConv\"\u003e\n\n**Exercice 14**\n\nSketch the result of texture mapping the image shown on the left to the quadrilateral shown on the right, with texture coordinates as shown next to the quadrilateral’s vertices. Assume that texture coordinates wrap if they exceed 1.\n\n\u003cimg src=\"../../../_resources/f0757b5ba31e74da20694fa05545d822.png\" alt=\"f0757b5ba31e74da20694fa05545d822.png\" width=\"338\" height=\"136\" class=\"jop-noMdConv\"\u003e\n\n\u003e **Exercice 15** You want to join two Bézier curves. The first curve must start at (0,0,0) with a tangent vector of (1,1,1). The second curve must end at (5,0,-5) with a tangent vector of (-1,-1,-1). The two curves should be joined at (2,5,0) and have C1 continuity. Give the geometry matrices for each curve.\n\u003e \n\u003e **Exercice 16** Find the parametric equations of the Hermite curve with P1=(-1,0,-1), P4=(1,0,1), R1=\\[0,-1,0\\], R4=\\[0,1,0\\]. What is the velocity along this curve at t=0, t=0.5, and t=1?\n\n**Exercice 17** **Given an eyepoint at (0,0,0), a pixel at (-3, 2, -4), and a sphere of radius 5 with its center at (-5, 10, -10), does the ray from the eyepoint through the pixel intersect the sphere? If so, what is the intersection point?**\n\n**Exercice 18** Given a ray beginning at the point Ro=(4,0,0) with direction Rd=\\[1,1,0\\], and a polygon with vertices (5,2,2), (5,3,-2), and (5,-1,0), does the ray intersect the polygon? If so, what is the intersection point?","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Introduction":{"title":"1. Introduction","content":"\n**creation**, **storage** and **manipulation** of models (biological, mathematical, artistic or abstract structures) and images\n\n**Animation Pipeline** = 3 steps: modeling, animating, rendering \u003cimg src=\"../../../_resources/226554c58f5957018d197ab7c5644ddd.png\" alt=\"226554c58f5957018d197ab7c5644ddd.png\" width=\"714\" height=\"277\" class=\"jop-noMdConv\"\u003e\n\n* * *\n\n# Interactive vs Batch Computer Graphics\n\n## **Interactive Computer Graphics**\n\n- Control of content, structure and appearance of objects via **rapid visual feedback**\n- Components\n    - Input (mouse, stylus, multi-touch, body…)\n        \n    - Processing (movement + rendering + storage)\n        \n    - Output/Display (screen, printer, video recorder, VR/AR systems…)\n        \n\n## Batch Computer Graphics\n\n- Batch mode means non-interactive\n- Used for final production-quality video and film (Maya, FX-special effects), 24 fp\n- Slow to compute: rendering of 1 frame of Monsters University (2013) averaged 29 hours on a 24000-core render farm\n\n* * *\n\n# Vector vs Raster Display\n\n## Vector Display Hardware\n\n- Calligraphic (laser beam), stroke (oscilloscope), random-scan (electron beam)\n    \n- Driven by display commands\n    \n    - moveto(x,y)\n    - char(“A”)\n    - lineto(x,y\n- Scalable (indefinite zoom)\n    \n\n## **Raster Display Hardware**\n\n- TV / screens, bitmap, pixmap\n- Driven by an array of pixels\n    - No semantics\n    - Lowest level of representation\n- Aliasing errors (jaggies) due to discrete sampling of continuous primitives\n\n* * *\n\n# Sample-based vs Geometry-based Graphics\n\n## Sample-based Graphics\n\n- Discrete samples are used to describe visual information\n    \n- Image is defined as pixel-array\n    \n- Pixels are point locations with associated sample values: light intensities/colors, transparency, and other control information\n    \n    - Created by digitizing images, using a sample-based “painting” program, camera, scanner  Input numerically (e.g., with numbers from computed dataset): for example, some aspect of the physical world is sampled for visualization, such as temperature across the US\n- Image Editing: changes made by user, such as cutting and pasting sections, brush-type tools, and processing selected areas\n    \n- Image Processing: algorithmic operations that are performed on image (or portion of image) without user intervention. Blurring, sharpening, edge-detection, color balancing, rotating, warping. These are front-end processes to Computer Vision.\n    \n- Applications: Adobe Photoshop™, GIMP™ , Adobe AfterEffects™\n    \n\n### Advantages\n\n- Once image is defined in terms of colors atlocations (x, y) on grid, image change is easy by altering location or color values\n    - Example: reversing color mapping and make 1 = white, 0 = black \u003cimg src=\"../../../_resources/9c1e88ce2e76ac96e5e5d12c52af0347.png\" alt=\"9c1e88ce2e76ac96e5e5d12c52af0347.png\" width=\"530\" height=\"140\" class=\"jop-noMdConv\"\u003e\n- Once image is defined in terms of colors at locations (x,y) on grid, image change is easy by altering location or color values\n    - Example: pixel information from one image can be copied and pasted into another, replacing or combining with previously stored pixels \u003cimg src=\"../../../_resources/c7d931d3a243042616602cb78792e522.png\" alt=\"c7d931d3a243042616602cb78792e522.png\" width=\"534\" height=\"111\" class=\"jop-noMdConv\"\u003e\n\n### Drawbacks\n\n- WYSIAYG (What You See Is All You Get): No additional information\n- No depth information\n- Can’t change point of view\n- At most can play with the individual pixels or groups of pixels to change colors, enhance contrast, find edges, etc.\n- But increasingly great success in image-based rendering to fake 3D scenes and arbitrary camera positions. New images constructed by interpolation, composition, warping and other operations.\n\n## **Geometry-based**\n\n- Also called scalable vector graphics or object- oriented graphics\n    \n- Geometrical models are created and stored along with various appearance attributes (e.g., color, material properties)\n    \n- Models are mathematical descriptions of geometric elements - lines, polygons, polyhedrons, polygonal meshes…\n    \n- Geometric elements are primitive shapes, i.e. primitives\n    \n\n## Rendering\n\n- Images are synthesized for visualization via sampling of geometry: rendering\n    \n- 2D applications: Adobe Illustrator™, Adobe Freehand™, Corel CorelDRAW™\n    \n- 3D applications: Autodesk AutoCAD™, Autodesk Maya™, Autodesk 3D Studio Max™\n    \n\n## Advantages\n\n- Aspects of physical world can be simulated\n- Animation is done using keyframes and interpolation\n- High-level control\n\n## Drawbacks\n\n• Users cannot work directly with individual pixels as user manipulates geometric elements, program resamples and redisplays elements (except with shaders) • Increasingly, rendering combines geometry-and sample-based graphics, both as performance hack and to increase quality of final product\n\n* * *\n\n# Conceptual Framework Interactive Graphics\n\n- Graphics library/package is **intermediary** between application and display hardware (Graphics System)\n- Application program maps application objects to views (images) of those objects by calling on **graphics library**. Application model may contain lots of non-graphical data (e.g., non-geometric object properties)\n- User interaction results in modification of image and/or model\n\n![16fe63c1d66867b8c389443b8c68948a.png](../../../_resources/16fe63c1d66867b8c389443b8c68948a.png)\n\n* * *\n\n# Frame-buffers\n\n- **Monochrome** : 1 bit per pixel (bitmap)\n    \n- **Full color**: 24 bits/pixel - 8 for each or r,g,b\n    \n- **Others**: if a LUT is not used, can have as many colors or shades of grey as specified by the number of bits/pixel 8 bits =\u003e 256 colors (normally 3,3,2) or shades of grey.-\n    \n- **Color LUTs (palettes)**\n    \n    - Each entry in the frame buffer is an index into the LUT. - if n bits/pixel =\u003e 2\u003csup\u003en\u003c/sup\u003e entries in the LUT- LUT entry then determines the color sent to the screen.\n        \n    - If each LUT entry is p bits, then can display 2\u003csup\u003ep\u003c/sup\u003e possible colors (example p=24 =\u003e 16 million colors in the palette)\n        \n    - Can only display 2\u003csup\u003en\u003c/sup\u003e colors simultaneously.\n        \n\n\u003cimg width=\"640\" height=\"226\" src=\"../../../_resources/frame1_2a8bf594af0141f5a370b30c4f633428.jpg\" class=\"jop-noMdConv\"\u003e\n\n- Example (typical) :\n    \n    - frame-buffer: 8 bits/pixel\n        \n    - LUT: 24 bits/entry\n        \n    - Therefore, can display 256 colors at any one time out of a possible 16 million\n        \n\n## Why use an LUT?\n\n\\- cheaper than full color (3 bytes\\*1280\\*1024 = almost 4MB of memory) - allows more displayable colors than without one. - Can do color table animation (later in course)\n\n* * *\n\n# Scenegraph\n\n- Composition of a scene\n    \n- Stores objects and relations to one another\n    \n    - Objects created in decomposition process must be assembled to create final scene.\n        \n    - Done with affine transformations: T, R, S (not commutative, order matters !\n        \n\n![1360391026814f3111898e3520d149e6.png](../../../_resources/1360391026814f3111898e3520d149e6.png)\n\n* * *\n\n# Lecture’s Overview\n\n- Geometric **transformations** (translation, rotation, scale) are essential for model organization, process of composing complex objects from simpler components and animation (lecture 2)\n    \n- Once object’s geometry is established, it must be **viewed** on screen: from 3D geometry to 2D projections for viewing (lecture 3)\n    \n- While mapping from 3D to 2D, object (surface) material properties and lighting effects are used in **rendering** one’s constructions. This rendering process is also called **image synthesis** (lecture 5)","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Lighting":{"title":"6283. Lighting","content":"\n# Basic Lighting\n\nLighting in the real world is extremely complicated and depends on way too many factors, something we can't afford to calculate on the limited processing power we have. Lighting in OpenGL is therefore based on approximations of reality using simplified models that are much easier to process and look relatively similar. These lighting models are based on the physics of light as we understand it. One of those models is called the Phong lighting model. The major building blocks of the Phong lighting model consist of 3 components: ambient, diffuse and specular lighting. Below you can see what these lighting components look like on their own and combined:\n\n![](../../../_resources/basic_lighting_phong_8ee6858443a74e57a4b2b67b23c82.png)\n\n- Ambient lighting: even when it is dark there is usually still some light somewhere in the world (the moon, a distant light) so objects are almost never completely dark. To simulate this we use an ambient lighting constant that always gives the object some color.\n- Diffuse lighting: simulates the directional impact a light object has on an object. This is the most visually significant component of the lighting model. The more a part of an object faces the light source, the brighter it becomes.\n- Specular lighting: simulates the bright spot of a light that appears on shiny objects. Specular highlights are more inclined to the color of the light than the color of the object.\n\nTo create visually interesting scenes we want to at least simulate these 3 lighting components. We'll start with the simplest one: *ambient lighting*.\n\n# Ambient lighting\n\nLight usually does not come from a single light source, but from many light sources scattered all around us, even when they're not immediately visible. One of the properties of light is that it can scatter and bounce in many directions, reaching spots that aren't directly visible; light can thus *reflect* on other surfaces and have an indirect impact on the lighting of an object. Algorithms that take this into consideration are called global illumination algorithms, but these are complicated and expensive to calculate.\n\nSince we're not big fans of complicated and expensive algorithms we'll start by using a very simplistic model of global illumination, namely ambient lighting. As you've seen in the previous section we use a small constant (light) color that we add to the final resulting color of the object's fragments, thus making it look like there is always some scattered light even when there's not a direct light source.\n\nAdding ambient lighting to the scene is really easy. We take the light's color, multiply it with a small constant ambient factor, multiply this with the object's color, and use that as the fragment's color in the cube object's shader:\n\n```\n void main()\n{\n    float ambientStrength = 0.1;\n    vec3 ambient = ambientStrength * lightColor;\n\n    vec3 result = ambient * objectColor;\n    FragColor = vec4(result, 1.0);\n} \n```\n\nIf you'd now run the program, you'll notice that the first stage of lighting is now successfully applied to the object. The object is quite dark, but not completely since ambient lighting is applied (note that the light cube is unaffected because we use a different shader). It should look something like this:\n\n![](../../../_resources/ambient_lighting_4686363ba886497699db0ae2358218e6.png)\n\n# Diffuse lighting\n\nAmbient lighting by itself doesn't produce the most interesting results, but diffuse lighting however will start to give a significant visual impact on the object. Diffuse lighting gives the object more brightness the closer its fragments are aligned to the light rays from a light source. To give you a better understanding of diffuse lighting take a look at the following image:\n\n![](../../../_resources/diffuse_light_b8f7990b6fea411ba10b504bca0f124d.png)\n\nTo the left we find a light source with a light ray targeted at a single fragment of our object. We need to measure at what angle the light ray touches the fragment. If the light ray is perpendicular to the object's surface the light has the greatest impact. To measure the angle between the light ray and the fragment we use something called a normal vector, that is a vector perpendicular to the fragment's surface (here depicted as a yellow arrow); we'll get to that later. The angle between the two vectors can then easily be calculated with the dot product.\n\nYou may remember from the [transformations](https://learnopengl.com/Getting-started/Transformations) chapter that, the lower the angle between two unit vectors, the more the dot product is inclined towards a value of 1. When the angle between both vectors is 90 degrees, the dot product becomes 0. The same applies to \u003ca id=\"MathJax-Element-1-Frame\"\u003e\u003c/a\u003e\u003ca id=\"MathJax-Span-1\"\u003e\u003c/a\u003e\u003ca id=\"MathJax-Span-2\"\u003e\u003c/a\u003e\u003ca id=\"MathJax-Span-3\"\u003e\u003c/a\u003eθ\n\n$\\theta$: the larger \u003ca id=\"MathJax-Element-2-Frame\"\u003e\u003c/a\u003e\u003ca id=\"MathJax-Span-4\"\u003e\u003c/a\u003e\u003ca id=\"MathJax-Span-5\"\u003e\u003c/a\u003e\u003ca id=\"MathJax-Span-6\"\u003e\u003c/a\u003eθ\n\n$\\theta$ becomes, the less of an impact the light should have on the fragment's color.\n\nNote that to get (only) the cosine of the angle between both vectors we will work with *unit vectors* (vectors of length `1`) so we need to make sure all the vectors are normalized, otherwise the dot product returns more than just the cosine (see [Transformations](https://learnopengl.com/Getting-started/Transformations)).\n\nThe resulting dot product thus returns a scalar that we can use to calculate the light's impact on the fragment's color, resulting in differently lit fragments based on their orientation towards the light.\n\nSo, what do we need to calculate diffuse lighting:\n\n- Normal vector: a vector that is perpendicular to the vertex' surface.\n- The directed light ray: a direction vector that is the difference vector between the light's position and the fragment's position. To calculate this light ray we need the light's position vector and the fragment's position vector.\n\n## Normal vectors\n\nA normal vector is a (unit) vector that is perpendicular to the surface of a vertex. Since a vertex by itself has no surface (it's just a single point in space) we retrieve a normal vector by using its surrounding vertices to figure out the surface of the vertex. We can use a little trick to calculate the normal vectors for all the cube's vertices by using the cross product, but since a 3D cube is not a complicated shape we can simply manually add them to the vertex data. The updated vertex data array can be found [here](https://learnopengl.com/code_viewer.php?code=lighting/basic_lighting_vertex_data). Try to visualize that the normals are indeed vectors perpendicular to each plane's surface (a cube consists of 6 planes).\n\nSince we added extra data to the vertex array we should update the cube's vertex shader:\n\n```\n #version 330 core\nlayout (location = 0) in vec3 aPos;\nlayout (location = 1) in vec3 aNormal;\n... \n```\n\nNow that we added a normal vector to each of the vertices and updated the vertex shader we should update the vertex attribute pointers as well. Note that the light source's cube uses the same vertex array for its vertex data, but the lamp shader has no use of the newly added normal vectors. We don't have to update the lamp's shaders or attribute configurations, but we have to at least modify the vertex attribute pointers to reflect the new vertex array's size:\n\n```\n glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 6 * sizeof(float), (void*)0);\nglEnableVertexAttribArray(0); \n```\n\nWe only want to use the first `3` floats of each vertex and ignore the last `3` floats so we only need to update the *stride* parameter to `6` times the size of a `float` and we're done.\n\nIt may look inefficient using vertex data that is not completely used by the lamp shader, but the vertex data is already stored in the GPU's memory from the container object so we don't have to store new data into the GPU's memory. This actually makes it more efficient compared to allocating a new VBO specifically for the lamp.\n\nAll the lighting calculations are done in the fragment shader so we need to forward the normal vectors from the vertex shader to the fragment shader. Let's do that:\n\n```\n out vec3 Normal;\n\nvoid main()\n{\n    gl_Position = projection * view * model * vec4(aPos, 1.0);\n    Normal = aNormal;\n} \n```\n\nWhat's left to do is declare the corresponding input variable in the fragment shader:\n\n```\n in vec3 Normal; \n```\n\n## Calculating the diffuse color\n\nWe now have the normal vector for each vertex, but we still need the light's position vector and the fragment's position vector. Since the light's position is a single static variable we can declare it as a uniform in the fragment shader:\n\n```\n uniform vec3 lightPos; \n```\n\nAnd then update the uniform in the render loop (or outside since it doesn't change per frame). We use the lightPos vector declared in the previous chapter as the location of the diffuse light source:\n\n```\n lightingShader.setVec3(\"lightPos\", lightPos); \n```\n\nThen the last thing we need is the actual fragment's position. We're going to do all the lighting calculations in world space so we want a vertex position that is in world space first. We can accomplish this by multiplying the vertex position attribute with the model matrix only (not the view and projection matrix) to transform it to world space coordinates. This can easily be accomplished in the vertex shader so let's declare an output variable and calculate its world space coordinates:\n\n```\n out vec3 FragPos;  \nout vec3 Normal;\n  \nvoid main()\n{\n    gl_Position = projection * view * model * vec4(aPos, 1.0);\n    FragPos = vec3(model * vec4(aPos, 1.0));\n    Normal = aNormal;\n} \n```\n\nAnd lastly add the corresponding input variable to the fragment shader:\n\n```\n in vec3 FragPos; \n```\n\nThis `in` variable will be interpolated from the 3 world position vectors of the triangle to form the FragPos vector that is the per-fragment world position. Now that all the required variables are set we can start the lighting calculations.\n\nThe first thing we need to calculate is the direction vector between the light source and the fragment's position. From the previous section we know that the light's direction vector is the difference vector between the light's position vector and the fragment's position vector. As you may remember from the [transformations](https://learnopengl.com/Getting-started/Transformations) chapter we can easily calculate this difference by subtracting both vectors from each other. We also want to make sure all the relevant vectors end up as unit vectors so we normalize both the normal and the resulting direction vector:\n\n```\n vec3 norm = normalize(Normal);\nvec3 lightDir = normalize(lightPos - FragPos); \n```\n\nWhen calculating lighting we usually do not care about the magnitude of a vector or their position; we only care about their direction. Because we only care about their direction almost all the calculations are done with unit vectors since it simplifies most calculations (like the dot product). So when doing lighting calculations, make sure you always normalize the relevant vectors to ensure they're actual unit vectors. Forgetting to normalize a vector is a popular mistake.\n\nNext we need to calculate the diffuse impact of the light on the current fragment by taking the dot product between the norm and lightDir vectors. The resulting value is then multiplied with the light's color to get the diffuse component, resulting in a darker diffuse component the greater the angle between both vectors:\n\n```\n float diff = max(dot(norm, lightDir), 0.0);\nvec3 diffuse = diff * lightColor; \n```\n\nIf the angle between both vectors is greater than `90` degrees then the result of the dot product will actually become negative and we end up with a negative diffuse component. For that reason we use the max function that returns the highest of both its parameters to make sure the diffuse component (and thus the colors) never become negative. Lighting for negative colors is not really defined so it's best to stay away from that, unless you're one of those eccentric artists.\n\nNow that we have both an ambient and a diffuse component we add both colors to each other and then multiply the result with the color of the object to get the resulting fragment's output color:\n\n```\n vec3 result = (ambient + diffuse) * objectColor;\nFragColor = vec4(result, 1.0); \n```\n\nIf your application (and shaders) compiled successfully you should see something like this:\n\n![](../../../_resources/basic_lighting_diffuse_40d47f7205724c858edecbc3e82.png)\n\nYou can see that with diffuse lighting the cube starts to look like an actual cube again. Try visualizing the normal vectors in your head and move the camera around the cube to see that the larger the angle between the normal vector and the light's direction vector, the darker the fragment becomes.\n\nFeel free to compare your source code with the complete source code [here](https://learnopengl.com/code_viewer_gh.php?code=src/2.lighting/2.1.basic_lighting_diffuse/basic_lighting_diffuse.cpp) if you're stuck.\n\n## One last thing\n\nin the previous section we passed the normal vector directly from the vertex shader to the fragment shader. However, the calculations in the fragment shader are all done in world space, so shouldn't we transform the normal vectors to world space coordinates as well? Basically yes, but it's not as simple as simply multiplying it with a model matrix.\n\nFirst of all, normal vectors are only direction vectors and do not represent a specific position in space. Second, normal vectors do not have a homogeneous coordinate (the `w` component of a vertex position). This means that translations should not have any effect on the normal vectors. So if we want to multiply the normal vectors with a model matrix we want to remove the translation part of the matrix by taking the upper-left `3x3` matrix of the model matrix (note that we could also set the `w` component of a normal vector to `0` and multiply with the 4x4 matrix).\n\nSecond, if the model matrix would perform a non-uniform scale, the vertices would be changed in such a way that the normal vector is not perpendicular to the surface anymore. The following image shows the effect such a model matrix (with non-uniform scaling) has on a normal vector:\n\n![](../../../_resources/basic_lighting_normal_transforma_7571bfabe2d346df9.png)\n\nWhenever we apply a non-uniform scale (note: a uniform scale only changes the normal's magnitude, not its direction, which is easily fixed by normalizing it) the normal vectors are not perpendicular to the corresponding surface anymore which distorts the lighting.\n\nThe trick of fixing this behavior is to use a different model matrix specifically tailored for normal vectors. This matrix is called the normal matrix and uses a few linear algebraic operations to remove the effect of wrongly scaling the normal vectors. If you want to know how this matrix is calculated I suggest the following [article](http://www.lighthouse3d.com/tutorials/glsl-tutorial/the-normal-matrix/).\n\nThe normal matrix is defined as 'the transpose of the inverse of the upper-left 3x3 part of the model matrix'. Phew, that's a mouthful and if you don't really understand what that means, don't worry; we haven't discussed inverse and transpose matrices yet. Note that most resources define the normal matrix as derived from the model-view matrix, but since we're working in world space (and not in view space) we will derive it from the model matrix.\n\nIn the vertex shader we can generate the normal matrix by using the inverse and transpose functions in the vertex shader that work on any matrix type. Note that we cast the matrix to a 3x3 matrix to ensure it loses its translation properties and that it can multiply with the `vec3` normal vector:\n\n```\n Normal = mat3(transpose(inverse(model))) * aNormal; \n```\n\nInversing matrices is a costly operation for shaders, so wherever possible try to avoid doing inverse operations since they have to be done on each vertex of your scene. For learning purposes this is fine, but for an efficient application you'll likely want to calculate the normal matrix on the CPU and send it to the shaders via a uniform before drawing (just like the model matrix).\n\nIn the diffuse lighting section the lighting was fine because we didn't do any scaling on the object, so there was not really a need to use a normal matrix and we could've just multiplied the normals with the model matrix. If you are doing a non-uniform scale however, it is essential that you multiply your normal vectors with the normal matrix.\n\n# Specular Lighting\n\nIf you're not exhausted already by all the lighting talk we can start finishing the Phong lighting model by adding specular highlights.\n\nSimilar to diffuse lighting, specular lighting is based on the light's direction vector and the object's normal vectors, but this time it is also based on the view direction e.g. from what direction the player is looking at the fragment. Specular lighting is based on the reflective properties of surfaces. If we think of the object's surface as a mirror, the specular lighting is the strongest wherever we would see the light reflected on the surface. You can see this effect in the following image:\n\n![](../../../_resources/basic_lighting_specular_theory_8f17acfe99e94197958.png)\n\nWe calculate a reflection vector by reflecting the light direction around the normal vector. Then we calculate the angular distance between this reflection vector and the view direction. The closer the angle between them, the greater the impact of the specular light. The resulting effect is that we see a bit of a highlight when we're looking at the light's direction reflected via the surface.\n\nThe view vector is the one extra variable we need for specular lighting which we can calculate using the viewer's world space position and the fragment's position. Then we calculate the specular's intensity, multiply this with the light color and add this to the ambient and diffuse components.\n\nWe chose to do the lighting calculations in world space, but most people tend to prefer doing lighting in view space. An advantage of view space is that the viewer's position is always at `(0,0,0)` so you already got the position of the viewer for free. However, I find calculating lighting in world space more intuitive for learning purposes. If you still want to calculate lighting in view space you want to transform all the relevant vectors with the view matrix as well (don't forget to change the normal matrix too).\n\nTo get the world space coordinates of the viewer we simply take the position vector of the camera object (which is the viewer of course). So let's add another uniform to the fragment shader and pass the camera position vector to the shader:\n\n```\n uniform vec3 viewPos; \n```\n\n```\n lightingShader.setVec3(\"viewPos\", camera.Position); \n```\n\nNow that we have all the required variables we can calculate the specular intensity. First we define a specular intensity value to give the specular highlight a medium-bright color so that it doesn't have too much of an impact:\n\n```\n float specularStrength = 0.5; \n```\n\nIf we would set this to `1.0f` we'd get a really bright specular component which is a bit too much for a coral cube. In the [next](https://learnopengl.com/Lighting/Materials) chapter we'll talk about properly setting all these lighting intensities and how they affect the objects. Next we calculate the view direction vector and the corresponding reflect vector along the normal axis:\n\n```\n vec3 viewDir = normalize(viewPos - FragPos);\nvec3 reflectDir = reflect(-lightDir, norm); \n```\n\nNote that we negate the `lightDir` vector. The `reflect` function expects the first vector to point **from** the light source towards the fragment's position, but the `lightDir` vector is currently pointing the other way around: from the fragment **towards** the light source (this depends on the order of subtraction earlier on when we calculated the `lightDir` vector). To make sure we get the correct `reflect` vector we reverse its direction by negating the `lightDir` vector first. The second argument expects a normal vector so we supply the normalized `norm` vector.\n\nThen what's left to do is to actually calculate the specular component. This is accomplished with the following formula:\n\n```\n float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32);\nvec3 specular = specularStrength * spec * lightColor; \n```\n\nWe first calculate the dot product between the view direction and the reflect direction (and make sure it's not negative) and then raise it to the power of `32`. This `32` value is the shininess value of the highlight. The higher the shininess value of an object, the more it properly reflects the light instead of scattering it all around and thus the smaller the highlight becomes. Below you can see an image that shows the visual impact of different shininess values:\n\n![](../../../_resources/basic_lighting_specular_shinines_cb14d8f9efea4fb38.png)\n\nWe don't want the specular component to be too distracting so we keep the exponent at `32`. The only thing left to do is to add it to the ambient and diffuse components and multiply the combined result with the object's color:\n\n```\n vec3 result = (ambient + diffuse + specular) * objectColor;\nFragColor = vec4(result, 1.0); \n```\n\nWe now calculated all the lighting components of the Phong lighting model. Based on your point of view you should see something like this:\n\n![](../../../_resources/basic_lighting_specular_672da1c1ee304726be1745ff05.png)\n\nYou can find the complete source code of the application [here](https://learnopengl.com/code_viewer_gh.php?code=src/2.lighting/2.2.basic_lighting_specular/basic_lighting_specular.cpp).\n\nIn the earlier days of lighting shaders, developers used to implement the Phong lighting model in the vertex shader. The advantage of doing lighting in the vertex shader is that it is a lot more efficient since there are generally a lot less vertices compared to fragments, so the (expensive) lighting calculations are done less frequently. However, the resulting color value in the vertex shader is the resulting lighting color of that vertex only and the color values of the surrounding fragments are then the result of interpolated lighting colors. The result was that the lighting was not very realistic unless large amounts of vertices were used:\n\n![](../../../_resources/basic_lighting_gouruad_0a74f14e60e6473a943dacc2cdc.png)\n\nWhen the Phong lighting model is implemented in the vertex shader it is called Gouraud shading instead of Phong shading. Note that due to the interpolation the lighting looks somewhat off. The Phong shading gives much smoother lighting results.\n\nBy now you should be starting to see just how powerful shaders are. With little information shaders are able to calculate how lighting affects the fragment's colors for all our objects. In the [next](https://learnopengl.com/Lighting/Materials) chapters we'll be delving much deeper into what we can do with the lighting model.\n\n## Exercises\n\n- Right now the light source is a boring static light source that doesn't move. Try to move the light source around the scene over time using either sin or cos. Watching the lighting change over time gives you a good understanding of Phong's lighting model: [solution](https://learnopengl.com/code_viewer_gh.php?code=src/2.lighting/2.3.basic_lighting_exercise1/basic_lighting_exercise1.cpp).\n- Play around with different ambient, diffuse and specular strengths and see how they impact the result. Also experiment with the shininess factor. Try to comprehend why certain values have a certain visual output.\n- Do Phong shading in view space instead of world space: [solution](https://learnopengl.com/code_viewer_gh.php?code=src/2.lighting/2.4.basic_lighting_exercise2/basic_lighting_exercise2.cpp).\n- Implement Gouraud shading instead of Phong shading. If you did things right the lighting should [look a bit off](https://learnopengl.com/img/lighting/basic_lighting_exercise3.png) (especially the specular highlights) with the cube object. Try to reason why it looks so weird: [solution](https://learnopengl.com/code_viewer_gh.php?code=src/2.lighting/2.5.basic_lighting_exercise3/basic_lighting_exercise3.cpp).","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Rendering-Pipeline":{"title":"","content":"## Introduction\n\nOnce data has been [loaded in an OpenGL buffer](http://www.haroldserrano.com/blog/loading-vertex-normal-and-uv-data-onto-opengl-buffers) and the [rendering sequence started](http://www.haroldserrano.com/blog/starting-the-primitive-rendering-process-in-opengl), the OpenGL rendering pipeline is started. The rendering pipeline is responsible for assembling the vertices of a character, apply a texture, converting the vertices to the right coordinate system and displaying the character on the default framebuffer, i.e, the screen.\n\nThe OpenGL rendering pipeline consists of six stages:\n\n- Per-Vertex Operation\n- Primitive Assembly\n- Primitive Processing\n- Rasterization\n- Fragment Processing\n- Per-Fragment Operation\n\n### Per-Vertex Operation\n\nIn the first stage, called **Per-Vertex Operation**, vertices are processed by a shader, known as the **Vertex Shader**.\n\nEach vertex is multiplied with a transformation matrix, effectively changing its 3D coordinate system to a new *coordinate system*. Just like a photographic camera transforms a 3D scenery into a 2D photograph. The *Vertex Shader* changes the 3D coordinate system of a cube into a projective coordinate system.\n\n![](../../../_resources/image-asset_1416189f741a41acb7f8a322c9f220fb.jpg)\n\n### Primitive Assembly\n\nAfter three vertices have been processed by the vertex shader, they are taken to the **Primitive Assembly** stage.\n\nThis is where a **primitive** is constructed by connecting the vertices in a specified order.\n\n![](../../../_resources/image-asset_c45e1c7e6a8848988c61f07efb9b13a0.jpg)\n\n### Primitive Processing\n\nBefore the primitive is taken to the next stage, **Clipping** occurs. Any primitive that falls outside the **View-Volume**, i.e. outside the screen, is *clipped* and ignore in the next stage.\n\n### Rasterization\n\nWhat you ultimately see on a screen are pixels approximating the shape of a primitive. This approximation occurs in the **Rasterization** stage. In this stage, pixels are tested to see if they are inside the primitive’s perimeter. If they are not, they are discarded.\n\nIf they are within the primitive, they are taken to the next stage. The set of pixels that passed the test is called a **fragment**.\n\n![](../../../_resources/image-asset_3b3e301b2bb24a359268eee346b9b978.jpg)\n\n### Fragment Processing\n\nA **Fragment** is a set of pixels approximating the shape of a primitive. When a fragment leaves the rasterization stage, it is taken to the **Per-Fragment** stage, where it is received by a **shader**.\n\nThis shader is called a **Fragment Shader** and its responsibility is to apply *color* or a *texture* to the pixels within the fragment.\n\n![](../../../_resources/image-asset_0cf375f087e8469eb02519083a846333.jpg)\n\n### Per-Fragment Operation\n\nBefore the pixels in the fragment are sent to the framebuffer, fragments are submitted to several tests like:\n\n- Pixel Ownership test\n- Scissor test\n- Alpha test\n- Stencil test\n- Depth test\n\nAt the end of the pipeline, the pixels are saved in a **Framebuffer**, more specifically the **Default-Framebuffer**. These are the pixels that you see in your mobile screen.","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Rendering-Pipeline-Overview":{"title":"7 Rendering Pipeline Overview","content":"\n## Pipeline\n\n[![Rendering Pipeline Flowchart](../../../_resources/RenderingPipeline_209ab5335c7a46e1ae5945f0f505f8c2.png)](https://www.khronos.org/opengl/wiki/File:RenderingPipeline.png)\n\nDiagram of the Rendering Pipeline. The blue boxes are programmable shader stages.\n\nThe OpenGL rendering pipeline is initiated when you perform a [rendering operation](https://www.khronos.org/opengl/wiki/Vertex_Rendering \"Vertex Rendering\"). Rendering operations require the presence of a [properly-defined vertex array object](https://www.khronos.org/opengl/wiki/Vertex_Specification \"Vertex Specification\") and a linked [Program Object](https://www.khronos.org/opengl/wiki/Program_Object \"Program Object\") or [Program Pipeline Object](https://www.khronos.org/opengl/wiki/Program_Pipeline_Object \"Program Pipeline Object\") which provides the [shaders](https://www.khronos.org/opengl/wiki/Shader \"Shader\") for the programmable pipeline stages.\n\nOnce initiated, the pipeline operates in the following order:\n\n1.  [Vertex Processing](https://www.khronos.org/opengl/wiki/Vertex_Processing \"Vertex Processing\"):\n    1.  Each vertex retrieved from the vertex arrays (as defined by the VAO) is acted upon by a [Vertex Shader](https://www.khronos.org/opengl/wiki/Vertex_Shader \"Vertex Shader\"). Each vertex in the stream is processed in turn into an output vertex.\n    2.  Optional primitive [tessellation stages](https://www.khronos.org/opengl/wiki/Tessellation \"Tessellation\").\n    3.  Optional [Geometry Shader](https://www.khronos.org/opengl/wiki/Geometry_Shader \"Geometry Shader\") primitive processing. The output is a sequence of primitives.\n2.  [Vertex Post-Processing](https://www.khronos.org/opengl/wiki/Vertex_Post-Processing \"Vertex Post-Processing\"), the outputs of the last stage are adjusted or shipped to different locations.\n    1.  [Transform Feedback](https://www.khronos.org/opengl/wiki/Transform_Feedback \"Transform Feedback\") happens here.\n    2.  [Primitive Assembly](https://www.khronos.org/opengl/wiki/Primitive_Assembly \"Primitive Assembly\")\n    3.  Primitive [Clipping](https://www.khronos.org/opengl/wiki/Clipping \"Clipping\"), the [perspective divide](https://www.khronos.org/opengl/wiki/Perspective_Divide \"Perspective Divide\"), and the [viewport transform](https://www.khronos.org/opengl/wiki/Viewport_Transform \"Viewport Transform\") to window space.\n3.  [Scan conversion and primitive parameter interpolation](https://www.khronos.org/opengl/wiki/Rasterization \"Rasterization\"), which generates a number of [Fragments](https://www.khronos.org/opengl/wiki/Fragment \"Fragment\").\n4.  A [Fragment Shader](https://www.khronos.org/opengl/wiki/Fragment_Shader \"Fragment Shader\") processes each fragment. Each fragment generates a number of outputs.\n5.  [Per-Sample_Processing](https://www.khronos.org/opengl/wiki/Per-Sample_Processing \"Per-Sample Processing\"), including but not limited to:\n    1.  [Scissor Test](https://www.khronos.org/opengl/wiki/Scissor_Test \"Scissor Test\")\n    2.  [Stencil Test](https://www.khronos.org/opengl/wiki/Stencil_Test \"Stencil Test\")\n    3.  [Depth Test](https://www.khronos.org/opengl/wiki/Depth_Test \"Depth Test\")\n    4.  [Blending](https://www.khronos.org/opengl/wiki/Blending \"Blending\")\n    5.  [Logical Operation](https://www.khronos.org/opengl/wiki/Logical_Operation \"Logical Operation\")\n    6.  [Write Mask](https://www.khronos.org/opengl/wiki/Write_Mask \"Write Mask\")\n\n## \u003ca id=\"Vertex_Specification\"\u003e\u003c/a\u003eVertex Specification\n\nMain article: [Vertex Specification](https://www.khronos.org/opengl/wiki/Vertex_Specification \"Vertex Specification\")\n\nThe process of vertex specification is where the application sets up an ordered list of vertices to send to the pipeline. These vertices define the boundaries of a *primitive*.\n\nPrimitives are basic drawing shapes, like triangles, lines, and points. Exactly how the list of vertices is interpreted as primitives is handled via a later stage.\n\nThis part of the pipeline deals with a number of objects like [Vertex Array Objects](https://www.khronos.org/opengl/wiki/Vertex_Array_Objects \"Vertex Array Objects\") and [Vertex Buffer Objects](https://www.khronos.org/opengl/wiki/Vertex_Buffer_Objects \"Vertex Buffer Objects\"). Vertex Array Objects define what data each vertex has, while Vertex Buffer Objects store the actual vertex data itself.\n\nA vertex's data is a series of [attributes](https://www.khronos.org/opengl/wiki/Vertex_Attributes \"Vertex Attributes\"). Each attribute is a small set of data that the next stage will do computations on. While a set of attributes do specify a vertex, there is nothing that says that part of a vertex's attribute set needs to be a position or normal. Attribute data is entirely arbitrary; the only meaning assigned to any of it happens in the vertex processing stage.\n\n### \u003ca id=\"Vertex_Rendering\"\u003e\u003c/a\u003eVertex Rendering\n\nMain article: [Vertex Rendering](https://www.khronos.org/opengl/wiki/Vertex_Rendering \"Vertex Rendering\")\n\nOnce the vertex data is properly specified, it is then rendered as a [Primitive](https://www.khronos.org/opengl/wiki/Primitive \"Primitive\") via a drawing command.\n\n## \u003ca id=\"Vertex_Processing\"\u003e\u003c/a\u003eVertex Processing\n\nVertices fetched due to the prior vertex rendering stage begin their processing here. The vertex processing stages are almost all [programmable operations](https://www.khronos.org/opengl/wiki/Shader \"Shader\"). This allows user code to customize the way vertices are processed. Each stage represents a different kind of shader operation.\n\nMany of these stages are optional.\n\n### \u003ca id=\"Vertex_shader\"\u003e\u003c/a\u003eVertex shader\n\nMain article: [Vertex Shader](https://www.khronos.org/opengl/wiki/Vertex_Shader \"Vertex Shader\")\n\nVertex shaders perform basic processing of each individual vertex. Vertex shaders receive the attribute inputs from the vertex rendering and converts each incoming vertex into a single outgoing vertex based on an arbitrary, [user-defined program](https://www.khronos.org/opengl/wiki/Shader \"Shader\").\n\nVertex shaders can have user-defined outputs, but there is also a special output that represents the final position of the vertex. If there are no subsequent vertex processing stages, vertex shaders are expected to fill in this position with the clip-space position of the vertex, for rendering purposes.\n\nOne limitation on vertex processing is that each input vertex *must* map to a specific output vertex. And because [vertex shader invocations](https://www.khronos.org/opengl/wiki/Shader_Invocation \"Shader Invocation\") cannot share state between them, the input attributes to output vertex data mapping is 1:1. That is, if you feed the exact same attributes to the same vertex shader in the same primitive, you will get the same output vertex data. This gives implementations the right to optimize vertex processing; if they can detect that they're about to process a previously processed vertex, they can use the previously processed data stored in a [post-transform cache](https://www.khronos.org/opengl/wiki/Post_Transform_Cache \"Post Transform Cache\"). Thus they do not have to run the vertex processing on that data again.\n\nVertex shaders are not optional.\n\n### \u003ca id=\"Tessellation\"\u003e\u003c/a\u003eTessellation\n\n|     |     |     |\n| --- | --- | --- |Tessellation\n| Core in version |     | 4.6 |\n| Core since version |     | 4.0 |\n| Core ARB extension | [ARB\\_tessellation\\_shader](http://www.opengl.org/registry/specs/ARB/tessellation_shader.txt) |     |\n\nMain article: [Tessellation Shader](https://www.khronos.org/opengl/wiki/Tessellation_Shader \"Tessellation Shader\")\n\nPrimitives can be tessellated using two shader stages and a fixed-function tessellator between them. The [Tessellation Control Shader](https://www.khronos.org/opengl/wiki/Tessellation_Control_Shader \"Tessellation Control Shader\") (TCS) stage comes first, and it determines the amount of tessellation to apply to a primitive, as well as ensuring connectivity between adjacent tessellated primitives. The [Tessellation Evaluation Shader](https://www.khronos.org/opengl/wiki/Tessellation_Evaluation_Shader \"Tessellation Evaluation Shader\") (TES) stage comes last, and it applies the interpolation or other operations used to compute user-defined data values for primitives generated by the fixed-function tessellation process.\n\nTessellation as a process is optional. Tessellation is considered active if a TES is active. The TCS is optional, but a TCS can only be used alongside a TES.\n\n### \u003ca id=\"Geometry_Shader\"\u003e\u003c/a\u003eGeometry Shader\n\nMain article: [Geometry Shader](https://www.khronos.org/opengl/wiki/Geometry_Shader \"Geometry Shader\")\n\nGeometry shaders are user-defined programs that process each incoming primitive, returning zero or more output primitives.\n\nThe input primitives for geometry shaders are the output primitives from a subset of the [Primitive Assembly](https://www.khronos.org/opengl/wiki/Primitive_Assembly \"Primitive Assembly\") process. So if you send a triangle strip as a single primitive, what the geometry shader will see is a series of triangles.\n\nHowever, there are a number of input primitive types that are defined specifically for geometry shaders. These adjacency primitives give GS's a larger view of the primitives; they provide access to vertices of primitives adjacent to the current one.\n\nThe output of a GS is zero or more simple primitives, much like the output of primitive assembly. The GS is able to remove primitives, or tessellate them by outputting many primitives for a single input. The GS can also tinker with the vertex values themselves, either doing some of the work for the vertex shader, or just to interpolate the values when tessellating them. Geometry shaders can even convert primitives to different types; input point primitives can become triangles, or lines can become points.\n\nGeometry shaders are optional.\n\n## \u003ca id=\"Vertex_post-processing\"\u003e\u003c/a\u003eVertex post-processing\n\nMain article: [Vertex Post-Processing](https://www.khronos.org/opengl/wiki/Vertex_Post-Processing \"Vertex Post-Processing\")\n\nAfter the shader-based vertex processing, vertices undergo a number of fixed-function processing steps.\n\n### \u003ca id=\"Transform_Feedback\"\u003e\u003c/a\u003eTransform Feedback\n\nMain article: [Transform Feedback](https://www.khronos.org/opengl/wiki/Transform_Feedback \"Transform Feedback\")\n\nThe outputs of the geometry shader or primitive assembly are written to a series of [buffer objects](https://www.khronos.org/opengl/wiki/Buffer_Objects \"Buffer Objects\") that have been setup for this purpose. This is called transform feedback mode; it allows the user to transform data via vertex and geometry shaders, then hold on to that data for use later.\n\nThe data output into the transform feedback buffer is the data from each primitive emitted by this step.\n\n### \u003ca id=\"Primitive_assembly\"\u003e\u003c/a\u003ePrimitive assembly\n\nMain article: [Primitive Assembly](https://www.khronos.org/opengl/wiki/Primitive_Assembly \"Primitive Assembly\")\n\nPrimitive assembly is the process of collecting a run of vertex data output from the prior stages and composing it into a sequence of primitives. The type of primitive the user rendered with determines how this process works.\n\nThe output of this process is an ordered sequence of simple primitives (lines, points, or triangles). If the input is a triangle strip primitive containing 12 vertices, for example, the output of this process will be 10 triangles.\n\nIf tessellation or geometry shaders are active, then a limited form of primitive assembly is executed before these [Vertex Processing](https://www.khronos.org/opengl/wiki/Vertex_Processing \"Vertex Processing\") stages. This is used to feed those particular shader stages with individual primitives, rather than a sequence of vertices.\n\nThe rendering pipeline can also be aborted at this stage. This allows the use of [Transform Feedback](https://www.khronos.org/opengl/wiki/Transform_Feedback \"Transform Feedback\") operations, without having to actually render something.\n\n### \u003ca id=\"Clipping\"\u003e\u003c/a\u003eClipping\n\nMain article: [Clipping](https://www.khronos.org/opengl/wiki/Clipping \"Clipping\")\n\nThe primitives are then clipped. Clipping means that primitives that lie on the boundary between the inside of the viewing volume and the outside are split into several primitives, such that the entire primitive lies in the volume. Also, the last [Vertex Processing](https://www.khronos.org/opengl/wiki/Vertex_Processing \"Vertex Processing\") shader stage can specify user-defined clipping operations, on a per-vertex basis.\n\nThe vertex positions are transformed from clip-space to window space via the [Perspective Divide](https://www.khronos.org/opengl/wiki/Perspective_Divide \"Perspective Divide\") and the [Viewport Transform](https://www.khronos.org/opengl/wiki/Viewport_Transform \"Viewport Transform\").\n\n### \u003ca id=\"Face_culling\"\u003e\u003c/a\u003eFace culling\n\nMain article: [Face Culling](https://www.khronos.org/opengl/wiki/Face_Culling \"Face Culling\")\n\nTriangle primitives can be culled (ie: discarded without rendering) based on the triangle's facing in window space. This allows you to avoid rendering triangles facing away from the viewer. For closed surfaces, such triangles would naturally be covered up by triangles facing the user, so there is never any need to render them. Face culling is a way to avoid rendering such primitives.\n\n## \u003ca id=\"Rasterization\"\u003e\u003c/a\u003eRasterization\n\nMain article: [Rasterization](https://www.khronos.org/opengl/wiki/Rasterization \"Rasterization\")\n\nPrimitives that reach this stage are then rasterized in the order in which they were given. The result of rasterizing a primitive is a sequence of *[Fragments](https://www.khronos.org/opengl/wiki/Fragment \"Fragment\")*.\n\nA fragment is a set of state that is used to compute the final data for a pixel (or sample if [multisampling](https://www.khronos.org/opengl/wiki/Multisampling \"Multisampling\") is enabled) in the output framebuffer. The state for a fragment includes its position in screen-space, the sample coverage if multisampling is enabled, and a list of arbitrary data that was output from the previous vertex or geometry shader.\n\nThis last set of data is computed by interpolating between the data values in the vertices for the fragment. The style of interpolation is defined by the shader that outputed those values.\n\n## \u003ca id=\"Fragment_Processing\"\u003e\u003c/a\u003eFragment Processing\n\nMain article: [Fragment Shader](https://www.khronos.org/opengl/wiki/Fragment_Shader \"Fragment Shader\")\n\nThe data for each fragment from the rasterization stage is processed by a fragment shader. The output from a fragment shader is a list of colors for each of the color buffers being written to, a depth value, and a stencil value. Fragment shaders are not able to set the stencil data for a fragment, but they do have control over the color and depth values.\n\nFragment shaders are optional. If you render without a fragment shader, the depth (and stencil) values of the fragment get their usual values. But the value of all of the colors that a fragment could have are undefined. Rendering without a fragment shader is useful when rendering only a primitive's default depth information to the depth buffer, such as when performing [Occlusion Query](https://www.khronos.org/opengl/wiki/Occlusion_Query \"Occlusion Query\") tests.\n\n## \u003ca id=\"Per-Sample_Operations\"\u003e\u003c/a\u003ePer-Sample Operations\n\nMain article: [Per-Sample_Processing](https://www.khronos.org/opengl/wiki/Per-Sample_Processing \"Per-Sample Processing\")\n\nThe fragment data output from the fragment processor is then passed through a sequence of steps.\n\nThe first step is a sequence of culling tests; if a test is active and the fragment fails the test, the underlying pixels/samples are not updated (usually). Many of these tests are only active if the user activates them. The tests are:\n\n- Pixel ownership test: Fails if the fragment's pixel is not \"owned\" by OpenGL (if another window is overlapping with the GL window). Always passes when using a [Framebuffer Object](https://www.khronos.org/opengl/wiki/Framebuffer_Object \"Framebuffer Object\"). Failure means that the pixel contains undefined values.\n- [Scissor Test](https://www.khronos.org/opengl/wiki/Scissor_Test \"Scissor Test\"): When enabled, the test fails if the fragment's pixel lies outside of a specified rectangle of the screen.\n- [Stencil Test](https://www.khronos.org/opengl/wiki/Stencil_Test \"Stencil Test\"): When enabled, the test fails if the stencil value provided by the test does not compare as the user specifies against the stencil value from the underlying sample in the stencil buffer. Note that the stencil value in the framebuffer can still be modified even if the stencil test fails (and even if the depth test fails).\n- [Depth Test](https://www.khronos.org/opengl/wiki/Depth_Test \"Depth Test\"): When enabled, the test fails if the fragment's depth does not compare as the user specifies against the depth value from the underlying sample in the depth buffer.\n\n**Note:** Though these are specified to happen after the [Fragment Shader](https://www.khronos.org/opengl/wiki/Fragment_Shader \"Fragment Shader\"), they can be made to happen [before the fragment shader](https://www.khronos.org/opengl/wiki/Early_Fragment_Test \"Early Fragment Test\") under certain conditions. If they happen before the FS, then any culling of the fragment will also prevent the fragment shader from executing, this saving performance.\n\nAfter this, [color blending](https://www.khronos.org/opengl/wiki/Blending \"Blending\") happens. For each fragment color value, there is a specific blending operation between it and the color already in the framebuffer at that location. [Logical Operations](https://www.khronos.org/opengl/wiki/Logical_Operation \"Logical Operation\") may also take place in lieu of blending, which perform bitwise operations between the fragment colors and framebuffer colors.\n\nLastly, the fragment data is written to the framebuffer. [Masking operations](https://www.khronos.org/opengl/wiki/Write_Mask \"Write Mask\") allow the user to prevent writes to certain values. Color, depth, and stencil writes can be masked on and off; individual color channels can be masked as well.","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Simplest-Galaxy-renderer":{"title":"Simplest Galaxy renderer","content":"\n# Simplest Galaxy renderer\n\nINF2110 - Introduction à l’Informatique Graphique\n\n\u003ccenter\u003e**Philippe Kévin**\u003c/center\u003e\u003ccenter\u003ekv.philippe@gmail.com\u003c/center\u003e\u003ccenter\u003eUniversité Bretagne Sud\u003c/center\u003e\u003ccenter\u003e\n\n![13239632316fdb58bfc0175f4a45b215.png](../../../_resources/13239632316fdb58bfc0175f4a45b215.png)\n\n\u003c/center\u003e\n\n# Usage\n\n**compile** `make -f Makefile outputName`\n\n**run** `./outputName`\n\n# Résumé\n\nCe mini projet en introduction à l’informatique graphique, est inspiré de l’article de Beltoforion [Rendering a Galaxy with the density wave theory](https://beltoforion.de/en/spiral_galaxy_renderer/ \"Rendering a Galaxy with the density wave theory\") avec une implémentation simplifié, ne prenant pas en compte la théorie de la densité, ni les lois de Kepler.\n\nLe projet c’est établi suivant 3 étapes :\n\n- Trajectoire et initialisation des étoiles\n- Luminosité\n- Couleur\n\nMots clé : QGLViewer, Midpoint Algorithm, glsl Shaders\n\n```\n.\n├── include\n│   ├── Galaxy.h\n│   ├── Shader.h\n│   ├── specrend.h\n│   ├── utils.h\n│   └── Viewer.h\n├── main.cpp\n├── Makefile\n├── shader.frag\n├── shader.vert\n├── src\n│   ├── Galaxy.cpp\n│   ├── Shader.cpp\n│   ├── utils.cpp\n│   └── Viewer.cpp\n├── tp8.pro\n└──  tp8.pro.user\n```\n\n# 1 Trajectoire et initialisation des étoiles\n\nLa création des étoiles est assez bancale et mériterait de suivre une loi normale ou une strategie plus effective pour pouvoir être généralisé. Elle donne cependant un bon résultat pour les données prédéfinit, en lancant le programme sans arguments.\n\nPour simplifier le problème, nous supposons que la trajectoire des étoiles suivent des ellipses qui se décalent petit à petit. Il s’agit donc de créer des étoiles suivant ces ellipses avec une répartition réaliste, pour que l’univers soit plus dense au centre.\n\nPour cela j’ai commencé par dessiner le centre de la galaxy avec le MidPoint circle algorithm et les ellipses autour. J’ai ensuite intialisé le nombre moyen d’étoiles par éllipse, accompagné d’un ratio suivant la distance au centre, et un vecteur de décalage aléatoire sur x et y pour que ce soit plus réaliste. La vitesse est calculé par soustraction entre le prochain point sur l’ellipse, le plus proche, et la position du point sur l’ellipse sans son vecteur de décalage.\n\n\u003ccenter\u003e\u003cimg src=\"../../../_resources/e433a94be8373f061947a7bcb8692e2a.png\" alt=\"e433a94be8373f061947a7bcb8692e2a.png\" width=\"369\" height=\"423\" class=\"jop-noMdConv\"\u003e\u003cimg src=\"../../../_resources/92a7e28faace39af6bed91197a66eb06.png\" alt=\"92a7e28faace39af6bed91197a66eb06.png\" width=\"444\" height=\"423\" class=\"jop-noMdConv\"\u003e\u003c/center\u003e\n\n# 2 Luminosité\n\nL’article stipule que conformément à Freeman, K. C., [*“On the Disks of Spiral and so Galaxies”*](http://adsabs.harvard.edu/cgi-bin/bib_query%3F1970ApJ...160..811F) (1970). Astrophysical Journal, vol. 160, p.811   La luminosité peut être décrite suivant une loi exponentiel :\n\n![be5eff996f644fc9355b3bcba68e0fc8.png](../../../_resources/be5eff996f644fc9355b3bcba68e0fc8.png) avec I\u003csub\u003e0\u003c/sub\u003e l’intensité centrale, R la distance au centre et Rd une distance à laquelle l’intensité descend de 50%\n\nJ’ai décidé d’utiliser le fragment shader avec comme variables uniform, la position de l’étoile dans la galaxy  on a donc :\n\n```C\nuniform float x;\nuniform float y;\nuniform float z;\n\nvoid main()\n{   \n    float dx = abs(x);\n    float dy = abs(y);\n    float dist = sqrt(dx*dx + dy*dy);\n\n    float lumOfCenter = 10.0;\n\n    float l = lumOfCenter * exp(-dist/10.0);\n    if (l \u003c 0.3) l = 0.3;\n\n    vec4 col = vec4(1.0,1.0,1.0,l);\n    gl_FragColor=col;\n}\n```\n\nL’utilisation d’un vecteur en variable uniform serait preferable\n\n\u003ccenter\u003e\u003cimg src=\"../../../_resources/44a6dcfa9958e89aa051eab4471ba4ff.png\" alt=\"44a6dcfa9958e89aa051eab4471ba4ff.png\" width=\"328\" height=\"355\" class=\"jop-noMdConv\"\u003e\u003cimg src=\"../../../_resources/dcc69acde1822fa0d982d9da8958950c.png\" alt=\"dcc69acde1822fa0d982d9da8958950c.png\" width=\"603\" height=\"356\" class=\"jop-noMdConv\"\u003e\u003c/center\u003e\n\n# 3 Couleurs\n\nD’après la loi de Planck, la température de surface des étoiles dans la galaxie simulée se situe entre 3000 et 9000 Kelvin. En réalité, la température de surface d’une étoile est sujette à des changements tout au long de sa vie, au fur et à mesure qu’elle progresse dans sa trajectoire dans le diagramme de Hertzsprung Russell.\n\nL’article cite alors,  d’un programme de John Walker appelé [specrend.c](https://www.fourmilab.ch/documents/specrend/specrend.c) (1996, April 25). Publié dans le domaine publique et qui peut calculer les valeurs RGB pour une température donnée. Il explique l’algorithmie sur son site :  [“Colour Rendering of Spectra.”](http://www.fourmilab.ch/documents/specrend/) J’utilise alors son programme pour calculer la couleurs des étoiles et les donner au fragment shader\n\n# Conclusion\n\n\u003ccenter\u003e\n\n![fe5f5ee4ae5280236728bc010593f73a.png](../../../_resources/fe5f5ee4ae5280236728bc010593f73a.png)\u003cimg src=\"../../../_resources/54478e8aff9e5a113edc436c7a67fb70.png\" alt=\"54478e8aff9e5a113edc436c7a67fb70.png\" width=\"328\" height=\"291\" class=\"jop-noMdConv\"\u003e\n\n\u003c/center\u003eLe résultat est très différent de la réalité, les simplifications sont, sans doute, trop nombreuses. Il faudrait implémenter une sorte de blur et de fumée. Mais il reste agréable à regarder\n\nDes améliorations peuvent naturellement être apporté comme énoncé ci dessus, ou revoir l’initialisation et la vitesse des étoiles, créer différents types d’étoiles et vérifier les performances et fuite de mémoire.","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Surface-Model":{"title":"6. Surface Model","content":"\n# Polygonal Surfaces\n\n\u003cimg src=\"../../../_resources/24f3041d2eac6e1ff6ad3ae5d3623514.png\" alt=\"24f3041d2eac6e1ff6ad3ae5d3623514.png\" width=\"303\" height=\"134\" class=\"jop-noMdConv\"\u003e\n\nSet of flat geometric primitives (quads, triangles)\n3 vertices define a plane ax + by + cz + d = 0\n\n\u003cimg src=\"../../../_resources/8ff8878ece7d1479cb71eef6d17292ba.png\" alt=\"8ff8878ece7d1479cb71eef6d17292ba.png\" width=\"310\" height=\"183\" class=\"jop-noMdConv\"\u003e\n\n### Good for rendering\n\n- Easy/fast ray-triangle intersection\n- Surface normal = cross product of 2 consecutive edges\n- Normals per point\n- Graphics boards render triangles (fast)\n\n### Not as good for modeling\n\n- Only approximates the surface\n    \n- Modeling is a tedius task\n    \n- Good for flat surfaces: planes, cubes, tables...\n    \n- Not so good for curved surfaces (more triangles)\n    \n- More polygons = better approximation of the surface\n    \n\n### Usually good for animation\n\n- Manipulation of vertices\n    \n- Animation might be slow if too many triangles\n    \n\n* * *\n\n## Mesh\n\n- Easy to set up\n- ⚠ Duplicates (using an index solves the problem)\n- ⚠ Coherency (there is an order !)\n\n![7380ea0f8c8237dd32c6b73d15da5feb.png](../../../_resources/7380ea0f8c8237dd32c6b73d15da5feb.png)\n\n### No Self-intersecting\n\n![63a03fc8ddf87e9d006ea06b62ab9c97.png](../../../_resources/63a03fc8ddf87e9d006ea06b62ab9c97.png)\n\n### Manifold\n\n**no hole and no singularity**\n\n**![a4d64587dd3ba8501d036519036b1ec2.png](../../../_resources/a4d64587dd3ba8501d036519036b1ec2.png)\u003cimg src=\"../../../_resources/9f6d28a8780378e1d7ded3fea9d9114c.png\" alt=\"9f6d28a8780378e1d7ded3fea9d9114c.png\" width=\"421\" height=\"249\" class=\"jop-noMdConv\"\u003e**\n\n# Voxel\n\nDescribe the volume of the object by (regularly) subdividing the space\n\n![daee94e1af95d546a5f15ec15884993c.png](../../../_resources/daee94e1af95d546a5f15ec15884993c.png)\n\n- Approximate the volume (same as meshes)\n    \n- Expensive in terms of memory\n    \n- Efficient visualization if combined with an octree\n    \n\n# Parametric Curves (1D)\n\nDefined by a few Control Points/Vertices\n\n- **Approximating** (go around): Cardinal splines, Bezier\n    \n- **Interpolating** (go through): cubic B-Splines, Hermite\n    ![7994da3194b40052509c57bd086887f0.png](../../../_resources/7994da3194b40052509c57bd086887f0.png)\n    \n\n\u003e Let P = {P1, . . . , Pk } be a set of k points in the plane. Let F = {F1, . . . , Fk } be a set of k functions defined on \\[0, 1\\] to R. We call spline curve\n\u003e generated by the couples (Pi , Fi ), 1 ≤ i ≤ k,\n\u003e \n\u003e the curve C which parametric equation is:\n\u003e `∀t ∈ [0, 1], C(t) = 1-k∑Fi (t)Pi (1)`\n\u003e Pi points are the control points of C .\n\u003e Fi Functions are called influence or basis functions of C .\n\n![f4dc475baa7f2ab5627f6371d5e55676.png](../../../_resources/f4dc475baa7f2ab5627f6371d5e55676.png)\n\n## Advantages\n\n- Shape influenced by control points (easier for modeling)\n    \n- Deformation is local\n    \n    - If one CP moves, only a portion of the curve will deform\n        \n    - To change a whole portion of the curve, only 1 CP needs to be moved\n        \n- A curve can be closed (first CP re-used) or open\n    \n- Behavior defined by the properties\n    \n\n### Normality\n\n\u003e A spline curve C is normal if\n\u003e \n\u003e `∀t ∈ [0, 1],0-k∑Fi (t) = 1`\n\n- Invariant to affine transformations (affine transformation is applied to the CPs)\n- Invariant to barycentric transformations (weighted mean of several splines can be computed from the weighted mean of their CPs)\n\n\u003cins\u003eConsequence\u003c/ins\u003e\n\n- The shape of a normal spline is independent of the frame (coordinate system) in which the CPs are expressed\n    \n- Translation, rotation and homotecy move the curve but do not change its shape\n    \n- Morphing realized by interpolation of the CPs\n    ![65197b23c52781a8079fd65f94579203.png](../../../_resources/65197b23c52781a8079fd65f94579203.png)\n    \n\n### Positivity\n\n\u003e A spline curve C is positive if\n\u003e `∀t ∈ [0, 1], ∀i = 1. . . k, Fi (t) ≥ 0`\n\nA normal and positive curve is entirely enclosed in its **convex hull**\n\n- Bounding box (collisions detection)\n- Straight line if CPs are aligned\n\n### Regularity\n\nA curve is regular if the number of intersections between a plane and the\ncurve is at most the number of intersections between this plane and the\ncontrol network of the curve\n\n- Useful to control the oscillations of the curve\n    ![e29929cf55b7166cbd922766b7e43c34.png](../../../_resources/e29929cf55b7166cbd922766b7e43c34.png)\n\n### Locality\n\n\u003e The locality controls the influence of the CPs on the curve\n\u003e \n\u003e Each Fi is defined by segment\n\u003e Fi (t) = polynomei (t) for t ∈ \\[T −i, T +i \\], 0 otherwise\n\u003e ∀t \u0026lt; T − i , Fi (t) = 0 and ∀t \u0026gt; T +i, Fi (t) = 0\n\u003e \n\u003e The set of all t for which the same CPs affect C (t) is a **curve segment**\n\u003e \n\u003e A spline curve C (t) is local of order m if each CP affects at most m\n\u003e \n\u003e or... A curve segment is computed thanks to m control points\n\nConsequences\n\n- \\+/\\- easy modeling\n- Effects +/- local\n- \\+/\\- fast to compute\n\n### Strict Convex Hull\n\nA normal, positive, regular and local spline curve is entirely enclosed in the union of the convex hulls of its control network\n\n![d9da85d39e85fb4ece39002baae836da.png](../../../_resources/d9da85d39e85fb4ece39002baae836da.png)\n\n### C Continuity\n\n\u003e A spline curve C has a parametric continuity of order n (noted as C n) if\n\u003e the function t 7 → dnC/dtn (t) is defined and continuous on \\[0, 1\\]\n\n### G Continuity\n\n\u003e A spline curve C has a geometric continuity of order n (noted as G n) if the function s → dnC/dsn (s) is defined and continuous on \\[0, 1\\] (s is the arc length of the curve)\n\n## Hermite\n\n\u003cimg src=\"../../../_resources/167690d346c8aaf4bed24c63fcc7c912.png\" alt=\"167690d346c8aaf4bed24c63fcc7c912.png\" width=\"545\" height=\"208\" class=\"jop-noMdConv\"\u003e\u003cimg src=\"../../../_resources/1ad8c6ff3a3dc26967cb5e5eedf001af.png\" alt=\"1ad8c6ff3a3dc26967cb5e5eedf001af.png\" width=\"360\" height=\"207\" class=\"jop-noMdConv\"\u003e\n\n## Bézier\n\n```\nB0(t) = (1 − t)3\nB1(t) = 3t(1 − t)2\nB2(t) = 3t2(1 − t)\nB3(t) = t3\n```\n\n![1fa83557246ef326ee6c3983f79c8a43.png](../../../_resources/1fa83557246ef326ee6c3983f79c8a43.png)\n\n## NURBS\n\nNon-Uniform Rational B-Spline\n\n\u003e \u003csub\u003e            0-n\u003c/sub\u003e∑wiBi(t)Pi\n\u003e c(t) = ─────────\n\u003e           \u003csub\u003e0-n\u003c/sub\u003e∑ wi Bi (t)\n\u003e \n\u003e - Non-Uniform: weights wi\n\u003e - Rational: fraction\n\u003e - B-Spline: uses functions Bi (t) from the B-Spline basis (usually cubic functions)\n\u003e \n\u003e Used in Maya\n\n![1c96037708171894ad31cc0830d9087d.png](../../../_resources/1c96037708171894ad31cc0830d9087d.png)","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Three-Dimensional-Graphics":{"title":"3.1 Three-Dimensional Graphics","content":"\n- We will use a right-handed coordinate system.\n    \n- Left-handed suitable to screens.\n    \n- To transform from right to left, negate the z values.\n    \n\nRight Handed Space                        Left Handed Space\n\n![](../../../_resources/ch7_fig1_9c920fd320bf48d7a9001d2b5b11ac87.gif)\n\nTransformations will be represented by 4x4 matrices.\n\n## Scaling\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| sx  | 0   | 0   | 0   |\n| 0   | sy  | 0   | 0   |\n| 0   | 0   | sz  | 0   |\n| 0   | 0   | 0   | 1   |\n\n## Translation\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| 1   | 0   | 0   | tx  |\n| 0   | 1   | 0   | ty  |\n| 0   | 0   | 1   | tz  |\n| 0   | 0   | 0   | 1   |\n\n## Shear (xy)\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| 1   | 0   | sh\u003csub\u003ex\u003c/sub\u003e | 0   |\n| 0   | sh\u003csub\u003ey\u003c/sub\u003e | 0   |     |\n| 0   | 0   | 1   | 0   |\n| 0   | 0   | 0   | 1   |\n\n## Rotation (along Z axis)\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| cosq | -sinq | 0   | 0   |\n| sinq | cosq | 0   | 0   |\n| 0   | 0   | 1   | 0   |\n| 0   | 0   | 0   | 1   |\n\n## Rotation (along X axis)\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| 1   | 0   | 0   | 0   |\n| 0   | cosq | -sinq | 0   |\n| 0   | sinq | cosq | 0   |\n| 0   | 0   | 0   | 1   |\n\n## Rotation (along Y axis)\n\n**(sign of sine reversed to maintain right-handed coordinate system)**\n\n|     |     |     |     |\n| --- | --- | --- | --- |\n| cosq | 0   | sinq | 0   |\n| 0   | 1   | 0   | 0   |\n| -sinq | 0   | cosq | 0   |\n| 0   | 0   | 0   | 1   |\n\n# Compositing 3D transformations\n\nThe example from the text:\n\nObjective: Transform the directed line segments P\u003csub\u003e1\u003c/sub\u003eP\u003csub\u003e2\u003c/sub\u003e and P\u003csub\u003e1\u003c/sub\u003eP\u003csub\u003e3\u003c/sub\u003e from their starting position to their final position as indicated in the figure below. Thus,\n\n- Point P\u003csub\u003e1\u003c/sub\u003e is to be translated to the origin,\n- P\u003csub\u003e1\u003c/sub\u003eP\u003csub\u003e2\u003c/sub\u003e is to lie on the positive Z axis and\n- P\u003csub\u003e1\u003c/sub\u003eP\u003csub\u003e3\u003c/sub\u003e is to lie in the positive y-axis half of the (y,z) plane.\n\n![Example 1: Composite 3D Rotation/Translation](../../../_resources/ch7_fig2_577cd6b2883048dcb6faf029e627119f.jpg)\n\n4 Steps:\n\n- 1.  Translate P\u003csub\u003e1\u003c/sub\u003e to the origin\n- 2.  Rotate about the Y axis\n\n\u003cimg width=\"814\" height=\"518\" src=\"../../../_resources/ch7_fig3_7583c755ac2848e39f22497d18bb94fd.jpg\" class=\"jop-noMdConv\"\u003e\n\n- 3.  Rotate about the X axis\n- 4.  Rotate about the Z axis \u003cimg width=\"700\" height=\"700\" src=\"../../../_resources/ch7_fig4_fbc6e1386c51411eabae8751832f3787.jpg\" class=\"jop-noMdConv\"\u003e\n\n* * *\n\nRotation About an Arbitrary Axis in Space\n\n- Assume we want to perform a rotation about an axis in space passing through the point (x0, y0, z0) with direction cosines  (cx, cy, cz) by d degrees.  - How do we do this?\n\n1.  First of all, we want to translate by -(x0, y0, z0)= |T|.\n    \n2.  Next, we rotate the axis into one of the principle axes, let’s pick Z (|Rx|, |Ry|).\n    \n3.  We rotate next by d degrees in Z ( |R\u003csub\u003ez\u003c/sub\u003e(d)|).\n    \n4.  Then we undo the rotations to align the axis.\n    \n5.  We undo the translation: translate  by (x0, y0, z0)\n    \n\n- The tricky part is (2) above.\n    \n- This is going to take  2 rotations,\n    \n\n1 about x  (to place the axis in the xz plane) and 1 about y (to place the result coincident with the z axis).\n\n* * *\n\n\\- Rotation by Alpha about x:\n\nHow do we determine Alpha?\n\n- Project  the vector into the yz plane as shown below.\n\nThe y and z components are cy and cz, the direction cosines of the unit vector along the arbitrary axis.\n\n- It can be seen from the diagram below that\n\nd= sqrt(cy2 + cz2), therefore cos(a) = cz/d sin(a) = cy/d\n\n![](../../../_resources/ch7_fig_ex2_6d79828f2d7d4ab8bf7bb961ded5c4ac.gif)\n\n* * *\n\n\\- Rotation by Beta about y:\n\nHow do we determine Beta?\n\nSimilar to above:\n\ndetermine the angle Beta to rotate the result into the Z axis:\n\n- The x component is cx and the z component is d.\n- It can be seen from the diagram that:\n\ncos(Beta)= d =  d/(length of the unit vector) sin(Beta)= cx =  cx/(length of the unit vector).\n\n* * *\n\n- Final Transformation:\n\nM = |T|-1 |Rx|-1 |Ry|-1 |Rd| |Ry| |Rx| |T|\n\n- If you are given 2 points instead, you can calculate the direction cosines as follows:\n\nV =|(x1 -x0)| **   |(y1 -y0)|** **   |(z1 -z0)|**\n\ncx =  (x1 -x0)/ |V| cy =  (y1 -y0)/ |V| cz =  (z1 -z0)/ |V|, where |V| is the length of V\n\n* * *\n\nTransformations as a Change in Coordinate Systems\n\n![](../../../_resources/ch7_fig6_872fcc6ab1e54fe8a07b9d6539eb9f94.gif)\n\n\\- P\u003csup\u003e(i)\u003c/sup\u003e is the representation of the point P in  coordinate system i.\n\n- M\u003csub\u003ei\u003c-j\u003c/sub\u003e is the transformation that converts the representation of point in coordinate system j into coordinate system i.\n    \n- P\u003csup\u003e(i)\u003c/sup\u003e = M\u003csub\u003ei\u003c-j\u003c/sub\u003e \\* M\u003csub\u003ej\u003c-k\u003c/sub\u003e \\* P\u003csup\u003e(k)\u003c/sup\u003e\n    \n- The example Above:\n    \n\nM\u003csub\u003e1\u003c-2\u003c/sub\u003e = T(4,2) **M\u003csub\u003e2\u003c-3\u003c/sub\u003e = T(2,3)* S(0.5, 0.5)*\\* **M\u003csub\u003e3\u003c-4\u003c/sub\u003e = T(6.7,1.8)* R(-45)*\\* **M\u003csub\u003e1\u003c-4\u003c/sub\u003e =  T(6,5)* S(0.5, 0.5) \\*T(6.7,1.8)\\*R(-45)**\n\n- Note that M\u003csub\u003ei\u003c-j\u003c/sub\u003e = M\u003csub\u003ej\u003c-i\u003c/sub\u003e \u003csup\u003e-1\u003c/sup\u003e\n\n* * *\n\n# The 3D Viewing Pipeline\n\n- Objects are modeled in object (modeling) space.\n    \n- Transformations are applied to the objects to position them in world space.\n    \n- View parameters are specified to define the view volume of the world, a projection plane, and the viewport on the screen.\n    \n- Objects are clipped to this View volume.\n    \n- The results are projected onto the projection plane (window) and finally mapped into the viewport.\n    \n- Hidden objects are then removed, the objects scan converted and shaded if necessary.\n    \n\n\u003cimg width=\"619\" height=\"191\" src=\"../../../_resources/ch7_pipeline_7114683ba12c4351be2a65d4d04aa1a5.jpg\" class=\"jop-noMdConv\"\u003e\n\n* * *\n\n## Spaces\n\n### Object Space\n\ndefinition of objects. Also called Modeling space.\n\n### World Space\n\nwhere the scene and viewing specification is made\n\n### Eyespace (Normalized Viewing Space)\n\nwhere eye point (COP) is at the origin looking down the Z axis.\n\n### 3D Image Space\n\nA 3D Perspected space.\n\nDimensions: -1:1 in x \u0026 y, 0:1 in Z.\n\nWhere Image space hidden surface algorithms work.\n\n- Screen Space (2D)\n\nCoordinates 0:width, 0:height\n\n* * *\n\n## The Computer Graphics Pipeline Viewing Process\n\n![](../../../_resources/ch7_viewinglagorithm_8b1802ebb7b44ce2a951f93eca061.gif)\n\n* * *\n\n# Projections\n\nWe will look at several planar geometric 3D to 2D projection:\n\n### Parallel Projections\n\nOrthographic Oblique\n\n### Perspective\n\n- Projection of a 3D object is defined  by straight projection  rays (projectors) emanating from the center of projection (COP) passing through each point of the object and intersecting the  projection plane.\n\n* * *\n\n\\- Perspective Projections:\n\n- Distance from COP to projection plane is finite.\n    \n- The projectors are not parallel  \u0026 we specify a center of projection.\n    \n- Center of Projection is also called the Perspective Reference Point COP = PRP\n    \n- Perspective foreshortening: the size of the perspective projection of the object varies inversely with the distance of the object from the center of projection.\n    \n- Vanishing Point: The persepctive projections of any set of parallel lines that are not parallel to the projection plane converge to a vanishing point.\n    \n\n\u003cimg width=\"500\" height=\"238\" src=\"../../../_resources/ch7_vanish_f379fdde265847cda5845feebc3b67ec.jpg\" class=\"jop-noMdConv\"\u003e\n\n- Example:\n\n\u003cimg width=\"485\" height=\"443\" src=\"../../../_resources/ch7_proj2_e6a2172c0c134d0f9b057cf87ec22b86.jpg\" class=\"jop-noMdConv\"\u003e\n\n* * *\n\n- Example: 2 Point Perspective Projection\n\n![](../../../_resources/ch7_proj3_607e59eff826429d9a2ebf5b3eec1306.jpg)\n\n* * *\n\n\\- Parallel Projection\n\n- Distance from COP to projection plane is *infinite.*\n    \n- Therefore,  the projectors are parallel lines \u0026 we specify a direction of projection (DOP)\n    \n- Orthographic: the direction of projection and the normal to the projection plane are the same. (direction of projection is normal to the projection plane)\n    \n- Example Orthographic Projection:\n    \n\n![](../../../_resources/ch7_proj4_bbf59547a91c41dba572216ec49175f1.jpg)\n\n- Axometric orthographic projections use planes of projection that are not normal to a principal axis. (they therefore show mutiple face os an object.)\n    \n- Isometric projection: projection plane normal makes equal angles with each principle axis\n    \n\nAll 3 axis are equally foreshortened allowing measurements along the axes to be made with the same scale.\n\n- Example Isometric Projection:\n\n\u003cimg width=\"800\" height=\"425\" src=\"../../../_resources/ch7_proj5_2d45aa9704d74925bde1aba63db159fb.jpg\" class=\"jop-noMdConv\"\u003e\n\n* * *\n\n- Oblique projections : projection plane normal and the direction of projection differ.\n    \n- Plane of projection is normal to a principle axis\n    \n- Projectors are not normal to the projection plane\n    \n- Example Oblique Projection\n    \n\n![](../../../_resources/ch7_proj6_aa50663ba1604c7f8ebbd0b7b348a10a.jpg)\n\n* * *\n\nClassification of Geometric Projections:\n\n\u003cimg width=\"730\" height=\"530\" src=\"../../../_resources/ch7_proj7_b6cbf016653e4d588df3ed15295068d8.jpg\" class=\"jop-noMdConv\"\u003e\n\n* * *\n\nNote: Most of the figures in this chapter are scanned from and copyrighted in *Introduction to Computer Graphics* by Foley, Van Dam, Feiner, Hughes, and Phillips, Addison Wesley 1994.\n\n* * *","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Graphisme/Tutoriel-_-Les-shaders-en-GLSL":{"title":"Tutoriel : Les shaders en GLSL","content":"\n# Les shaders en GLSL\n\nBonjour à tous ! :)\n\nVous êtes-vous jamais demandé comment étaient faits les superbes effets 3D à la mode comme on en voit dans les jeux vidéos récents, comme par exemple l’eau, l’HDR ou l’effet de flou de vitesse dans les jeux de voiture ? Une bonne partie de la réponse se trouve dans l’utilisation de [**shaders**](http://fr.wikipedia.org/wiki/Shader_Model) au sein d’un rendu 3D.\n\nVous en avez sans doute déjà entendu parler (*Shader Model 2.0*, *Shader Model 3.0*, …), mais savez-vous vraiment ce qu’est un shader ? Savez-vous ce que permet de faire un shader ? Non ? Et bien c’est justement ce que je vais essayer de vous apprendre à travers ce tutoriel.\n\nIci, je vous apprendrai à programmer dans un langage de programmation de shaders appelé le GLSL. Nous allons tout d’abord voir en quoi cela consiste, comment on s’y prend, et enfin je vous apprendrai à créer quelques effets graphiques sympathiques :) Allons-y !\n\nCe tutoriel nécessite la lecture du [tutoriel sur OpenGL](http://www.siteduzero.com/tuto-3-5616-0-creez-des-programmes-en-3d-avec-opengl.html) de Kayl, [annexe sur la trigonométrie](http://www.siteduzero.com/tuto-3-23980-1-la-trigonometrie.html) comprise. Les exemples de code seront écrits en langage C, et la connaissance de ce langage en général (ou d’un langage qui lui ressemble syntaxiquement comme le C++ ou le Java) est conseillée car le GLSL est basé dessus. Je ne vous détaillerai donc aucune base de la programmation avec GLSL puisqu’elles sont quasiment identiques à celles du C (if, else, for, etc…).\n\n# Introduction au GLSL\n\nVous vous demandez probablement qui peut bien être ce GLSL, et à quoi il peut servir ? o_O\n\nJe vais, dans ce premier chapitre, essayer de vous expliquer à quoi il peut amener. Nous verrons ce qu’il représente exactement et comment il intervient dans un rendu 3D avec OpenGL.\n\n**Que saurais-je faire à la fin de ce tutoriel ?**\n\nJe ne peux pas être affirmatif sur ce point, mais je pense pouvoir vous apprendre :\n\n- à faire de la lumière. Nous apprendrons à gérer des lumières avec le GLSL;\n    \n- cel-shading, ou rendu cartoon. Cet effet est très simple à réaliser, je pense que c’est l’un des premiers que nous étudierons;\n    \n- manipulation de textures. Nous verrons comment déformer simplement nos textures pour donner des effets de distorsion, mais aussi des effets de flou (comme le flou de vitesse de certains jeux de voiture);\n    \n- pseudo-HDR. La gestion de la lumière alliée à la manipulation des textures nous permettra de réaliser “facilement” un effet de pseudo-HDR.\n    \n\nMais avant de voir toutes ces jolies choses, il nous faut tout d’abord connaître l’essentiel : qu’est-ce que le GLSL, et comment on l’utilise.\n\n## C’est quoi ?\n\nA l’origine pensé par [Pixar](http://www.pixar.com/) pour ses animations vidéos, les shaders ont fait leur apparition dans le domaine du jeu vidéo assez récemment et sont aujourd’hui indispensables pour qui veut réaliser des effets graphiques un tant soit peu évolués.\n\nGLSL ([Def. GLSL (en)](http://en.wikipedia.org/wiki/GLSL)) est l’abréviation de Open**GL****S**hading **L**anguage, traduisez : langage de programmation de shaders OpenGL. Effectivement, le GLSL est un langage de programmation de shaders.\n\n## La programmation GPU\n\nLe GPU est le processeur de votre carte graphique, c’est lui qui calcule vos rendus 3D. La programmation GPU revient donc à… programmer nos calculs de rendus 3D o_O Ah bah tiens, c’est la meilleure du siècle celle-là :p\n\nLes shaders servent à programmer le [pipeline](http://jeux.developpez.com/faq/3d/?page=definitions#DEFINITIONS_pipeline) de rendu par défaut de votre carte graphique, appelé le FFP. Les shaders ne sont donc rien de plus que des programmes, donc :\n\n- un code source;\n    \n- une compilation;\n    \n- une exécution.\n    \n\nIls se différencient toutefois des programmes écrits en C, C++ ou autre langage réservé à une exécution CPU, de par leur compilation et leur exécution. La compilation d’un shader est effectuée lors du lancement de votre application, et l’exécution se passe au niveau du GPU, contrairement à vos programmes habituels (C, C++, C#, Java, …) qui eux sont traités par le CPU, et c’est ce qui fait la puissance et la flexibilité des shaders dans le rendu 3D en général :)\n\n### En assembleur ?\n\nQuand on parle de la programmation d’un processeur, on pense généralement à l’assembleur. Il existe effectivement des langages assembleur pour programmer un GPU, mais nous ne les traiterons pas dans ce tutoriel. Ici, nous ne parlerons que d’un langage de programmation GPU dit de haut niveau, le GLSL. Le GLSL a été développé par l’ARB pour l’API graphique OpenGL afin d’offrir une plus grande souplesse dans la programmation de shaders. DirectX a également développé son propre langage haut niveau pour la programmation de shaders, il s’agit du HLSL, mais il est plutôt hors-sujet, je ne vous en parle qu’à titre de comparaison.\n\nLe GLSL est donc un langage de programmation de shaders de haut niveau, mais à quoi ça ressemble au juste ? Voici le code source d’un shader écrit en GLSL :) :\n\n```\nvoid main(void)\n\n{\n\n    gl_TexCoord[0] = gl_MultiTexCoord0;\n\n    gl_Position = gl_Vertex * gl_ModelViewMatrix;\n\n}\n```\n\nIl s’agit là d’un simple vertex shader.\n\nVertex shader ??\n\nOui. Il est important de distinguer deux types de shaders différents, remplissant chacun des fonctions bien définies et aucunement identiques :\n\n- les **vertex shaders** : ce sont des shaders qui interviennent lors du traitement de chaque sommet. Dans les vertex shaders vous pourrez modifier le calcul des différents attributs de vos sommets;\n    \n- les **pixel shaders** : aussi appelés fragment shaders, ils permettent de traiter le rendu de chaque pixel qui s’affichera à l’écran. Ces derniers offrent une grande flexibilité dans le domaine du rendu 3D.\n    \n\nJ’espère que vous y voyez à présent un peu plus clair ;) Les shaders vous permettent de programmer le traitement de chaque sommet ainsi que de chaque pixel.\n\nUne nouvelle génération de shaders vient de faire son apparition avec le nouveau GPU (GeForce8) de nVidia, les *geometry shaders*. Cette technologie étant assez nouvelle je n’en parlerai pas. Aussi je n’ai pas les moyens de me procurer ce genre de carte, et beaucoup de gens étant dans mon cas, l’explication d’une fonctionnalité que personne ne pourrait exploiter serait plutôt inutile à l’heure actuelle ;)\n\n* * *\n\n## Pourquoi faire ?\n\nLes shaders permettent donc de programmer la fonction de traitement d’un vertex ainsi que d’un pixel. Mais à quoi cela rime-t-il ? Quel utilité cela peut-il bien avoir ?\n\n## Le traitement d’un vertex et d’un pixel, c’est quoi ?\n\nVoilà une bien bonne question :) Quand vous envoyez des données de sommet à OpenGL via les commandes *glVertex*()*, *glColor*()*, *glTexCoord*()*, *glNormal*()*, … (ou par des tableaux via *gl*Pointer()* ) OpenGL les stocke et les associe à un ou plusieurs triangles bien définis.\n\nJe rappelle que le triangle est la seule primitive supportée nativement par toutes les cartes graphiques, les GL_QUADS et autres ne sont que des émulations via des constructions de plusieurs triangles, d’où leur coût de traitement plus élevé.\n\nLe traitement de ce triangle se décompose par le traitement de ses 3 sommets, puis par une interpolation des données de ses sommets pour obtenir un triangle plein. Ce sont ces deux dernières étapes qui sont traitées respectivement par le vertex et le pixel shader.\n\nLe traitement d’un vertex consiste à lui appliquer des transformations matricielle (GL\\_MODELVIEW, GL\\_TEXTURE, …) pour obtenir les données des sommets définitives qui seront ensuite interpolées. Le pixel shader reçoit des données interpolées de couleur et autres attributs traités dans le vertex shader.\n\nQuel est l’intérêt des shaders ?\n\nPensez bien qu’il y en a un ;) En réalité, il y a deux grands avantages à utiliser les shaders. Le premier est qu’ils permettent une énorme flexibilité de rendu. En gérant le rendu de chaque pixel vous avez un contrôle quasi absolu sur vos rendus 3D et vous pouvez ainsi réaliser beaucoup d’effets chouettes sans trop vous compliquer la vie. Le second intérêt réside dans leur principe même. Étant exécutés par la carte graphique, les shaders ne consomment **pas** de processeur (CPU), ce dernier peut alors souffler un peu et se concentrer sur la gestion de l’IA ou du réseau par exemple. Dans cette optique de décharger le processeur, les shaders ont également un énorme intérêt si l’on utilise un langage assez “gourmand” comme le C# ou le Java, qui sont moins rapides que le C.\n\n## Un exemple concret ?\n\nMais concrètement, qu’est-ce qu’on peut faire avec des shaders ?\n\nIl est temps de vous montrer à quoi cela ressemble. Voici deux captures d’écran de la même scène, l’une utilisant le FFP standard, l’autre, des shaders.\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_640_73c7119f82b84068b.jpg)\n\nRendu standard\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_640_15af334fbee54bcd9.jpg)\n\nRendu avec shaders\n\n*(source du modèle 3D et des textures : [http://mdeverdelhan.developpez.com/tut \\[…\\] ht/tutoriel6/](http://mdeverdelhan.developpez.com/tutoriel/dynamiclight/tutoriel6/))*\n\nLes shaders permettent d’ajouter des effets qui peuvent être réalistes, beaux ou encore rigolos, comme le cel-shading (aussi appelé rendu cartoon).\n\nHey je veux savoir faire ça !\n\nPas de problème :) Toutefois soyez prévenus, pour aboutir à un résultat tel que vous venez d’en voir, les shaders ne suffisent pas, mais ils constituent une partie importante de la réalisation d’un tel effet. Et oui, les shaders ça ne fait pas tout, il faudra souvent les associer à des techniques de rendu (rendu offscreen notamment).\n\n![Image utilisateur](../../../_resources/users.teledisnet.be_web_mde28256_01c6017f34b24ea68.gif)\n\n:’(\n\nNe pleurez pas, je tâcherai de vous enseigner ces techniques au fur et à mesure à travers d’autres tutoriels ;) Et puis sachez qu’il existe aussi des techniques de rendu qui ne se contentent que des shaders.\n\n* * *\n\n## Comment faire ?\n\nMalgré quelques explications en début de chapitre, il est important que vous sachiez avec un peu plus de précision comment fonctionne l’implémentation théorique des shaders au sein d’un programme OpenGL.\n\n## Programmer un shader, c’est dur ?\n\nPour peu que vous sachiez raisonner logiquement, la programmation d’un shader ne devrait pas vous poser de problème ;) Cela n’a en réalité rien de sorcier, et si vous maîtrisez un temps soit peu la programmation d’un langage procédural tel que le C, vous vous apercevrez que le GLSL y ressemble beaucoup ;)\n\nEn effet, le GLSL est un langage ressemblant fortement au langage C.\n\nCependant, il est important**impératif** de distinguer deux choses :\n\n- la programmation d’un shader en GLSL;\n    \n- son utilisation au sein d’une application OpenGL.\n    \n\nCes deux choses sont totalement différentes, il est primordial de bien faire leur distinction. Nous avons d’une part la programmation du shader lui-même, c’est-à-dire le codage de la fonction qu’il remplira, l’effet graphique qu’il produira, d’autre part la définition de son utilisation, quand et comment l’utiliser dans notre application.\n\nNous pouvons comparer cela à l’utilisation des textures, nous avons d’une part la création de la texture, soit la création de l’image via un logiciel de dessin 2D, et d’autre part le chargement et l’utilisation de cette texture dans notre programme.\n\nL’idée est la même pour les shaders, nous allons tout d’abord programmer un shader, nous placerons son code source dans un fichier, puis nous programmerons notre application OpenGL et nous chargerons via celle-ci le code source de notre shader afin de l’utiliser à notre convenance au sein de notre programme.\n\n## Programmer un shader, avec quel IDE ?\n\nIl n’existe pas beaucoup d’éditeurs de texte qui colorent le langage GLSL.\n\nOn peut toutefois citer [Kate](http://kate-editor.org/), qui bénéficie du support de la coloration syntaxique du GLSL, il active automatiquement celle-ci pour tout fichier ayant pour extension .vert pour les vertex shader, ou .frag pour les fragment shader (ou pixel shader).\n\nIl existe également [QShaderEdit](http://castano.ludicon.com/page.php?page_id=118), un éditeur qui semble assez pratique ainsi que portable (bien qu’il utilise QT), mais que je n’ai jamais testé (merci à [XT95](http://www.siteduzero.com/membres-294-22249.html) pour l’info).\n\n## Programmer un shader, avec quel compilateur ?\n\nAucun ! :p\n\nVous avez bien lu, il ne vous faut télécharger aucun compilateur. Comme je l’ai déjà dit, les shaders GLSL sont compilés lors de l’exécution de votre application, c’est OpenGL qui s’en charge ;) Donc rien à faire de particulier ici.\n\nVous savez à présent qui sont ces fameux shaders, et ce qu’ils permettent de réaliser. Mais vous ne savez pas encore *comment* le réaliser. Pour l’instant le plus important est que vous ayez compris leur fonctionnement global, il faut pour cela retenir une chose importante : **les shaders sont des programmes exécutés par la carte graphique.**\n\nÀ partir de cette bonne base, nous allons étudier leur fonctionnement plus en profondeur afin de comprendre comment ils marchent réellement :)\n\n### Les spécifications du langage\n\nPour les adeptes des specs, voici [les spécifications](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf) du langage GLSL.\n\n* * *\n\n# Implémentation du GLSL côté API\n\nVous savez normalement comment fonctionne un shader et quel est son rôle, mais vous ne savez pas encore comment **l’intégrer** dans un programme avec OpenGL. Comment diable va-t-on réussir à utiliser une telle chose dans nos programmes OpenGL ? Comment ça marche ? C’est ce que nous allons étudier dans ce chapitre, nous apprendrons à manier les shaders avec OpenGL.\n\nL’implémentation des shaders se décompose en plusieurs parties :\n\n- premièrement, la **création** d’un shader. Nous verrons comment créer un shader en OpenGL;\n    \n- nous verrons ensuite comment attribuer un contenu à ce shader. Souvenez-vous : un shader est un programme, il possède donc un code source. Nous verrons comment **envoyer un code source** à notre shader précédemment créé;\n    \n- une fois le code source spécifié, il nous faudra le **compiler**. Il faudra également gérer les erreurs, car comme toute compilation, la compilation d’un shader peut échouer;\n    \n- notre shader est fin prêt, mais il n’est pas encore utilisable. Il nous faudra pour cela créer un **program**, car celui-ci peut être exécuté directement par la carte graphique.\n    \n\nIci nous allons uniquement programmer en C avec l’API OpenGL, ne confondez pas ce que nous allons écrire maintenant avec le langage GLSL, celui-ci ne sera étudié qu’à partir du prochain chapitre.\n\n## Création d’un shader\n\nNous y voilà :)\n\nVous vous demandez probablement comment fonctionnent ces tant convoités shaders ? En réalité, ils ne sont pas difficiles à manier rassurez-vous ;)\n\nNous allons voir ici la simple opération qu’est la création d’un shader, mais avant cela, il est important de savoir si votre implémentation supporte les shaders GLSL.\n\nComment ça ?\n\n## Les extensions des shaders\n\nSi vous possédez une ancienne carte graphique, vous risquez de ne pas pouvoir utiliser les shaders ou alors leur utilisation conduirait à une erreur indéterminée (erreur de segmentation la plupart du temps :-° ), il est donc important de tester si l’extension correspondante aux shaders GLSL est disponible.\n\nC’est quoi les extensions ?\n\nJe vous invite à lire [mon tutoriel sur les extensions d’OpenGL](http://www.siteduzero.com/tuto-3-17911-1-opengl-les-extensions.html). Il vous expliquera dans le détail ce que sont les extensions, et comment on les utilise.\n\nBon OK, et c’est quoi le nom de l’extension des shaders GLSL ?\n\nIl y en a en fait 4 :D\n\nVoici la liste des noms des extensions nécessaires à l’utilisation de shaders GLSL dans un programme OpenGL :\n\n- **GL\\_ARB\\_shading\\_language\\_100** : support du langage GLSL;\n    \n- **GL\\_ARB\\_shader_objects** : support des objets de shader (cf plus bas);\n    \n- **GL\\_ARB\\_vertex_shader** : support des vertex shaders;\n    \n- **GL\\_ARB\\_fragment_shader** : support des pixel shaders.\n    \n\nGlobalement, on peut dire que les shaders GLSL sont supportés à partir des GeForceFX chez nVidia, et à partir du Radeon 9500 chez ATI.\n\n## Création d’un shader\n\nVous vous souvenez de ce que je vous ai dit dans l’introduction ? Le maniement des shaders ressemble à celui des textures ;) Et c’est quoi une texture ? … (réflexion intense…) un **GLuint** !\n\n```\nGLuint shader;\n```\n\nBon, et bien voilà, ça c’est fait… :-°\n\nHep hep hep, une minute ! J’ai rien compris moi…\n\nEh bien un shader est un objet qui ne se manie qu’à partir de son identifiant, tout comme les textures. Cependant, les shaders ne se manipulent pas avec les habituelles fonctions glGen*, glIs*, glBind* et compagnie, il va donc falloir que je vous fasse découvrir dans un premier temps la fonction qui va venir remplacer glGen*, autrement dit : la fonction qui va créer un shader et nous renvoyer son identifiant. Il s’agit de la fonction glCreateShader, dont voici le prototype :\n\n```\nGLuint glCreateShader(GLenum type);\n```\n\n- ***type*** : attend une constante qui peut être GL\\_VERTEX\\_SHADER ou GL\\_FRAGMENT\\_SHADER. Chacune de ces constantes représente respectivement un shader de sommet et un shader de pixel. Souvenez-vous lors de l’introduction je vous avait dit qu’il existait deux types de shader, et bien c’est ici que vous allez spécifier ce type ;)\n\nCette fonction renvoie l’identifiant de l’objet de shader créé.\n\nAllez, un exemple complet :\n\n```\nGLuint shader;\nshader = glCreateShader(GL_VERTEX_SHADER);\n```\n\nEt voilà, nous avons à présent un shader de sommet prêt à être utilisé :)\n\nEt quand on ne voudra plus l’utiliser ?\n\nAlors il faudra le supprimer. Voici le prototype de la fonction qui permet de supprimer un shader :\n\n```\nvoid glDeleteShader(GLuint shader);\n```\n\nNous l’utiliserons comme ceci au sein de notre programme :\n\n```\nGLuint shader;\n\n/* creation */\nshader = glCreateShader(GL_VERTEX_SHADER);\nif(shader == 0)\n{\n    /* erreur de creation :( */\n    return;\n}\n\n/* utilisation ... */\n\n/* suppression */\nglDeleteShader(shader);\nshader = 0;\n```\n\nNotez l’ajout de la dernière ligne de code, ainsi que de la vérification de la valeur de l’identifiant. Tout comme tout autre identifiant d’objet OpenGL, 0 n’est pas un identifiant de shader valide. Bien que cela soit rare, il n’est pas impossible qu’à priori OpenGL vous renvoie 0, il est donc conseillé de tester la valeur de retour de glCreateShader, mais ce n’est pas obligatoire comme avec malloc.\n\nPour finir, je vais vous présenter une fonction dont la syntaxe devrait vous être familière : glIsShader. A l’instar des autres fonctions glIs* d’OpenGL, cette fonction permet de savoir si l’identifiant qu’elle reçoit en paramètre est un identifiant de shader valide. Voici le prototype de cette fonction :\n\n```\nGLboolean glIsShader(GLuint shader);\n```\n\nBien, nous avons réussi à créer un shader… mais quelles sont les fonctions permettant de le manipuler afin de l’utiliser à notre guise ? Eh bien suivez-moi, c’est par là :)\n\n* * *\n\n## Envoi d’un code source à un shader\n\nNous voici parvenus à la seconde étape de la création d’un shader fonctionnel.\n\nNous allons voir ici comment charger notre code source afin de le donner à manger à OpenGL.\n\nComment ça ?\n\nJe vous l’ai déjà dit lors de l’introduction, les shaders sont compilés lors de l’exécution de votre application, il va donc falloir charger leur code source dynamiquement, à partir d’un fichier par exemple ;)\n\nPourquoi un shader doit se compiler à l’exécution ? Ça doit être lent non ?\n\nCe n’est pas lent du tout rassurez-vous ;) Sans être affirmatif, je pense que les principales raisons à cela sont :\n\n- plus simple à gérer, s’il fallait procéder à la compilation séparée des shaders on ne s’en sortirait plus;\n    \n- je pense qu’une compilation à l’exécution permet à OpenGL d’optimiser le shader en fonction du matériel de la machine qui exécute le programme OpenGL.\n    \n\n## Charger un code source à partir d’un fichier\n\nVoilà une étape des plus enfantines, pour peu que vous sachiez utiliser les fichiers dans le langage que vous utilisez pour faire vos programmes OpenGL.\n\nJe vais ici vous présenter un exemple de code en langage C (langage qui est et sera d’ailleurs utilisé pour tous les exemples). Le but est donc d’obtenir un code source, et qu’est-ce qu’un code source ? Une chaîne de caractères ! Bingo ;) Voyons voir… :\n\n```\nchar* LoadSource(const char *filename);\n```\n\nCeci pourrait être un bon prototype pour une fonction ayant pour but de charger le code source de nos shaders :) C’est une fonction simple et générique, je l’adopte ! Il faut à présent la programmer, rien de très sorcier :\n\n```\nchar* LoadSource(const char *filename)\n{\n    char *src = NULL;   /* code source de notre shader */\n    FILE *fp = NULL;    /* fichier */\n    long size;          /* taille du fichier */\n    long i;             /* compteur */\n    \n    \n    /* on ouvre le fichier */\n    fp = fopen(filename, \"r\");\n    /* on verifie si l'ouverture a echoue */\n    if(fp == NULL)\n    {\n        fprintf(stderr, \"impossible d'ouvrir le fichier '%s'\\n\", filename);\n        return NULL;\n    }\n    \n    /* on recupere la longueur du fichier */\n    fseek(fp, 0, SEEK_END);\n    size = ftell(fp);\n    \n    /* on se replace au debut du fichier */\n    rewind(fp);\n    \n    /* on alloue de la memoire pour y placer notre code source */\n    src = malloc(size+1); /* +1 pour le caractere de fin de chaine '\\0' */\n    if(src == NULL)\n    {\n        fclose(fp);\n        fprintf(stderr, \"erreur d'allocation de memoire!\\n\");\n        return NULL;\n    }\n    \n    /* lecture du fichier */\n    for(i=0; i\u003csize; i++)\n        src[i] = fgetc(fp);\n    \n    /* on place le dernier caractere a '\\0' */\n    src[size] = '\\0';\n    \n    fclose(fp);\n    \n    return src;\n}\n```\n\nCeci étant fait, nous devons voir à présent comment envoyer notre code source à notre objet *shader*. Effectivement, OpenGL nous propose de spécifier le code source de notre shader via un **char***. Ça tombe bien, nous l’avons celui-ci :p\n\nVoici la fonction qui permet d’envoyer le code source d’un shader :\n\n```\nvoid glShaderSource(GLuint shader, GLsizei nombre, const GLchar **sources, const GLint *longueur);\n```\n\n- ***shader*** : c’est l’identifiant de notre shader, afin que la fonction adresse notre code source à ce shader et pas un autre.\n    \n- ***nombre*** : c’est le nombre de chaînes contenues dans *sources*.\n    \n- ***sources*** : c’est notre code source, décomposé en plusieurs chaînes.\n    \n- ***longueur*** : un paramètre bizarre autant que compliqué :-° nous le laisserons à NULL, c’est tout à fait autorisé ;)\n    \n\nHé mais cette fonction attend plusieurs chaînes, mais nous on en a qu’une seule !\n\nCe fut également la réaction que j’ai eu lorsque j’ai vu le prototype de la fonction pour la première fois :-° J’ai vite compris que ça n’avait aucune importance, nous avons une seule chaîne, donc nous allons positionner *nombre* à 1 et nous enverrons l’adresse de notre pointeur sur notre code source.\n\nUn exemple ? Ok :\n\n```\nchar *src = LoadSource(...);\nglShaderSource(shader, 1, \u0026src, NULL);\n```\n\nVoilà, notre shader est à présent prêt à être compilé :)\n\nC’est quoi l’intérêt d’envoyer un code source à OpenGL si ce n’est pas pour qu’il le compile ? Pourquoi ne l’a-t-il pas déjà compilé ?\n\nVous restez ainsi maître de votre application et c’est réellement vous qui choisissez quand il doit se passer telle ou telle chose.\n\nNotez qu’il n’est pas possible de procéder à plusieurs appels de la fonction *glShaderSource()* afin “d’entasser” les codes sources, seul le dernier code envoyé sera pris en compte !\n\nBien, passons à présent à la compilation. Elle a droit à toute une sous-partie et ce n’est pas pour rien, comme nous allons le voir :p\n\n* * *\n\n## Compilation d’un shader\n\nVous avez sans doute l’habitude de compiler vos programmes en C ou dans un autre langage, et en général la procédure se déroule ainsi :\n\n- vous enregistrez votre code source dans un fichier;\n    \n- vous demandez la compilation de ce code source;\n    \n- vous tombez sur une erreur de compilation :-°\n    \n\nC’est la dernière étape la plus intéressante :D En effet, imaginez que vous ayez fait une faute dans l’écriture du code de votre shader, OpenGL va alors refuser la compilation et générera une erreur accompagnée d’un message, vous indiquant où vous vous êtes plantés :-° Il est très important de récupérer les messages d’erreur de compilation des shaders, vous ferez probablement des erreurs parfois en programmant vos shaders, ou bien des fautes de frappe. Récupérer une erreur de compilation c’est aussi et surtout récupérer une ligne de code, c’est grâce à elle que vous pourrez localiser votre erreur.\n\nNous allons dans un premier temps voir comment compiler un shader, puis nous verrons comment vérifier le succès de cette compilation en récupérant un code d’erreur, en l’analysant, et en agissant en fonction de celui-ci.\n\n## Compiler un shader\n\nPour compiler un shader GLSL, rien de compliqué, il existe une fonction dédiée à cela. La fonction permettant de compiler un shader est glCompileShader, tout simplement. Voici son prototype :\n\n```\nvoid glCompileShader(GLuint shader);\n```\n\n- ***shader*** : c’est l’identifiant de notre shader à compiler.\n\nVoici un exemple de code complet, reprenant les exemples précédents (le contenu de la fonction *LoadSource()* a été enlevé afin d’alléger le code) :\n\n```\nGLuint shader;\n    char *src = NULL;\n    \n    /* creation d'un shader de sommet */\n    shader = glCreateShader(GL_VERTEX_SHADER);\n    if(shader == 0)\n    {\n        fprintf(stderr, \"impossible de creer le shader\\n\");\n        return -1;\n    }\n    \n    /* chargement du code source */\n    src = LoadSource(\"test.vert\");\n    if(src == NULL)\n    {\n        /* theoriquement, la fonction LoadSource a deja affiche un message\n           d'erreur, nous nous contenterons de supprimer notre shader\n           et de retourner 0 */\n        \n        glDeleteShader(shader);\n        return 0;\n    }\n    \n    /* assignation du code source */\n    glShaderSource(shader, 1, (const GLchar**)\u0026src, NULL);\n    \n    /* compilation du shader */\n    glCompileShader(shader);\n    \n    /* liberation de la memoire du code source */\n    free(src);\n    \n    /* verification du succes de la compilation ... */\n    \n    ...\n    \n    /* utilisation ... */\n    \n    ...\n    \n    /* suppression */\n    glDeleteShader(shader);\n```\n\nNe pas oublier de libérer le pointeur src après la compilation, même si celle-ci a échoué, le code source ne nous sera de toute façon d’aucune utilité.\n\n## Vérifier le succès d’une compilation\n\nComme pour toute compilation, des erreurs sont possibles et leur nature doit être connue. Pour cela, il nous faut savoir si il y a eu une erreur, et s’il y en a une, on récupère le message qu’elle contient et on affiche ce dernier à l’écran.\n\nIl existe une fonction pour récupérer l’état de la compilation. Plus globalement, il s’agit d’une fonction permettant de récupérer un entier relatif à une information spécifique d’un shader.\n\n```\nvoid glGetShaderiv(GLuint shader, GLenum type, GLint *result);\n```\n\n- ***shader*** : nous placerons ici l’identifiant de notre shader.\n    \n- ***type*** : il s’agit du type d’état demandé. Nous recherchons l’état de la compilation du shader, nous placerons donc ici la constante GL\\_COMPILE\\_STATUS.\n    \n- ***result*** : il s’agit d’un pointeur sur un entier dans lequel OpenGL écrira la valeur de l’état demandé.\n    \n\nCette fonction va donc placer dans *result* la valeur de l’état demandé, en l’occurrence, l’état de la compilation du shader. Nous allons procéder ainsi :\n\n```\nGLint compile_status = GL_TRUE;\n\n/* verification du succes de la compilation */\nglGetShaderiv(shader, GL_COMPILE_STATUS, \u0026compile_status);\nif(compile_status != GL_TRUE)\n{\n    /* erreur a la compilation\n       recuperation du log d'erreur */\n    ...\n}\n```\n\nSi *compile_status* est différent de la constante GL_TRUE, une erreur est survenue et il nous faut donc récupérer le message qu’elle contient. Attention, cette procédure n’est à effectuer que si la compilation a échoué, sinon elle est inutile et ne ferait que ralentir l’application. C’est pour cela que nous allons à présent remplir de quelques lignes de code le bloc de ce **if**.\n\n## Récupérer les messages d’erreur de la compilation\n\nBien, supposons qu’une erreur soit intervenue, nous nous trouvons à présent dans le bloc du **if** du code précédent, et il nous faut agir.\n\nLe message d’erreur se trouve sous la forme d’une chaîne de caractères, mais attention, OpenGL n’allouera aucune mémoire pour nous, il va donc falloir lui demander quelle est la taille du message d’erreur, allouer une chaîne de cette taille puis demander à OpenGL d’écrire le message d’erreur dans notre mémoire fraîchement allouée.\n\nNous allons reprendre notre fonction glGetShaderiv, mais cette fois-ci en lui envoyant comme second paramètre (*type*) la constante GL\\_INFO\\_LOG_LENGTH, afin d’obtenir la longueur du message d’erreur :\n\n```\nGLint logsize;\n\n...\n\nglGetShaderiv(shader, GL_INFO_LOG_LENGTH, \u0026logsize);\n```\n\nA présent, il nous faut allouer un espace mémoire de la taille de *logsize* :\n\n```\nchar *log = NULL;\n\n...\n\nlog = malloc(logsize+1); /* +1 pour le caractere de fin de chaine '\\0' */\nif(log == NULL)\n{\n    fprintf(stderr, \"erreur d'allocation memoire !\\n\");\n    return -1; /* ou autre code approprie */\n}\n```\n\nEt pour finir, nous allons récupérer le message d’erreur en envoyant notre pointeur *log* à une fonction d’OpenGL appelée glGetShaderInfoLog. Voici le prototype de cette fonction :\n\n```\nvoid glGetShaderInfoLog(GLuint shader, GLsizei max_size, Glsizei *longueur, char *info_log);\n```\n\n- ***shader*** : c’est l’identifiant de notre shader.\n    \n- ***max_size*** : c’est le nombre maximal de bytes qu’OpenGL écrira dans notre mémoire. OpenGL ne dépassera pas cette valeur.\n    \n- ***longueur*** : c’est la longueur de notre chaîne. C’est un paramètre un peu bizarre je vous l’accorde, nous placerons ici l’adresse de notre variable *logsize*.\n    \n- ***info_log*** : c’est l’adresse mémoire dans laquelle OpenGL écrira le message d’erreur.\n    \n\nIl ne faudra évidemment pas oublier de libérer notre mémoire *log* après avoir affiché son contenu.\n\nVoyons à présent si vous le voulez bien, un exemple de code complet :) :\n\n```\nGLuint LoadShader(GLenum type, const char *filename)\n{\n    GLuint shader = 0;\n    GLsizei logsize = 0;\n    GLint compile_status = GL_TRUE;\n    char *log = NULL;\n    char *src = NULL;\n    \n    /* creation d'un shader de sommet */\n    shader = glCreateShader(type);\n    if(shader == 0)\n    {\n        fprintf(stderr, \"impossible de creer le shader\\n\");\n        return 0;\n    }\n    \n    /* chargement du code source */\n    src = LoadSource(filename);\n    if(src == NULL)\n    {\n        /* theoriquement, la fonction LoadSource a deja affiche un message\n           d'erreur, nous nous contenterons de supprimer notre shader\n           et de retourner 0 */\n        \n        glDeleteShader(shader);\n        return 0;\n    }\n    \n    /* assignation du code source */\n    glShaderSource(shader, 1, (const GLchar**)\u0026src, NULL);\n    \n    /* compilation du shader */\n    glCompileShader(shader);\n    \n    /* liberation de la memoire du code source */\n    free(src);\n    src = NULL;\n    \n    /* verification du succes de la compilation */\n    glGetShaderiv(shader, GL_COMPILE_STATUS, \u0026compile_status);\n    if(compile_status != GL_TRUE)\n    {\n        /* erreur a la compilation recuperation du log d'erreur */\n        \n        /* on recupere la taille du message d'erreur */\n        glGetShaderiv(shader, GL_INFO_LOG_LENGTH, \u0026logsize);\n        \n        /* on alloue un espace memoire dans lequel OpenGL ecrira le message */\n        log = malloc(logsize + 1);\n        if(log == NULL)\n        {\n            fprintf(stderr, \"impossible d'allouer de la memoire !\\n\");\n            return 0;\n        }\n        /* initialisation du contenu */\n        memset(log, '\\0', logsize + 1);\n        \n        glGetShaderInfoLog(shader, logsize, \u0026logsize, log);\n        fprintf(stderr, \"impossible de compiler le shader '%s' :\\n%s\",\n                filename, log);\n        \n        /* ne pas oublier de liberer la memoire et notre shader */\n        free(log);\n        glDeleteShader(shader);\n        \n        return 0;\n    }\n    \n    return shader;\n}\n```\n\nEt voilà, nous avons une fonction opérationnelle capable de charger un shader à partir d’un fichier :) La fonction renvoie 0 en cas d’erreur, ou bien l’identifiant du shader créé si elle a réussi.\n\n* * *\n\n## Création et utilisation d’un program\n\n“program” ? C’est quoi ce nouveau mot ?\n\nC’est comme cela que l’on appelle les program de shader en OpenGL. Un peu flou ? :D Nous venons de voir comment créer un shader, mais ce shader n’est hélas pas exécutable, la seule chose qui soit exécutable est un program.\n\nUn program recueille un ou deux shaders, et il est exécutable par la carte graphique.\n\n## Créer un objet de program\n\nEt oui, nous revoilà à nouveau avec des objets OpenGL, eux aussi différents de tous ceux que vous aurez pu manipuler jusqu’à maintenant.\n\nRassurez-vous toutefois, leur fonctionnement est très simple :) La base des objets OpenGL est d’ailleurs reprise, un objet de program est un GLuint (entier non signé) :\n\n```\nGLuint program;\n```\n\nLa création d’un program est simple, il suffit d’appeler la fonction *glCreateProgram()* qui ne prend aucun paramètre, et retourne simplement l’identifiant du program créé :\n\n```\nprogram = glCreateProgram();\n```\n\nJusque là, pas de difficulté majeure :-°\n\nIdem pour la suppression d’un program, cela se fait en toute simplicité avec la fonction *glDeleteProgram()*. Un exemple ? :\n\n```\nglDeleteProgram(program);\n```\n\nPour l’instant, notre program ne fait rien, il va donc falloir lui donner des shaders à exécuter.\n\n## Association d’un ou plusieurs shaders à un program\n\nOui, vous avez bien lu.\n\nComme je l’ai déjà dit, un program est un recueil de un ou deux shaders. On peut y mettre soit un vertex shader, soit un pixel shader, soit les deux.\n\nPour clarifier vos idées dès à présent, je vous ai préparé un petit schéma :) Voici la procédure à suivre pour créer un program exécutable :\n\n1.  créer un vertex shader, nous allons l’appeler *VS*;\n    \n2.  créer un pixel shader, nous allons l’appeler *PS*;\n    \n3.  créer un program, nous l’appellerons *Program*;\n    \n4.  incorporer (je fais de la cuisine là :-° ) le vertex et le pixel shader dans le program;\n    \n5.  rendre le program exécutable en le liant (nous verrons plus bas en quoi cela consiste);\n    \n6.  le program étant lié, nous pouvons supprimer nos shaders VS et PS si nous en avons plus besoin;\n    \n7.  utiliser le program à notre guise :)\n    \n8.  détruire les shaders (si ce n’est pas déjà fait) et le program.\n    \n\nEt voici le schéma correspondant :) :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_640_f2c7faf9a7d448d09.gif)\n\nIci, trois notions qui vous sont encore inconnues ont été introduites, il s’agit de “attach”, “construction” et “utilisation”. Nous allons sans plus tarder nous intéresser à “attach”.\n\nBon, nous voulons donc associer un ou plusieurs shaders à un program. Il existe pour cela une fonction très simple, *glAttachShader()* :\n\n```\nvoid glAttachShader(GLuint program, GLuint shader);\n```\n\n- ***program*** : il s’agit là du program qui recevra le shader.\n    \n- ***shader*** : c’est le shader à associer à *program*.\n    \n\nSon utilisation est tellement simple qu’on en pleurerait :’( Je vous épargne l’exemple de code pour cette fonction, je pense que ça serait inutile.\n\nA l’inverse de *glAttachShader()*, il existe une fonction qui a l’effet contraire. Supposez que vous vouliez mettre à jour un shader, il faudra d’abord que vous le détachiez du program auquel il a été attaché via *glAttachShader()*, utilisez pour cela *glDetachShader()* :\n\n```\nvoid glDetachShader(GLuint program, GLuint shader);\n```\n\nJe pense qu’elle se passe de commentaire ;)\n\nBien, nous savons à présent comment créer un program exécutable, comment lui assigner des shaders, mais nous ne savons toujours pas comment l’utiliser. Toutefois avant de pouvoir utiliser un program, il est important de le rendre opérationnel en le liant.\n\n## Liage d’un program de shader\n\nLe liage (ou linking) d’un program peut se comparer à la compilation des shaders car il se décompose également en deux étapes :\n\n- le liage en lui même;\n    \n- la vérification du succès de ce liage.\n    \n\nOui mais qu’est-ce que le liage d’un program ? Et bien en fait lorsqu’on lie un program de shader on demande à OpenGL de lier le vertex shader avec le pixel shader. Cette liaison peut échouer dans la mesure où les deux shaders peuvent être incompatibles entre eux.\n\nNous verrons dans une autre partie de ce tutoriel en quoi consiste réellement le linking et ce qu’il apporte.\n\nBien, passons à présent au vif du sujet : nous voulons lier un program de shaders. Pour ce faire, il existe une simple fonction appelée *glLinkProgram()* :\n\n```\nvoid glLinkProgram(GLuint program);\n```\n\n- ***program*** : c’est le program que l’on souhaite lier.\n\nComme je l’ai dit plus haut, l’étape suivante consiste à vérifier que le liage a bien fonctionné. La méthode employée est très similaire à celle des shaders :\n\n- on vérifie si une erreur est présente;\n    \n- s’il y en a une, on récupère la taille de la chaîne contenant le message d’erreur;\n    \n- on alloue un espace mémoire de cette taille;\n    \n- on indique l’adresse de cette mémoire à OpenGL pour qu’il puisse y écrire le message d’erreur.\n    \n\nVoici la fonction permettant (entre autres) de savoir si une erreur a été levée :\n\n```\nvoid glGetProgramiv(GLuint program, GLenum type, GLint *result);\n```\n\nSon fonctionnement est identique à glGetShaderiv pour les shaders, je vais donc passer les descriptions minutieuses. Tout ce que vous devez savoir ici, c’est la constante à passer à *type* pour obtenir ce que l’on cherche. Nous cherchons l’état du précédent liage du program, pour cela nous allons passer la constante GL\\_LINK\\_STATUS. La vérification de la valeur de *result* fonctionne de la même façon que pour les shaders, si elle est différente de GL_TRUE, alors une erreur a été levée.\n\nEtape suivante, nous voulons récupérer la longueur du message d’erreur, nous allons utiliser pour cela glGetProgramiv avec comme paramètre *type* la constante GL\\_INFO\\_LOG_LENGTH (comme pour les shaders).\n\nEnfin, pour récupérer le message d’erreur, nous avons à notre disposition la fonction glGetProgramInfoLog :\n\n```\nvoid glGetProgramInfoLog(GLuint program, GLsizei max_size, GLsizei *longueur, char *log);\n```\n\nSon fonctionnement est lui aussi identique à la fonction glGetShaderInfoLog pour les shaders.\n\nUn exemple de code complet sera disponible à la fin du chapitre.\n\n## Utiliser un program de shader\n\nAh ! Nous voici arrivés à la partie la plus intéressante :)\n\nRésumons une fois de plus si vous le voulez bien :\n\n- nous savons créer un shader;\n    \n- nous savons créer un program exécutable;\n    \n- nous savons attribuer à ce program des shaders à exécuter;\n    \n- nous ne savons pas comment rendre ce program actif :-°\n    \n\nUtiliser un program, c’est le rendre actif pour tous les prochains rendus jusqu’à ce que l’on demande explicitement l’arrêt de l’utilisation d’un quelconque program de shader, ou jusqu’à ce que l’on active un autre program de shader.\n\nComme toujours, je vais reprendre mon exemple sur la similitude avec les textures. Vous savez certainement comment on rend une texture active ?\n\n```\nglBindTexture(GL_TEXTURE_2D, tex_id);\n```\n\nCe code rend la texture *tex_id* active pour tous les prochains rendus jusqu’à ce qu’un appel de glBindTexture avec un identifiant de 0 soit effectué :\n\n```\n/* desactive la precedente texture active */\nglBindTexture(GL_TEXTURE_2D, 0);\n```\n\nVous noterez que pour les textures, l’emploi de glDisable(GL\\_TEXTURE\\_2D) est préférable, mais pour utiliser un program de shader, aucun état OpenGL n’est à activer.\n\nBien, il est temps de vous présenter la fonction qui permet de rendre un program actif pour le rendu :) :\n\n```\nvoid glUseProgram(GLuint program);\n```\n\n- ***program*** : il s’agit là de l’identifiant du program que l’on souhaite activer, si cet identifiant est de 0, OpenGL désactivera l’utilisation des programs de shaders.\n\nAllez, un exemple pour le fun :-° :\n\n```\nglUseProgram(program);\n\n/* super rendus avec des effets de la mort qui tue */\n\n/* desactive l'utilisation des shaders, OpenGL retourne en mode normal (passe par le FFP) */\nglUseProgram(0);\n```\n\nTout comme les textures, vous pouvez charger plusieurs shaders en début de programme et ensuite les utiliser simultanément, comme ceci :\n\n```\nglUseProgram(prog1);\n\n/* rendus utilisant le program prog1 */\n\nglUseProgram(prog2);\n\n/* rendus utilisant le program prog2 */\n\nglUseProgram(prog3);\n\n/* rendus utilisant le program prog3 */\n\nglUseProgram(0);\n\n/* fin des rendus utilisant les shaders */\n```\n\nAttention toutefois, comme avec les textures, il est impossible d’utiliser deux programs à la fois. Ici, le second appel à glUseProgram défini prog2 comme étant actif **à la place** de prog1.\n\n* * *\n\n# Un exemple complet\n\nVoilà, je crois que nous avons abordé toutes les facettes de la gestion des shaders GLSL du côté de l’API :) Bien sûr, il reste encore quelques détails, mais je vous les ferai connaître plus tard, pour l’instant ils ne feraient que vous embrouiller croyez-moi ;)\n\nAfin que vous vous fassiez une meilleure idée de la façon dont tout ce bazar s’assemble, je vous ai préparé un programme complet chargeant un simple vertex shader qui a pour effet de transformer l’image affichée en couleurs négatives. Pour activer le shader, vous devez appuyer sur une touche du clavier.\n\n[Télécharger l’exemple de code et le Makefile Unix](http://yno.goldzoneweb.info/sdz/ch2.zip)\n\nJ’utilise [Glew](http://glew.sourceforge.net/) pour charger les extensions d’OpenGL, vous devez le posséder si vous voulez pouvoir compiler/recompiler le code source. L’exécutable fourni utilise la glibc2.4\n\nQue les utilisateurs de MacOS et Windows m’excusent, je n’utilise pas ces OS et par conséquent je n’ai pas pu vous mijoter quelque chose, il va falloir que vous vous débrouilliez pour compiler les sources :euh: Toutefois je vous recommande fortement de télécharger ces sources pour les étudier afin de bien comprendre comment fonctionne le chargement et l’utilisation des shaders. N’hésitez pas à relire les parties du chapitre que vous n’avez pas comprises, avec l’exemple de code sous les yeux afin de bien faire la relation entre ce que j’explique et la mise en pratique ;)\n\nUn peu à l’instar de Kayl avec son sdlglutils, je vous propose de télécharger cet ensemble de deux fichiers qui proposent quelques fonctions bien pratiques pour charger un shader simplement sans trop se fatiguer :\n\n[Télécharger loadprogram.zip](http://yno.goldzoneweb.info/sdz/loadprogram.zip)\n\nCe sont en réalité les fonctions que nous avons construites ensembles, avec quelques petits ajouts toutefois ;) Dorénavant j’utiliserai ces fonctions pour le chargement des shaders afin d’alléger les exemples de code.\n\nCes deux exemples de code sont distribués sous licence GPL ;)\n\nOuf, nous voici enfin arrivés au terme de ce long chapitre ! :)\n\nVous savez à présent comment utiliser les shaders dans vos programmes OpenGL, les activer, les désactiver, etc… Mais (parce qu’il y a un mais :-° ), vous ne savez pas programmer un shader.\n\nEt d’ailleurs, ça vous dirait de savoir les programmer, ces fameux shaders ? Oui ? Pas de problème, c’est par ici :)\n\n* * *\n\n## Les bases du langage\n\nNous y voilà enfin, nous allons ici commencer à apprendre le langage GLSL qui est un langage de programmation de shaders conçu pour OpenGL.\n\nNous étudierons d’abord les bases du langage :\n\n- les variables et leur types ;\n    \n- la surcharge des opérateurs ;\n    \n- le cast (très important et très employé en GLSL).\n    \n\nNous programmerons ensuite de simples vertex et pixel shaders, afin de voir comment ils fonctionnent :) Vous verrez qu’ils utilisent tout deux des variables d’entrée et des variables de sortie, qui nous permettent de recevoir et de renvoyer des données. Les données reçues seront traitées par les instructions contenues dans le code source du shader, pour obtenir un résultat qui sera ensuite renvoyé. Ces résultats représentent généralement des informations de **position à l’écran** pour les vertex shaders, et de **couleur** pour les pixel shaders.\n\n## Une forte ressemblance avec le C\n\nLe langage GLSL a beaucoup de points communs avec le langage C. Syntaxiquement, les deux langages sont quasiment identiques.\n\n## Les variables\n\nTout comme en C, il est possible de créer des variables en GLSL. Il existe une multitude de types de variables, chacun ayant une utilité bien précise. Par exemple, si vous souhaitez créer une variable capable de stocker des nombres flottants, faites ceci :\n\n```\nfloat variable;\n```\n\nEt oui, comme en C :) Notez également la présence d’un point-virgule, qui se place aux mêmes endroits qu’en C. La création de deux variables à la fois est également autorisée, avec l’ajout d’une virgule entre les deux noms de variable :\n\n```\nfloat a, b;\n```\n\nLes variables préfixées **gl_** sont réservées au langage lui-même, il est donc interdit de créer une variable dont le nom commence par gl_ !\n\nIl est possible de créer des variables des types suivants :\n\n- **int** : entier ;\n    \n- **float** : flottant ;\n    \n- **bool** : booléen, peut valoir **true** ou **false** ;\n    \n- **vec2** : vecteur à 2 composantes flottantes ;\n    \n- **vec3** : vecteur à 3 composantes flottantes ;\n    \n- **vec4** : vecteur à 4 composantes flottantes ;\n    \n- **mat2** : matrice 2 * 2 de flottants ;\n    \n- **mat3** : matrice 3 * 3 de flottants ;\n    \n- **mat4** : matrice 4 * 4 de flottants ;\n    \n- **ivec2** : vecteur à 2 composantes entières ;\n    \n- **ivec3** : vecteur à 3 composantes entières ;\n    \n- **ivec4** : vecteur à 4 composantes entières ;\n    \n- **bvec2** : vecteur à 2 composantes booléennes ;\n    \n- **bvec3** : vecteur à 3 composantes booléennes ;\n    \n- **bvec4** : vecteur à 4 composantes booléennes.\n    \n\nSoudainement, les ressemblances avec le C s’arrêtent :-° Effectivement, le GLSL possède beaucoup de types de variables… qui ne sont finalement plus des variables mais des ensembles de variables. Nous pouvons toutefois les comparer à des structures, et nous allons voir pourquoi. Lorsque vous créez un vecteur à 3 composantes par exemple (**vec3**), GLSL vous permet d’accéder à une seule de ses composante de cette façon :\n\n```\nvec3 direction;\ndirection.x = 0.2;\n```\n\nLa seconde instruction place la valeur 0.2 dans la composante X du vecteur *direction* grâce à l’opérateur d’affectation =, qui fonctionne de la même façon qu’en C… ou presque.\n\n## Les opérateurs\n\nIl est bien sûr possible de multiplier une variable par une autre, ou bien encore de soustraire une valeur à une variable. Les opérateurs en GLSL s’utilisent comme en C, voici un exemple :\n\n```\nfloat var1 = 0.2, var2 = 3.0;\nfloat resultat = (var1 - 0.1) * var2;\n```\n\nIci, *resultat* vaudra (0.2 - 0.1) * 3.0 soit 0.3.\n\nEt si je vous apprenais qu’on peut multiplier un vecteur par un vecteur, vous me répondriez quoi ?\n\n### La surcharge des opérateurs\n\nPremier point commun avec le langage C++ : les opérateurs en GLSL sont surchargés.\n\nEuh, et ça veut dire quoi ?\n\nJe ne vais pas vous faire une description avancée de ce qu’est la surcharge des opérateurs, mais pour vous expliquer en deux mots, ça veut dire qu’on peut additionner, soustraire, multiplier et diviser tous les types de variable par tous les types de variable !\n\nJ’y comprend rien o_O\n\nVous connaissez probablement la multiplication matricielle ? Et bien effectuer ce genre de multiplication en GLSL est un jeu d’enfant :\n\n```\nmat4 a = ..., b = ...;\nmat4 resultat = a * b;\n```\n\n*resultat* vaut maintenant le résultat de la multiplication matricielle de *a* par *b*. Et ça marche aussi pour les vecteurs ! :) :\n\n```\nvec4 position = ...;\nmat4 m = ...;\n \nvec4 resultat = m * position;\n```\n\n*resultat* vaut à présent la position que représente le vecteur *position* transformé par la matrice *m*.\n\nNotez qu’ici l’ordre de la multiplication est important ! C’est d’abord la matrice, puis le vecteur. Si cela vous semble flou, n’hésitez pas à aller lire [le tutoriel de Kayl sur les matrices](http://www.siteduzero.com/tuto-3-23978-1-les-matrices.html).\n\nAllez, encore un exemple :\n\n```\nvec3 vecteur = ...;\nvecteur *= 2.0;\n```\n\nLa seconde ligne de ce code a pour effet de multiplier chaque composante du vecteur *vecteur* par 2.\n\n### Les limites de la surcharge\n\nHé oui malheureusement cette surcharge a des limites, on ne peut pas réellement tout faire comme je l’ai dit avant, il existe des exceptions. Ces exceptions sont toutefois logiques et n’ont rien de mystérieux comme nous allons le voir. Par exemple, il est impossible de multiplier une matrice 3\\*3 par une matrice 4\\*4, si vous vous y risquez, OpenGL lèvera une erreur lors de la compilation de votre shader. Autre cas typique : les vecteurs, il est impossible d’effectuer une quelconque opération entre deux vecteurs de type différents. Enfin, il est également impossible de multiplier un vecteur à 2 composantes (**vec2**) par une matrice autre qu’une 2*2 (**mat2**), et il en va de même pour tous les autres types, **vec3** avec **mat3** et **vec4** avec **mat4**.\n\nMaintenant que je vous ai exposé pleins d’inconvénients dûs à la surcharge, je vais vous proposer des une solution :)\n\n## Le cast\n\nTout comme en C, il est possible de forcer la conversion d’un type vers un autre. Ici, la syntaxe est différente que celle du C où l’on fait comme ceci :\n\n```\nfloat flottant = (float)entier;\n```\n\nEn GLSL, le cast d’une variable se fait ainsi :\n\n```\nfloat flottant = float(entier);\n```\n\nLa conversion explicite de int vers float ou de float vers int n’est pas obligatoire, en revanche, si vous souhaitez convertir un **vec3** en **vec2**, là il va falloir le demander explicitement.\n\nComment on peut convertir un vecteur à trois dimensions en un vecteur à deux dimensions ?\n\nJe ne vais rien vous cacher, et une conversion de ce type amène forcément à une perte de donnée(s), nous allons uniquement conserver dans le vecteur à 2 dimensions deux composantes du vecteur à 3 dimensions. Mais avec le cast, c’est vous qui allez choisir quelles données vous souhaiterez supprimer et quelles données vous souhaiterez garder. (par donnée je sous-entend *composante* d’un vecteur)\n\nÉtant donné qu’il existe un trop grand nombre de conversions possible (chaque type peut être converti en chaque type), je ne vais pas vous faire une démonstration pour chacune d’entre elles, je vais juste vous fournir la technique à utiliser, elle est logique et fonctionne de la même façon (ou presque) pour tous les types de conversion.\n\nNous allons prendre l’exemple de la conversion d’un **vec3** vers un **vec2**, puis nous prendrons ensuite l’exemple inverse, à savoir **vec2** -\\\u003e **vec3**.\n\nPour convertir un vec3 en vec2, une méthode simple existe :\n\n```\nvec3 v = ...;\n \nvec2 v2 = vec2(v);\n```\n\nCe code est simple et pourrait se traduire de la façon suivante :\n\n```\nvec3 v = ...;\nvec2 v2;\n \nv2.x = v.x;\nv2.y = v.y;\n```\n\nEn réalité, le cast du premier code prend les *n* premières composantes de la variable à caster et les places dans la variable finale, où *n* représente le nombre maximal de variables stockables dans le type de la variable finale, dans notre exemple, *n* vaut 2.\n\nVous pouvez également prendre d’autres composantes de *v* pour les placer dans *v2* sans avoir à spécifier manuellement les composantes de *v* qui recevrons la valeur. L’instruction suivante place les composantes de *v* demandées et les places respectivement dans *v2.x* et *v2.y* :\n\n```\nvec2 v2 = vec2(v.z, v.x);\n```\n\nVoyons à présent comment convertir un **vec2** en **vec3**, nous verrons cette voici qu’à l’inverse d’une conversion **vec3** -\\\u003e **vec2**, il y a un manque de données. À priori, on pourrait se dire qu’une conversion comme ceci est correct :\n\n```\nvec2 v2 = ...;\nvec3 v3 = vec3(v2);\n```\n\nMais…\n\n```\nimpossible de compiler le shader 'test.vert' :\n(5) : error C1033: cast not allowed\n(5) : error C1056: invalid initialization\n```\n\nEn effet, c’est une instruction non valide, refusée par OpenGL à la compilation du shader.\n\nCe que vous avez sous les yeux est le résultat d’une compilation d’un shader ayant échouée, c’est le message d’erreur que nous a retourné OpenGL. La première phrase est de moi, je l’ai placée dans le code source C du programme. Les deux autres lignes contiennent un message mais avant cela, entre parenthèses, la ligne de code de notre shader qui a été refusée (5). C’est très important, retenez cela ;)\n\nAfin de pouvoir effectuer un cast sans encombre, il va falloir donner à notre shader ce qu’il attend : la composante manquante. (en l’occurrence il s’agit de la composante z) Il nous faut donc la spécifier explicitement, comme dans l’exemple qui suit :\n\n```\nvec2 v2 = ...;\nvec3 v3 = vec3(v2, 0.0);\n```\n\nCe code est équivalent à :\n\n```\nvec2 v2 = ...;\nvec3 v3;\n \nv3.x = v2.x;\nv3.y = v2.y;\nv3.z = 0.0;\n```\n\nSi vous le souhaitez, vous pouvez aussi faire ceci :\n\n```\nvec2 v2 = ...;\nvec3 v3 = vec3(0.0, v2);\n```\n\nMais ce code n’aura pas le même effet que le précédent, voici ce que l’on obtient en l’appelant :\n\n```\nvec2 v2 = ...;\nvec3 v3;\n \nv3.x = 0.0;\nv3.y = v2.x;\nv3.z = v2.y;\n```\n\n### Initialiser le contenu d’un vecteur\n\nMaintenant que vous savez comment fonctionne l’opérateur de cast, vous devriez comprendre facilement ce que fait ce bout de code :\n\n```\nvec3 v = vec3(0.0, 1.0, 0.5);\n```\n\nAllez cherchez un peu :-°\n\n…\n\nAlors vous trouvez ? :D\n\n…\n\nBon, je sens que vous avez fait bouillonner votre cerveau, c’est l’heure de votre récompense :\n\n```\nvec3 v;\n \nv.x = 0.0;\nv.y = 1.0;\nv.z = 0.5;\n```\n\nEt voilà l’travail :)\n\nIl est également possible d’initialiser toutes les composantes d’un vecteur d’un seul coup :\n\n```\nvec3 v = vec3(0.0);\n```\n\nCe code place toutes les composantes du vecteur *v* à 0.\n\n### Et les matrices… ?\n\nVous savez quoi ? On peut mettre des vecteurs dans des matrices :D Si si je vous assure :) Ainsi, ce code est tout à fait correct :\n\n```\nvec4 a, b, c, d;\n \na = vec4(1.0, 0.0, 0.0, 0.0);\nb = vec4(0.0, 1.0, 0.0, 0.0);\nc = vec4(0.0, 0.0, 1.0, 0.0);\nd = vec4(0.0, 0.0, 0.0, 1.0);\n \nmat4 m = mat4(a, b, c, d);\n```\n\nCe code a pour effet de charger dans *m* la matrice d’identité. Bien évidemment, il est inutilement lourd à cause de la création de 4 vecteurs, il n’est là qu’à titre indicatif ;)\n\nIl est important de noter ici que chaque vecteur représente une ligne de la matrice, c’est-à-dire que le premier vecteur ira se loger de *m*1,1 à *m*1,4\n\nTout comme pour les vecteurs, il est possible d’initialiser une matrice ainsi :\n\n```\nmat3 m = mat3(1.0);\n```\n\nToutefois il y a une différence ici avec les vecteurs. L’initialisation d’une matrice comme nous l’avons fait place toutes les composantes de **la diagonale** de la matrice à 1, et toutes les autres à 0. Avec 1, la matrice chargée est celle d’identité, avec une autre valeur, la matrice est une matrice de mise à l’échelle de la valeur envoyée.\n\n## Les commentaires\n\nTout comme en C, il est possible d’intégrer des commentaires en GLSL. Ils ont la même forme ainsi que le même comportement :\n\n```\n/* commentaire sur\n   plusieurs lignes */\n```\n\nLe GLSL accepte également les commentaires commençant par // comme en C99 :\n\n```\n// ceci est un commentaire sur une seule ligne\n```\n\n## Les tableaux\n\nEncore une similitude avec le C : les tableaux. Ils se définissent et s’utilisent comme en C. Il est interdit de fournir une variable comme taille de tableau lors de sa déclaration, seules les constantes sont acceptées :\n\n```\nfloat tab[3] = {0.0, 0.5, 1.0};\n```\n\nEn revanche l’accès aux valeurs contenues dans un tableau est des plus simples, cette fois-ci les variables sont bien sûr acceptées :\n\n```\nint case = 2;\nfloat val = tab[case]; // val = 1\n```\n\nLes tableaux en GLSL commencent également à 0 : tab\\[0\\]\n\nVous souvenez-vous de la manière dont on accède à une composante d’un vecteur ? Nous faisions comme ceci :\n\n```\nvec2 v = vec2(1.0, 0.0);\nfloat vx = v.x;\n```\n\nEt bien sachez qu’il est possible de considérer un vecteur comme un tableau ! Ainsi, ce code est strictement identique :\n\n```\nvec2 v = vec2(1.0, 0.0);\nfloat vx = v[0];\n```\n\nNotez que l’on préfèrera la première méthode car elle est beaucoup plus légère et beaucoup plus lisible ;) .\n\nEt pour les matrices ? Il existe aussi un tour de passe-passe ?\n\n### Les tableaux à deux dimensions\n\nRien qu’à la vue de ce titre, j’imagine que vous prévoyez déjà ce que je vais vous dire :D Allons-y franchement : les matrices sont des tableaux à deux dimensions !\n\nSi vous connaîssez les tableaux à deux dimensions en C, alors vous ne devriez pas avoir de problèmes. Allez, un exemple de code vaudra sûrement mieux qu’un long discours :\n\n```\nmat4 m = mat4(\n    1.0, 0.0, 0.0, 0.0,\n    0.0, 1.0, 0.0, 0.0,\n    0.0, 5.0, 1.0, 0.0,\n    0.0, 0.0, 0.0, 1.0);\n \nfloat var = m[2][1];\n \n// ici, var = 5.0\n```\n\nDans *m\\[i\\]\\[j\\]* on a :\n\n- ***i*** : la ligne (position en hauteur)\n    \n- ***j*** : la colonne (position en largeur)\n    \n\nEt voilà, rien de très compliqué, encore faut-il le savoir ;) .\n\nEt comment on crée un tableau à deux dimensions ?\n\nComme en C :\n\n```\nfloat tab[3][3] =\n{\n    {0.0, 0.0, 0.0},\n    {0.0, 0.0, 2.0},\n    {0.0, 0.0, 0.0}\n};\n \nfloat var = tab[1][2];\n \n// var = 2.0\n```\n\nNotez qu’il est impératif de définir la taille d’un tableau lors de sa déclaration en GLSL, contrairement au langage C qui est capable de déduire tout seul de la taille d’un tableau rien que par son contenu. Cette règle s’applique aussi bien aux tableaux 1D que 2D.\n\n* * *\n\n# Un vertex shader\n\nMaintenant que vous avez acquis les bases du langage, ça vous dirait de programmer votre premier vertex shader ? Oui ? Pas de problème, allons-y :p\n\n## Un vertex shader : ça fait quoi ?\n\nUn shader est donc un code source qui, une fois compilé, est exécutable par la carte graphique. Quand vous écrivez ce code source en OpenGL :\n\n```\nglBegin(GL_TRIANGLES);\n    glColor3f(1.0, 0.0, 0.0); glVertex2f(0.9, -0.9);\n    glColor3f(0.0, 1.0, 0.0); glVertex2f(-0.9, -0.9);\n    glColor3f(0.0, 0.0, 1.0); glVertex2f(0.0, 0.9);\nglEnd();\n```\n\nvous envoyez exactement 3 sommets (ou vertices, nom au choix) à la carte graphique. Avant d’être affichés à l’écran ils sont tout d’abord traités; ils subissent de nombreuses transformations, puis les données sont interpolées afin de donner naissance à un triangle plein.\n\nEt qu’est-ce qu’il fait le vertex shader là dedans ?\n\nLe vertex shader effectue entre autres la première opération : il fait subir des transformations (matricielles) aux sommets. Il vous permet en fait de toucher à toutes les composantes (coordonnées de texture, normale, couleur, etc…) d’un sommet et de les modifier à votre guise :) Nous allons voir qu’il y a des règles pour le codage d’un vertex shader, mais passé celles-ci vous êtes libres de faire tout ce dont vous avez envie.\n\nAvec l’exemple ci-dessus, le vertex shader sera invoqué exactement 3 fois, ce qui est très peu. Le nombre d’appel au vertex shader dépend donc du nombre de sommet que comporte votre scène, plus elle en comporte, et plus il y aura d’appels au vertex shader, et donc plus le traitement sera lourd et consommateur de ressources.\n\n**Il est important de savoir :** qu’un vertex shader activé sera actif sur tous les futurs sommets qui seront envoyés à la carte graphique, jusqu’à ce que les shaders de sommet soient désactivés. Quand vous activez un vertex shader, il vient remplacer une partie du FFP, donc tous les sommets envoyés après l’activation du shader seront traités par le vertex shader que vous avez activé.\n\nÇa a l’air d’être un vrai chantier…\n\nC’est une réflexion normale :-° Vous vous apercevrez vite que ça n’a rien de sorcier et que le langage a été bien pensé, ce n’est pas si difficile que ça en a l’air rassurez-vous, et puis, je suis là pour vous guider :D\n\n## Quelques règles de programmation\n\nTout comme en C, la programmation d’un shader ne se fait pas à “l’arrache”, il y a des règles à respecter.\n\n### La fonction main\n\nEn GLSL une fonction principale appelée *main()* est nécessaire. Cette dernière se différencie des habituelles formes du *main()* du langage C par sa valeur de retour et ses arguments : la fonction main en GLSL ne renvoie rien et ne prend aucun paramètre.\n\nNous l’invoquerons comme ceci :\n\n```\nvoid main(void)\n\n{\n\n    // notre code ici\n\n}\n```\n\nComme en C, la fonction main représente la première fonction qui sera exécutée.\n\nContrairement au C, les codes sources GLSL ne réclament pas de retour chariot en fin de fichier.\n\nC’est quoi un retour chariot ?\n\nC’est un retour à la ligne (entrée) tout à la fin du fichier.\n\nEnfin, une dernière chose à retenir : un vertex shader doit **toujours** placer une valeur dans la variable de sortie gl_Position.\n\nHein ? C’est quoi ce truc ?\n\n## Les variables d’entrée/sortie\n\nIl est ici important de se rappeler ce qu’est en gros un vertex shader : son objectif est d’agir sur le traitement de chaque vertex qu’on lui enverra. Nous allons à présent voir quel est le rôle précis d’un vertex shader, et ce qu’il permet de faire.\n\n### Les variables d’entrée\n\nLes variables d’entrée sont généralement destinées à être lues puis traitées. Lorsque vous programmerez un vertex shader (et uniquement un vertex shader), OpenGL aura créé pour vous quelques variables utiles, dont voici justement la liste :\n\n| Nom de la variable GLSL | Type | Fonction OpenGL appropriée | Description |\n| --- | --- | --- | --- |\n| gl_Vertex | **vec4** | *glVertex*()* | Position du sommet |\n| gl_Color | **vec4** | *glColor*()* | Couleur du sommet |\n| gl_Normal | **vec3** | *glNormal*()* | Normale du sommet. |\n| gl_MultiTexCoord*n* | **vec4** | *glMultiTexCoord*()\\* ou *glTexCoord*()* | Coordonnées de l’unité de texture *n* |\n| gl_SecondaryColor | **vec4** | *glSecondaryColor*()* | Couleur secondaire du sommet |\n| gl_FogCoord | **float** | *glFogCoord*()* | Coordonnées de brouillard |\n\nJ’espère qu’à la vue de cette liste vous y voyez déjà plus clair sur la tâche que remplie un vertex shader. Mais je pense que vous y verrez d’autant plus clair lorsque vous aurez vu la liste des variables de sortie ;)\n\n### Les variables de sortie\n\nAprès avoir traité les variables d’entrées à notre guise, nous pourrons écrire dans les variables de sortie. Les variables de sortie d’un vertex shader (uniquement) représentent la position finale du sommet (position écran, ou presque) sa couleur finale, etc… Voici la liste des variables de sortie disponibles :\n\n| Nom de la variable GLSL | Type | Description |\n| --- | --- | --- |\n| gl_Position | **vec4** | Position en coordonnées écran du sommet |\n| gl_FrontColor | **vec4** | Couleur du côté “avant” de la face à laquelle\u003cbr\u003eest rattaché le sommet |\n| gl_BackColor | **vec4** | Couleur du côté “arrière” de la face à laquelle\u003cbr\u003eest rattaché le sommet |\n| gl_FrontSecondaryColor | **vec4** | Couleur secondaire du côté “avant” de la face\u003cbr\u003eà laquelle est rattaché le sommet |\n| gl_BackSecondaryColor | **vec4** | Couleur secondaire du côté “arrière” de la face\u003cbr\u003eà laquelle est rattaché le sommet |\n| gl_TexCoord\\[n\\] | tableau de **vec4** | Coordonnées de l’unité de texture *n* |\n| gl_FogFragCoord | **float** | Coordonnée de fog |\n| gl_PointSize | **float** | Taille du point du sommet |\n| gl_ClipVertex | **vec4** | Vecteur utilisé pour les plans de clipping |\n\nOn y voit tout de suite plus clair n’est-ce pas ? :D Vous pouvez déjà vous faire une petite idée de la fonction d’un vertex shader à la vue de ces deux tableaux.\n\nVous vous souvenez de la règle de base pour un vertex shader ? C’est que la variable gl_Positiondoit être affectée à une valeur à la fin du vertex shader, sinon le vertex shader est invalide. Nous pouvons donc construire un vertex shader de base, tout simple, comme ceci :\n\n```\nvoid main(void)\n\n{\n\n    gl_Position = gl_Vertex;\n\n}\n```\n\nCe vertex shader est tout à fait correct, mais sa fonctionnalité laisse à désirer :-° Je vous propose tout de même de l’étudier, afin de mettre les choses au clair pour la gestion des vertex shaders.\n\nSi vous appliquez ce vertex shader à vos rendus, les données envoyées à la fonction *glVertex*()\\* seront les coordonnées **écran** de vos sommets, même si vous utilisez une transformation quelconque (*glTranslate*()\\* et compagnie) **elle ne sera pas appliquée au sommet** ! Idem pour la matrice de projection, elle n’affectera pas la position que vous aurez envoyé à la fonction *glVertex*()*.\n\nC’est un peu débile non ?\n\nNon ! C’est ce qui fait la flexibilité des shaders, c’est vous qui décidez exactement comment vos sommets seront rendus, vous êtes le maître absolu de votre machine :)\n\nEt alors comment on fait pour que notre vertex soit au bon endroit en subissant les transformations de nos matrices modelview et de projection ?\n\n## Les matrices, quelques variables d’entrée supplémentaires\n\nSi vous avez à peu près compris ce que sont les variables d’entrée, vous devriez sauter au plafond à la vue de ce titre :D\n\nAh bon ? Moi ça ne fait que m’embrouiller encore plus… Qu’est-ce qu’elles peuvent nous faire ces matrices ?\n\nChers Zér0s, vous devriez savoir comment fonctionne le rendu d’un sommet et quelles sont les transformations qui lui sont appliquées, sinon c’est que vous n’êtes pas totalement prêts à lire ce tutoriel. Bien sûr je pourrais vous faire gober des principes tout cuits, mais ça ne serait pas très pédagogique en plus du fait que vous risqueriez d’être un peu bloqué par la suite. Sur ce, je vous renvoie sur [cet excellent lien](http://jeux.developpez.com/faq/3d/?page=definitions#DEFINITIONS_3d_to_2d) qui vous expliquera comment on passe des coordonnées 3D aux coordonnées écran.\n\n### Vous avez dit “variable d’entrée” ?\n\nParfaitement :) Ces variables ne sont rien d’autre que des matrices, et ô combien utiles. Je vous propose de voir sans plus tarder la listes des matrices disponibles au sein d’un vertex shader uniquement :\n\n| Nom de la variable | Type | Description |\n| --- | --- | --- |\n| gl_ModelViewMatrix | **mat4** | C’est la matrice de modélisation/visualisation,\u003cbr\u003ecelle que l’on manipule avec GL_MODELVIEW en C |\n| gl_ModelViewMatrixInverse | **mat4** | C’est l’inverse de la matrice gl_ModelViewMatrix |\n| gl_ModelViewMatrixTranspose | **mat4** | C’est la transposée de la matrice gl_ModelViewMatrix |\n| gl_ModelViewMatrixInverseTranspose | **mat4** | C’est la transposée de la matrice gl_ModelViewMatrixInverse |\n| \\-\\-\\- | \\-\\-\\- | \\-\\-\\- |\n| gl_ProjectionMatrix | **mat4** | C’est la matrice de projection GL_PROJECTION, maniable\u003cbr\u003eentre autres avec gluPerspective() dans le code C |\n| gl_ProjectionMatrixInverse | **mat4** | C’est l’inverse de la matrice gl_ProjectionMatrix |\n| gl_ProjectionMatrixTranspose | **mat4** | C’est la transposée de la matrice gl_ProjectionMatrix |\n| gl_ProjectionMatrixInverseTranspose | **mat4** | C’est la transposée de la matrice gl_ProjectionMatrixInverse |\n| \\-\\-\\- | \\-\\-\\- | \\-\\-\\- |\n| gl_ModelViewProjectionMatrix | **mat4** | C’est la matrice gl_ModelViewMatrix multipliée\u003cbr\u003epar la matrice gl_ProjectionMatrix |\n| gl_ModelViewProjectionMatrixInverse | **mat4** | C’est l’inverse de la matrice gl_ModelViewProjectionMatrix |\n| gl_ModelViewProjectionMatrixTranspose | **mat4** | C’est la transposée de la matrice gl_ModelViewProjectionMatrix |\n| gl_ModelViewProjectionMatrixInverseTranspose | **mat4** | C’est la transposée de la matrice gl_ModelViewProjectionMatrixInverse |\n| \\-\\-\\- | \\-\\-\\- | \\-\\-\\- |\n| gl_TextureMatrix\\[n\\] | tableau de **mat4** | C’est la matrice de l’unité de texturage *n*,\u003cbr\u003emaniable en C avec GL_TEXTURE |\n| gl_TextureMatrixInverse\\[n\\] | tableau de **mat4** | C’est l’inverse de la matrice gl_TextureMatrix\\[n\\] |\n| gl_TextureMatrixTranspose\\[n\\] | tableau de **mat4** | C’est la transposée de la matrice gl_TextureMatrix\\[n\\] |\n| gl_TextureMatrixInverseTranspose\\[n\\] | tableau de **mat4** | C’est la transposée de la matrice gl_TextureMatrixInverse\\[n\\] |\n| \\-\\-\\- | \\-\\-\\- | \\-\\-\\- |\n| gl_NormalMatrix | **mat3** | C’est la transposée inverse de la partie 3*3 de la matrice gl_ModelViewMatrix\u003cbr\u003e(matrice généralement appliquée à la variable gl_Normal\u003cbr\u003epour les transformations de normales) |\n\nPffiouuu, ça fait du monde hein ? :D Allez, que diriez-vous d’un petit…\n\n### Exercice\n\nFini d’rire ! :diable:\n\nBien, voici le vertex shader que nous avons précédemment écrit :\n\n```\nvoid main(void)\n\n{\n\n    gl_Position = gl_Vertex;\n\n}\n```\n\nJ’aimerai que vous le modifiez afin que la position finale du sommet (gl_Position) soit affectée par la matrice de modélisation **et** la matrice de projection, comme ça notre sommet aura la bonne position à l’écran si par exemple nous avons configuré une projection 3D :) Un indice ? Rappelez-vous la première partie du tutoriel, à l’endroit où je parle des opérateurs, et plus précisément de leur surcharge ;)\n\nAllez-y !\n\n…\n\n### Correction\n\nVoici la réponse :\n\n```\nvoid main(void)\n\n{\n\n    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;\n\n}\n```\n\nAllez, avouez que c’était pas trop difficile :-°\n\nVoilà, vous savez à présent théoriquement comment faire un vertex shader, évidemment celui-ci est extrêmement simple et n’a que peu d’intérêt, mais vous pouvez déjà essayer de vous amuser à modifier les variables de sortie pour voir le résultat que cela donnera et aussi pour vous familiariser avec le langage GLSL ;)\n\n* * *\n\n## Un pixel shader\n\nNous avons vu en gros quel était la tâche d’un vertex shader, son rôle au sein du rendu 3D. Que diriez-vous de savoir ce que fait un pixel shader à présent ? Vous vous demandez probablement à quoi ils peuvent bien servir, mais croyez-moi : ils servent énormément ;)\n\n## Traiter le rendu d’un pixel ?\n\nUn pixel shader agit au niveau du rendu du pixel à l’écran. C’est petit, très petit, et pourtant chaque pixel est traité indépendamment et nécessite des calculs, parfois nombreux, pour obtenir sa couleur exacte à l’écran.\n\nLe code source d’un pixel shader peut être plus ou moins gros, mais une chose est sûre : plus il est conséquent et demande beaucoup de calculs et plus les performances chutent vite. Effectivement, alors que les vertex shaders agissent au niveau de chaque sommet, si vous n’affichez qu’un triangle, le code de votre vertex shader ne sera exécuté qu’une seule fois. Les pixel shaders quant à eux sont exécutés autant de fois qu’il y a de pixels dans ce triangle à l’écran ! Si votre triangle rempli tout l’écran et que votre fenêtre de rendu fait 1024\\*768 pixels, alors votre pixel shader sera appelé 1024 \\* 768 = 786432 fois ! C’est beaucoup, très beaucoup ! :D\n\n### Une limite en puissance assez restreinte ?\n\nEt pourtant non ! Il est aujourd’hui possible de programmer des pixels shaders très complexes sur des résolutions d’écran de 1600*1024 sans que le frame rate en soit très affecté. Prenez un exemple simple : les jeux vidéo. Les jeux vidéo récents utilisent énormément les shaders, vertex et pixel. Les joueurs s’achètent des écrans toujours plus larges et arrivent tout de même à jouer à des jeux gourmands tels que F.E.A.R ou SplinterCell DA en haute résolution et sans lags (saccades).\n\n### Pourquoi ?\n\nPourquoi, avec des résolutions énormes, des shaders complexes et des scènes rendues en plusieurs passes les jeux ne mettent pas à genoux les PC modernes ? (bien que certains se plaignent de jouer à 40 FPS :-° ) Comment est-il possible de traiter plusieurs millions, et parfois même milliard(s), d’appels à un pixel shader par seconde ? La réponse est relativement simple : les pixels shaders sont des shaders, et par conséquent ils sont traités par la **carte graphique**.\n\nOuah je suis super impressionné… En plus je le savais déjà.\n\nCroyez-moi, il y a de quoi être impressionné, si vous demandiez à votre processeur de modifier une image pixel par pixel (vous comprendrez mieux cela lorsque nous parlerons des textures, plus loin dans le tutoriel), cela prendrait un temps énorme. Un exemple simple : les logiciels de dessin 2D (The GIMP, Photoshop, …) sont très lourds et parfois aussi très lents à rendre un effet sur vos images, essayez pour voir de regarder quelle est la consommation CPU rien que quand vous dessinez un trait avec un effet de flou ;)\n\nLes cartes graphiques sont **conçues pour** traiter des pixels, enfin tout du moins les cartes graphiques un minimum récentes. Si vous avez une GeForce 6 ou supérieur, ou une Radeon 9800pro ou supérieur, vous pouvez êtres sûrs que les shaders de sommet tout comme de pixel sont parfaitement supportés ;)\n\n## Bon, qu’est-ce qu’on attend pour programmer ça ?\n\nQue vous soyez psychologiquement prêts :D\n\n### Le code source de base\n\nTout comme le vertex shader, le pixel shader requiert une fonction main. En revanche contrairement aux vertex shaders, les pixel shaders GLSL n’exigent aucun code source de base au sein de la fonction main, ce qui veut dire qu’un pixel shader écrit comme suit :\n\n```\nvoid main(void)\n\n{\n\n    // rien\n\n}\n```\n\nest tout à fait acceptable et compilera sans broncher. Par contre, son effet est plus que maigre : il ne fait **rien**. Et ici, rien signifie rien de rien, autrement dit, rien ne s’affichera à l’écran.\n\nAvant de pouvoir faire afficher quelque chose à notre pixel shader, il est important de connaître ses variables d’entrée ainsi que celles de sortie, car il en possède, tout comme les vertex shaders.\n\n### Les variables d’entrée\n\nComme pour les variables d’entrée de nos vertex shaders, un joli tableau fera l’affaire. Il n’est bien sûr pas important que vous le reteniez par coeur pour l’instant, mais au moins, le jour où vous voudrez une info, vous n’aurez qu’à venir ici ;) :\n\n| Nom de la variable GLSL | Type | Description |\n| --- | --- | --- |\n| gl_Color | **vec4** | Couleur du pixel |\n| gl_FragCoord | **vec2** | Coordonnées écran du pixel |\n| gl_SecondaryColor | **bool** | Couleur secondaire |\n| gl_TexCoord\\[n\\] | tableau de **vec4** | Coordonnées de l’unité de texturage *n* |\n| gl_FogFragCoord | **float** | Coordonnée de fog |\n\nComme vous le voyez, certaines variables correspondent à des variables de sortie du vertex shader. Cela prouve bien que les vertex et les pixel shaders GLSL sont très liés entre eux.\n\nNous avons maintenant une couleur récupérable dans la variable gl\\_Color, chouette, on va pouvoir attribuer une couleur à notre pixel. Mais… il nous manque quelque chose… Comment dire à GLSL qu’on souhaite voir notre pixel avec la couleur contenue dans gl\\_Color ? Hé bien l’expérience des vertex shaders devrait vous le dire, il nous faut une variable de sortie à laquelle attribuer cette couleur :) .\n\n### Les variables de sortie\n\nC’est bon, c’est fini les gros tableaux de la mort ?\n\nEt non, pourtant avec un simple pixel shader on peut se demander ce qu’il peut bien faire à part affecter la couleur finale du pixel. Pourtant, il existe deux autres variables de sortie que celle qui permet de renvoyer la couleur du pixel :\n\n| Nom de la variable | Type | Description |\n| --- | --- | --- |\n| gl_FragColor | **vec4** | Couleur finale du pixel |\n| gl_FragDepth | **float** | Profondeur du pixel dans le depth buffer |\n| gl_FragData\\[n\\] | tableau de **vec4** | En rapport avec *glDrawBuffers()* |\n\nIl n’existe malheureusement encore aucune variable permettant de modifier la position finale du pixel à l’écran.\n\nL’intérêt général des pixel shaders est plutôt mince non ?\n\nPas du tout ! Bon évidemment pour l’instant il est normal que vous soyez sceptiques, mais vous découvrirez au fur et à mesure l’utilité des pixel shaders, et à la fin vous verrez ; on ne s’en passe plus ;)\n\n### Programmer un simple pixel shader\n\nVous vous souvenez de la façon dont on s’y prend, dans les vertex shaders, pour affecter la variable de sortie gl_Position afin que notre vertex soit positionné au bon endroit ? Et bien le principe est le même dans les pixel shaders lorsqu’on veut affecter la couleur du pixel sortant par la couleur d’entrée de base. Contrairement au vertex shader où il faut appliquer des transformations matricielle pour obtenir la position finale, ici rien de particulier n’est à faire, il suffit de transmettre directement la couleur, comme ceci :\n\n```\nvoid main(void)\n\n{\n\n    gl_FragColor = gl_Color; // c'est aussi simple que cela\n\n}\n```\n\nCe pixel shader n’est pas très évolué et n’a pour effet que d’affecter à la couleur finale du pixel la couleur interpolée des trois sommets formant le triangle auquel appartient ce pixel. (phrase compliquée je vous l’accorde :-° ) Il n’y a aucun traitement des textures ou autres attributs du vertex, seules les données de couleur (*glColor*()*) sont traitées.\n\n**Attention** : Comme je l’ai déjà dit, le vertex shader est très lié au pixel shader, ainsi donc, si vous n’affectez pas la variable de sortie gl\\_FrontColor de votre vertex shader, la variable d’entrée gl\\_Color du pixel shader ne contiendra aucune valeur ! La valeur par défaut des variables est 0 généralement, vous aurez donc un écran noir si vous ne faites pas un vertex shader conçu comme ceci :\n\n```\nvoid main(void)\n\n{\n\n    gl_FrontColor = gl_Color;\n\n    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;\n\n}\n```\n\nEt voilà, c’est déjà enfin la fin de ce chapitre, peut-être un peu rebutant, mais très important ;) .\n\nMaintenant la compréhension de la suite du tutoriel vous sera plus aisée, et nous pourrons donc avancer plus vite dans l’apprentissage du langage, et c’est tant mieux, parce que le GLSL c’est bien joli, mais notre but de base c’est d’apprendre des techniques de rendu pour réaliser de chouettes effets graphiques :)\n\n*Les tableaux énumératifs de variables de ce chapitre sont inspirés du livre [OpenGL 2.0 Guide Officiel](http://www.amazon.fr/Open-GL-2-0-Guide-officiel/dp/2744020869), mais certains sont également disponibles dans les [spécifications du langage](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf).*\n\n* * *\n\n# Notions supplémentaires\n\nAu terme de ce chapitre, vous serez fin prêts pour apprendre toutes les fonctionnalités avancées que propose le GLSL, et cela vous permettra de trouver une réelle utilité aux shaders.\n\nNous allons tout d’abord passer en revue toutes les notions du langage GLSL qui sont communes à celles du C, puis dans un second temps je vais vous montrer les quelques différences entre les deux langages, afin de mettre les choses au clair. Ensuite, nous apprendrons à créer des fonctions, mais surtout à les surcharger. Vous ne connaissez peut-être pas la notion de surcharge des fonctions, il est donc important que vous l’appreniez, vous verrez que cela ressemble à la surcharge des opérateurs. Puis je finirai par vous présenter quelques fonctions natives du langage GLSL bien pratiques, qui sont très souvent utilisées.\n\n## Notions communes et incompatibilités avec le C\n\nBien, commençons. Je voudrais tout d’abord vous présenter tout ce qui existe dans le langage GLSL qui se rapporte au C, afin de gagner du temps.\n\nLe GLSL n’est pas un langage aussi rigoureux que le C, je le considérerais plutôt comme un langage “jouet”, il suffit d’enchaîner quelques instructions dans un `main()` et le tour est joué. À partir du moment où votre shader fonctionne correctement, il y a peu de chances que vous ayez à le réviser pour une raison autre que sa performance.\n\n## Notions communes\n\nJe vous propose de commencer par les instructions de contrôle.\n\n### Les instructions if…else\n\nEn C, il est possible de créer une condition de la façon suivante :\n\n```\nif(condition)\n{\n    instructions;\n}\nelse\n{\n    autres instructions;\n}\n```\n\nEh bien sachez que ce code fonctionne aussi en GLSL. Par exemple, ceci est tout à fait correct :\n\n```\nint a, b;\n \n...\n \nif(a == b)\n{\n    instructions;\n}\nelse\n{\n    autres instructions;\n}\n```\n\nL’omission des accolades est également autorisée si les instructions se résument à une seule instruction :\n\n```\nint a, b;\n \n...\n \nif(a == b)\n    instruction;\nelse\n    autre instruction;\n```\n\nLes opérateurs de comparaison sont les mêmes qu’en C.\n\n### Instructions break et continue\n\nIdem qu’en C là encore, les instructions **break** et **continue** existent et ont le même effet qu’en langage C ; à savoir :\n\n- **break** : sortir de la boucle d’instructions courante ;\n    \n- **continue** : poursuivre le déroulement de la boucle d’instructions à partir du “haut” du bloc.\n    \n\n### La boucle do…while\n\nComme en C, le mot clé **do** est suivi d’un bloc d’instructions, puis d’une condition entre parenthèses après un **while**, comme dans l’exemple ci-dessous :\n\n```\ndo\n{\n    instructions;\n}\nwhile(condition);\n```\n\nCe code veut dire :\n\n```\nexécuter\n{\n    tout ceci\n}\ntant que (condition) est vraie\n```\n\nNe pas oublier le point-virgule à la fin du while. Les accolades peuvent là aussi êtres omisent si il n’y a qu’une seule instruction dans le bloc.\n\n### La boucle while\n\nS’utilise de la même façon qu’en C, et a le même effet, à savoir ; exécuter un bloc d’instructions en boucle tant que la condition contenue entre les parenthèses suivants le mot clé **while** est vraie, avec une vérification de celle-ci avant le premier lancement de la boucle (contrairement à do…while).\n\n```\nwhile(condition)\n{\n    instructions;\n}\n```\n\nComme d’habitude, les accolades peuvent êtres enlevées si il n’y a qu’une instruction à exécuter.\n\n### La boucle for\n\nCelle-ci permet, comme en C, d’intégrer facilement un compteur à une boucle. Voici un pseudo-code pour présenter l’instruction **for** :\n\n```\nfor( instructions1 ; conditions ; instructions2 )\n{\n    autres instructions;\n}\n```\n\nSon effet est le même qu’en C :\n\n1.  exécuter *instructions1* ;\n    \n2.  tant que *conditions* est vrai, exécuter :\n    \n    1.  *autre instructions* ;\n        \n    2.  *instructions2*.\n        \n\n### Les structures\n\nLes structures sont également possibles en GLSL. Elles se définissent bien sûr de la même façon, en utilisant le mot clé **struct** :\n\n```\nstruct MaStructure\n{\n    int a, b;\n};\n```\n\nVous pouvez bien sûr créer toutes sortes de variables dans votre structure (des vecteurs, des matrices, etc…). Une structure se crée et s’utilise ainsi :\n\n```\nMaStructure str; // declaration\n \nstr.a = 0; // acces aux variables\nstr.b = str.a;\n```\n\nVous noterez qu’il n’est pas nécessaire de préfixer la déclaration des variables de type structure avec le mot clé `struct`. Eh oui, le mot clé **typedef** n’existe pas en GLSL, plus besoin de vous embêter avec.\n\n### Le préprocesseur\n\nIl fonctionne comme en langage C : toutes les commandes de préprocesseur doivent être préfixées par « # ». Parmi ces commandes, on retrouvera entre autre le fameux **\"#define\"**, qui permet de définir des macros, **\"#undef\"** qui les “dé-défini”, mais aussi les instructions **\"#if\"**, **\"#ifdef\"**, **\"#ifndef\"**, **\"#else\"**, **\"#elif\"** et **\"#endif\"**, qui ont toutes le même effet qu’en C.\n\nPar exemple, vous pourriez changer l’intégrité de votre shader juste avec une macro, comme ceci :\n\n```\n#ifdef SUPERSHADER\n \n// code source du super shader\n \n#else\n \n// code source d'un shader un peu moins bien\n \n#endif\n```\n\nAinsi, si SUPERSHADER est définie, seules les instructions contenues entre **\"#ifdef\"** et **\"#else\"** seront compilées, sinon ça sera celles qui sont entre **\"#else\"** et **\"#endif\"**.\n\n## Incompatibilités et différences\n\n### Les déclarations de variables\n\nContrairement au C89 qui exige que les variables soient définies au début de votre code, le GLSL autorise quant à lui la création de variables n’importe où dans votre shader (autorisé également en C99). Avec cette liberté de création de variables, il est possible de créer une variable dans une instruction for, comme ceci par exemple :\n\n```\nfor(int i = 0; i \u003c 5; i++)\n{\n    ...\n}\n```\n\n### Les pointeurs et l’instruction switch\n\nLes pointeurs de même que l’instruction switch n’existent pas en GLSL.\n\n* * *\n\n## Créer et surcharger des fonctions\n\n## Déclarer une simple fonction\n\nTout est quasiment identique au C, mais je préfère tout de même mettre les choses au clair. Comme en C, une fonction possède :\n\n- une valeur de retour d’un certain type ;\n    \n- un nom ;\n    \n- des paramètres ;\n    \n- un contenu, entre accolades {}.\n    \n\nLa déclaration d’une fonction se fait comme en C, on commence par mettre son type de retour, son nom, puis ses paramètres entre parenthèses. Pour finir, on ouvre une accolade puis on place le contenu de notre fonction à l’intérieur :\n\n```\nvoid my_func(void)\n{\n    // contenu\n}\n```\n\nVous voyez ici l’emploi du type **void**, qui signifie comme en C : vide. Donc notre fonction ne retourne rien et ne prend aucun paramètre. De même qu’en C, la notion de prototype existe. Déclarez vos prototypes tout en haut du code source, ainsi vous n’aurez aucun problème :\n\n```\nfloat my_func(void);\n\nvoid main(void)\n{\n    ...\n}\n\nfloat my_func(void)\n{\n    ...\n}\n```\n\nNotez que d’une façon générale, si votre fonction n’a pas été déclarée, vous ne pourrez pas l’utiliser. Ainsi, soit vous déclarez son prototype tout en haut de votre code et vous vous épargnez tout problème, soit vous triez vos fonctions de façon sélective afin que les dépendances soient satisfaites.\n\n### Paramètres et valeur de retour\n\nNous pouvons également écrire une fonction qui prend un ou plusieurs paramètres, et renvoie une variable. Pour renvoyer une variable, vous devez mettre son type avant le nom de la fonction. Vous pouvez renvoyer n’importe quel type de variable en GLSL :\n\n```\nvec3 my_func(void)\n{\n    vec3 result;\n    \n    ... // calculs horriblement complexes\n\n    return result; // on renvoie le resultat\n}\n```\n\nNotez ici le mot clé **return**, il existe également en GLSL et a le même effet qu’en C : renvoyer une valeur de retour en terminant l’exécution de la fonction.\n\nPour donner un paramètre à une fonction, il suffit de rajouter son type suivi du nom de la variable qui contiendra la valeur du paramètre, entre les parenthèses qui suivent le nom de la fonction, comme ceci :\n\n```\nvec3 my_func(vec3 v)\n{\n    vec3 result;\n\n    result = v * 2; // calculs horriblement complexes\n\n    return result; // on renvoie le resultat\n}\n```\n\nComme en C, on accède à un paramètre en écrivant son nom. Ici, la super fonction que j’ai écrit relève réellement du génie : elle renvoie un vecteur qui est celui envoyé en paramètre multiplié par 2.\n\n## La surcharge des fonctions\n\n### Notion de surcharge\n\nNous avons déjà vu la surcharge des opérateurs dans le précédent chapitre. La notion de surcharge existe également pour les fonctions. Surcharger une fonction signifie, en gros, qu’on va attribuer un seul nom de fonction à plusieurs fonctions.\n\nPar exemple, supposez que vous vouliez écrire une fonction qui renvoie le [produit scalaire](http://www.siteduzero.com/tuto-3-18391-1-les-vecteurs.html#ss_part_3) de deux vecteurs. En C, vous auriez écrit une fonction pour chaque type de vecteur : une pour les vecteurs à 2 dimensions et une autre pour les vecteurs en 3 dimensions, et elles auraient chacune un nom différent. Pas très pratique à utiliser.\n\nPour remédier à cela, la surcharge permet de ne créer qu’un seul nom de fonction pour deux fonctions différentes. Ainsi, vous pourrez appeler votre fonction de produit scalaire indifféremment avec des vecteurs 2D ou 3D :\n\n```\nvec2 a, b;\nvec3 x, y;\n\nfloat resultat1 = produitScalaire(a, b);\nfloat resultat2 = produitScalaire(x, y);\n```\n\nCela évite de créer 36 noms de fonctions juste parce que le nombre et/ou le type de leur(s) paramètre(s) change. Nous pouvons aussi imaginer une fonction qui pourrait travailler aussi bien sur des entiers (**int**) que sur des flottants (**float**), dans ce cas la surcharge serait également utile.\n\n### Surcharger une fonction\n\nNous allons prendre l’exemple du produit scalaire, qui est un très bon exemple. Voici une fonction qui calcule le produit scalaire de deux vecteurs 3D :\n\n```\nfloat produitScalaire(vec3 a, vec3 b)\n{\n    float resultat;\n\n    // on calcul le produit scalaire (3D)\n    resultat = (a.x * b.x) + (a.y * b.y) + (a.z * b.z);\n\n    // on retourne le resultat\n    return resultat;\n}\n```\n\nNotez que les parenthèses dans le calcul du produit scalaire sont facultatives dans la mesure où * a la priorité sur +, elles ne sont présentes que pour une meilleure lisibilité.\n\nMaintenant, nous voudrions que cette fonction marche aussi pour les vecteurs à 2 dimensions. En fait, il n’y a pas de secret : il faut re-écrire la fonction en entier. Ce qu’accepte le GLSL, contrairement au C, c’est d’avoir plusieurs fonctions du même nom, qui ne se différencient que par leurs paramètres et/ou leur type respectif.\n\nAinsi, pour surcharger notre fonction produitScalaire(), il nous suffit de rajouter une version de notre fonction qui calculera le produit scalaire de deux vecteurs 2D, comme ceci :\n\n```\nfloat produitScalaire(vec2 a, vec2 b)\n{\n    float resultat;\n\n    // on calcul le produit scalaire (2D)\n    resultat = (a.x * b.x) + (a.y * b.y);\n\n    // on retourne le resultat\n    return resultat;\n}\n```\n\nOn n’oubliera pas de rajouter un prototype en haut de notre code pour chaque version de notre fonction.\n\n```\nfloat produitScalaire(vec3, vec3);\nfloat produitScalaire(vec2, vec2);\n```\n\n### Exemple complet\n\nJe vous propose un petit vertex shader tout simple pour illustrer tout ce que nous venons de voir, afin que vous sachiez comment emballer tout ça dans un joli code tout propre tout fini :\n\n```\n// prototypes de nos fonctions\nfloat produitScalaire(vec4, vec4);\nfloat produitScalaire(vec3, vec3);\nfloat produitScalaire(vec2, vec2);\n\nvoid main(void)\n{\n    // il est aussi possible d'acceder aux composantes d'un vecteur en utilisant\n    // les noms r, g ou b, pour red, green et blue respectivement\n    \n    // calculs au hasard, pour donner un effet rigolo\n    gl_FrontColor.b = produitScalaire(gl_Color, gl_Vertex);\n    gl_FrontColor.g = produitScalaire(gl_Color, gl_Vertex * 2.0);\n\n    gl_Position = gl_Vertex;\n}\n\n// version 4D\nfloat produitScalaire(vec4 a, vec4 b)\n{\n    float resultat;\n\n    // on calcul le produit scalaire (3D)\n    resultat = (a.x * b.x) + (a.y * b.y) + (a.z * b.z);\n\n    // on retourne le resultat\n    return resultat;\n}\n\n// version 3D\nfloat produitScalaire(vec3 a, vec3 b)\n{\n    float resultat;\n\n    // on calcul le produit scalaire (3D)\n    resultat = (a.x * b.x) + (a.y * b.y) + (a.z * b.z);\n\n    // on retourne le resultat\n    return resultat;\n}\n\n// version 2D\nfloat produitScalaire(vec2 a, vec2 b)\n\n{\n    float resultat;\n\n    // on calcul le produit scalaire (2D)\n    resultat = (a.x * b.x) + (a.y * b.y);\n\n    // on retourne le resultat\n    return resultat;\n}\n```\n\nJe vous avoue cependant que ce vertex shader ne fait rien de génial, il ne sert qu’à vous montrer l’implémentation complète d’une fonction en GLSL.\n\n* * *\n\n# Quelques fonctions natives du GLSL\n\nLe langage GLSL offre par défaut de nombreuses fonctions. Parmi ces fonctions, on retrouve beaucoup de fonctions mathématiques qui permettent de calculer à peu près tout et n’importe quoi, mais on retrouve aussi des fonctions indispensables effectuant des tâches bien précises propres aux shaders.\n\nTout d’abord, vous devez savoir que la plupart des fonctions du GLSL sont surchargées, ce qui facilite leur utilisation, qui devient alors intuitive et un vrai jeu d’enfant. Pour faire simple, je vous préviens d’avance : toutes les fonctions que je vais vous présenter sont surchargées, donc utilisez-les à volonté et dans toutes les circonstances. De plus, l’usage des fonctions prédéfinies du GLSL est **fortement recommandé** dans la mesure où la plupart de celles-ci sont directement implantées dans les cartes graphique, ce qui vous permet de tirer parti de toute la puissance de vos cartes et ainsi gagner en performance.\n\n## Fonctions de manipulation de vecteurs\n\nPour comprendre la plupart des fonctions que nous allons étudier ici, je vous recommande la lecture du [chapitre annexe sur les vecteurs](http://www.siteduzero.com/tuto-3-18391-1-les-vecteurs.html).\n\n### Normalisation de vecteurs\n\nLe langage GLSL offre une fonction permettant de normaliser un vecteur. Cette fonction s’appelle *normalize()*. Elle prend un paramètre (un vecteur) et renvoie ce même vecteur, mais normalisé. Voici un code pour illustrer la normalisation d’un vecteur *v* :\n\n```\nvec3 v = vec3(0.2, 0.4, 0.6);\n\nv = normalize(v);\n```\n\n### Produit scalaire\n\nPour calculer le produit scalaire de deux vecteurs en GLSL, rien de plus simple : appelez la fonction *dot()*. Cette fonction prend deux paramètres. Ces paramètres sont les deux vecteurs dont on veut connaître le produit scalaire. *dot()* renvoie un flottant qui n’est autre que le résultat du produit :\n\n```\nvec3 v1 = ..., v2 = ...;\n...\nfloat res = dot(v1, v2);\n```\n\n### Produit vectoriel\n\nLà encore, une fonction existe, il s’agit de *cross()*. Elle prend deux vecteurs en paramètres, et renvoie un vecteur qui est le résultat du produit vectoriel de ses deux paramètres :\n\n```\nvec3 v1 = ..., v2 = ...;\n...\nvec3 res = cross(v1, v2);\n```\n\n### Longueur d’un vecteur\n\nPour connaître la longueur d’un vecteur simplement, utilisez la fonction *length()* :\n\n```\nfloat longueur = length( vec3(2.0, 0.8, 1.6) );\n```\n\n### Distance entre deux vecteurs\n\nBien que cette solution soit envisageable :\n\n```\nvec3 a, b;\n...\nfloat d = length( a - b );\n```\n\nIl en existe une plus explicite : utiliser la fonction *distance()* :\n\n```\nvec3 a, b;\n...\nfloat d = distance( a, b );\n```\n\nEt voilà, ça sera tout pour les fonctions de manipulation de vecteurs :)\n\nEn ce qui concerne les additions/soustractions de vecteurs, rappelez-vous le précédent chapitre : les opérateurs en GLSL sont surchargés, par conséquent, vous n’aurez qu’à placer l’opérateur de votre choix entre deux vecteurs, ou entre un vecteur et une valeur.\n\n```\nvec3 v1 = ..., v2 = ...;\n\nvec3 add = v1 + v2;  // add = le resultat de l'addition des vecteurs v1 et v2\nvec3 mul = v1 * 2.0; // chaque composante de mul = chaque composante de v1 * 2\n```\n\n## La fonction *ftransform()*\n\nVoici une fonction qui est souvent utilisée par les programmeurs pour… se faciliter la vie. Notez bien qu’elle n’est utilisable qu’au sein d’un vertex shader. Souvenez-vous lorsque vous avez créé votre premier vertex shader lors du précédent chapitre. Vous aviez attribué à la variable de sortie *gl_Position* le résultat de la multiplication de la position du sommet par les matrices modelview et projection combinées. Voici quel était le code final du vertex shader :\n\n```\nvoid main(void)\n{\n    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;\n}\n```\n\nCe code est plutôt lourd et long à coder. Il est cependant remplaçable par celui-ci, qui a l’avantage d’être beaucoup plus léger :\n\n```\nvoid main(void)\n{\n    gl_Position = ftransform();\n}\n```\n\nVous me demanderez sans doute quel est l’intérêt de la première méthode, ce à quoi je vous répondrai : quel est l’intérêt de la seconde vous voulez dire ? En fait la fonction *ftransform()* a pour effet de vous rendre la position finale du sommet comme si il avait été traité par le FFP.\n\n## Encore quelques fonctions\n\nJe vous montre encore quelques fonctions, et après c’est bon, je vous aurai montré le principal (fonctions les plus utilisées).\n\nNous allons voir trois fonctions très simples, mais très pratiques :\n\n- *min()* ;\n    \n- *max()* ;\n    \n- *clamp()*.\n    \n\n### min()\n\nCette fonction renvoie la plus petite valeur entre deux valeurs fournises :\n\n```\nfloat a = 0.2, b = 0.5;\n\nfloat res = min(a, b);\n```\n\nIci, *res* = **0.2**\n\nNotez que cette fonction peut être remplacée par l’instruction suivante (comme en C) :\n\n```\n(a \u003c b) ? a : b;\n```\n\nTout comme de nombreuses fonctions, *min()* est surchargée, vous pouvez donc lui envoyer des vecteurs, elle vous renverra le plus court.\n\n### max()\n\nExactement l’inverse de *min()*, *max()* vous renvoie son plus grand paramètre :\n\n```\nint res = max(2, 4); // res = 4\n```\n\nElle est bien évidemment elle aussi surchargée.\n\n### clamp()\n\nLa fonction *clamp()* est un mélange des deux fonctions vues ci-dessus, elle prend trois paramètres :\n\n```\nT clamp(T var, T minimum, T maximum);\n```\n\nL’emploi de ‘T’ représente juste un type quelconque.\n\net renvoie ceci :\n\n```\nmin(max(var, minimum), maximum);\n```\n\nEuh, j’ai rien compris, c’est normal ?\n\nOui, rassurez-vous :D\n\nEn fait, la fonction *clamp()* vous renvoie une valeur qui se situe forcément entre *minimum* et *maximum*. *clamp()* renvoie *var* si sa valeur est située entre *minimum* et *maximum*, sinon elle renvoie la valeur la plus proche de *var* (*minimum* ou *maximum*).\n\nNous pouvons programmer *clamp()* comme ceci :\n\n```\nif(minimum \u003e var)\n    return minimum;\nelse if(up \u003c var)\n    return maximum;\nelse\n    return var;\n```\n\n## Spécifications du GLSL\n\nLa version du langage étudié dans ce tutoriel possède [des spécifications](http://www.opengl.org/registry/doc/GLSLangSpec.Full.1.20.8.pdf) que vous trouverez sur le site d’OpenGL. Ceci est la documentation de référence et votre meilleur guide dans l’avenir pour l’apprentissage du GLSL.\n\nJe reconnais que ce chapitre avait un aspect “bourrage de crâne”, mais il vous sera sûrement plus utile que vous ne le pensez. En effet, mine de rien nous avons appris beaucoup de choses très pratiques :\n\n- les instructions de contrôle, et les incompatibilités avec le C ;\n    \n- les fonctions et la surcharge des fonctions ;\n    \n- quelques fonctions du GLSL, que nous utiliserons fréquemment.\n    \n\nMaintenant que vous connaissez le langage GLSL, vous devriez être aptes à comprendre un code source quelconque, sauf bien sûr si celui-ci comporte des fonctions du GLSL qui vous sont inconnues.\n\n* * *\n\n# Communiquer avec l’application : attributs et « uniforms »\n\nBienvenue dans la seconde partie de ce tutoriel consacré aux shaders en GLSL ! :)\n\nNous allons la commencer sans plus tarder en abordant deux façons de **transmettre** des informations au shader, à partir de l’application. Ces deux façons sont relativement simples à mettre en œuvre, et puisqu’elles font intervenir toutes les deux des exemples en langage C (langage utilisé pour notre application), j’ai décidé de les fusionner dans un seul chapitre.\n\n- Nous allons tout d’abord étudier les variables de type **uniform**. Ce type de variable du GLSL vous permettra de recevoir des variables provenant de l’application. Vous pourrez ainsi changer dynamiquement la valeur d’une variable au sein du shader, lorsque votre application sera en cours.\n    \n- Nous apprendrons ensuite à utiliser les **attributs** de sommet. Ce sont en fait des informations qui sont différentes pour chaque sommet, un peu comme la couleur ou la position ;) Cela nous permettra de rajouter des données à nos sommets.\n    \n\n## Les variables de type uniform\n\n## Principe\n\nL’idée est simple : envoyer une variable de l’application au shader. En réalité ce n’est pas un véritable envoi, mais plutôt une copie de valeur. Nous allons pour cela créer une variable dans notre shader, en lui assignant un type particulier, puis, à partir de notre application, localiser cette variable dans notre shader pour y demander la copie d’une valeur.\n\nVous pouvez bien sûr transmettre différents types de variables, comme des entiers, des flottants, des booléens, des vecteurs et même des matrices.\n\n# Le type « uniform »\n\nDans un shader, pour créer des variables capables de recevoir leur valeur à partir de l’application appelante, il faut les rendre **globales** et leur assigner le préfixe **uniform**.\n\nRendre une variable globale ? o_O\n\nCela veut dire, comme en C, rendre une variable accessible par tout le programme. Créer une variable globale en GLSL revient à faire ceci :\n\n```\nint variable; // 'variable' est globale\n\n\n\nvoid main(void)\n\n{\n\n    ...\n\n}\n\n\n\n...\n```\n\nEt le type « uniform » dans tout ça ?\n\nIl vient se placer devant le type de la variable, comme ceci :\n\n```\nuniform int variable;\n```\n\nDéclarer une variable avec **uniform** revient à dire : “je veux que la valeur de cette variable soit indiquée par mon application”. Et voilà, c’est tout ce qu’on aura à faire dans notre shader pour indiquer à OpenGL les variables dont la valeur proviendra de l’application :)\n\n## Implémentation côté API\n\n### Une affaire d’identifiants\n\nDites donc, on dirait qu’ils aiment bien les identifiants chez OpenGL :D Avant de pouvoir transmettre une valeur à une variable de notre shader, il est important de préciser à OpenGL quelle variable recevra la valeur.\n\nBen, c’est celle qu’on a créée avant avec uniform non ?\n\nEh bien non, pas forcément, car il est possible de créer plusieurs variables uniform dans un même shader. Si par exemple vous en créez deux, comment OpenGL saura à quelle variable il doit transmettre la valeur ? Il est donc important de récupérer l’ID de notre variable avant de lui envoyer une valeur.\n\n### Récupérer un ID\n\nIl n’existe pas 36 façons de localiser une variable dans un shader (et n’importe où d’ailleurs…), il va falloir donner à OpenGL le nom de notre variable, pour qu’il nous retourne son identifiant, nous nous servirons ensuite de celui-ci pour envoyer une valeur à notre variable.\n\nVoici la fonction OpenGL permettant de récupérer l’ID d’une variable dans un shader :\n\n```\nGLint glGetUniformLocation(GLuint program, const char *nom);\n```\n\n- ***program*** : c’est l’identifiant du program tout entier dans lequel on voudra rechercher la variable.\n    \n- ***nom*** : le nom de la variable dont on veut récupérer l’identifiant.\n    \n\nAttention : si vous créez une variable uniform qui a le même nom dans le vertex et le pixel shader, les deux variables seront affectées par la valeur que vous spécifierez.\n\nLa valeur retournée par cette fonction est l’identifiant de votre variable de shader nommée *“nom”*, si la fonction n’a pas trouvé votre variable, ou qu’elle a échoué pour une raison x ou y, elle renvoie -1.\n\nDans quelle mesure cette fonction peut “échouer” ?\n\nSi votre program n’a pas été lié par exemple, rappelez-vous dans le second chapitre de la fonction *glLinkProgram()*.\n\n### Assigner une valeur\n\nNous voici enfin parvenus à l’étape finale : l’envoi d’une valeur à la variable de notre shader :)\n\nPour cela, nous avons besoin de 3 choses :\n\n1.  l’identifiant de notre variable, récupéré avec *glGetUniformLocation()* ;\n    \n2.  une valeur à attribuer à cette variable ;\n    \n3.  et surtout, que notre program ait été défini comme actif pour le rendu, c’est-à-dire activé via *glUseProgram()* !\n    \n\nLa dernière condition est très importante, si votre program n’a pas été activé, une erreur OpenGL de type GL\\_INVALID\\_OPERATION sera levée.\n\nLes erreurs OpenGL sont récupérables via la fonction *glGetError()*, et peuvent être transformées en chaînes de caractères avec *gluErrorString()* comme ceci :\n\n```\nconst char *err = gluErrorString(glGetError());\n```\n\nAllez, il est temps que je vous présente la fonction permettant d’envoyer une valeur à une variable de notre shader :) :\n\n```\nvoid glUniform*(GLint id, TYPE val);\n```\n\n- ***id*** : c’est l’ID de notre variable, récupéré via *glGetUniformLocation()*.\n    \n- ***val*** : la valeur que l’on souhaite envoyer à notre variable.\n    \n\nCette fonction agit directement sur le program actif, d’où la nécessité de l’avoir activé au préalable avec *glUseProgram()*.\n\nLorsque *glUniform*()\\* est appelée, la variable désignée par l’identifiant prend alors la valeur demandée, et garde cette valeur jusqu’à ce que le program soit à nouveau lié ou supprimé. Par conséquent, si vous souhaitez envoyer une valeur constante (un paramètre de démarrage par exemple), n’invoquez *glUniform*()*qu’une seule fois.\n\n## Les différentes formes de *glUniform*()*\n\nComme vous l’aurez remarqué, j’ai mis une petite étoile « * » au nom de la fonction, c’est pour dire qu’elle a été définie sous plusieurs formes, comme pour les fonctions *glVertex*()*, *glTexCoord*()*, etc… Cela permet d’envoyer différents types de variables, comme je l’ai dit plus haut ; des vecteurs, des matrices, etc…\n\n### Envoi d’une simple variable\n\nLa fonction *glUniform*()\\* a été définie sous de nombreuses formes. Toutefois, le nombre de types de variable qu’elle supporte est toujours limité à deux :\n\n- les entiers (**int**) ;\n    \n- les flottants (**float**).\n    \n\nDu côté du GLSL, nous remarquons la présence d’un type supplémentaire : le type **bool**. Rassurez-vous cependant, vous pourrez affecter une variable **bool** en passant par la forme entière de *glUniform*()*.\n\nVoici un premier exemple de code illustrant le simple envoi d’une variable à notre program nommé *prog* :\n\n```\nuniform int var; // n'oublions pas de declarer 'var' globale\n```\n\n```\n/* on recupere l'ID */\nint id = glGetUniformLocation(prog, \"var\");\n\n/* on defini notre program actif */\nglUseProgram(prog);\n\n/* on envoie notre variable (ici nous envoyons la valeur 2) */\nglUniform1i(id, 2);\n```\n\nNotez qu’il n’est pas obligatoire de récupérer l’identifiant à chaque fois que vous voudrez envoyer une valeur à une variable de votre shader, l’ID est invariable, sauf si vous liez à nouveau votre program. Donc, dans la mesure où la recherche d’un identifiant est plutôt lourde (analyse d’une chaîne de caractères), on essayera si possible de stocker au préalable tous les identifiants dans des variables.\n\n### Envoi d’un simple vecteur\n\nSi vous voulez envoyer un vecteur à 3 dimensions (par exemple) à votre shader, vous pouvez faire comme ceci :\n\n```\nuniform vec3 vecteur;\n```\n\n```\n/* on recupere l'ID */\nint id = glGetUniformLocation(program, \"vecteur\");\n\n/* on defini notre program actif */\nglUseProgram(program);\n\n/* on envoie notre vecteur */\nglUniform3f(id, 1.7, 5.2, 3.6);\n```\n\nCette méthode peut poser un petit problème ; elle est plutôt “lourde” et peut flexible, il faut spécifier chaque composante du vecteur une par une, et si l’on souhaite subitement envoyer un vecteur à deux dimensions à la place, il faudra non seulement changer le nom de la fonction, mais aussi le nombre de ses paramètres. Pour remédier à ce problème, vous pouvez utiliser la version vectorielle de *glUniform*()*.\n\n### Étude de la version vectorielle de glUniform*()\n\nAfin d’envoyer un groupe de données (comme un vecteur), la fonction *glUniform*v()* vous propose de lui spécifier un pointeur vers ces données. De plus, elle bénéficie d’un nouveau paramètre :\n\n```\nvoid glUniform*v(GLint id, GLsizei count, TYPE *val);\n```\n\n- ***id*** : …\n    \n- ***count*** : nombre de groupes de données.\n    \n- ***val*** : …\n    \n\nVoyons tout d’abord comment modifier le code précédent pour spécifier la valeur de notre vecteur par le biais d’un tableau :\n\n```\nuniform vec3 vecteur;\n```\n\n```\n/* le vecteur que l'on veut envoyer en parametre */\nfloat vec[3] = {1.7, 5.2, 3.6};\n\n/* on recupere l'ID */\nint id = glGetUniformLocation(program, \"vecteur\");\n\n/* on defini notre program actif */\nglUseProgram(program);\n\n/* on envoie notre vecteur */\nglUniform3fv(id, 1, vec);\n```\n\nVous pouvez voir ici que j’ai spécifié le paramètre *count* de *glUniform*v()* à la valeur 1. Cela veut dire que j’ai souhaité envoyer **un** vecteur, un vecteur à **3** composantes ( *glUniform**3**fv()* ). En effet, le chiffre contenu dans le nom de la fonction *glUniform*()\\* (qui peut varier de 1 à 4 inclus) nous informe du type de la variable GLSL (nombre de composantes du vecteur), et par conséquent du nombre de données que la fonction *glUniform*()\\* va aller chercher dans notre pointeur.\n\nDonc : faites bien attention aux débordements mémoire. Mais attendez, vous n’avez pas encore tout vu. Eh bien oui ; qu’advient-il de notre paramètre *count* ? Il ne faut pas l’oublier.\n\nLe paramètre *count* vient complexifier la chose en vous permettant d’envoyer des tableaux de vecteurs. Avec ce paramètre, vous allez pouvoir spécifier le nombre de vecteurs que contient votre tableau. Prenons tout de suite un exemple :\n\n```\nuniform vec3 vecteurs[2]; // tableau de deux vecteurs\n```\n\n```\n/* les vecteurs que l'on veut envoyer en parametre */\nfloat vecs[2][3] =\n{\n    {0.8, 2.1, 1.3},\n    {1.9, 3.2, 1.7}\n};\n\n/* on recupere l'ID */\nint id = glGetUniformLocation(program, \"vecteurs\");\n\n/* on defini notre program actif */\nglUseProgram(program);\n\n/* on envoie nos deux vecteurs */\nglUniform3fv(id, 2, vecs);\n```\n\nComme vous le voyez, côté GLSL vous pouvez remarquer que j’ai créé un tableau de vecteurs, tout comme je l’ai fait dans l’exemple en C. J’ai également placé le paramètre *count* à la valeur **2** dans *glUniform*v()*, pour indiquer que je souhaite envoyer **deux** vecteurs.\n\n\\*\\*Prenez garde :\\***glUniform*v()* attend une suite de données, donc un tableau ou un tableau de tableaux, mais en aucun cas un pointeur de pointeurs ! La solution suivante est envisageable et produira le même effet :\n\n```\nfloat vec[2*3] = {0.8, 2.1, 1.3, 1.9, 3.2, 1.7};\n```\n\nAu final, le nombre de variables qui seront lues dans votre tableau sera égal au chiffre du nom de la fonction *glUniform*v()* multiplié par *count* (dans notre cas, 2*3).\n\nEt si je veux envoyer un simple tableau, je fais comment ?\n\nInvoquez *glUniform1*v()*, elle ira prendre exactement *count* données dans votre tableau et ira les loger dans votre shader dans un tableau de type **bool**, **int** ou **float**. Eh oui, un vecteur à **une** composante ( *glUniform**1***v()* ) n’est rien d’autre qu’une simple variable ;)\n\n### Et les matrices ?\n\nÀ partir du moment où vous avez compris le fonctionnement de la version vectorielle de glUniform*(), les matrices vous paraîtront tout aussi simple ; en fait, le principe est identique, sauf qu’une matrice a plus de composantes qu’un vecteur ;)\n\nAfin d’envoyer une matrice à votre shader, chose qui risque d’arriver assez rarement dans la mesure où les matrices de projection, de texturage et de visualisation sont déjà à votre disposition en GLSL, la fonction *glUniform*()\\* prend une autre… forme :p :\n\n```\nvoid glUniformMatrix*fv(GLint id, GLsizei count, GLboolean transpose, const float *val);\n```\n\n- ***id*** : …\n    \n- ***count*** : …\n    \n- ***val*** : les valeurs doivent être contenues dans un pointeur sur des flottants de type **float** ;\n    \n- ***transpose*** : positionné à GL_TRUE, les matrices envoyées seront transposées avant d’arriver dans le shader.\n    \n\nComme vous le voyez, cette version laisse moins de libertés au programmeur, le forçant à utiliser des matrices codées sur des flottants de type **float**. Toutefois, elle lui permet :\n\n- de spécifier l’ordre de sa matrice, via le paramètre *transpose* ;\n    \n- d’indiquer la taille de sa matrice, via le nom de la fonction ( *glUniformMatrix**2**fv()* pour une matrice **2*2**, *glUniformMatrix**3**fv()* pour une matrice **3*3**, etc… ).\n    \n\nPour plus d’informations sur la transposée d’une matrice, vous pouvez consulter [la FAQ de Developpez.com sur les matrices](http://jeux.developpez.com/faq/matquat/?page=arithmetique#Q8).\n\nVoici un bref exemple pour illustrer une utilisation possible :\n\n```\nuniform mat3 matrix;\n```\n\n```\n/* la matrice que l'on veut envoyer en parametre */\nfloat mat[3][3] =\n{\n    {1.2, 0.0, 0.0},\n    {0.0, 2.5, 0.0},\n    {0.0, 0.0, 1.0}\n};\n\n/* on recupere l'ID */\nint id = glGetUniformLocation(program, \"matrix\");\n\n/* on defini notre program actif */\nglUseProgram(program);\n\n/* on envoie notre matrice */\nglUniformMatrix3fv(id, 1, 0, mat);\n```\n\nEt voilà, vous savez tout sur les variables uniform des shaders :) Servez-vous en pour envoyer des informations supplémentaires, de couleur par exemple, ou bien des données envoyées par l’utilisateur ; eh oui, aucun dialogue direct n’est possible entre l’utilisateur et le shader, servez-vous donc de votre application comme un tiers.\n\nUn exemple complet est disponible en téléchargement à la fin de ce chapitre.\n\n* * *\n\n## Les attributs de sommet\n\n## Qu’est-ce qu’un attribut ?\n\nComme indiqué à l’introduction de ce chapitre, les **attributs de sommet** sont des données supplémentaires, différentes pour chaque sommet, à l’instar de la position, de la coordonnée de texture, etc…\n\nAinsi, les attributs de sommet ne sont accessibles que par les vertex shaders, là où les informations de sommets sont disponibles en lecture (et en lecture seulement).\n\nComment accéder aux attributs de sommet dans le vertex shader ?\n\nLes données de position du sommet par exemple, sont disponible par défaut dans une variable du GLSL : *gl_Vertex*. Pour les attributs de sommet, il va falloir créer cette variable, mais pas n’importe comment.\n\n# Le type « attribute »\n\nÀ l’instar des variables uniform, que nous avons vue à l’instant, il va à nouveau falloir attribuer un type différents à nos attributs de sommet. Tout comme les uniform, les attributs doivent être des variables globales, mais préfixées cette fois-ci avec le mot clé **attribute** :\n\n```\nattribute vec3 donnee_supplementaire;\n```\n\nIci, j’ai décidé de rajouter une variable de type **vec3**. En gros, ce bout de code peut se traduire : « *je rajoute une donnée à mes sommets qui seront dessinés avec ce vertex shader* ».\n\nSupposons que nous voulions dessiner un triangle, nous allons donc spécifier trois sommets :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_780_d57889049e1e4cd6b.gif)\n\nChaque sommet possède son lot de données en tout genre : position, normale, couleur, etc… Eh bien imaginez que vous vouliez en rajouter ; vous pouvez !\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_780_449f98fe8e5040ef9.gif)\n\nC’est ce qui se passe lorsque vous créez une variable avec le type **attribute** :)\n\n## Côté API\n\nBien, voyons maintenant comment spécifier la valeur de ces données en plus que sont les attributs de sommet.\n\nGlobalement, le principe est le même que pour les variables uniform :\n\n- on récupère l’ID (plus couramment appelé **index** dans le cas des attributs de sommet) de notre attribut ;\n    \n- on s’en sert pour localiser nos attributs et ainsi leur envoyer la valeur de notre choix.\n    \n\n### Récupérer l’index\n\nBon, comme vous avez déjà pris l’habitude avec les uniforms, je vais aller un peu plus vite dans la pratique. Pour récupérer l’index d’un attribut de sommet dans un shader GLSL, invoquez *glGetAttribLocation()* :\n\n```\nGLint glGetAttribLocation(GLuint program, const char *name);\n```\n\n- ***program*** : désigne le program dans lequel nous voulons rechercher l’index.\n    \n- ***name*** : c’est le nom de l’attribut dont on souhaite obtenir l’index.\n    \n\nUne fois que nous avons notre index, il nous suffira de le spécifier à la fonction qui permet de définir les valeurs des attributs de sommet, et ces valeurs étant différentes pour chaque sommet, il nous faudra appeler cette fonction pour chaque sommet que nous définirons.\n\n### Spécifier la valeur d’un attribut\n\nPrenons un exemple ; supposons un triangle, créé de la façon suivante avec OpenGL :\n\n```\nglBegin(GL_TRIANGLES);\n    glVertex2f(0.9, -0.9);\n    glVertex2f(-0.9, -0.9);\n    glVertex2f(0.0, 0.9);\nglEnd();\n```\n\nAvec ce code, nous demandons la création de trois sommets (pour former un triangle). Pour chaque sommet traité, le vertex shader actif sera invoqué et sa variable *gl_Vertex* sera affectée aux valeurs que nous avons spécifiées à la fonction *glVertex*()*. Il en va de même pour chaque variable d’entrée du vertex shader (couleur, normale, …), y compris son attribut. Ainsi, pour affecter un attribut d’un sommet, il suffit de spécifier sa valeur pour chaque création de sommet avec la fonction *glVertexAttrib*()*, en spécifiant bien quel attribut nous souhaitons affecter via son index :\n\n```\nglBegin(GL_TRIANGLES);\n    glVertexAttrib3f(index, 0.0, 0.0, 0.0); glVertex2f(0.9, -0.9);\n    glVertexAttrib3f(index, 0.0, 0.0, 0.0); glVertex2f(-0.9, -0.9);\n    glVertexAttrib3f(index, 0.0, 0.0, 0.0); glVertex2f(0.0, 0.9);\nglEnd();\n```\n\nEt voici son prototype :\n\n```\nvoid glVertexAttrib*(GLuint index, TYPE vals);\n```\n\n- ***index*** : il s’agit là de placer l’index que l’on a récupéré avec *glGetAttribLocation()*.\n    \n- ***vals*** : ce sont les valeurs auquels on souhaite positionner notre attribut, le nombre de valeurs peut varier de 1 à 4 inclus.\n    \n\nLa fonction *glVertexAttrib*()\\* permet de spécifier la valeur de l’attribut de chaque sommet, comme vous venez de le voir. Voici un exemple d’utilisation des attributs de sommet :\n\n```\nattribute float numero_sommet; // representera le numero du sommet\n```\n\n```\n/* on recupere l'index de notre attribut de sommets */\nint index = glGetAttribLocation(program, \"numero_sommet\");\n\n...\n\n/* on active notre program */\nglUseProgram(program);\n\nglBegin(GL_TRIANGLES);\n    glVertexAttrib1f(index, 0.0); glVertex2f(0.9, -0.9);\n    glVertexAttrib1f(index, 1.0); glVertex2f(-0.9, -0.9);\n    glVertexAttrib1f(index, 2.0); glVertex2f(0.0, 0.9);\nglEnd();\n\n/* on desactive les shaders */\nglUseProgram(0);\n```\n\nVous noterez que la forme de *glVertexAttrib*()\\* utilisée doit correspondre au type de l’attribut dans le shader, sinon vous risquez de vous retrouver avec une valeur d’attribut erronée dans votre shader (en gros ça fera comme si vous faisiez un cast GLSL : *Attrib = TypeDeAttrib(TypeDeLaFonction)* ).\n\nJe vous conseille d’aller faire un petit tour sur la page de manuel de *[glVertexAttrib*()](http://www.opengl.org/sdk/docs/man/xhtml/glVertexAttrib.xml)*, vous risquez d’y trouver quelques informations complémentaires intéressantes ; cette fonction vous permet notamment de normaliser le vecteur que vous lui envoyez.\n\n* * *\n\n## Les tableaux d’attributs\n\nSi vous connaissez les [vertex arrays](http://www.siteduzero.com/tuto-3-18395-1-les-vertex-arrays.html), et que vous êtes un flemmard (quelqu’un de normal quoi), vous vous êtes probablement demandé : mais existe-t-il une alternative pour envoyer mes attributs de sommets par le biais de tableaux ? Eh bien la réponse est oui :)\n\nCette section est bien sûr facultative, elle ne vous aidera pas à mieux comprendre le fonctionnement des attributs de sommet, elle est plutôt réservée aux connaisseurs des vertex arrays.\n\n## Activation des tableaux d’attributs\n\nÀ l’instar des vertex arrays simples, les tableaux d’attributs ont besoin d’une activation qui leur est propre. Chaque index d’attribut doit être activé indépendamment, car chaque index représente un type de données différent.\n\nQue quoi ? Hein ??\n\nOui, chaque index d’attribut représente un type différent ; la différence qu’il y a entre l’index 0 et l’index 1 est la même qu’entre la position d’un sommet et sa normale : ce ne sont pas les mêmes données, elles sont identifiées différemment. Je vous conseille d’aller jeter un oeil à [ma petite définition de ce qu’est un sommet](http://www.siteduzero.com/tuto-3-18395-1-les-vertex-arrays.html#ss_part_1), dans mon tutoriel sur les vertex arrays.\n\nBien, revenons-en au sujet initial : l’activation. Étant donné que chaque type d’attribut est identifié différemment par OpenGL, il va falloir, comme pour chaque type de donnée d’un sommet, l’activer indépendamment des autres, et pour cela, il va nous falloir son **index**. Avec la fonction *glEnableClientState()*, c’était facile, il nous suffisait de lui donner une constante au nom trivial et facile à retenir, et hop, elle activait le type de vertex array demandé.\n\nLa fonction *glEnableVertexAttribArray()* quant à elle, demande l’index de l’attribut à activer.\n\n```\nvoid glEnableVertexAttribArray(GLuint index);\n```\n\n- ***index*** : c’est l’index du type de l’attribut que l’on souhaite activer.\n\nAvec les shaders GLSL, l’index d’un attribut de sommet se récupère comme nous l’avons vu plus haut : avec la fonction *glGetAttribLocation()*. Après vous être muni de cet index, vous n’aurez qu’à le donner à *glEnableVertexAttribArray()* pour que nous puissions exploiter les attributs de sommet demandés :)\n\n## Envoi d’un tableau\n\nAllez, je ne vais pas passer par 36 chemins ; ici je considère que vous maîtrisez un minimum le concept des vertex arrays, je ne m’étalerai donc pas sur les détails.\n\nAfin de spécifier un tableau d’attributs, utilisez la fonction *glVertexAttribPointer()* :\n\n```\nvoid glVertexAttribPointer(GLuint index, int size, GLenum type, GLboolean norm, GLsizei stride, const void *data);\n```\n\n- ***size***, ***type***, ***stride***, ***data*** : référez-vous à mon tutoriel sur les vertex arrays, ces paramètres ont la même incidence que ceux des autres fonctions *gl*Pointer()*.\n    \n- ***index*** : il s’agit d’indiquer ici le type de l’attribut, c’est-à-dire son index récupéré à l’aide de *glGetAttribLocation()*.\n    \n- ***norm*** : positionné à GL\\_TRUE, les vecteurs contenus dans votre tableau de données seront normalisés. Je vous conseille personnellement de laisser ce paramètre à 0 (ou GL\\_FALSE), ainsi OpenGL ne touchera pas à vos données.\n    \n\nComme vous le voyez, cette fonction demande à ce qu’on lui fournisse le type d’attribut que représentera le tableau qu’on lui envoie.\n\nComment ça se fait ? Pourquoi elle a besoin de savoir ça, alors qu’on a déjà donné l’index lorsqu’on a activé les tableaux ?\n\nCar vous pouvez avoir activé plusieurs tableaux d’attributs à la fois (c’est possible sachez-le), il est donc important de spécifier explicitement quel est le type d’attribut que vous lui envoyez.\n\nLe reste du fonctionnement est le même que pour les vertex arrays (les tabeaux d’attributs sont en fait des vertex arrays un peu différents sur certains points) : après avoir appelé cette fonction, le tableau sera envoyé à la carte graphique pour traitement lorsque vous appelerez une fonction de dessin comme *glDrawArrays()* ou *glDrawElements()*.\n\n### Et les VBOs ?\n\nAh ! J’allais les oublier ceux-là. Les tableaux t’attributs ayant un système de fonctionnement identique aux vertex arrays, vous pouvez également héberger vos tableaux dans un VBO, puis utiliser l’adresse 0 avec *glVertexAttribPointer()* pour spécifier l’emplacement de votre VBO actif, et utiliser les données directement à partir de la mémoire de la carte graphique.\n\n« VBO » ? Avons-nous été présentés ?\n\nVous ne connaissez pas les VBOs ? Eh bien alors il est grand temps que vous fassiez leur connaissance ! Les VBOs sont un sujet assez vaste, c’est pourquoi je vous ai concocté [un petit tutoriel à leur sujet](http://www.siteduzero.com/tuto-3-18397-1-les-vertex-buffer-objects.html). Pour faire court ; les VBOs sont une sorte d’amélioration du système des vertex arrays, ils servent à augmenter considérablement leur performance (pour peu qu’ils soient bien utilisés) ;)\n\n## Désactivation des tableaux d’attributs\n\nJe vous l’avais dit que les tableaux d’attributs étaient des vertex arrays :p Un peu différents toutefois, la fonction pour désactiver les tableaux d’attributs est la suivante :\n\n```\nvoid glDisableVertexAttribArray(GLuint index);\n```\n\n- ***index*** : encore une fois, il est nécessaire d’indiquer quel type d’attribut on souhaite désactiver.\n\n## Exemple d’utilisation\n\nUn petit exemple ne fera pas de mal je pense. Vous vous rappelez de l’exemple qui présentait une utilisation possible des attributs de sommet, en spécifiant les attributs un à un ? Je vous en propose ici l’adaptation qui utilise les tableaux d’attributs :\n\n```\nattribute float numero_sommet;\n```\n\n```\n/* notre index d'attribut */\nint index;\n\n/* tableau des positions */\nfloat pos[6] =\n{\n    0.9, -0.9,\n    -0.9, -0.9,\n    0.0, 0.9\n};\n/* tableau t'attributs */\nfloat attribs[3] =\n{\n    0.0, 1.0, 2.0\n};\n\n...\n\n/* on recupere l'index de notre attribut de sommets */\nindex = glGetAttribLocation(program, \"numero_sommet\");\n\n...\n\n/* on active les tableaux */\nglEnableClientState(GL_VERTEX_ARRAY);\nglEnableVertexAttribArray(index);\n\n/* on specifie nos donnees */\nglVertexPointer(2, GL_FLOAT, 0, pos);\nglVertexAttribPointer(index, 1, GL_FLOAT, 0, 0, attribs);\n\nglUseProgram(program);\n\n/* dessin */\nglDrawArrays(GL_TRIANGLES, 0, 3);\n\nglUseProgram(0);\n\n/* on desactive les tableaux */\nglDisableVertexAttribArray(index);\nglDisableClientState(GL_VERTEX_ARRAY);\n```\n\nCe chapitre touche à sa fin ; nous y avons vu deux méthodes pour transmettre des informations à nos shaders : l’une où l’on envoyait une “simple” variable, allant de l’entier à la matrice 4×4, et l’autre où l’on pouvait envoyer des données différentes à chacun de nos sommets.\n\n## Téléchargement\n\nComme promis, voici un programme exemple, afin que vous voyez comment on peut mélanger efficacement tout ce qu’on vient de voir.\n\n[Télécharger l’exemple de code et le makefile Linux.](http://yno.goldzoneweb.info/sdz/ch5.zip)\n\n[Télécharger l’exemple utilisant les vertex arrays.](http://yno.goldzoneweb.info/sdz/ch5-2.zip)\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_780_069218cc8e24432ca.gif)\n\n*Screenshot de l’application exemple.*\n\nComme d’habitude, l’exemple ne présente rien d’extraordinaire, toutefois ne vous inquiétez pas ; nous verrons dans la prochaine partie de ce tutoriel comment réaliser différents effets graphiques grâce aux shaders, afin d’embellir nos scènes 3D :)\n\nLe tuto n’est pas fini, d’autres chapitres/parties sont en cours de rédaction ;)\n\n* * *\n\n## Les vecteurs\n\nCette annexe risque d’être votre plus grande alliée si vous voulez réellement comprendre le fonctionnement de la plupart des effets que nous étudierons dans la partie 3. Nous allons ici étudier ce qu’est un vecteur, ce qu’est la **normalisation** d’un vecteur, comment on fait le **produit scalaire** de deux vecteurs, comment on fait leur **produit vectoriel**, mais surtout, à quoi tout cela peut servir. Je me doute que vous avez probablement déjà appris ces concepts à l’école, mais vous a-t-on déjà donné une utilisation pratique de ces outils mathématiques forts pratiques que sont les vecteurs ? Non ? Et bien je vais vous en donner une :) Vous verrez, lorsqu’on a un objectif, l’apprentissage d’un concept est tout de suite plus simple.\n\n## Les vecteurs, notions de base\n\nIl est avant-tout important de savoir additionner et soustraire deux vecteurs, ces opérations très simples sont la base des vecteurs mais on les utilise tout le temps, il est donc important de les maîtriser.\n\nAttention préparez-vous, car ce chapitre va pleuvoir de schémas. Je me baserai sur une illustration 2D, mais les calculs que je ferai sont tout à fait appliquables en 3D, et heuresement, car c’est notre objectif.\n\n## Un vecteur, c’est quoi ?\n\nCette section est bien sûr réservée aux néophytes, si vous savez déjà ce qu’est un vecteur, passez tout de suite au gros titre suivant.\n\nVous pouvez comparer un vecteur avec une **direction**. Un vecteur marche aussi bien en 1D, qu’en 2D et qu’en 3D, les principes sont les mêmes.\n\nOui mais un vecteur, ça ressemble à quoi ?\n\nJe vous propose de voir mon premier schéma, qui illustre un plan 2D et un vecteur dessiné dans ce plan :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_f0a8f712d45045f19.gif)\n\nCette barre rouge au milieu est un vecteur, comme vous le voyez, elle représente une direction. Ce vecteur v s’écrit comme ceci :\n\nv(1; 1)\n\nLe premier chiffre représente la composante x, et le second la composante y. Pour les vecteurs 3D, il y a une 3eme composate : la composante z. Ici notre vecteur peut être transformé en vecteur 3D, il aura donc une composante z nulle :\n\nv(1; 1; 0)\n\nPuisqu’un vecteur représente une direction, on part du principe qu’un vecteur commence toujours au point (0; 0).\n\n## L’addition de vecteurs\n\nL’addition de vecteurs sert à obtenir une coordonnée finale dans l’espace résultante de plusieurs vecteurs. Comme l’illustre le schéma ci-dessous, mes deux vecteurs additionnés donnent naissance à un 3eme point qui est le résultat de l’addition des vecteurs a et b :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_45f0e10445954e96a.gif)\n\nVous pouvez toujours additionner un vecteur à un autre, et ainsi vous ballader librement dans l’espace, c’est un peu le principe qui est utilisé pour les **caméras** dans les jeux vidéos : la position de la caméra est représentée par un vecteur auquel on en additionne d’autres afin de **déplacer** la caméra.\n\nPour additionner deux vecteurs mathématiquement, on procède à l’addition de chaque composante du vecteur a par la même composante chez le vecteur b :\n\na(1; 0) + b(0; 1) = v(1; 1)\n\nSoit :\n\nv.x = a.x + b.x v.y = a.y + b.y\n\nEssayons d’additionner plusieurs vecteurs entres eux. Nous allons additionner 3 vecteurs : a, b et c. Voici ces trois vecteurs :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_e41b112201d04ecca.gif)\n\nEuh, comment on additionne tout ça ?\n\nJe vais vous représenter tout ces vecteurs autrement. On peut schématiser l’addition comme ceci :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_185e9da2b6054550b.gif)\n\nIci, le vecteur résultant, v, se calcule ainsi :\n\nv.x = a.x + b.x + c.x v.y = a.y + b.y + c.y\n\nCe qui donne :\n\nv.x = -2 + 2 + 1 v.y = 1 + 2 + -2\n\nNous obtenons donc le vecteur v(1; 1).\n\nNotez que l’ordre d’addition n’a pas d’importance : 2+1 = 1+2 Voyez ci-dessous l’illustration d’un autre ordre d’addition : on retombe exactement au même endroit qu’avant (1; 1) :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_710_fcbe277decaf4a0e9.gif)\n\n### L’addition de vecteurs pour trouver une moyenne\n\nL’addition de vecteurs peut également servir à trouver un vecteur moyen entre plusieurs vecteurs, en fait c’est ce que nous avons fait jusqu’à maintenant, mais à présent si nous considérons la position résultante de l’addition de plusieurs vecteurs comme une **direction** et non une position, nous obtenons en fait la direction moyenne de tous les vecteurs additionnés.\n\nReprenons notre premier schéma sur l’addition des vecteurs :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_45f0e10445954e96a.gif)\n\nNous voyons ici que le vecteur résultant est positionné exactement entre a et b. Il est souvent utile de connaître une moyenne entre plusieurs directions, à présent vous savez comment faire, il suffit d’additionner toutes ces directions entres elles.\n\n## La soustraction de vecteurs\n\nLa soustraction de vecteurs est utilisée pour connaître le vecteur qui va d’un point à un autre. Supposez que vous ayez les coordonnées dans l’espace de deux objets A et B, et que vous vouliez connaître le vecteur qui va de A vers B, ou de B vers A, il va vous falloir utiliser la soustraction de vecteurs.\n\nCa me servira à quoi de connaître le vecteur qui va de A vers B ?\n\nImaginez par exemple que vous vouliez programmer une animation fluide qui déplace l’objet A vers l’objet B, il vous faudra connaître la direction dans laquelle déplacer A, la soustraction de vecteurs est inévitable.\n\nVoici un schéma de base pour illustrer ce que nous recherchons :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_9b1d25760d014eaf8.gif)\n\nNous allons calculer le vecteur v en soustrayant A à B. Cela fonctionne exactement de la même façon que l’addition, rien de plus simple :\n\nv.x = B.x - A.x v.y = B.y - A.y\n\nCe qui revient à effectuer le calcul suivant :\n\nv.x = -2 - 3 v.y = 1 - 2\n\nNous obtenons le vecteur v(-5; -1). Si nous le traçons dans le plan, nous obtenons… ceci :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_9ab2680615e34561b.gif)\n\nHéé, c’est pas du tout ça !\n\nMais si, il suffit de placer l’origine du vecteur sur le point A et nous obtenons ce que nous cherchions.\n\n* * *\n\n## Longueur et normalisation\n\n## Une question de longueur\n\nAvant de voir ce qu’est la **normalisation** d’un vecteur, il nous faut d’abord voir ce qu’est sa **longueur** et ce qu’elle représente.\n\n### La longueur d’un vecteur, c’est quoi ?\n\nLa longueur d’un vecteur, c’est la distance qui sépare le point (0; 0) du point pointé par le vecteur dont on veut connaître la longueur. Lorsque nous dessinons ceci :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_7db73c6554c54e6cb.gif)\n\nIl est aisé de s’appercevoir que la longueur du vecteur v est de **1**. En revanche, la longueur d’un vecteur comme nous en avons vu tout à l’heure :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_f0a8f712d45045f19.gif)\n\nest moins évidente, il nous faut la calculer.\n\n### Calculer la longueur d’un vecteur\n\nVous connaîssez probablement Pythagore, ce Grec philosophe et mathématicien de l’antiquité ? Non ? Mais alors connaîssez-vous seulement son théorème ? Si vous ne le connaîssez pas, vous risquez d’avoir quelques difficultés à comprendre cette partie du chapitre.\n\nLa longueur d’un vecteur se calcule ainsi :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_f93afa7099b0476b9.gif)\n\nDans le cas d’un vecteur à 3 dimensions, le calcul est le même, il suffit de rajouter la composante z comme ceci :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_8eeb270d72b849799.gif)\n\nlongueur est égal à la longueur du vecteur v. Il est possible d’illustrer le calcul de la longueur de notre vecteur à deux dimensions v :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_d29e16361dd54ffbb.gif)\n\nNous remarquons ici la présence d’un triangle rectangle, sur lequel on a en fait tout simplement appliqué le théorème de Pythagore ;)\n\n## La normalisation\n\nLa normalisation d’un vecteur revient à donner une **norme** de **1** à sa longueur. Ce qui veut dire que la longueur d’un vecteur normalisé est toujours de **1**.\n\n### Représentation de la normalisation\n\nIl est possible d’illustrer la normalisation d’un vecteur par un simple schéma :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_b20a32530e914fe7a.gif)\n\nSoit 1 le rayon de ce cercle, tout vecteur partant du point (0; 0) et ayant une longueur de 1 touchera pile poil un endroit de la courbe de ce cercle.\n\nQuel est l’utilité de la normalisation ?\n\nL’utilité est difficile à démontrer pour l’instant, nous verrons cela plus bas lorsque nous parlerons du produit scalaire.\n\n### Calcul de la normalisation\n\nEffectuer une normalisation est très simple, surtout si l’on sait calculer la longueur d’un vecteur et qu’on a bien compris le principe de la normalisation.\n\nIl suffit en fait de diviser chaque composante du vecteur (x, y, z (si 3D)) par la longueur du vecteur, et nous obtenons un vecteur normalisé. Rappelez-vous du calcul de la longueur d’un vecteur, vu plus haut. Nous avons donc une valeur appelée longueur qui est la longueur de notre vecteur v. Puisque la normalisation d’un vecteur signifie qu’il faut diviser chaque composante du vecteur par la longueur du vecteur, le calcul s’effectue ainsi :\n\nv.x = v.x / longueur; v.y = v.y / longueur;\n\nIl faut bien sûr rajouter ce calcul :\n\nv.z = v.z / longueur;\n\nsi le vecteur est en 3D.\n\nNotez que pour un vecteur 4D (c’est-à-dire avec une composante w), la normalisation de ce dernier revient à diviser chacune de ses trois premières composantes par w au lieu de longueur.\n\nSi vous recalculez la longueur d’un vecteur normalisé, vous verrez que le résultat sera 1.\n\n### Une application pratique\n\nJe vous propose de voir une première utilisation pratique des vecteurs normalisés, car je suis sûr que vous vous demandez à quoi la normalisation peut servir.\n\nSouvenez-vous de notre schéma avec nos objets A et B, nous avions réussi à créer un vecteur qui allait de A vers B :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_9b1d25760d014eaf8.gif)\n\n*(notez qu’ici je n’ai pas dessiné le vecteur normalisé)*\n\nSupposons que nous normalisons ce vecteur et que nous l’appelons v.\n\nAvec la normalisation, on sait de combien on se déplace : on se déplace toujours de **1**. Supposons que vous ayez considéré en OpenGL que 1 = 1 mètre, alors vous êtes sûrs qu’en additionnant un vecteur normalisé à un point celui-ci se déplacera d’un mètre dans la direction indiquée par le vecteur.\n\nAinsi, en additionnant v à A, nous sommes sûrs et certains que A se déplacera d’un mètre dans la direction de B. Et si nous voulons qu’il se déplace d’un centimètre, comme nous avons un vecteur normalisé, nous n’aurons qu’à diviser celui-ci par 100 avant de l’additionner à A pour qu’il se déplace d’un centimètre.\n\nDiviser un vecteur par un réel quelconque revient à diviser chaque composante du vecteur par le réel en question, comme pour la normalisation, mais en remplaçant longueur par ce réel. Il en va de même pour la multiplication d’un vecteur par un réel, sauf que cette fois au lieu de diviser on multiplie.\n\nEt voilà, vous savez maintenant normaliser un vecteur et vous en servir pour une utilisation basique. Nous allons voir maintenant une technique de calcul qui nécessite obligatoirement des vecteurs normalisés : le produit scalaire.\n\n* * *\n\n## Le produit scalaire (dot product)\n\nLe produit scalaire se dit *dot product* en anglais. Vous avez peut-être déjà entendu parler du produit scalaire, mais savez-vous comment le calculer et surtout, à quoi il peut servir ? Non ? Et bien nous allons voir ça :)\n\n## Le produit scalaire comme calculateur d’angles\n\nEffectuer le produit scalaire de deux vecteurs, c’est connaître l’angle qu’il y a entre deux vecteurs. Voici un schéma qui illustre assez bien ce que nous voulons calculer :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_b7277dcdb3224bc19.gif)\n\nBon, là je vous l’accorde, l’angle se devine facilement. Mais il se devine seulement, car en programmation 3D il ne s’agit pas de deviner, il s’agit de calculer.\n\nSi nous prenons deux vecteurs, (3; 2; 5) et (0; 2; 1) par exemple, comment, à partir de ces données, pourriez-vous calculer l’angle qui sépare ces deux vecteurs ? Le produit scalaire sert à calculer cela.\n\nÇa marche aussi en 3D ?\n\nBien sûr ! sinon cela n’aurait aucun intérêt.\n\nNous supposerons par la suite que tous nos vecteurs sont normalisés.\n\n## Le calcul du produit scalaire\n\nEn supposant que vous ayez deux vecteurs, a et b, et que vous souhaitez connaître leur produit scalaire, le calcul est, pour des vecteurs 2D :\n\ndot = (a.x * b.x) + (a.y * b.y)\n\nEt en 3D, on rajoute la composante Z, aussi simplement que cela :\n\ndot = (a.x * b.x) + (a.y * b.y) + (a.z * b.z)\n\nEuh, c’est bien joli ce dot, mais c’est quoi ? C’est la valeur de l’angle ?\n\nNon, mais c’est le cosinus de l’angle.\n\nSi dot vaut **1**, les deux vecteurs pointent dans la même direction (0°). Si dot vaut **0**, alors les deux vecteurs pointent dans deux directions qui sont à angle droit (90°).\n\nEt donc logiquement, quand dot est entre 0 et 1, l’angle est compris entre 90° et 0°.\n\nMais moi je veux un angle en degrès précis, ça va me servir à quoi sinon ? Et que vaut dot quand les vecteurs sont séparés par plus de 90° ? Et puis à quoi ça sert de calculer le produit scalaire ?\n\nTout d’abord, pour obtenir l’angle, il suffit d’utiliser la simple fonction mathématique arc cosinus (cos-1() sur les calculatrices) sur notre valeur dot. Mais attention, arc cosinus ne fonctionne pas sur des nombres négatifs, et lorsque l’angle qui sépare deux vecteurs est supérieur à 90°, dot prend alors une valeur négative, et on ne peut alors plus calculer l’angle qui sépare nos vecteurs.\n\nMais rassurez-vous, en 3D cela sera inutile, nous nous contenterons de vérifier si dot se situe entre 0 et 1, sinon on considèrera sa valeur comme étant de 0.\n\nAh ouais, mais alors il sert à quoi ce produit scalaire ?\n\nPour vous répondre en quelques mots : à calculer le taux de reception de lumière d’un plan. Nous étudierons cela plus en détail lorsque nous apprendrons à gérer la lumière dans la 3eme partie du tutoriel.\n\nPour clore, retenez que :\n\n- Le produit scalaire sert à calculer l’angle entre deux vecteurs.\n    \n- Le produit scalaire ne fonctionne **que** sur des vecteurs normalisés !\n    \n\n* * *\n\n## Le produit vectoriel (cross product)\n\nLe produit vectoriel sert à calculer le vecteur perpendiculaire à deux autres vecteurs. Le produit vectoriel se dit *cross product* (produit croisé) en anglais, mais vous voudriez peut-être savoir à quoi cela sert avant d’apprendre à le calculer ? Pas de problème.\n\n## Notion de “normale” d’une face\n\nNous allons commencer simplement.\n\nToute face (surface plane) possède une **normale**. Prenons par exemple votre table de bureau, c’est une surface plane. Sa normale pointe pile poil vers le plafond (vers le haut).\n\nVoici comment schématiser la normale d’une face :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_ae9852d9b75e4915a.png)\n\nVoici un cube. J’ai dessiné (à l’aide de Blender) pour chaque face du cube, sa normale. Comme vous pouvez le voir, la normale d’une face plane est un vecteur qui est perpendiculaire à la face.\n\nQuel est le rapport avec le produit vectoriel ?\n\nEt bien le produit vectoriel permet de calculer cette normale, uniquement grâce aux positions des sommets qui la composent :)\n\n## Calcul du produit vectoriel\n\nIl est temps maintenant de représenter le produit vectoriel, ainsi que de montrer le calcul qu’il faut faire pour le trouver.\n\nLe calcul du produit vectoriel se fait à partir de deux vecteurs et permet d’obtenir un autre vecteur. Ce vecteur obtenu est perpendiculaire aux deux autres vecteurs… tout comme la normale d’une face est perpendiculaire à la face elle même.\n\nNous pouvons faire l’analogie avec le produit vectoriel et la normale d’une face. En effet, voyez plutôt ce schéma :\n\n![Image utilisateur](../../../_resources/uploads.siteduzero.com_files_690_c89a026e6f5b43558.gif)\n\nCette illustration résume assez bien tout ce que nous venons de voir :) Nous pouvons voir d’une part les vecteurs a et b, d’autre part le vecteur n, qui n’est autre que le résultat du produit vectoriel de a et b, en effet, n est perpendiculaire à a et b. Mais il est aussi perpendiculaire à la face, il représente donc sa normale.\n\nNous venons de voir qu’avec deux vecteurs qui longent les bords d’une face, nous pouvons obtenir la normale de cette face\n\nEt comment on les trouve ces vecteurs qui longent les bords de notre face ? (a et b)\n\nRevoyez la première partie de ce chapitre, et plus précisément l’endroit qui parle de la soustraction de vecteurs… vous devriez trouver assez aisément ;) Rappelez-vous que nous connaissons les positions des sommets qui constituent notre face.\n\nMais ça ne nous dit pas le plus important : comment on calcule ça ?\n\nOh ça, c’est le moins important, il s’agit d’une grosse formule barbare, l’important c’est de bien savoir ce que permet de faire le produit vectoriel.\n\nVoici le calcul du produit vectoriel :\n\nn.x = (a.y * b.z) - (a.z * b.y) n.y = (a.z * b.x) - (a.x * b.z) n.z = (a.x * b.y) - (a.y * b.x)\n\nNotez que si vous échangez les vecteurs a et b dans les calculs, le vecteur obtenu sera exactement le vecteur opposé à celui que vous auriez obtenu sans échanger a et b.\n\nMais alors comment connaître le bon ordre de calcul pour obtenir la bonne normale de notre face ?\n\nIl n’existe pas de méthode magique pour cela… Comment savoir quelle doit être la normale de votre face ? Il n’y a pas de “haut” en 3D, ni nulle part d’ailleurs, tout est relatif. Les sommets des triangles dans les maillages sont généralement donné dans un ordre conventionnel, ce qui permet de détermnier l’orientation de la face.\n\nLes vecteurs ne sont pas une notion simple à aborder, il est possible qu’il vous fasse du temps avant de vous y faire. Prenez le temps de relire tranquillement chaque passage de ce chapitre afin de vous familiariser avec les vecteurs, c’est essentiel croyez-moi, car nous les utiliserons en permanence par la suite. Il est donc important que vous vous sentiez à l’aise avec ceux-ci.\n\nPour finir, je vais vous renvoyer sur les articles de Wikipedia à propos de tout ce que nous avons appris, ça vaut toujours le coup d’oeil.\n\n- [Le vecteur.](http://fr.wikipedia.org/wiki/Vecteur)\n    \n- [Le produit scalaire.](http://fr.wikipedia.org/wiki/Produit_scalaire)\n    \n- [Le produit vectoriel.](http://fr.wikipedia.org/wiki/Produit_vectoriel)\n    \n\nEt voilà, c’est la fin de cette annexe, n’hésitez pas à venir la consulter régulièrement si vous vous sentez bloqué par la suite.\n\nMerci au site [www.developpez.com](http://www.developpez.com/) et aux membres de sa section programmation 3D, grâce auxquels j’ai acquis la plupart des mes connaissances actuelles en terme de programmation 3D.\n\nLes commentaires, critiques ou corrections sont les bienvenus. Si vous pensez avoir trouvé une incohérence ou si vous avez mal compris quelque chose, n’hésitez pas à m’en faire part, je serai heureux de pouvoir améliorer le tutoriel pour vous ;)\n\n*[![Image utilisateur](../../../_resources/88x31_f68b4c5b8aa1497ab41e05225e616157.png)](http://creativecommons.org/licenses/by-sa/2.0/fr/)Cette création est mise à disposition sous un [contrat Creative Commons](http://creativecommons.org/licenses/by-sa/2.0/fr/).*\n\n* * *","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Programmation-multi-paradigme/0.-Java-OOP":{"title":"0. Java OOP","content":"\n# Encapsulation\n\n## Definition\n\nWrapping the fields (state) and methods (behaviors) together as a single unit in a way that sensitive data are hidden from the users.\n\n### in the real word\nWith an ATM, we can perform operations like cash withdrawal, money transfer, balance checks. But only the account owner can perform those operations. So, all the operations are encapsulated inside an object for that particular account owner. And the only way to access data like the balance is by using the predefined operations such as balance checks.\n\n## Java\n\nUsing access modifiers like `private` and `protected` for class variables (fields) and providing getters and setters to access them if necessary.\n\n```\npublic class Person {\n    private String name; // using private access modifier\n\n    // Getter\n    public String getName() {\n      return name;\n    }\n\n    // Setter\n    public void setName(String newName) {\n      this.name = newName;\n    }\n} \n```\n\n## Why use encapsulation\n\n1.  **Data Hiding** \\- Data inside an encapsulated class can only be accessible inside the class or through a getter or a setter method.\n2.  **Flexibility** \\- We can make variables read-only or write-only by omitting the getter or setter of that variable\n3.  **Reusability**\n4.  **Easy to perform unit testing**\n\n# Inheritance\n\n## Definition\n\nA mechanism where an object of the subclass (child class), acquires all the properties (fields) and behaviors (methods) of an object of the superclass (parent class)\n\n## Java\n\nBy extending the child class to parent classes using `extends` or `implements` keywords.\n\n```\n// parent class\nclass Employee {\n    float salary = 100; // property of the parent class\n}\n\n// child class\nclass Programmer extends Employee {\n    float bonus = 30;\n}\n\n// My main class\nclass MyMainClass {\n    public static void main(String[] args) {\n        Programmer myVariable = new Programmer()\n        System.out.println(\"My salary is \" + myVariable.salary );\n        System.out.println(\"My bonus is \" + myVariable.bonus );\n    }\n} \n```\n\nThe result will be\n\n```\nMy salary is 100\nMy bonus is 30 \n```\n\nHere, `myVariable` object has access to the `salary` which belongs to the parent class even though `myVariable` is an object of the child class.\n\n## Why use inheritance\n\n- For code reusability\n- To take advantage of polymorphism\n\n# Polymorphism\n\n## Definition\n\nPerform a single action in different ways\n\n### in the real word\n\nA man can be a father, a husband, and an employee according to the situation he is in.\n\n### Java\n\nThere are two types of polymorphism in java\n\n1.  **Compile-time polymorphism** (Static polymorphism)\n2.  **Run-time polymorphism** (Dynamic polymorphism)\n\n## Compile-time polymorphism\n\nWhen **method overloading** is used, which method to call is resolved during the compile time by looking at the signature of the method invoke statement.\n\n### method overloading\n\nA feature that allows a class to have more than one method having the **same name** but with different signatures.\n\n### signature of a method\n\nThe signature of a method is determined by the **number of arguments**, **types of each argument**, and the **order of the arguments**. The return type of the method does not affect the signature.\n\n```\n// A class with multiple methods with the same name\npublic class Adder {\n    // method 1\n    public void add(int a, int b) {\n        System.out.println(a + b);\n    }\n\n    // method 2\n    public void add(int a, int b, int c) {\n        System.out.println(a + b + c);\n    }\n\n    // method 3\n    public void add(String a, String b) {\n        System.out.println(a + \" + \" + b);\n    }\n}\n\n// My main class\nclass MyMainClass {\n    public static void main(String[] args) {\n        Adder adder = new Adder(); // create a Adder object\n        adder.add(5, 4); // invoke method 1\n        adder.add(5, 4, 3); // invoke method 2\n        adder.add(\"5\", \"4\"); // invoke method 3\n    }\n} \n```\n\nThe result will be\n\n```\n9\n12\n5 + 4 \n```\n\n## Run-time polymorphism\n\nWhen **method overriding** and **upcasting** is used, which class’s method to call is resolved during the run-time.\n\n### method overriding\n\nProviding a specific implementation in the child class (subclass) of a method that already provided by one of its parent classes (super-classes). And also, the method in the subclass should have the **same signature** and the **same return type** for it to override the superclass method.\n\n### upcasting\n\nWhen the reference variable of the parent class is referring to an object of the child class, it is upcasting. In other words, casting an object of an individual type to one common type.\n\n### downcasting\n\nWhen the reference variable of the child class is referring to an object of the parent class, it is downcasting. In other words, casting an object of a common type to a narrower (special) type.\n\n### Real-life example of Upcasting \u0026 Downcasting\n\nAssume there are classes named, `Fruits` and `Apple`. And the `Apple` class is the child class of the `Fruits` class.\n\nIf we cast an object of the `Apple` class to `Fruits` type, it is Upcasting. If we cast an object of the `Fruits` class to `Apple` type, it is Downcasting\n\n## Remarks\n\n- Upcasting can be done directly in Java. But Downcasting cannot. We have to do the casting **explicitly**.\n- But we have to be careful not to downcast incompatible types. Unless it will throw an error.\n\n```\nclass Fruits {} // parent class\nclass Apple extends Fruits {} // child class\n\n// My main class\nclass MyMainClass {\n    public static void main(String[] args) {\n        Fruits upcastedVariable = new Apple() // upcasting (implicit casting)\n        Apple downcastedVariable = (Apple) upcastedVariable // downcasting (explicit casting)\n    }\n} \n```\n\nHere `upcastedVariable` can be downcasted into `Apple` because, even though `upcastedVariable` is `Fruit` type, it refers to an object of the `Apple` class.\n\n```\nclass Fruits {} // parent class\nclass Apple extends Fruits {} // child class\n\n// My main class\nclass MyMainClass {\n    public static void main(String[] args) {\n        Fruits myVariable = new Fruits()\n        Apple downcastedVariable = (Apple) myVariable // throws an error\n    }\n} \n```\n\nBut in the above example, `myVariable` is `Fruit` type as well as it refers to a `Fruit` object. Therefore when we downcast into the `Apple` type it will throw an error.\n\n```\n// parent class\nclass Bank {\n    public float getInterestRate() {\n        return 0\n    }\n}\n\n// child class - 1\nclass AwesomeBank extends Bank {\n    public float getInterestRate() { // superclass's method is overridden\n        return 8.4;\n    }\n}\n\n// child class - 2\nclass SuperBank extends Bank {\n    public float getInterestRate() { // superclass's method is overridden\n        return 9.6;\n    }\n}\n\n// child class - 3\nclass GovernmentBank extends Bank {} // superclass's method is not overridden\n\n// My main class\nclass MyMainClass {\n    public static void main(String[] args) {\n        Bank b = new Bank()\n        System.out.println(b.getInterestRate());\n        b = new AwesomeBank() // upcasting\n        System.out.println(b.getInterestRate());\n        b = new SuperBank() // upcasting\n        System.out.println(b.getInterestRate());\n        b = new GovernmentBank() // upcasting\n        System.out.println(b.getInterestRate());\n    }\n} \n```\n\nThe result will be\n\n```\n0\n8.4\n9.6\n0 \n```\n\nSince in `AwesomeBank` class the `getInterestRate()` method is not overridden, the method in the parent class will be called in the run-time.\n\n# Abstraction\n\n## Definition\n\nHiding certain details and showing only the essential information to the user. In other words, identifying only the required characteristics of an object ignoring the irrelevant details.\n\n## in the real word\n\nWith an ATM, we can perform operations like cash withdrawal, money transfer, balance checks, etc. But we can’t know the internal details about those operations, how they operate or likewise.\n\n## Java\n\nUsing either an `abstract class` or an `interface`\n\n### abstract class\n\nA class contains both abstract and regular methods.\n\n### abstract method\n\nA method without a body (i.e. no implementation). The implementation is provided by the subclass that inherits the abstract class\n\n```\n// abstract class\nabstract class Animal {\n    public abstract void animalSound(); // abstract method\n    public void sleep() {\n        System.out.println(\"Zzzzzz!\")\n    }\n} \n```\n\n## Remarks\n\n- `abstract` keyword is a non-access modifier, used for classes and methods.\n- You don’t have to implement (override) all methods of an abstract class. But you **must implement all the abstract methods** in it.\n- You cannot create objects from an abstract class\n- To access an abstract class you have to inherit (`extend`) it from another class\n- Fields in an abstract class should **not have to be** `public`, `static`, and `final`\n- You can have `public`, `private` or `protected` methods\n\n```\n// abstract class\nabstract class Animal {\n    public abstract void animalSound(); // abstract method\n    public void sleep() {\n        System.out.println(\"Zzzzzz!\")\n    }\n}\n\n// subclass (inherits the abstract class)\nclass Pig extends Animal {\n    public void AnimalSound() { // body of the abstract method is provided here\n        System.out.println(\"Wee Wee!\");\n    }\n}\n\n// My main class\nclass MyMainClass {\n    public static void main(String[] args) {\n        Pig myPig = new Pig(); // create a Pig object\n        myPig.animalSound();\n        myPig.sleep();\n    }\n} \n```\n\nThe results will be\n\n```\nWee Wee!\nZzzzzz! \n```\n\n## Why use Abstract classes\n\nTo have some methods to implement later. If you don’t use an abstract class, you have to implement the `AnimalSound()` method in the `Animal` class even if you inherit it from another class.\n\n# Interface\n\n## What is an interface\n\nA completely abstract class. In other words, all the methods in an interface should not have a body.\n\n```\n// interface\ninterface Animal {\n    public void animalSound(); // interface method\n    public void sleep(); // interface method\n} \n```\n\n## Remarks\n\n- You cannot create objects from an interface.\n- To access an interface you have to `implement` (kinda like inherit) it from another class.\n- You must override all the methods in an interface from a subclass.\n- All the fields in an interface are `public`, `static`, and `final`.\n- All the methods are `public`\n\n```\n// interface\ninterface Animal {\n    public void animalSound(); // interface method\n    public void sleep(); // interface method\n}\n\n// subclass (implemets the abstract class)\nclass Cat implements Animal {\n    public void AnimalSound() { // body of the interface method is provided here\n        System.out.println(\"Meow!\");\n    }\n    public void sleep() { // body of the interface method is provided here\n        System.out.println(\"Purrrrr!\");\n    }\n\n}\n\n// My main class\nclass MyMainClass {\n    public static void main(String[] args) {\n        Cat myCat = new Cat(); // create a Cat object\n        myCat.animalSound();\n        myCat.sleep();\n    }\n} \n```\n\nThe results will be\n\n```\nMeow!\nPurrrrr! \n```\n\n# Why use Interfaces?\n\n- To specify the behavior of a particular data\n- To achieve **multiple inheritance**.\n\n\u003e Java doesn’t support multiple inheritances. ( You can only inherit from a single superclass.) However, it can be achieved using interfaces.","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Programmation-multi-paradigme/1.-Introduction":{"title":"1. Introduction","content":"\n# Péocupation\n\n1.  **fonctionnalité**\n    - test\n    - compléxité\n2.  **Extensibilité**\n    - si je veux rajouter une fonctionnalité, est-ce que je dois tout modifier\n3.  **Modularité**\n    - si je modifie un fichier, est-ce que ca a une conséquence pour les autres fichiers ?réutilisation\n        - travail en équipe\n            \n        - limiter la diffusion des erreurs\n            \n        - cascades\n4.  **Réutilisabilité**\n    - duplication de code ?\n    - Documentation ?\n    - Qualité ?\n5.  Testabilité\n    - Facile à tester ?\n    - Certitude ?\n    - Couverture de test ?\n6.  Clarté\n    - La structure est facile à comprendre ?\n    - facile à expliquer ?\n    - simple à documenter ?\n\n* * *\n\n# Programmation impérative\n\n- Une séquence d’instruction change un état général\n- Détailler une suite d’instruction qui indique comment modifier des variables\n- Les variables contiennent les confitions de départ et leur évolution donne le résultat du programme\n\nDémarche : Trouver les structures de données et trouver une séquenec d’instruction qui modifie l’état\n\n## programmation structurée\n\n- Instruction de contrôle\n- Blocs de code\n\n## programmation procédurale\n\n\u003cimg src=\"../../../_resources/523e892d29eb8bea624fec7044e10162.png\" alt=\"523e892d29eb8bea624fec7044e10162.png\" width=\"257\" height=\"193\"\u003e\n\n## programmation modulaire\n\nmodules regroupant fonctions, structures de donnée, types, objets, etc.\n\nC++ / C / Java / PHP / Python / Ruby\n\n## Programmation évènementielle\n\n• Quand il se produit… Faire\n\n## Programmation séquentielle\n\n- Notion de bloc d’exécution\n- Région spécifique\n- Le sens de l’exécution est important =\u003e De gauche à droite et de haut en bas\n\nTrouver une erreur revient à faire des hypothèses et à les vérifier\n\n## POO\n\n- Une collection d'objet en **interaction** via des **méthodes**\n- Chaque objet est responsable de code\n- Chaque objet possède un état\n\n## Programmation par prototypes\n\n- Self / Javascript\n- Object sans (nécéssairement) classes\n\n## Programmation chimique\n\n- Gamma\n- Transformation de multi ensembles\n- Exemples\n- Map/reduce\n- On ne s'interesse pas au **comment**, mais au **quoi faire**\n\n# **Programmation déclarative**\n\nProlog, SQL\n\n# **Programmation par flots de données**\n\n- Définition de dépendances entre données\n\nExcel, Angular\n\n# Fonctionnel\n\n- Le résultat d’un programme c’est la transformation des données de départ\n    - Pas besoin de variables\n        \n    - pas besoin de mémoire\n        \n    - Distribution\n        \n    - Fiabilité\n\n# Récursif\n\n- Boucle impérative\n    - Parcourir explicitement chaque portion\n        \n    - Pas besoin de fonction\n        \n- Boucle récursive\n    - Utiliser une fonction\n        \n    - Faire une petite partie, puis recommencer avec le reste","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Programmation-multi-paradigme/2.-Java5":{"title":"2. Java5 ","content":"\n![65963a329acbbd9e2422b7ecfb217549.png](../../../_resources/65963a329acbbd9e2422b7ecfb217549.png)\n\n# Java 5 : Généricité\n\n- Méthode qui s’applique sur n’importe quel type\n    \n    - une méthode par type et par collection\n        - type primitifs\n        - objets\n        - Polymorphisme\n- ## collections\n    \n    - ### ArrayList contient des **Objects**\n        \n        ```Java\n        ist list = new ArrayList();\n        list.add(new Integer(2));\n        list.add(\"hello\");\n        ```\n        \n    - Retrouver le type par cast\n        \n        ```java\n        Integer a = (Integer) list.get(0);\n        String chaine = (String) list.get(1);\n        ```\n        \n\n## Généricité\n\nLe code devient plus générique il dépend moins du type Plus facile à maintenir ou à faire évoluer **Laissez définitivement tomber les tableaux et les boucles à indice**\n\n- - ### ArrayList de Strings\n        \n        - Un seul type pour la Collection\n            \n            ```java\n            List\u003cString\u003e chaines = new ArrayList\u003cString\u003e(); \n            chaines.add(\"bonjour\"); \n            String uneChaine = chaines.get(0);\n            ```\n            \n\n- - - - ### Itération\n                \n                ```java\n                List\u003cString\u003e chaines = new ArrayList\u003cString\u003e();\n                chaines.add(\"bonjour\");\n                for(String uneChaine : chaines){\n                    System.out.println(uneChaine);\n                }\n                ```\n                \n                PAS D’INDICE\n                \n            - ### Itérateurs :\n                \n                ```java\n                List\u003cString\u003e chaines = new ArrayList\u003cString\u003e();\n                chaines.add(\"bonjour\") ;\n                Iterator\u003cString\u003e iterateur = list.iterator();\n                while(iterateur.hasNext()){\n                    String uneChaine = iterateur.next();\n                    ...\n                }\n                ```\n                \n                - Outil (méthode) pour parcourir les éléments d’une collection\n                - pas d’indice\n                    - Indépendant de la représentation interne mémoire\n                    - **Ordre conservé ou pas**\n                    - **local ou pas**\n                    - parallèle ou pas\n                - très différent d’un parcours élément par élément\n\n## Créer une classe générique\n\n```java\npublic interface Paire\u003cK, V\u003e \n{\n    public K getClé();\n    public V getValeur();\n}\n\npublic class PaireOrdonnée\u003cK, V\u003e implements Paire\u003cK, V\u003e \n{\n    private K clé;\n    private V valeur;\n    \n    public PaireOrdonnée(K clé, V valeur) {\n        this.clé = clé;\n        this.valeur = valeur;\n    }\n    \n    public K getKey() { return clé; }\n    public V getValue() { return valeur; }\n    }\n```\n\n## Rajouter le mécanisme itérateur\n\n```java\npublic class MaCollection\u003cE\u003e implements Iterable\u003cE\u003e\n{\n    public Iterator\u003cE\u003e iterator() {\n        return new MonIterateur\u003cE\u003e();\n    }\n}\n\npublic class MonIterateur \u003cT\u003e implements Iterator\u003cT\u003e {\n    public boolean hasNext() {\n        ...\n    }\n    public T next() {\n        ...\n    }\n}\n```\n\n# Java 8","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Programmation-multi-paradigme/3.-JAVA-8":{"title":"3. JAVA 8","content":"\n# Lambda Expression\n\n```java\n(int a) -\u003e a * 2; // Calculate the double of a\na -\u003e a * 2; // or simply without type\n```\n\n```java\n(a, b) -\u003e a + b; // Sum of 2 parameters\n```\n\nIf the lambda is more than one expression we can use **{ }** and **return**\n\n```java\n(x, y) -\u003e {\n    int sum = x + y;\n    int avg = sum / 2;\n    return avg;\n}\n```\n\nA lambda expression cannot stand alone in Java, it need to be associated to a functional interface.\n\n```java\ninterface MyMath {\n    int getDoubleOf(int a);\n}\n    \nMyMath d = a -\u003e a * 2; // associated to the interface\nd.getDoubleOf(4); // is 8\n```\n\nAll examples with \"list\" use :\n\n```java\nList\u003cString\u003e list = [Bohr, Darwin, Galilei, Tesla, Einstein, Newton]\n```\n\n# Collections\n\n**sort** sort(list, comparator)\n\n```java\nlist.sort((a, b) -\u003e a.length() - b.length())\nlist.sort(Comparator.comparing(n -\u003e n.length())); // same\nlist.sort(Comparator.comparing(String::length)); // same\n//\u003e [Bohr, Tesla, Darwin, Newton, Galilei, Einstein]\n```\n\n**removeIf**\n\n```java\nlist.removeIf(w -\u003e w.length() \u003c 6);\n//\u003e [Darwin, Galilei, Einstein, Newton]\n```\n\n**merge** merge(key, value, remappingFunction)\n\n```java\nMap\u003cString, String\u003e names = new HashMap\u003c\u003e();\nnames.put(\"Albert\", \"Ein?\");\nnames.put(\"Marie\", \"Curie\");\nnames.put(\"Max\", \"Plank\");\n\n// Value \"Albert\" exists\n// {Marie=Curie, Max=Plank, Albert=Einstein}\nnames.merge(\"Albert\", \"stein\", (old, val) -\u003e old.substring(0, 3) + val);\n\n// Value \"Newname\" don't exists\n// {Marie=Curie, Newname=stein, Max=Plank, Albert=Einstein}\nnames.merge(\"Newname\", \"stein\", (old, val) -\u003e old.substring(0, 3) + val);\n```\n\n## Method Expressions `Class::staticMethod`\n\nAllows to reference methods (and constructors) without executing them\n\n```java\n// Lambda Form:\ngetPrimes(numbers, a -\u003e StaticMethod.isPrime(a));\n\n// Method Reference:\ngetPrimes(numbers, StaticMethod::isPrime);\n```\n\n| Method Reference | Lambda Form |\n| --- | --- |\n| StaticMethod::isPrime | n -\u003e StaticMethod.isPrime(n) |\n| String::toUpperCase | (String w) -\u003e w.toUpperCase() |\n| String::compareTo | (String s, String t) -\u003e s.compareTo(t) |\n| System.out::println | x -\u003e System.out.println(x) |\n| Double::new | n -\u003e new Double(n) |\n| String\\[\\]::new | (int n) -\u003e new String\\[n\\] |\n\n## Streams\n\nSimilar to collections, but\n\n- They don't store their own data\n- The data comes from elsewhere (collection, file, db, web, ...)\n- *immutable* (produce new streams)\n- *lazy* (only computes what is necessary !)\n\n```java\n// Will compute just 3 \"filter\"\nStream\u003cString\u003e longNames = list\n   .filter(n -\u003e n.length() \u003e 8)\n   .limit(3);\n```\n\n**Create a new stream**\n\n```java\nStream\u003cInteger\u003e stream = Stream.of(1, 2, 3, 5, 7, 11);\nStream\u003cString\u003e stream = Stream.of(\"Jazz\", \"Blues\", \"Rock\");\nStream\u003cString\u003e stream = Stream.of(myArray); // or from an array\nlist.stream(); // or from a list\n\n// Infinit stream [0; inf[\nStream\u003cInteger\u003e integers = Stream.iterate(0, n -\u003e n + 1);\n```\n\n**Collecting results**\n\n```java\n// Collect into an array (::new is the constructor reference)\nString[] myArray = stream.toArray(String[]::new);\n\n// Collect into a List or Set\nList\u003cString\u003e myList = stream.collect(Collectors.toList());\nSet\u003cString\u003e mySet = stream.collect(Collectors.toSet());\n\n// Collect into a String\nString str = list.collect(Collectors.joining(\", \"));\n```\n\n**map** `map(mapper)`\nApplying a function to each element\n\n```java\n// Apply \"toLowerCase\" for each element\nres = stream.map(w -\u003e w.toLowerCase());\nres = stream.map(String::toLowerCase);\n//\u003e bohr darwin galilei tesla einstein newton\n\nres = Stream.of(1,2,3,4,5).map(x -\u003e x + 1);\n//\u003e 2 3 4 5 6\n```\n\n**filter** `filter(predicate)`\nRetains elements that match the predicate\n\n```java\n// Filter elements that begin with \"E\"\nres = stream.filter(n -\u003e n.substring(0, 1).equals(\"E\"));\n//\u003e Einstein\n\nres = Stream.of(1,2,3,4,5).filter(x -\u003e x \u003c 3);\n//\u003e 1 2\n```\n\n**reduce**\nReduce the elements to a single value\n\n```java\nString reduced = stream\n    .reduce(\"\", (acc, el) -\u003e acc + \"|\" + el);\n//\u003e |Bohr|Darwin|Galilei|Tesla|Einstein|Newton\n```\n\n**limit** `limit(maxSize)` The n first elements\n\n```java\nres = stream.limit(3);\n//\u003e Bohr Darwin Galilei\n```\n\n**skip** Discarding the first n elements\n\n```java\nres = strem.skip(2); // skip Bohr and Darwin\n//\u003e Galilei Tesla Einstein Newton\n```\n\n**distinct** Remove duplicated elemetns\n\n```java\nres = Stream.of(1,0,0,1,0,1).distinct();\n//\u003e 1 0\n```\n\n**sorted** Sort elements (must be *Comparable*)\n\n```java\nres = stream.sorted();\n//\u003e Bohr Darwin Einstein Galilei Newton Tesla \n```\n\n**allMatch**\n\n```java\n// Check if there is a \"e\" in each elements\nboolean res = words.allMatch(n -\u003e n.contains(\"e\"));\n```\n\nanyMatch: Check if there is a \"e\" in an element\nnoneMatch: Check if there is no \"e\" in elements\n\n**parallel** Returns an equivalent stream that is parallel\n\n**findAny** faster than findFirst on parallel streams\n\n### Primitive-Type Streams\n\nWrappers (like Stream) are inefficients. It requires a lot of unboxing and boxing for each element. Better to use `IntStream`, `DoubleStream`, etc.\n\n**Creation**\n\n```java\nIntStream stream = IntStream.of(1, 2, 3, 5, 7);\nstream = IntStream.of(myArray); // from an array\nstream = IntStream.range(5, 80); // range from 5 to 80\n\nRandom gen = new Random();\nIntStream rand = gen(1, 9); // stream of randoms\n```\n\nUse *mapToX* (mapToObj, mapToDouble, etc.) if the function yields Object, double, etc. values.\n\n### Grouping Results\n\n**Collectors.groupingBy**\n\n```java\n// Groupe by length\nMap\u003cInteger, List\u003cString\u003e\u003e groups = stream\n    .collect(Collectors.groupingBy(w -\u003e w.length()));\n//\u003e 4=[Bohr], 5=[Tesla], 6=[Darwin, Newton], ...\n```\n\n**Collectors.toSet**\n\n```java\n// Same as before but with Set\n... Collectors.groupingBy(\n    w -\u003e w.substring(0, 1), Collectors.toSet()) ...\n```\n\n**Collectors.counting** Count the number of values in a group\n\n**Collectors.summing__** `summingInt`, `summingLong`, `summingDouble` to sum group values\n\n**Collectors.averaging__** `averagingInt`, `averagingLong`, ...\n\n```java\n// Average length of each element of a group\nCollectors.averagingInt(String::length)\n```\n\n*PS*: Don't forget Optional (like `Map\u003cT, Optional\u003cT\u003e\u003e`) with some Collection methods (like `Collectors.maxBy`).\n\n### Parallel Streams\n\n**Creation**\n\n```java\nStream\u003cString\u003e parStream = list.parallelStream();\nStream\u003cString\u003e parStream = Stream.of(myArray).parallel();\n```\n\n**unordered** Can speed up the `limit` or `distinct`\n\n```java\nstream.parallelStream().unordered().distinct();\n```\n\n*PS*: Work with the streams library. Eg. use `filter(x -\u003e x.length() \u003c 9)` instead of a `forEach` with an `if`.\n\n## Optional\n\nIn Java, it is common to use null to denote absence of result. Problems when no checks: `NullPointerException`.\n\n```java\n// Optional\u003cString\u003e contains a string or nothing\nOptional\u003cString\u003e res = stream\n   .filter(w -\u003e w.length() \u003e 10)\n   .findFirst();\n\n// length of the value or \"\" if nothing\nint length = res.orElse(\"\").length();\n\n// run the lambda if there is a value\nres.ifPresent(v -\u003e results.add(v));\n```\n\nReturn an Optional\n\n```java\nOptional\u003cDouble\u003e squareRoot(double x) {\n   if (x \u003e= 0) { return Optional.of(Math.sqrt(x)); }\n   else { return Optional.empty(); }\n}\n```\n\n* * *\n\n**Note on inferance limitations**\n\n```java\ninterface Pair\u003cA, B\u003e {\n    A first();\n    B second();\n}\n```\n\nA steam of type `Stream\u003cPair\u003cString, Long\u003e\u003e` :\n\n- `stream.sorted(Comparator.comparing(Pair::first)) // ok`\n- `stream.sorted(Comparator.comparing(Pair::first).thenComparing(Pair::second)) // dont work`\n\nJava cannot infer type for the `.comparing(Pair::first)` part and fallback to Object, on which `Pair::first` cannot be applied.\n\nThe required type for the whole expression cannot be propagated through the method call (`.thenComparing`) and used to infer type of the first part.\n\nType *must* be given explicitly.\n\n```java\nstream.sorted(\n    Comparator.\u003cPair\u003cString, Long\u003e, String\u003ecomparing(Pair::first)\n    .thenComparing(Pair::second)\n) // ok\n```\n\n* * *\n\nThis cheat sheet was based on the lecture of Cay Horstmann http://horstmann.com/heig-vd/spring2015/poo/","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Programmation-multi-paradigme/Java-Versions-and-Features":{"title":"Java Versions and Features","content":"\n| Version | Year | Features added |     |\n| --- | --- | --- | --- |\n| JDK Beta | 1995 |     |     |\n| JDK 1.0 | January 1996 |     |     |\n| JDK 1.1 | February 1997 | AWT, JDBC, RMI, JIT |     |\n| J2SE 1.2 | December 1998 | Swing, Collections |     |\n| J2SE 1.3 | May 2000 | Hotspot JVM, JNDI, JPDA |     |\n| J2SE 1.4 | February 2002 | Regular Expressions, Non blocking I/O, JAXP, Exception Handeling |     |\n| J2SE 5.0 | September 2004 | Generics, Enumaration, static imports, Varargs, for each, Auto boxing |     |\n| Java SE 6 | December 2006 | JAX-WS, JDBC 4, Supports Annotations, JAXB 2.0, compiler level performance |     |\n| Java SE 7 | July 2011 | Strings in switch, Concurrency utilities, java.nio packages |     |\n| Java SE 8 | March 2014 | lambda expressions, functional interfaces, new Date api, Streams, JavaFX |     |\n| Java SE 9 | September 2017 | Modularization, jshell, Reactive Streams |     |\n| Java SE 10 | March 2018 | Local-variable type inference, Java-based JIT compiler, Parallel full GC for G1, Thread-local handshakes, Heap allocation on alternative memory devices |     |\n| Java SE 11 | September 2018 | Dynamic class-file constants, Epsilon: a no-op garbage collector, Local-variable syntax for lambda parameters, HTTP client |     |\n| Java SE 12 | March 2019 | Switch Expressions, Default CDS archives, Microbenchmark, |     |\n\n## Java 17 Features\n\n**Java 17** was released on September 14, 2021. Java 17 is an LTS (Long Term Support) release, like Java 11 and Java 8. [Spring 6 and Spring boot 3](https://www.infoq.com/news/2021/09/spring-6-spring-boot-3-overhaul/) will have first-class support for Java 17. So it is a good idea to plan for upgrading to Java 17.\n\nThe below listed 14 JEPs are part of Java 17.\n\n- ([JEP-306](https://openjdk.java.net/jeps/306)) Restore Always-Strict Floating-Point Semantics\n- ([JEP-356](https://openjdk.java.net/jeps/356)) Enhanced Pseudo-Random Number Generators\n- ([JEP-382](https://openjdk.java.net/jeps/382)) New macOS Rendering Pipeline\n- ([JEP-391](https://openjdk.java.net/jeps/391)) macOS/AArch64 Port\n- ([JEP-398](https://openjdk.java.net/jeps/398)) Deprecate the Applet API for Removal\n- ([JEP-403](https://openjdk.java.net/jeps/403)) Strongly Encapsulate JDK Internals\n- ([JEP-406](https://openjdk.java.net/jeps/406)) Pattern Matching for switch (Preview)\n- ([JEP-407](https://openjdk.java.net/jeps/407)) Remove RMI Activation\n- ([JEP-409](https://openjdk.java.net/jeps/409)) Sealed Classes\n- ([JEP-410](https://openjdk.java.net/jeps/410)) Remove the Experimental AOT and JIT Compiler\n- ([JEP-411](https://openjdk.java.net/jeps/411)) Deprecate the Security Manager for Removal\n- ([JEP-412](https://openjdk.java.net/jeps/412)) Foreign Function \u0026 Memory API (Incubator)\n- ([JEP-414](https://openjdk.java.net/jeps/414)) Vector API (Second Incubator)\n- ([JEP-415](https://openjdk.java.net/jeps/415)) Context-Specific Deserialization Filters\n\n## Java 16 Features\n\nJava 16 was released on 16 March 20121. It was largely a maintenance release, except it made the *Java Records* and *Pattern matching* the standard features of Java language.\n\n- [JEP 338: Vector API (Incubator)](https://mkyong.com/java/what-is-new-in-java-16/#jep-338-vector-api-incubator)\n- [JEP 347: Enable C++14 Language Features](https://mkyong.com/java/what-is-new-in-java-16/#jep-347enable-c14-language-features)\n- [JEP 357: Migrate from Mercurial to Git](https://mkyong.com/java/what-is-new-in-java-16/#jep-357-migrate-from-mercurial-to-git)\n- [JEP 369: Migrate to GitHub](https://mkyong.com/java/what-is-new-in-java-16/#jep-369-migrate-to-github)\n- [JEP 376: ZGC: Concurrent Thread-Stack Processing](https://mkyong.com/java/what-is-new-in-java-16/#jep-376-zgc-concurrent-thread-stack-processing)\n- [JEP 380: Unix-Domain Socket Channels](https://mkyong.com/java/what-is-new-in-java-16/#jep-380-unix-domain-socket-channels)\n- [JEP 386: Alpine Linux Port](https://mkyong.com/java/what-is-new-in-java-16/#jep-386-alpine-linux-port)\n- [JEP 387: Elastic Metaspace](https://mkyong.com/java/what-is-new-in-java-16/#jep-387-elastic-metaspace)\n- [JEP 388: Windows/AArch64 Port](https://mkyong.com/java/what-is-new-in-java-16/#jep-388-windowsaarch64-port)\n- [JEP 389: Foreign Linker API (Incubator)](https://mkyong.com/java/what-is-new-in-java-16/#jep-389-foreign-linker-api-incubator)\n- [JEP 390: Warnings for Value-Based Classes](https://mkyong.com/java/what-is-new-in-java-16/#jep-390-warnings-for-value-based-classes)\n- [JEP 392: Packaging Tool](https://mkyong.com/java/what-is-new-in-java-16/#jep-392-packaging-tool)\n- [JEP 393: Foreign-Memory Access API (Third Incubator)](https://mkyong.com/java/what-is-new-in-java-16/#jep-393-foreign-memory-access-api-third-incubator)\n- [JEP 394: Pattern Matching for instanceof](https://mkyong.com/java/what-is-new-in-java-16/#jep-394-pattern-matching-for-instanceof)\n- [JEP 395: Records](https://mkyong.com/java/what-is-new-in-java-16/#jep-395-records)\n- [JEP 396: Strongly Encapsulate JDK Internals by Default](https://mkyong.com/java/what-is-new-in-java-16/#jep-396-strongly-encapsulate-jdk-internals-by-default)\n- [JEP 397: Sealed Classes (Second Preview)](https://mkyong.com/java/what-is-new-in-java-16/#jep-397-sealed-classes-second-preview)\n\n## Java 15 Features\n\nJava 15 was released on 15th Sep’2020. It continues support for various preview features in previous JDK releases; and also introduced some new features.\n\n- [Sealed Classes and Interfaces](https://howtodoinjava.com/java15/sealed-classes-interfaces/) (Preview) (JEP 360)\n- [EdDSA Algorithm](https://howtodoinjava.com/java15/java-eddsa-example/) (JEP 339)\n- Hidden Classes (JEP 371)\n- [Pattern Matching for *instanceof*](https://howtodoinjava.com/java14/pattern-matching-instanceof/) (Second Preview) (JEP 375)\n- Removed Nashorn JavaScript Engine (JEP 372)\n- Reimplement the Legacy DatagramSocket API (JEP 373)\n- Records (Second Preview) (JEP 384)\n- Text Blocks become a standard feature. (JEP 378)\n\n## Java 14 Features\n\n[Java 14](https://howtodoinjava.com/java14/java14-new-features/) (released on March 17, 2020) is the latest version available for JDK. Let’s see the new features and improvements, it brings for developers and architects.\n\n- [JEP 305 – Pattern Matching for instanceof (Preview)](https://howtodoinjava.com/java14/pattern-matching-instanceof/)\n- [JEP 368 – Text Blocks (Second Preview)](https://howtodoinjava.com/java14/java-text-blocks/)\n- [JEP 358 – Helpful NullPointerExceptions](https://howtodoinjava.com/java14/helpful-nullpointerexception/)\n- [JEP 359 – Records (Preview)](https://howtodoinjava.com/java14/java-14-record-type/)\n- [JEP 361 – Switch Expressions (Standard)](https://howtodoinjava.com/java14/switch-expressions/)\n- JEP 343 – Packaging Tool (Incubator)\n- JEP 345 – NUMA-Aware Memory Allocation for G1\n- JEP 349 – JFR Event Streaming\n- JEP 352 – Non-Volatile Mapped Byte Buffers\n- JEP 363 – Remove the Concurrent Mark Sweep (CMS) Garbage Collector\n- JEP 367 – Remove the Pack200 Tools and API\n- JEP 370 – Foreign-Memory Access API (Incubator)\n\n## Java 13 Features\n\nJava 13 (released on September 17, 2019) had fewer developer-specific features. Let’s see the new features and improvements, it brought for developers and architects.\n\n- JEP 355 – Text Blocks (Preview)\n- JEP 354 – Switch Expressions Enhancements (Preview)\n- JEP 353 – Reimplement the Legacy Socket API\n- JEP 350 – Dynamic CDS Archive\n- JEP 351 – ZGC: Uncommit Unused Memory\n- FileSystems.newFileSystem() Method\n- DOM and SAX Factories with Namespace Support\n\n## Java 12 Features\n\n[Java 12](https://howtodoinjava.com/java12/new-features-enhancements/) was released on March 19, 2019. Let’s see the new features and improvements, it brings for developers and architects.\n\n- Collectors.teeing() in Stream API\n- String API Changes\n- Files.mismatch(Path, Path)\n- Compact Number Formatting\n- Support for Unicode 11\n- Switch Expressions (Preview)\n\n## Java 11 Features\n\n[Java 11](https://howtodoinjava.com/java11/features-enhancements/) (released on September 2018) includes many important and useful updates. Let’s see the new features and improvements, it brings for developers and architects.\n\n- HTTP Client API\n- Launch Single-File Programs Without Compilation\n- String API Changes\n- Collection.toArray(IntFunction)\n- Files.readString() and Files.writeString()\n- Optional.isEmpty()\n\n## Java 10 Features\n\nAfter Java 9 release, Java 10 came very quickly. Unlike it’s previous release, Java 10 does not have that many exciting features, still, it has [few important updates](https://howtodoinjava.com/java10/java10-features/) which will change the way you code, and other future Java versions.\n\n- [JEP 286: Local Variable Type Inference](https://howtodoinjava.com/java10/var-local-variable-type-inference/)\n- JEP 322: Time-Based Release Versioning\n- JEP 304: Garbage-Collector Interface\n- JEP 307: Parallel Full GC for G1\n- JEP 316: Heap Allocation on Alternative Memory Devices\n- JEP 296: Consolidate the JDK Forest into a Single Repository\n- JEP 310: Application Class-Data Sharing\n- JEP 314: Additional Unicode Language-Tag Extensions\n- JEP 319: Root Certificates\n- JEP 317: Experimental Java-Based JIT Compiler\n- JEP 312: Thread-Local Handshakes\n- JEP 313: Remove the Native-Header Generation Tool\n- New Added APIs and Options\n- Removed APIs and Options\n\n## Java 9 Features\n\nJava 9 was made available on `September, 2017`. The biggest change is the modularization i.e. Java modules.\n\nSome important features/[changes in Java 9](https://howtodoinjava.com/java9/java9-new-features-enhancements/) are:\n\n- [Java platform module system](https://howtodoinjava.com/java9/java-9-modules-tutorial/)\n- [Interface Private Methods](https://howtodoinjava.com/java9/java9-private-interface-methods/)\n- HTTP 2 Client\n- JShell – REPL Tool\n- Platform and JVM Logging\n- Process API Updates\n- Collection API Updates\n- [Improvements in Stream API](https://howtodoinjava.com/java9/stream-api-improvements/)\n- Multi-Release JAR Files\n- @Deprecated Tag Changes\n- Stack Walking\n- Java Docs Updates\n- Miscellaneous Other Features\n\nPlease see the updated release info [here](https://openjdk.java.net/projects/jdk9/).\n\n## Java 8 Features\n\n**Release Date** : `March 18, 2014`\n\nCode name culture is dropped. Included features were:\n\n- [Lambda expression](https://howtodoinjava.com/java8/lambda-expressions/) support in APIs\n- [Stream API](https://howtodoinjava.com/java8/java-streams-by-examples/)\n- [Functional interface](https://howtodoinjava.com/java8/functional-interface-tutorial/) and [default methods](https://howtodoinjava.com/java8/default-methods-in-java-8/)\n- [Optionals](https://howtodoinjava.com/java8/java-8-optionals-complete-reference/)\n- Nashorn – JavaScript runtime which allows developers to embed JavaScript code within applications\n- Annotation on Java Types\n- [Unsigned Integer Arithmetic](https://howtodoinjava.com/java8/java-8-exact-airthmetic-operations-supported-in-math-class/)\n- Repeating annotations\n- [New Date and Time API](https://howtodoinjava.com/java8/date-and-time-api-changes-in-java-8-lambda/)\n- Statically-linked JNI libraries\n- Launch JavaFX applications from jar files\n- Remove the permanent generation from GC\n\n## Java SE 7 Features\n\n**Release Date** : `July 28, 2011`\n\nThis release was called “Dolphin”. Included features were:\n\n- JVM support for dynamic languages\n- Compressed 64-bit pointers\n- [Strings in switch](https://howtodoinjava.com/java7/strings-in-switch-statement/)\n- [Automatic resource management in try-statement](https://howtodoinjava.com/java7/try-with-resources/)\n- [The diamond operator](https://howtodoinjava.com/java7/improved-type-inference-in-java-7/)\n- Simplified varargs method declaration\n- Binary integer literals\n- [Underscores in numeric literals](https://howtodoinjava.com/java7/improved-formatted-numbers-in-java-7/)\n- [Improved exception handling](https://howtodoinjava.com/java7/improved-exception-handling/)\n- [ForkJoin Framework](https://howtodoinjava.com/java7/forkjoin-framework-tutorial-forkjoinpool-example/)\n- [NIO 2.0](https://howtodoinjava.com/java/nio/nio-read-file/) having support for multiple file systems, file metadata and symbolic links\n- [WatchService](https://howtodoinjava.com/java7/auto-reload-of-configuration-when-any-change-happen/)\n- Timsort is used to sort collections and arrays of objects instead of merge sort\n- APIs for the graphics features\n- Support for new network protocols, including SCTP and Sockets Direct Protocol\n\n## Java SE 6 Features\n\n**Release Date** : `December 11, 2006`\n\nThis release was called “Mustang”. Sun dropped the “.0” from the version number and version became Java SE 6. Included features were:\n\n- Scripting Language Support\n- Performance improvements\n- JAX-WS\n- JDBC 4.0\n- Java Compiler API\n- JAXB 2.0 and StAX parser\n- Pluggable annotations\n- New GC algorithms\n\n## J2SE 5.0 Features\n\n**Release Date** : `September 30, 2004`\n\nThis release was called “Tiger”. Most of the features, which are asked in java interviews, were added in this release.\n\nVersion was also called 5.0 rather than 1.5. Included features are listed down below:\n\n- [Generics](https://howtodoinjava.com/java/generics/complete-java-generics-tutorial/)\n- [Annotations](https://howtodoinjava.com/java/annotations/complete-java-annotations-tutorial/)\n- Autoboxing/unboxing\n- [Enumerations](https://howtodoinjava.com/java/enum/enum-tutorial/)\n- Varargs\n- [Enhanced `for each` loop](https://howtodoinjava.com/java/flow-control/enhanced-for-each-loop-in-java/)\n- [Static imports](https://howtodoinjava.com/java/basics/static-import-declarations-in-java/)\n- New [concurrency utilities](https://howtodoinjava.com/java/multi-threading/executor-framework-tutorial/) in `java.util.concurrent`\n- `Scanner` class for parsing data from various input streams and buffers.\n\n## J2SE 1.4 Features\n\n**Release Date** : `February 6, 2002`\n\nThis release was called “Merlin”. Included features were:\n\n- `[assert](https://howtodoinjava.com/java/keywords/java-assert/)` keyword\n- [Regular expressions](https://howtodoinjava.com/java-regular-expression-tutorials/)\n- Exception chaining\n- Internet Protocol version 6 (IPv6) support\n- [New I/O; NIO](https://howtodoinjava.com/java-nio-tutorials/)\n- Logging API\n- Image I/O API\n- Integrated XML parser and XSLT processor (JAXP)\n- Integrated security and cryptography extensions (JCE, JSSE, JAAS)\n- Java Web Start\n- Preferences API (java.util.prefs)\n\n## J2SE 1.3 Features\n\n**Release Date** : `May 8, 2000`\n\nThis release was called “Kestrel”. Included features were:\n\n- HotSpot JVM\n- Java Naming and Directory Interface (JNDI)\n- Java Platform Debugger Architecture (JPDA)\n- JavaSound\n- Synthetic proxy classes\n\n## J2SE 1.2 Features\n\n**Release Date** : `December 8, 1998`\n\nThis release was called “Playground”. This was a major release in terms of number of classes added (almost trippled the size). “J2SE” term was introduced to distinguish the code platform from J2EE and J2ME. Included features were:\n\n- `strictfp` keyword\n- Swing graphical API\n- Sun’s JVM was equipped with a JIT compiler for the first time\n- Java plug-in\n- [Collections framework](https://howtodoinjava.com/java/collections/useful-java-collection-interview-questions/)\n\n## JDK 1 Features\n\n**Release Date** : `January 23, 1996`\n\nThis was the [initial release](https://web.archive.org/web/20080205101616/http://www.sun.com/smi/Press/sunflash/1996-01/sunflash.960123.10561.xml) and was originally called **Oak**. This had very unstable APIs and one java web browser named **WebRunner**.\n\nThe first stable version, JDK 1.0.2, was called Java 1.\n\nOn February 19, 1997, JDK 1.1 was released havind a list of big features such as:\n\n- AWT event model\n- Inner classes\n- JavaBeans\n- JDBC\n- RMI\n- [Reflection](https://howtodoinjava.com/java/reflection/real-usage-examples-of-reflection-in-java/) which supported Introspection only, no modification at runtime was possible.\n- JIT (Just In Time) compiler for Windows\n\nAgain, feel free to suggest any **java feature in any java version** which I missed in the above lists.\n\nHappy Learning !!\n\n### Was this post helpful?\n\nLet us know if you liked the post. That’s the only way we can improve.\n\n### Join 7000+ Fellow Programmers\n\nSubscribe to get new post notifications, industry updates, best practices, and much more. Directly into your inbox, for free.\n\n[Subscribe](https://howtodoinjava.com/sendyemails/subscription?f=3qgnusD4fwgMrE1qTMFqStUuFXrFXRMyRQm7C1HVsXueiiFLgewivqQTeeksQPgQ)\n\n### 7 thoughts on “Java Latest Versions and Features”\n\n1.  Ivaylo\n    \n    [July 19, 2019 at 9:01 pm](https://howtodoinjava.com/java-version-wise-features-history/#comment-56076)\n    \n    Stream API was introduced in Java 8.\n    \n    https://www.google.com/search?q=java+stream+api+when+was+it+introduced\u0026rlz=1C1CHBF_enBG856BG856\u0026oq=java+stream+api\u0026aqs=chrome.0.69i59j69i57j0l4.3450j0j7\u0026sourceid=chrome\u0026ie=UTF-8\n    \n    - [Lokesh Gupta](https://howtodoinjava.com/)\n        \n        [July 20, 2019 at 11:25 pm](https://howtodoinjava.com/java-version-wise-features-history/#comment-56171)\n        \n        That’s true. The Java 9 link discusses about improvements added, later.\n        \n2.  suresh\n    \n    [October 31, 2017 at 12:01 pm](https://howtodoinjava.com/java-version-wise-features-history/#comment-26637)\n    \n    Stream API introduced in jdk8 is missed\n    \n3.  Anil kumar\n    \n    [July 7, 2017 at 3:32 pm](https://howtodoinjava.com/java-version-wise-features-history/#comment-25763)\n    \n    Hi Lokesh,\n    \n    java version 9 release is postponed to 27th September 2017. You wrongly mentioned the year.\n    \n    - [Lokesh Gupta](https://howtodoinjava.com/)\n        \n        [July 9, 2017 at 1:05 pm](https://howtodoinjava.com/java-version-wise-features-history/#comment-25785)\n        \n        Hi Anil, I missed to update the article. In fact, release date has been pushed many times.. so I have added link to release calendar as well, in case there are more changes.\n        \n4.  Varun T\n    \n    [June 16, 2017 at 8:51 am](https://howtodoinjava.com/java-version-wise-features-history/#comment-25547)\n    \n    Java 7 is named as Project Coin\n    \n    - [Lokesh Gupta](https://howtodoinjava.com/)\n        \n        [June 16, 2017 at 9:03 am](https://howtodoinjava.com/java-version-wise-features-history/#comment-25548)\n        \n        Hi Varun, Appreciate your comment. I am referring to [wiki](https://en.wikipedia.org/wiki/Java_version_history#Java_SE_7) which can be wrong, Can you please point to any credible source of information?\n        \n\nComments are closed.\n\nSearch for:\n\n#### HowToDoInJava\n\nA blog about Java and its related technologies, the best practices, algorithms, interview questions, scripting languages, and Python.\n\n#### Recommended\n\n[10 Life Lessons](https://howtodoinjava.com/resources/10-life-lessons-i-have-learned-in-last-few-years/)\n\n[Secure Hash Algorithms](https://howtodoinjava.com/java/java-security/how-to-generate-secure-password-hash-md5-sha-pbkdf2-bcrypt-examples/)\n\n[Best Way to Learn Java](https://howtodoinjava.com/resources/best-way-to-learn-java/)\n\n[How to Start New Blog](https://howtodoinjava.com/start-new-blog/)\n\n#### Meta Links\n\n[About Me](https://howtodoinjava.com/about/)\n\n[Contact Us](https://howtodoinjava.com/contact/)\n\n[Privacy policy](https://howtodoinjava.com/privacy-policy/)\n\n[Advertise](https://howtodoinjava.com/advertise/)\n\n[Guest Posts](https://howtodoinjava.com/guest-and-sponsored-posts/)\n\n[Full Archive](https://howtodoinjava.com/full-yearly-archive/)\n\n#### Blogs\n\n[REST API Tutorial](http://restfulapi.net/)\n\nCopyright © 2021 · Hosted on [Bluehost](https://www.bluehost.com/track/howtodp5/) · [Sitemap](https://howtodoinjava.com/sitemap.xml)\n\n## Learn Java\n\n- [Java Date Time](https://howtodoinjava.com/java-date-and-time-apis/)\n- [Java Collections](https://howtodoinjava.com/java-collections/)\n- [Java Concurrency](https://howtodoinjava.com/java-concurrency-tutorial/)\n- [Java New I/O](https://howtodoinjava.com/java-nio-tutorials/)\n- [Java OOP](https://howtodoinjava.com/java/oops/object-oriented-programming/)\n- [Java Regex](https://howtodoinjava.com/java-regular-expression-tutorials/)\n- [Java Puzzles](https://howtodoinjava.com/java-interview-puzzles-answers/)\n- [Java Examples](https://howtodoinjava.com/java-examples/examples/)\n- [Java Libraries](https://howtodoinjava.com/java/library/readingwriting-excel-files-in-java-poi-tutorial/)\n- [Java Resources](https://howtodoinjava.com/resources/)\n- [Java 8](https://howtodoinjava.com/java-8-tutorial/)\n- [Hibernate](https://howtodoinjava.com/hibernate-tutorials/)\n- [JUnit 5](https://howtodoinjava.com/junit-5-tutorial/)\n- [Log4j2](https://howtodoinjava.com/log4j2-tutorial/)\n- [Maven](https://howtodoinjava.com/maven/)\n- [TypeScript](https://howtodoinjava.com/typescript/typescript-tutorial/)","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Programmation-multi-paradigme/Modern-Java":{"title":"Modern Java","content":"\n## Resources\n\n- [Java 8 Javadoc](https://docs.oracle.com/javase/8/docs/api/overview-summary.html)\n- [Java SE8 for the Really Impatient: A Short Course on the Basics](http://horstmann.com/java8/) by Cay S. Horstmann\n- [Java 8 in Action: Lambdas, streams, and functional-style programming](https://www.manning.com/books/java-8-in-action) by Raoul-Gabriel Urma, Mario Fusco, and Alan Mycroft\n- http://horstmann.com/heig-vd/spring2015/poo/\n\n## Java 8 Optional\n\nOptional is a functional replacement for null. Javadoc: [https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html](https://philvarner.github.io/pages/java.util.Optional%3CT%3E)\n\nJava Optional Method Summary\n\n| Method | Description |\n| --- | --- |\n| empty() | create Optional with an empty value |\n| of(T) | create an optional with a non-null value |\n| ofNullable(T) | create an optional with a possibly null reference |\n| ifPresent(Consumer\u0026lt;? super T\u0026gt;) | if the underlying value is not empty, execute the Consumer with it as an argument |\n| isPresent() | if value is not emtpy, return true |\n| get() | get the underlying value, or if null, throw NoSuchElementException |\n| orElseGet(T) | get the underlying value, or if null, return the argument. Argument can be null. |\n| orElse(Supplier\u0026lt;? extends T\u0026gt;) | get the underlying value, or if null, execute the Supplier function and return the result |\n| orElseThrow(Supplier\u0026lt;? extends X\u0026gt;) | get the underlying value, or if null, execute the Supplier function and throw the result |\n| filter(Predicate\u0026lt;? super T\u0026gt;) | if the predicate is true, return the Optional, other wise return empty Optional |\n| map(Function\u0026lt;? super T,? extends U\u0026gt;) | apply the Function, and return the non-null result auto-wrapped as an Optional, or if null an empty Optional |\n| flatMap(Function\u0026lt;? super T, Optional\u0026gt;) | apply the Optional-bearing Function, and return without wrapping as an Optional |\n\nTips\n\n- Prefer ifPresent over isPresent/get\n\n```\n// length of the value or \"\" if nothing\nint length = res.orElse(\"\").length();\n\n// run the lambda if there is a value\nres.ifPresent(v -\u003e results.add(v)); \n```\n\nReturn an Optional\n\n```\nOptional\u003cDouble\u003e squareRoot(double x) {\n   if (x \u003e= 0) { return Optional.of(Math.sqrt(x)); }\n   else { return Optional.empty(); }\n} \n```\n\nUses of filter, map, and flatMap\n\n```\nSystem.out.println(\"empty().filter(\\\"foo\\\"::equals)\" + \" =\u003e \" + empty().filter(\"foo\"::equals));\n// empty().filter(\"foo\"::equals) =\u003e Optional.empty\n\nSystem.out.println(\"of(\\\"foo\\\").filter(\\\"foo\\\"::equals)\" + \" =\u003e \" + of(\"foo\").filter(\"foo\"::equals));\n// of(\"foo\").filter(\"foo\"::equals) =\u003e Optional[foo]\n\nSystem.out.println(\"ofNullable(null).filter(\\\"foo\\\"::equals)\" + \" =\u003e \" + ofNullable(null).filter(\"foo\"::equals));\n// ofNullable(null).filter(\"foo\"::equals) =\u003e Optional.empty\n\nSystem.out.println(\"empty().map(\\\"foo\\\"::equals)\" + \" =\u003e \" + empty().map(\"foo\"::equals));\n// empty().map(\"foo\"::equals) =\u003e Optional.empty\n\nSystem.out.println(\"of(\\\"foo\\\").map(\\\"foo\\\"::equals)\" + \" =\u003e \" + of(\"foo\").map(\"foo\"::equals));\n// of(\"foo\").map(\"foo\"::equals) =\u003e Optional[true]\n\nSystem.out.println(\"ofNullable(null).map(\\\"foo\\\"::equals)\" + \" =\u003e \" + ofNullable(null).map(\"foo\"::equals));\n// ofNullable(null).map(\"foo\"::equals) =\u003e Optional.empty\n\nSystem.out.println(\"empty().flatMap(s -\u003e ofNullable(\\\"foo\\\".equals(s)))\" + \" =\u003e \" + empty().flatMap(s -\u003e ofNullable(\"foo\".equals(s))));\n// empty().flatMap(s -\u003e ofNullable(\"foo\".equals(s))) =\u003e Optional.empty\n\nSystem.out.println(\"of(\\\"foo\\\").flatMap(s -\u003e ofNullable(\\\"foo\\\".equals(s)))\" + \" =\u003e \" + of(\"foo\").flatMap(s -\u003e ofNullable(\"foo\".equals(s))));\n// of(\"foo\").flatMap(s -\u003e ofNullable(\"foo\".equals(s))) =\u003e Optional[true]\n\nSystem.out.println(\"ofNullable(null).flatMap(s -\u003e ofNullable(\\\"foo\\\".equals(s)))\" + \" =\u003e \" + ofNullable(null).flatMap(s -\u003e ofNullable(\"foo\".equals(s))));\n// ofNullable(null).flatMap(s -\u003e ofNullable(\"foo\".equals(s))) =\u003e Optional.empty \n```\n\n## Lambda Expressions\n\nUsed to contruct implementations of [Functional Interfaces](https://docs.oracle.com/javase/8/docs/api/java/util/function/package-summary.html) without explicitly creating new classes and instances. All functional interfaces implement exactly one method, which allows for syntactic sugar to implement that one method with much less code.\n\n```\n() -\u003e expression | statement\nparam -\u003e expression | statement\n(params) -\u003e expression | statement\n(params) -\u003e { expressions and statements }\n(types) (params) -\u003e { expressions and statements } \n```\n\n- optional types before parameters\n- final and annotations can be used on typed parameters\n\n```\n() -\u003e System.out.println(\"I'm a function that prints this statement.\"); \n```\n\n```\na -\u003e a * 2        // calculate double of a (idiomatic)\n(a) -\u003e a * 2      // without the type, with parens\n(int a) -\u003e a * 2  // with type and parens\n(final int a) -\u003e a * 2  // with final, type and parens (final only works with a type)\n(@NonNull int a) -\u003e a * 2  // with an annotation, type and parens (annotations only work with a type) \n```\n\n```\n(a, b) -\u003e a + b   // Sum of 2 parameters, inferred types (idiomatic)\n(int a, int b) -\u003e a + b   // Sum of 2 parameters, explicit types\n(int, int) (tx, status) -\u003e a + b  // explicit types, alternate syntax \n```\n\nIf the lambda is more than one expression, we must use `{ }` and `return`\n\n```\n(x, y) -\u003e {\n    int sum = x + y;\n    int avg = sum / 2;\n    return avg;\n} \n```\n\nWithin a lambda, you can reference only parameters and final variables from the outer scope.\n\nA lambda expression cannot stand alone in Java, it need to be associated to a functional interface.\n\n```\n@FunctionalInterface\ninterface MyMath {\n    int getDoubleOf(int a);\n}\n    \nMyMath d = a -\u003e a * 2; // associated to the interface\nd.getDoubleOf(4); // is 8 \n```\n\n### Useful functions\n\nReturn the input parameter\n\n```\nx -\u003e x\n// or\nFunction.identity() \n```\n\n### Method and Constructor References\n\nAllows referencing methods and constructors without writing an explicit lambda function\n\n```\n// Lambda Form:\ngetPrimes(numbers, a -\u003e StaticMethod.isPrime(a));\n\n// Method Reference:\ngetPrimes(numbers, StaticMethod::isPrime); \n```\n\n| Style | Method Reference | Lambda Form |\n| --- | --- | --- |\n| *Class*::staticMethod | `MyClass::staticMethod` | `n -\u003e MyClass.staticMethod(n)` |\n| *Class*::instanceMethod | `String::toUpperCase` | `(String w) -\u003e w.toUpperCase()` |\n| …   | `String::compareTo` | `(String s, String t) -\u003e s.compareTo(t)` |\n| …   | `System.out::println` | `x -\u003e System.out.println(x)` |\n| *instance*::instanceMethod | `manager::getByID` | `(int id) -\u003e manager.getByID(id)` |\n| this::instanceMethod | `this::getValueByID` | `(int id) -\u003e this.getValueByID(id)` |\n| super::instanceMethod | `super::aMethodThatIveOverridden` | `(int id) -\u003e super.aMethodThatIveOverridden(id)` |\n| *Class*::new | `Double::new` | `n -\u003e new Double(n)` |\n| *Class*\\[\\]::new | `String[]::new` | `(int n) -\u003e new String[n]` |\n| *primitive*\\[\\]::new | `int[]::new` | `(int n) -\u003e new int[n]` |\n\nExamples of static methods commonly used:\n\n- System.out::println\n- Math::pow\n- StringUtils::isBlank (though s -\u003e isBlank(s) with a static import is often more concise)\n\n### Generified Functional Interfaces\n\n| Class | Description | Single method | Additional methods |\n| --- | --- | --- | --- |\n| Function\u0026lt;T,R\u0026gt; | a function that accepts one argument and produces a result | R apply(T t) | andThen(Function), compose(Function), static identity() |\n| Predicate | a boolean-valued function of one argument | boolean test(T t) | static isEqual(Object), and(Predicate), or(Predicate), negate() |\n| Supplier | a supplier of values. | T get() | n/a |\n| Consumer | an operation that accepts a single input argument and returns no result | void accept(T) | andThen(Consumer) |\n| Runnable | an executable unit that takes no arguments and returns no result | void run() | n/a |\n| Callable | an executable unit that returns a result. throws Exception. Typically used when the execution side-effects are purpose rather than the return value. | V call() | n/a |\n| UnaryOperator | an operation on a single operand that produces a result of the same type as its operand. | R apply(T t) | static identity() |\n| BiConsumer\u0026lt;T,U\u0026gt; | an operation that accepts two input arguments and returns no result | void accept(T t, U u) | andThen(BiConsumer) |\n| BiFunction\u0026lt;T,U,R\u0026gt; | a function that accepts two arguments and produces a result. | R apply(T t, U u) | andThen(Function) |\n| BinaryOperator | an operation upon two operands of the same type, producing a result of the same type as the operands. | R apply(T t, U u) | andThen(Function) |\n| BiPredicate\u0026lt;T,U\u0026gt; | a predicate (boolean-valued function) of two arguments. | boolean test(T t, U u) | and(BiPredicate), or(BiPredicate), negate() |\n\nMost interfaces also have a primitive-specific variant, to avoid autoboxing that that would happen were the generic functional interface version used.\n\nRecommended:\n\n- Supplier\u0026lt;? extends T\u0026gt;\n- Consumer\u0026lt;? super T\u0026gt;\n\n| Class | Description |\n| --- | --- |\n| {Int,Long,Double}Function | a function that accepts an type-valued argument and produces a result. |\n| {Int,Long,Double}Predicate | a predicate (boolean-valued function) of one long-valued argument. |\n| {Int,Long,Double}Consumer | an operation that accepts a single type-valued argument and returns no result. |\n| {Boolean,Int,Long,Double}Supplier | a supplier of type-valued results. |\n| To{Int,Long,Double}Function | a function that produces a type-valued result. |\n| To{Int,Long,Double}BiFunction\u0026lt;T,U\u0026gt; | a function that accepts two arguments and produces an type-valued result. |\n| {Int,Long,Double}UnaryOperator | an operation on a single type-valued operand that produces a type-valued result. |\n| {Int,Long,Double}BinaryOperator | an operation upon two type-valued operands and producing a type-valued result. |\n| {Int,Long,Double}To{Int,Long,Double}Function | a function that accepts a type1-valued argument and produces an type2-valued result. If type1 == type2, use UnaryOperator variant instead. |\n| Obj{Int,Long,Double}Consumer | an operation that accepts an object-valued and a type-valued argument, and returns no result. |\n\n## Streams\n\nhttps://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html\n\nSimilar to collections, but\n\n- Data representation rather than data store\n- *immutable* (produce new streams)\n- *lazy* (only computes what is necessary)\n\nProcess\n\n- **Create** a stream (all Collections now have stream() method, or create using [StreamSupport](https://docs.oracle.com/javase/8/docs/api/java/util/stream/StreamSupport.html) and a spliterator\n- **Transform** the stream entries – filter, map, etc\n- **Reduce** into a collection of entries or value – collect and Collectors, count\n\n```\nSet\u003cString\u003e genres = \n    Stream.of(\"Jazz\", \"Blues\", \"Rock\") \n        .map(String::toLowerCase)\n        .collect(Collectors.toSet()); \n```\n\n### Create\n\n```\nStream\u003cString\u003e stream = Stream.of(\"Jazz\", \"Blues\", \"Rock\"); // stream from references\n\nStream\u003cString\u003e stream = Stream.of(myArray); // from an array\n\nlist.stream(); // from a list\n\nStreamSupport.stream(iterable.spliterator(), false); // from an iterable\n\nStreamSupport.stream(Spliterators.spliteratorUnknownSize(iterator, Spliterator.ORDERED), false) // from an iterator\n\nStream\u003cInteger\u003e integers = Stream.iterate(0, n -\u003e n + 1); // Infinite stream, lazily generated\n\nStream\u003cString\u003e strings = Arrays.stream(new String[] { \"a\", \"b\", \"c\"});\nStream\u003cString\u003e strings = Stream.of(new String[] { \"a\", \"b\", \"c\"});\n\nIntStream = Arrays.stream(new int[] {1, 2});\nStream\u003cint[]\u003e arr1 = Stream.of(new int[] {1, 2});  // stream of int arrays, not stream of ints\n\n// static \u003cT\u003e Stream\u003cT\u003e stream(T[] array, int startInclusive, int endExclusive), also overloaded methods for primitives\nStream\u003cString\u003e strings = Arrays.stream(new String[] { \"a\", \"b\", \"c\", \"d\", \"e\"}, 2, 4) // preferable to using Stream.of(array).skip(n).limit(m), as it starts the stream at the start instead of iterating through the stream til the start \n```\n\n**parallel** Returns an equivalent stream that is parallel\n\n### Transform\n\n*filter(Predicate\u0026lt;? super T\u0026gt;)* and *map(Function\u0026lt;? super T,? extends R\u0026gt;)* are the most common. Filter retains elements that match the predicate, typically written as a lambda. Map applies the Function to each element, also typically written as a lambda.\n\n```\n// count of names longer than 24 characters\nlong longNamesCount = list\n   .filter(n -\u003e n.length() \u003e 24)\n   .map(n -\u003e n * 2)  // doesn't do anything, count is still the same\n   .count();\n   \n// names longer than 24 characters, with name strings reversed\nSet\u003cString\u003e longNamesReversed = list\n   .filter(n -\u003e n.length() \u003e 24)\n   .map(n -\u003e StringUtils.reverse(n))\n   .collect(toSet()); \n```\n\n**filter** Stream filter(Predicate\u0026lt;? super T\u0026gt;)\n\nRemove elements not matching the Predicate.\n\n**map** signature: Stream map(Function\u0026lt;? super T, ? extends R\u0026gt;)\n\nApply a Function to each element\n\nApply a Function to each element\n\n// Apply “toLowerCase” for each element List list = Arrays.asList(new String\\[\\]{\"A\", \"B\", \"C\"}); res = list.stream().map(w -\u003e w.toLowerCase()); list.stream().map(String::toLowerCase); // stream of \\[\"a\", \"b\", \"c\"\\]\n\nStream.of(1,2,3,4,5).map(x -\u003e x + 1); // stream of \\[2, 3, 4, 5, 6\\]\n\n**limit** `limit(maxSize)` The first *n* elements\n\n```\nStream.of(1,2,3,4,5).limit(3);\n// stream of [1, 2, 3] \n```\n\n**skip** Discarding the first *n* elements\n\n```\nStream.of(1,2,3,4,5).skip(3);\n// stream of [4, 5] \n```\n\n**distinct** Remove duplicated elements\n\n```\nStream.of(1,0,0,1,0,1).distinct();\n// stream of [1, 0] \n```\n\n**sorted** Sort elements (must be *Comparable*)\n\n```\nStream.of(2,1,5,3,4).sorted(); // must be Comparable\n//  stream of [1, 2, 3, 4, 5]\n\n// using sorted(Comparator\u003c? super T\u003e comparator)\nStream.of(2,1,5,3,4).sorted((i1, i2) -\u003e -1 * Integer.compare(i1, i2)); // reverse sort\n// stream of [5, 4, 3, 2, 1] \n```\n\n### Collect\n\nCollect to a collection, a value, or a boolean. Most commonly done with a statically imported method from [Collectors](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html)\n\n**toList** and **toSet**\n\n```\n// Collect into a List\nList\u003cString\u003e myList = stream.collect(toList());\n\n// Collect into a Set\nSet\u003cString\u003e mySet = stream.collect(toSet()); \n```\n\n**toArray**\n\n```\n// Collect into an array\nString[] myArray = stream.toArray(String[]::new); \n```\n\n**toMap**\n\nCollectors.toMap(Function keyFunction, Function valueFunction)\n\n```\nMap\u003cString, Foo\u003e result =\n    choices.stream().collect(Collectors.toMap(Foo::getName,\n                                              Function.identity())); \n```\n\nThree toMap static methods\n\n- simple key and value – static \u0026lt;T,K,U\u0026gt; Collector\u0026lt;T,?,Map\u003cK,U» toMap(Function\u003c? super T,? extends K\u0026gt; keyMapper, Function\u0026lt;? super T,? extends U\u0026gt; valueMapper)\n- key, value, and merge function if there are duplicate keys in the stream – static \u0026lt;T,K,U\u0026gt; Collector\u0026lt;T,?,Map\u003cK,U» toMap(Function\u003c? super T,? extends K\u0026gt; keyMapper, Function\u0026lt;? super T,? extends U\u0026gt; valueMapper, BinaryOperator mergeFunction)\n- key, value, merge, and a Supplier to supply the intial map – static \u0026lt;T,K,U,M extends Map\u003cK,U» Collector\u003cT,?,M\u0026gt; toMap(Function\u0026lt;? super T,? extends K\u0026gt; keyMapper, Function\u0026lt;? super T,? extends U\u0026gt; valueMapper, BinaryOperator mergeFunction, Supplier mapSupplier)\n\nAlso, all methods have a toMapConcurrent that returns a concurrent map for use with parallel streams, and the Supplier\n\n**toCollection**\n\nTransform the Stream into a specified Collection\n\n```\n// Collect into a specified Collection\nConcurrentSkipListSet\u003cString\u003e mySet = stream.collect(toCollection(ConcurrentSkipListSet::new));\n\n// Collect into an existing collection\nList\u003c?\u003e groups = ...;\nstream.collect(toCollection(() -\u003e groups)); \n```\n\n**joining**\n\nConcatenate the Stream values into a String.\n\n```\n// Collect into a String, concatentating with no delmiter\nString str = Stream.of(\"a\", \"b\", \"c\").collect(joining());\n//\u003e abc\n\n// Collect into a String, concatenating with a delimter\nString str = Stream.of(\"a\", \"b\", \"c\").collect(joining(\", \"));\n//\u003e a, b, c\n\n// Collect into a String, concatenating with a delimter, prefix, and suffix\nString str = Stream.of(\"a\", \"b\", \"c\").collect(joining(\", \"), \"before \", \" after\");\n//\u003e before a, b, c after \n```\n\n**allMatch** All entries of the stream match the predicate. boolean allMatch(Predicate\u0026lt;? super T\u0026gt; predicate)\n\n```\n// Check if there is a \"e\" in each elements\nboolean res = words.allMatch(n -\u003e n.contains(\"e\")); \n```\n\n**anyMatch** Any entry in the stream matches the predicate. boolean anyMatch(Predicate\u0026lt;? super T\u0026gt; predicate)\n\n**noneMatch** No entry in the stream matches the predicate. boolean noneMatch(Predicate\u0026lt;? super T\u0026gt; predicate)\n\n**findAny** Find any entry in the stream that matches the predicate and return it. Faster than **findFirst** in parallel streams if any entry is sufficient.\n\n```\n// Optional\u003cString\u003e contains a string or nothing\nOptional\u003cString\u003e res = stream\n   .filter(w -\u003e w.length() \u003e 10)\n   .findAny(); \n```\n\n**findFirst**\n\n```\n// Optional\u003cString\u003e contains a string or nothing\nOptional\u003cString\u003e res = stream\n   .filter(w -\u003e w.length() \u003e 10)\n   .findFirst(); \n```\n\nFinds the first entry the stream that matches, not just any match. The semantics for this still hold even if the stream is parallel, which requires additional operations.\n\n**reduce**\nReduce the elements to a single value (rarely used, given the other more specific methods) The BiFunction accumulator must be an associative function, e.g., (a op b) op c == a op (b op c)\n\n```\n// reduce to an object with the same type as the stream, with the initial value of the accumulator set to the first stream entry\nOptional\u003cString\u003e r1 = Stream.of(\"a\", \"b\", \"c\").reduce((acc, e) -\u003e acc + \"|\" + e.toUpperCase());\n//\u003e A|B|C\n\n// reduce with an explicit initial accumulator state\nString r2 = Stream.of(\"a\", \"b\", \"c\").reduce(\"\", (acc, e) -\u003e acc + \"|\" + e.toUpperCase());\n//\u003e A|B|C\n\n// fused map / reduce (tbd)\n \u003cU\u003e U reduce(U identity,\n             BiFunction\u003cU,? super T,U\u003e accumulator,\n             BinaryOperator\u003cU\u003e combiner) \n```\n\n### Grouping Results\n\n**Collectors.groupingBy**\n\ncollect a stream into a Map grouped by a function.\n\n```\n // I18nEntry has three attributes: locale, key, and value\n        List\u003cI18nEntry\u003e list = new ArrayList\u003c\u003e();\n        list.add(new I18nEntry(ENGLISH, \"key1\", \"value1\"));\n        list.add(new I18nEntry(ENGLISH, \"key2\", \"value2\"));\n        list.add(new I18nEntry(FRENCH, \"key3\", \"value3\"));\n        list.add(new I18nEntry(FRENCH, \"key4\", \"value4\"));\n        list.add(new I18nEntry(GERMAN, \"key5\", \"value5\"));\n        list.add(new I18nEntry(GERMAN, \"key6\", \"value6\"));\n\n        Map\u003cString, List\u003cI18nEntry\u003e\u003e mapOfLocaleStringToI18nEntry = list.stream()\n                .collect(groupingBy(w -\u003e w.getLocale().toString()));\n        System.out.println(mapOfLocaleStringToI18nEntry);\n        // {de=[I18nEntry{ de, 'key5', 'value5'}, I18nEntry{ de, 'key6', 'value6'}], \n        // en=[I18nEntry{ en, 'key1', 'value1'}, I18nEntry{ en, 'key2', 'value2'}], \n        // fr=[I18nEntry{ fr, 'key3', 'value3'}, I18nEntry{ fr, 'key4', 'value4'}]}\n\n        Map\u003cString, Set\u003cString\u003e\u003e mapOfLocaleStringToSetOfI18nEntryNames\n                = list.stream().collect(groupingBy(w -\u003e w.getLocale().toString(),\n                mapping(I18nEntry::getKey, toSet())));\n        System.out.println(mapOfLocaleStringToSetOfI18nEntryNames);\n        // {de=[key5, key6], en=[key1, key2], fr=[key3, key4]}\n\n        Map\u003cString, Map\u003cString, String\u003e\u003e mapOfLocaleStringToMapOfKeyValues =\n                list.stream().collect(groupingBy(w -\u003e w.getLocale().toString(),\n                        toMap(I18nEntry::getKey, I18nEntry::getValue)));\n        System.out.println(mapOfLocaleStringToMapOfKeyValues);\n        // {de={key5=value5, key6=value6}, en={key1=value1, key2=value2}, fr={key3=value3, key4=value4}} \n```\n\ngroupingByConcurrent does the same thing, only concurrently.\n\n**Collectors.counting** Count the number of values in a group\n\n**Collectors.summing{Int|Long|Double}** `summingInt`, `summingLong`, `summingDouble` to sum group values\n\n|     |     |     |\n| --- | --- | --- |\n| **Collectors.summarizing{Int | Long | Double}** |\n\n|     |     |     |\n| --- | --- | --- |\n| {Int | Long | Double}SummaryStatistics |\n\n**Collectors.averaging{Int|Long|Double}** `averagingInt`, `averagingLong`, …\n\n```\n// Average length of each element of a group\nCollectors.averagingInt(String::length) \n```\n\n*PS*: Don’t forget Optional (like `Map\u003cT, Optional\u003cT\u003e\u003e`) with some Collection methods (like `Collectors.maxBy`).\n\n**reducing**\n\n**minBy**\n\n**maxBy**\n\n**mapping**\n\n**Finisher** static \u0026lt;T,A,R,RR\u0026gt; Collector\u0026lt;T,A,RR\u0026gt; collectingAndThen(Collector\u0026lt;T,A,R\u0026gt; downstream, Function\u0026lt;R,RR\u0026gt; finisher)\n\npeek\n\n### Partitioning Results\n\ntbd\n\n```\n // Partition students into passing and failing\n     Map\u003cBoolean, List\u003cStudent\u003e\u003e passingFailing =\n         students.stream()\n                 .collect(Collectors.partitioningBy(s -\u003e s.getGrade() \u003e= PASS_THRESHOLD)); \n```\n\n### Parallel Streams\n\nBe aware these lose any staticly-held context, e.g., security context in a servlet.\n\n**Creation**\n\n```\nStream\u003cString\u003e parStream = list.parallelStream();\nStream\u003cString\u003e parStream = Stream.of(myArray).parallel(); \n```\n\n**unordered** Can speed up the `limit` or `distinct`\n\n```\nstream.parallelStream().unordered().distinct(); \n```\n\n*PS*: Work with the streams library. Eg. use `filter(x -\u003e x.length() \u003c 9)` instead of a `forEach` with an `if`.\n\nhttp://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html#MutableReduction\n\n### Primitive-Type Streams\n\nWrappers (like Stream) are inefficients. It requires a lot of unboxing and boxing for each element. Better to use \\`IntStream\\`, \\`DoubleStream\\`, etc.\n\n**Creation**\n\n```\nIntStream stream = IntStream.of(1, 2, 3, 5, 7);\nstream = IntStream.of(myArray); // from an array\nstream = IntStream.range(5, 80); // range from 5 to 80\n\nRandom gen = new Random();\nIntStream rand = gen(1, 9); // stream of randoms \n```\n\n### IntStream\n\n```\nIntStream.of(3, 1, 4);  \n//\u003e 3, 1, 4\n\nIntStream.rangeClosed(1, 5);  \n//\u003e 1, 2, 3, 4, 5\n\nIntStream.range(1, 5);  \n//\u003e 1, 2, 3, 4\n\nIntStream.iterate(1, i -\u003e i * 2).limit(5);  \n//\u003e 1, 2, 4, 8, 16\n\nIntStream.generate(() -\u003e ThreadLocalRandom.current().nextInt(10)).limit(5);  \n//\u003e 5, 4, 9, 7, 1 \n```\n\nUse *mapToX* (mapToObj, mapToDouble, etc.) if the function yields Object, double, etc. values. boxed() min() max()\n\n### Creating objects using Generic Types\n\nDefinition:\n\n```\n T T[] toArray(IntFunction\u003cT[]\u003e constructor) {\n    int n = ...; // length of array\n    T[] result = constructor.apply(n);\n    // ... populate result array here\n    return result;\n} \n```\n\nCalling\n\n```\nString[] array = MyClass.toArray(String[]::new); \n```\n\n## Interface Default Methods\n\ndefault methods. Useful for adding new methods to existing interfaces without breaking existing implementations.\n\n```\ninterface Foo {\n    default boolean isTrue() { return true; }\n} \n```\n\n## Collections\n\n**sort** `sort(list, comparator)`\n\n```\nlist.sort((a, b) -\u003e a.length() - b.length())\nlist.sort(Comparator.comparing(n -\u003e n.length())); // same\nlist.sort(Comparator.comparing(String::length)); // same\n//\u003e [Bohr, Tesla, Darwin, Newton, Galilei, Einstein] \n```\n\n**removeIf**\n\n```\nlist.removeIf(w -\u003e w.length() \u003c 6);\n//\u003e [Darwin, Galilei, Einstein, Newton] \n```\n\n**Merge** `merge(key, value, remappingFunction)`\n\n```\nMap\u003cString, String\u003e names = new HashMap\u003c\u003e();\nnames.put(\"Albert\", \"Ein?\");\nnames.put(\"Marie\", \"Curie\");\nnames.put(\"Max\", \"Plank\");\n\n// Value \"Albert\" exists\n// {Marie=Curie, Max=Plank, Albert=Einstein}\nnames.merge(\"Albert\", \"stein\", (old, val) -\u003e old.substring(0, 3) + val);\n\n// Value \"Newname\" don't exists\n// {Marie=Curie, Newname=stein, Max=Plank, Albert=Einstein}\nnames.merge(\"Newname\", \"stein\", (old, val) -\u003e old.substring(0, 3) + val); \n```\n\n## Generic Static Methods\n\nDefinition\n\n```\npublic class SomeStaticMethods {\n    public static \u003cT\u003e boolean method1(T t) { ... } \n    public static \u003cT\u003e boolean methodThatOnlyConsumes(List\u003c? extends T\u003e listT) { ... } \n    public static \u003cT\u003e boolean methodThatOnlyAdds(List\u003c? super T\u003e listT) { ... } \n    public static \u003cT\u003e boolean methodThatDoesBoth(List\u003cT\u003e listT) { ... } \n\n    public static \u003cT\u003e T method3(boolean b) { ... } \n    public static \u003cT\u003e List\u003c? super T\u003e method4(boolean b) { ... } \n\n    public static \u003cT,U\u003e U method5(T t) { ... } \n    public static \u003cT,U\u003e List\u003c? super U\u003e method6(List\u003c? extends T\u003e listT) { ... } \n} \n```\n\nInvocation\n\n```\nSomeStaticMethods.\u003cString\u003emethod();\nSomeStaticMethods.\u003cString,String\u003emethod();\n``\n\n## try-with-resources\n\nResource assigned in try that implements AutoCloseable has implicity finally \"close()\" call.\n\n```java\ntry (Stream\u003cPath\u003e paths = Files.list(directoryPath)) {\n\n} \n```\n\n## I/O Improvements – Files, Readers, etc\n\n### Working with files on disk\n\n- Use a Path instead File. No need to specify file-system specific delimiters.\n- Immutable, so great for concurrency.\n- Construct with [Paths](https://docs.oracle.com/javase/8/docs/api/java/nio/file/Paths.html)\n\n```\n// non-cross platform construction\nPath absoluteToDirectory2 = Paths.getPath(\"/usr/var/logs\"); \n\n// cross platform construction\n// \"/\" is the root, not the delimiter!\nPath absoluteToDirectory = Paths.getPath(\"/\", \"usr\", \"var\", \"logs\"); \nPath relativeToDirectory = Paths.getPath(\"logs\");\n\nPath absoluteToFile = Paths.getPath(\"/\", \"usr\", \"var\", \"logs\", \"access.log\"); \nPath relativeToFile = Paths.getPath(\"logs\", \"access.log\");\n\n// windows?\nPath absoluteToFile = Paths.getPath(\"c:\\\\\", \"usr\", \"var\", \"logs\", \"access.log\"); \n\n```java\n\nResolve paths relative to other paths\n\n```java\nPath logPath = Paths.getPath(\"/usr/var/logs\"); \nPath accessPartialPath = Paths.getPath(\"tomcat\", \"access.log\");\nPath accessPath = logPath.resolve(accessPartialPath); \n// normalize tbd\n// relativize tbd \n```\n\nPath#toFile File#toPath, oh yeah\n\nPath path = Paths.getPath(“logs”, “access.log”); BufferedReader reader = Files.newBufferedReader(path, StandardCharsets.UTF_8);\n\n```\nbyte[] bytes = Files.readAllBytes(path);\nString fileString = new String(Files.readAllBytes(path), StandardCharsets.UTF_8);\nList\u003cString\u003e lines = Files.readAllLines(path); \n```\n\n- static Path write(Path, Iterable\u0026lt;? extends CharSequence\u0026gt;, OpenOption…)\n\nFiles.write(path, content.getBytes(StandardCharsets.UTF\\_8)); // create or overwrite semantics Files.write(path, content.getBytes(StandardCharsets.UTF\\_8), StandardOpenOption.APPEND);\n\n- java.nio.file.Files\n    - static BufferedReader newBufferedReader(Path)\n    - static BufferedWriter newBufferedWriter(Path, OpenOption…)\n    - InputStream in = Files.newInputStream(path);\n    - OutputStream out = Files.newOutputStream(path);\n    - copy(InputStream, Path)\n    - copy(Path, OutputStream)\n\n*Files Stream methods\n\n- static Stream list(Path dir) -- list of Paths representing files and directories in a directory\n- static Stream walk(Path start, FileVisitOption... options) -- walk a directory tree, with max depth\n- static Stream walk(Path start, int maxDepth, FileVisitOption... options) -- walk a directory tree, with max depth\n- static Stream find(Path start, int maxDepth, BiPredicate\u0026lt;Path, BasicFileAttributes\u0026gt; matcher, FileVisitOption... options)\n- BufferedReader\n    - lines() – same as Files.lines methods\n\nFileVisitOption – only one FOLLOW_LINKS OpenOption\n\n**Files.lines**\n\n- static Stream lines(Path) -- lazy, defaults to UTF-8\n- static Stream lines(Path path, Charset cs) stream of lines, one line per entry, but does not automatically close the File resource! So must wrap in a try()\n\n```\nPath path = FileSystems.getDefault().getPath(\"/usr\", \"var\", \"logs\", \"access.log\"); // \"/\" is the root, not the delimiter!\ntry (Stream\u003cString\u003e lines = Files.lines(path)) {\n   Optional\u003cString\u003e timeoutEntry = lines.filter(s -\u003e s.startsWith(\"timeout:\")).findAny();\n   ...\n} \n```\n\nException thrown as UncheckedIOException\n\n## Annotations\n\n## Collections and Collections\n\n- Iterable\n    \n    - forEach\n- Iterator\n    \n    - forEachRemaining\n- Collection interface\n    \n    - boolean removeIf(Predicate\u0026lt;? super E\u0026gt; filter)\n    - Stream stream()\n    - Stream parallelStream()\n    - Spliterator spliterator()\n- Collections static class (tbd)\n    \n    - |     |     |     |     |     |\n        | --- | --- | --- | --- | --- |\n        | (unmodifiable | synchronized | checked | empty)Navigable(Set | Map) |\n        \n    - checkedQueue\n        \n    - |     |     |\n        | --- | --- |\n        | emptySorted(Set | Map) |\n        \n    - |     |     |\n        | --- | --- |\n        | empty(Set | Map) |\n        \n- List class\n    \n    - void replaceAll(UnaryOperator operator)\n    - void sort(Comparator\u0026lt;? super E\u0026gt; c)\n- Map\n    \n    - forEach\n    - replace\n    - replaceAll\n    - remove(key, value)\n    - putIfAbsent\n    - compute\n    - computeIfAbsent\n    - computeIfPresent\n    - merge\n- BitSet\n    \n    - Stream stream\n- NavigableSet\n    \n- NavigableMap\n    \n- https://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListMap.html\n    \n- https://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArraySet.html\n    \n- https://docs.oracle.com/javase/6/docs/api/java/util/SortedSet.html\n    \n- https://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html\n    \n\n## Minor Changes\n\n- Objects static class\n    - static boolean isNull(Object)\n    - static boolean nonNull(Object)\n    - static T requireNonNull(T, Supplier) -- if not null, lazily generate an error message (complementary to eager requireNonNull(T) and requireNonNull(T, String) introduced in 7)\n- String class\n    - static String join(CharSequence delimiter, CharSequence… elements)\n    - static String join(CharSequence delimiter, Iterable\u0026lt;? extends CharSequence\u0026gt; elements)\n- Comparator\n    - comparing(Function\u0026lt;? super T,? extends U\u0026gt; keyExtractor) – static method to create a Comparator typically converting T to Comparable like String or Integer\n        \n    - comparing(Function\u0026lt;? super T,? extends U\u0026gt; keyExtractor, Comparator\u0026lt;? super U\u0026gt; keyComparator) –\n        \n    - thenComparing(Function\u0026lt;? super T,? extends U\u0026gt; keyExtractor) – tie breaker\n        \n    - naturalOrder – Comparator that’s the default for a Comparable type.\n        \n    - reverseOrder() - Returns a comparator that imposes the reverse of the natural ordering.\n        \n    - comparing(Function\u0026lt;? super T,? extends U\u0026gt; keyExtractor, Comparator\u0026lt;? super U\u0026gt; keyComparator)\n        \n    - |     |     |     |     |     |\n        | --- | --- | --- | --- | --- |\n        | comparing{Int | Double | Long}(To{Int | Double | Long}Function\u0026lt;? super T\u0026gt;) |\n        \n    - nullsFirst(Comparator\u0026lt;? super T\u0026gt; comparator)\n        \n    - nullsLast(Comparator\u0026lt;? super T\u0026gt; comparator)\n        \n    - reversed() - Returns a comparator that imposes the reverse ordering of this comparator.\n        \n- Annotations? tbd\n\n## Numbers and Math\n\nBigInteger\n\n- longValueExact(), intValueExact(), shortValueExact(), byteValueExact() throws ArithmeticException\n\nPrimitive wrapper types\n\n- hashCode() in native, so no boxing\n\nNew methods in primitive wrapper types:\n\n| Method | Boolean | Byte | Short | Integer | Long | Float | Double |\n| --- | --- | --- | --- | --- | --- | --- | --- |\n| sum() | —   | —   | —   | yes | yes | yes | yes |\n| max() | —   | —   | —   | yes | yes | yes | yes |\n| min() | —   | —   | —   | yes | yes | yes | yes |\n| logicalAnd(T) | yes | —   | —   | —   | —   | —   | —   |\n| logicalOr(T) | yes | —   | —   | —   | —   | —   | —   |\n| logicalXor(T) | yes | —   | —   | —   | —   | —   | —   |\n| toUnsignedInt(T) | —   | yes | yes | —   | —   | —   | —   |\n| toUnsignedLong(T) | —   | yes | yes | yes | —   | —   | —   |\n| compareUnsigned(T) | —   | —   | —   | yes | yes | —   | —   |\n| divideUnsigned(T) | —   | —   | —   | yes | yes | —   | —   |\n| remainderUnsigned(T) | —   | —   | —   | yes | yes | —   | —   |\n| isFinite(T) | —   | —   | —   | —   | —   | yes | yes |\n\n- Math.floorMod(x, n) – if x might be negative\n\n## Base64\n\n- [Base64](https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html)\n    - getEncoder / getDecoder - general Base64 encoder/decoder\n    - getUrlEncoder / getUrlDecoder – URL and filename safe scheme\n    - getMimeEncoder / getMimeDecoder – MIME type scheme\n    - Encoder\n        - String encodeToString(byte\\[\\]) {\n        - byte\\[\\] encode(byte\\[\\])\n        - int encode(byte\\[\\], byte\\[\\]) {\n        - ByteBuffer encode(ByteBuffer)\n        - OutputStream wrap(OutputStream)\n        - Encoder withoutPadding()\n    - Decoder\n        - byte\\[\\] decode(byte\\[\\] src)\n        - byte\\[\\] decode(String src)\n        - int decode(byte\\[\\] src, byte\\[\\] dst)\n        - ByteBuffer decode(ByteBuffer buffer)\n        - InputStream wrap(InputStream is)\n\n## Locale https://docs.oracle.com/javase/8/docs/api/java/util/Locale.html\n\n- Locale.forLanguageTag(“en-US”)\n- Parts\n    - Language - two or three lowercase letters, e.g., en, de, jp, zh\n    - Script - four letters, capitalized, e.g., Latn (Latin), Cyrl (Cyrillic), Hant (traditional Chinese characters) – Serbian (Latin or Cyrillic), Chinese (traditional or simplified)\n    - Country - the country-specific variant of a language. two uppercase letters or three digits, e.g., en\\_US (English, United States), de\\_CH (German, Switzerland), zh\\_CN (Chinese, Mainland China), zh\\_TW (Taiwan)\n    - Variant – language and country specific variant, two uppercase letters, e.g., Nyorsk Norwegian. Rare, as many are now use a different Language code, e.g., Nyorsk Norwegian now uses nn\\_NO instead of no\\_NO_NY.\n    - Extensions – local preference for calendar, number, etc. Examples: Japanese calendar (u-ca-japanese), Thai numerals (u-nu-thai). ja\\_JP\\_JP_#u-ca-japanese\n\nLanguageRange List ranges = Stream.of(\"de\\_CH\", \"de\", \"*\\_CH\") // prefer Swiss German, then any German, than any language with a Swiss country variation .map(Locale.LanguageRange::new) .collect(toList()); // A list containing the Locale.LanguageRange objects for the given strings List matches = Locale.filter(ranges, Arrays.asList(Locale.getAvailableLocales())); // The matching locales: de\\\\\\_CH, de, de\\\\\\_AT, de\\\\\\_LU, de\\\\\\_DE, de\\\\\\_LI, fr\\\\\\_CH, it\\\\_CH Locale bestMatch = Locale.lookup(ranges, locales);\n\n## JDBC\n\nJava 7 - 4.1, Java 8 - 4.2\n\n- |     |     |     |     |     |\n    | --- | --- | --- | --- | --- |\n    | methods to convert java.sql.{Date | Time | Timestamp} \u0026lt;=\u0026gt; java.time.{LocalDate | LocalTime | LocalDateTime} |\n    \n- **long Statement#executeLargeUpdate** \\- when row count exceeds Integer.MAX_VALUE.\n    \n- Statement and ResultSet\n    \n    - getObject(column, Class type)\n    - setObject(column, Class type)\n\n## Date / Time\n\n- Immutable objects, unlike Date and Calendar\n    \n- DateTimeFormatter – format and parse dates and times.\n    \n- Instant - Date equivalent – a single point on the time line\n    \n    - now() - current Instant\n- Duration - delta between two instants\n    \n    - between(Instant, Instant) - difference between two Instants\n    - |     |     |     |     |     |     |\n        | --- | --- | --- | --- | --- | --- |\n        | to{Nanos | Millis | Seconds | Minutes | Hours | Days} - convert a duration to a long representing that unit |\n        \n- Instant and Duration\n    \n    - plus(Duration), minus(Duration)\n        \n    - |     |     |     |     |     |     |     |     |     |     |     |\n        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n        | plus{Nanos | Millis | Seconds | Minutes | Hours | Days}(long), minus{Nanos | Millis | Seconds | Minutes | Hours | Days}(long) |\n        \n    - multipliedBy(long)\n        \n    - dividedBy(long)\n        \n    - negated\n        \n    - isZero\n        \n    - isNegative\n        \n- Period - used when advancing a timezoned time\n    \n- LocalDateTime - non-time zoned date/time\n    \n- ZonedDateTime - time zoned date/time (GregorianCalendar equivalent)\n    \n- TemporalAdjuster - calendar calculations, e.g., first Wednesday in June 2312\n    \n\n## Etc\n\n- Scanner\n- DirectoryStream - J7, huge directory trees\n- @Repeatable annotations\n- annotation type use vs. only name use\n- annotation Method Parameter Reflection\n- Logger – all methods have a Supplier argument that lazily computes the error message\n- Regex\n    - Java 7 introduced named capturing groups.\n    - Pattern.splitAsStream\n    - Stream words = Pattern.compile(\"\\[\\\\\\P{L}\\]+\").splitAsStream(contents);\n    - Pattern#asPredicate – convert regex to predicate\n- String contents = new String(Files.readAllBytes(path), StandardCharsets.UTF_8);\n- this.foo = Objects.requireNonNull(foo); // throws NPE\n- BitSet - set of integers that is implemented as a sequence of bits. The ith bit is set if the set contains the integer i. That makes for very efficient set operations. Union/intersection/complement are simple bitwise or/and/not.\n- ProcessBuilder ProcessBuilder builder = new ProcessBuilder(“grep”, “-o”, “\\[A-Za-z_\\]\\[A-Za-z_0-9\\]*”); builder.redirectInput(Paths.get(“Hello.java”).toFile()); builder.redirectOutput(Paths.get(“identifiers.txt”).toFile()); // or, builder.inheritIO() Process process = builder.start(); process.waitFor(1, TimeUnit.MINUTES);\n\nObjects.equals(a, b) instead of a.equals(b) hashCode using Objects.hash(first, second, …, last);\n\n```\n List\u003cLong\u003e ids = stream(result.results()).map(JO::getID).collect(toList());\n                        groupFilter.setIDs(ids);\n                        Map\u003cLong,Group\u003e map = stream(groupManager.getGroups(startIndex, count, groupFilter.build(), sort))\n                                .collect(toMap(Group::getID, identity(), (v1, v2) -\u003e v1));\n                        groups = ids.stream().map(map::get).collect(toList()); \n```\n\n## Phil Varner\n\n- Phil Varner\n    \n- [philvarner@gmail.com](mailto:philvarner@gmail.com)\n    \n- [philvarner](https://github.com/philvarner)\n    \n- [philvarner](https://www.twitter.com/philvarner)\n    \n\nHomepage of Phil Varner","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/Programmation-multi-paradigme/Scala":{"title":"Scala","content":"\n# Evaluation Rules\n\n```scala\n    def example = 2      // evaluated when called\n    val example = 2      // evaluated immediately\n    lazy val example = 2 // evaluated once when needed\n    \n    def square(x: Double)    // call by value\n    def square(x: =\u003e Double) // call by name\n    def myFct(bindings: Int*) { ... } // bindings is a sequence of int, containing a varying # of arguments\n```\n\n# Higher order functions\n\nThese are functions that take a function as a parameter or return functions.\n\n```scala\n    // sum() returns a function that takes two integers and returns an integer  \n    def sum(f: Int =\u003e Int): (Int, Int) =\u003e Int = {  \n      def sumf(a: Int, b: Int): Int = {...}  \n      sumf  \n    } \n    \n    // same as above. Its type is (Int =\u003e Int) =\u003e (Int, Int) =\u003e Int  \n    def sum(f: Int =\u003e Int)(a: Int, b: Int): Int = { ... } \n    \n    // Called like this\n    sum((x: Int) =\u003e x * x * x)          // Anonymous function, i.e. does not have a name  \n    sum(x =\u003e x * x * x)                 // Same anonymous function with type inferred\n    \n    def cube(x: Int) =\u003e x * x * x  \n    sum(x =\u003e x * x * x)(1, 10) // sum of cubes from 1 to 10\n    sum(cube)(1, 10)           // same as above      \n```\n\n# Currying\n\nConverting a function with multiple arguments into a function with a single argument that returns another function.\n\n```scala\n    def f(a: Int, b: Int): Int // uncurried version (type is (Int, Int) =\u003e Int)\n    def f(a: Int)(b: Int): Int // curried version (type is Int =\u003e Int =\u003e Int)\n```\n\n# Classes\n\n```scala\n    class MyClass(x: Int, y: Int) {           // Defines a new type MyClass with a constructor  \n      require(y \u003e 0, \"y must be positive\")    // precondition, triggering an IllegalArgumentException if not met  \n      def this (x: Int) = { ... }             // auxiliary constructor   \n      def nb1 = x                             // public method computed every time it is called  \n      def nb2 = y  \n      private def test(a: Int): Int = { ... } // private method  \n      val nb3 = x + y                         // computed only once  \n      override def toString =                 // overridden method  \n          member1 + \", \" + member2 \n      }\n    \n    new MyClass(1, 2) // creates a new object of type\n```\n\n# Class Organization\n\n- **scala.Any** base type of all types. Has methods `hashCode` and `toString` that can be overloaded\n- **scala.AnyVal** base type of all primitive types. (`scala.Double`, `scala.Float`, etc.)\n- **scala.AnyRef** base type of all reference types. (alias of `java.lang.Object`, supertype of `java.lang.String`, `scala.List`, any user-defined class)\n- **scala.Null** is a subtype of any `scala.AnyRef` (`null` is the only instance of type `Null`), and `scala.Nothing` is a subtype of any other type without any instance.\n\n# Type Parameters\n\nSimilar to C++ templates or Java generics. These can apply to classes, traits or functions.\n\n```scala\n    class MyClass[T](arg1: T) { ... }  \n    new MyClass[Int](https://gist.github.com/heathermiller/1)  \n    new MyClass(1)   // the type is being inferred, i.e. determined based on the value arguments  \n```\n\nIt is possible to restrict the type being used, e.g.\n\n```scala\n    def myFct[T \u003c: TopLevel](arg: T): T = { ... } // T must derive from TopLevel or be TopLevel\n    def myFct[T \u003e: Level1](arg: T): T = { ... }   // T must be a supertype of Level1\n    def myFct[T \u003e: Level1 \u003c: Top Level](arg: T): T = { ... }\n```\n\n## Variance\n\nGiven `A \u003c: B`\n\nIf `C[A] \u003c: C[B]`, `C` is covariant\n\nIf `C[A] \u003e: C[B]`, `C` is contravariant\n\nOtherwise C is nonvariant\n\n```scala\n    class C[+A] { ... } // C is covariant\n    class C[-A] { ... } // C is contravariant\n    class C[A]  { ... } // C is nonvariant\n```\n\nFor a function, if `A2 \u003c: A1` and `B1 \u003c: B2`, then `A1 =\u003e B1 \u003c: A2 =\u003e B2`.\n\nFunctions must be contravariant in their argument types and covariant in their result types, e.g.\n\n```scala\n    trait Function1[-T, +U] {\n      def apply(x: T): U\n    } // Variance check is OK because T is contravariant and U is covariant\n    \n    class Array[+T] {\n      def update(x: T)\n    } // variance checks fails\n```\n\nFind out more about variance in [lecture 4.4](https://class.coursera.org/progfun-2012-001/lecture/81) and [lecture 4.5](https://class.coursera.org/progfun-2012-001/lecture/83 \"Link: https://class.coursera.org/progfun-2012-001/lecture/83\")\n\nPattern Matching\n\nPattern matching is used for decomposing data structures:\n\n```scala\n    unknownObject match {\n      case MyClass(n) =\u003e ...\n      case MyClass2(a, b) =\u003e ...\n    }\n```\n\nHere are a few example patterns\n\n```scala\n    (someList: List[T]) match {\n      case Nil =\u003e ...          // empty list\n      case x :: Nil =\u003e ...     // list with only one element\n      case List(x) =\u003e ...      // same as above\n      case x :: xs =\u003e ...      // a list with at least one element. x is bound to the head,\n                               // xs to the tail. xs could be Nil or some other list.\n      case 1 :: 2 :: cs =\u003e ... // lists that starts with 1 and then 2\n      case (x, y) :: ps =\u003e ... // a list where the head element is a pair\n      case _ =\u003e ...            // default case if none of the above matches\n    }\n```\n\nThe last example shows that every pattern consists of sub-patterns: it only matches lists with at least one element, where that element is a pair. `x` and `y` are again patterns that could match only specific types.\n\n### Options\n\nPattern matching can also be used for `Option` values. Some functions (like `Map.get`) return a value of type `Option[T]` which is either a value of type `Some[T]` or the value `None`:\n\n```scala\n    val myMap = Map(\"a\" -\u003e 42, \"b\" -\u003e 43)\n    def getMapValue(s: String): String = {\n      myMap get s match {\n        case Some(nb) =\u003e \"Value found: \" + nb\n        case None =\u003e \"No value found\"\n      }\n    }\n    getMapValue(\"a\")  // \"Value found: 42\"\n    getMapValue(\"c\")  // \"No value found\"\n```\n\nMost of the times when you write a pattern match on an option value, the same expression can be written more concisely using combinator methods of the `Option` class. For example, the function `getMapValue` can be written as follows:\n\n```scala\n    def getMapValue(s: String): String =\n      myMap.get(s).map(\"Value found: \" + _).getOrElse(\"No value found\")\n```\n\n### Pattern Matching in Anonymous Functions\n\nPattern matches are also used quite often in anonymous functions:\n\n```scala\n    val pairs: List[(Char, Int)] = ('a', 2) :: ('b', 3) :: Nil\n    val chars: List[Char] = pairs.map(p =\u003e p match {\n      case (ch, num) =\u003e ch\n    })\n```\n\nInstead of `p =\u003e p match { case ... }`, you can simply write `{case ...}`, so the above example becomes more concise:\n\n```scala\n    val chars: List[Char] = pairs map {\n      case (ch, num) =\u003e ch\n    }\n```\n\n# Collections\n\nScala defines several collection classes:\n\n## Base Classes\n\n- `Iterable` (collections you can iterate on)\n- `Seq` (ordered sequences)\n- `Set`\n- `Map` (lookup data structure)\n\n## Immutable Collections\n\n- `List` (linked list, provides fast sequential access)\n- `Stream` (same as List, except that the tail is evaluated only on demand)\n- `Vector` (array-like type, implemented as tree of blocks, provides fast random access)\n- `Range` (ordered sequence of integers with equal spacing)\n- `String` (Java type, implicitly converted to a character sequence, so you can treat every string like a `Seq[Char]`)\n- `Map` (collection that maps keys to values)\n- `Set` (collection without duplicate elements)\n\n## Mutable Collections\n\n- `Array` (Scala arrays are native JVM arrays at runtime, therefore they are very performant)\n- Scala also has mutable maps and sets; these should only be used if there are performance issues with immutable types\n\n# Pairs (similar for larger Tuples)\n\n```scala\n    val pair = (\"answer\", 42)   // type: (String, Int)\n    val (label, value) = pair   // label = \"answer\", value = 42  \n    pair._1 // \"answer\"  \n    pair._2 // 42  \n```\n\n# Ordering\n\nThere is already a class in the standard library that represents orderings: `scala.math.Ordering[T]` which contains comparison functions such as `lt()` and `gt()` for standard types. Types with a single natural ordering should inherit from the trait `scala.math.Ordered[T]`.\n\n```scala\n    import math.Ordering  \n    \n    def msort[T](xs: List[T])(implicit ord: Ordering) = { ...}  \n    msort(fruits)(Ordering.String)  \n    msort(fruits)   // the compiler figures out the right ordering  \n```\n\n# For-Comprehensions\n\nA for-comprehension is syntactic sugar for `map`, `flatMap` and `filter` operations on collections.\n\nThe general form is `for (s) yield e`\n\n- `s` is a sequence of generators and filters\n- `p \u003c- e` is a generator\n- `if f` is a filter\n- If there are several generators (equivalent of a nested loop), the last generator varies faster than the first\n- You can use `{ s }` instead of `( s )` if you want to use multiple lines without requiring semicolons\n- `e` is an element of the resulting collection\n\n## Example 1\n\n```scala\n    // list all combinations of numbers x and y where x is drawn from\n    // 1 to M and y is drawn from 1 to N\n    for (x \u003c- 1 to M; y \u003c- 1 to N)\n      yield (x,y)\n```\n\nis equivalent to\n\n```scala\n    (1 to M) flatMap (x =\u003e (1 to N) map (y =\u003e (x, y)))\n```\n\n## Translation Rules\n\nA for-expression looks like a traditional for loop but works differently internally\n\n`for (x \u003c- e1) yield e2` is translated to `e1.map(x =\u003e e2)`\n\n`for (x \u003c- e1 if f) yield e2` is translated to `for (x \u003c- e1.filter(x =\u003e f)) yield e2`\n\n`for (x \u003c- e1; y \u003c- e2) yield e3` is translated to `e1.flatMap(x =\u003e for (y \u003c- e2) yield e3)`\n\nThis means you can use a for-comprehension for your own type, as long as you define `map`, `flatMap` and `filter`.\n\nFor more, see [lecture 6.5](https://class.coursera.org/progfun-2012-001/lecture/111 \"Link: https://class.coursera.org/progfun-2012-001/lecture/111\").\n\n## Example 2\n\n```scala\n    for {  \n      i \u003c- 1 until n  \n      j \u003c- 1 until i  \n      if isPrime(i + j)  \n    } yield (i, j)  \n```\n\nis equivalent to\n\n```scala\n    for (i \u003c- 1 until n; j \u003c- 1 until i if isPrime(i + j))\n        yield (i, j)  \n```\n\nis equivalent to\n\n```scala\n    (1 until n).flatMap(i =\u003e (1 until i).filter(j =\u003e isPrime(i + j)).map(j =\u003e (i, j)))\n```","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/Master/paradigmes":{"title":"","content":"[0. Java OOP](Master/Programmation%20multi-paradigme/0.%20Java%20OOP.md)\n[1. Introduction](Master/Programmation%20multi-paradigme/1.%20Introduction.md)\n[2. Java5](Master/Programmation%20multi-paradigme/2.%20Java5.md)\n[3. JAVA 8](Master/Programmation%20multi-paradigme/3.%20JAVA%208.md)\n[Java Versions and Features](Master/Programmation%20multi-paradigme/Java%20Versions%20and%20Features.md)\n[Modern Java](Master/Programmation%20multi-paradigme/Modern%20Java.md)\n[Scala](Master/Programmation%20multi-paradigme/Scala.md)","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/POO":{"title":"","content":"","lastmodified":"2022-08-03T10:31:04.477738523Z","tags":null},"/WebNet":{"title":"","content":"Welcome in the Web section\npreface [intro_Net](Web\u0026Net/Net/intro_Net.md)\n\n# MDN\n[MDN](Web\u0026Net/MDN.md)\n\n\n# HTML\n[HTML](Web\u0026Net/HTML.md)\n\n# Javascript\nIf you wante some precise explanation about newJS (since ES2015) check out this article\n[Modern Javascript](Web\u0026Net/Modern%20Javascript.md)\n\n# Node\n[Node](Web\u0026Net/Node.md)\n\n# CSS\n[CSS](Web\u0026Net/CSS.md)\n\n# HTTP\n[HTTP](Web\u0026Net/HTTP.md)","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/CSS":{"title":"","content":"# CSS\n\n[animations](Web\u0026Net/styling/animations/animations.md)\n\n[centring](Web\u0026Net/styling/centring.md)\n\n[Positioning](Web\u0026Net/styling/Positioning.md)\n\n[flexbox](Web\u0026Net/styling/flexbox.md)\n\n[pseudoClass](Web\u0026Net/styling/pseudoClass.md)\n\n[features](Web\u0026Net/styling/features.md)","lastmodified":"2022-08-03T10:31:04.493738425Z","tags":null},"/WebNet/HTML":{"title":"","content":"# HTML Cheat Sheet\nA reminder of HTML elements.\n## Minimal page\n```html\n\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n    \u003chead\u003e\n        \u003cmeta charset=\"UTF-8\"\u003e\n        \u003ctitle\u003eTitle\u003c/title\u003e\n    \u003c/head\u003e\n    \u003cbody\u003e\n        \u003c!-- content here --\u003e\n    \u003c/body\u003e\n\u003c/html\u003e\n```\n\n## Head\n```html\n\u003chead\u003e\n    \u003ctitle\u003eTitle\u003c/title\u003e\n    \u003cbase href=\"base-url\" /\u003e\n    \u003clink href=\"style.css\" rel=\"stylesheet\" type=\"text/css\" /\u003e\n    \u003cstyle type=\"text/css\"\u003e\n        /* CSS code */\n    \u003c/style\u003e\n    \u003cscript src=\"script.js\"\u003e\u003c/script\u003e\n    \u003cscript\u003e\n        // Javascript code\n    \u003c/script\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003cmeta name=\"keywords\" content=\"keywords\"\u003e\n    \u003cmeta name=\"description\" content=\"description\"\u003e\n    \u003cmeta name=\"author\" content=\"name\"\u003e\n    \u003cmeta http-equiv=\"refresh\" content=\"10\"\u003e\n\u003c/head\u003e\n```\n\ntag | element\n--- | ---\n**title** | page title\n**base** | base url for all links\n**link** | link to external source\n**style** | CSS inside HTML page\n**script** | Javascript code\n**meta** | metadata\n**meta** *http-equiv*=\"refresh\" *content*=\"10\" | auto-refresh page in 10s\n\n\n## Text content\n\n### Headings\n```html\n\u003ch1\u003eMain heading\u003c/h1\u003e\n\u003c!-- etc --\u003e\n\u003ch6\u003eLevel-6 heading\u003c/h6\u003e\n```\n\ntag | element\n--- | ---\n**h1** | main heading\n**h6** | least important heading\n\n### Paragraphs\n```html\n\u003cp\u003eParagraph.\u003cbr/\u003e\nOther line.\u003c/p\u003e\n\u003cp\u003eOther paragraph.\u003c/p\u003e\n\u003chr/\u003e\n\u003cp\u003eSee the line above.\u003c/p\u003e\n```\n\ntag | element\n--- | ---\n**p** | paragraph\n**br** | line break\n**hr** | horizontal line\n\n### Formatting\n```html\n\u003cem\u003eFormatting\u003c/em\u003e is \u003cstrong\u003eimportant\u003c/strong\u003e !\n(a+b)\u003csup\u003e2\u003c/sup\u003e = a\u003csup\u003e2\u003c/sup\u003e + b\u003csup\u003e2\u003c/sup\u003e + 2ab\n```\n\ntag | element\n--- | ---\n**sub** | subscript\n**sup** | superscript\n**em** | emphasize\n**strong** | important\n**mark** | highlighted\n**small** | small\n**i** | italic\n**b** | bold\n\n### Quotes\n```html\n\u003ccite\u003eThis book\u003c/cite\u003e was written by this author.\n\u003cq cite=\"url\"\u003equotation\u003c/q\u003e\n\u003cblockquote cite=\"url\"\u003e\nLorem ipsum\u003cbr/\u003e\nLorem ipsum\n\u003c/blockquote\u003e\n```\n\ntag | element\n--- | ---\n**cite** | title of a work\n**q** | inline quotation\n**blockquote** | quotation\n\n\n## Content\n\n### Links\n```html\n\u003ca href=\"url\"\u003elink\u003c/a\u003e\n\u003ca href=\"url\" target=_blank\u003eopen in a new window\u003c/a\u003e\n\n\u003ca href=\"#comments\"\u003ewatch comments\u003c/a\u003e\n\u003ch2 id=\"comments\"\u003ecomments\u003c/h2\u003e\n```\n\ntag | element\n--- | ---\n**a** | hyperlink\n\n### Images\n```html\n\u003cimg src=\"image.png\" alt=\"description\" width=\"300\" height=\"200\" /\u003e\n```\n\ntag | element\n--- | ---\n**img** | image\n\n### Blocks\n```html\n\u003cdiv\u003eblock\u003c/div\u003e\n\u003cspan\u003einline\u003c/span\u003e\n```\n\ntag | element\n--- | ---\n**div** | block-level element\n**span** | inline element\n\n\n## Lists\n\n### Unordered list\n```html\n\u003cul\u003e\n    \u003cli\u003eitem\u003c/li\u003e\n    \u003cli\u003eitem\u003c/li\u003e\n    \u003cli\u003eitem\u003c/li\u003e\n\u003c/ul\u003e\n```\n\ntag | element\n--- | ---\n**ul** | unordered list\n**li** | list item\n\n### Ordored list\n```html\n\u003col\u003e\n    \u003cli\u003efirst\u003c/li\u003e\n    \u003cli\u003esecond\u003c/li\u003e\n    \u003cli\u003ethird\u003c/li\u003e\n\u003c/ol\u003e\n```\n\ntag | element\n--- | ---\n**ol** | ordered list\n**li** | list item\n\n### Definition list\n```html\n\u003cdl\u003e\n    \u003cdt\u003eterm\u003c/dt\u003e\u003cdd\u003edefinition\u003c/dd\u003e\n    \u003cdt\u003eterm\u003c/dt\u003e\u003cdd\u003edefinition\u003c/dd\u003e\n    \u003cdt\u003eterm\u003c/dt\u003e\u003cdd\u003edefinition\u003c/dd\u003e\n\u003c/dl\u003e\n```\n\ntag | element\n--- | ---\n**dl** | definition list\n**dt** | term\n**dd** | definition\n\n\n## Tables\n\n### Basic table\n```html\n\u003ctable\u003e\n\u003ctr\u003e\n    \u003cth\u003eheading 1\u003c/th\u003e\n    \u003cth\u003eheading 2\u003c/th\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n    \u003ctd\u003eline 1, column 1\u003c/td\u003e\n    \u003ctd\u003eline 1, column 2\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n    \u003ctd\u003eline 2, column 1\u003c/td\u003e\n    \u003ctd\u003eline 2, column 2\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/table\u003e\n```\n\ntag | element\n--- | ---\n**table** | table\n**tr** | table row\n**th** | table heading\n**td** | table cell\n\n### Advanced table\n```html\n\u003ctable\u003e\n\u003ccaption\u003ecaption\u003c/caption\u003e\n\u003ccolgroup\u003e\n    \u003ccol span=\"2\" style=\"...\" /\u003e\n    \u003ccol style=\"...\" /\u003e\n\u003c/colgroup\u003e\n\u003cthead\u003e\n    \u003ctr\u003e\n        \u003cth\u003eheading 1\u003c/th\u003e\n        \u003cth\u003eheading 2\u003c/th\u003e\n        \u003cth\u003eheading 3\u003c/th\u003e\n    \u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctfoot\u003e\n    \u003ctr\u003e\n        \u003cth\u003efooter 1\u003c/th\u003e\n        \u003cth\u003efooter 2\u003c/th\u003e\n        \u003cth\u003efooter 3\u003c/th\u003e\n    \u003c/tr\u003e\n\u003c/tfoot\u003e\n\u003ctbody\u003e\n    \u003ctr\u003e\n        \u003ctd\u003eline 1, column 1\u003c/td\u003e\n        \u003ctd\u003eline 1, column 2\u003c/td\u003e\n        \u003ctd\u003eline 1, column 3\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n        \u003ctd\u003eline 2, column 1\u003c/td\u003e\n        \u003ctd\u003eline 2, column 2\u003c/td\u003e\n        \u003ctd\u003eline 2, column 3\u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n```\n\ntag | element\n--- | ---\n**caption** | caption\n**colgroup** | defines groups of columns\n**col** | defines column's properties\n**thead** | groups headings together\n**tfoot** | groups footers together\n**tbody** | groups other rows\n\n\n## Forms\n```html\n\u003cform action=\"url\" method=\"post\"\u003e\n    \u003cfieldset\u003e\n        \u003clegend\u003eWho are you ?\u003c/legend\u003e\n        \u003clabel\u003eLogin :\u003cinput type=\"text\" name=\"login\" /\u003e\u003c/label\u003e\u003cbr/\u003e\n        \u003clabel for=\"pswd\"\u003ePassword :\u003c/label\u003e\u003cinput type=\"password\" name=\"password\" id=\"pswd\" /\u003e\u003cbr/\u003e\n        \u003cinput type=\"radio\" name=\"sex\" value=\"male\" /\u003eMale\u003cbr/\u003e\n        \u003cinput type=\"radio\" name=\"sex\" value=\"female\" /\u003eFemale\u003cbr/\u003e\n    \u003c/fieldset\u003e\n    \n    \u003clabel\u003eYour favorite color : \u003cselect name=\"color\"\u003e\n        \u003coption\u003ered\u003c/option\u003e\n        \u003coption\u003egreen\u003c/option\u003e\n        \u003coption\u003eblue\u003c/option\u003e\n    \u003c/select\u003e\u003c/label\u003e\n    \n    \u003cinput type=\"checkbox\" name=\"available\" value=\"monday\" /\u003eMonday\u003cbr/\u003e\n    \u003cinput type=\"checkbox\" name=\"available\" value=\"tuesday\" /\u003eTuesday\u003cbr/\u003e\n    \n    \u003ctextarea name=\"comments\" rows=\"10\" cols=\"30\" placeholder=\"Write your comments here\"\u003e\u003ctextarea/\u003e\n    \n    \u003cinput type=\"submit\" value=\"Button text\"\u003e\n\u003c/form\u003e\n```\n\ntag | element\n--- | ---\n**form** | form\n**label** | label for input\n**fieldset** | group inputs together\n**legend** | legend for fieldset\n**input** type=\"*text*\" | text input\n**input** type=\"*password*\" | password input\n**input** type=\"*radio*\" | radio button\n**input** type=\"*checkbox*\" | checkbox\n**input** type=\"*submit*\" | send form\n**select** | drop-down list\n**option** | drop-down list item\n**optgroup** | group of drop-down list items\n**datalist** | autocompletion list\n**textarea** | large text input\n\n\n## HTML5 Semantic\n\n### Page layout\n```html\n\u003cheader\u003eMy website\u003c/header\u003e\n\u003cnav\u003e\n    \u003ca href=\"page1\"\u003ePage 1\u003c/a\u003e\n    \u003ca href=\"page2\"\u003ePage 2\u003c/a\u003e\n    \u003ca href=\"page3\"\u003ePage 3\u003c/a\u003e\n\u003c/nav\u003e\n\n\u003csection\u003e\n    Hello everybody, Welcome to my website !\n\u003c/section\u003e\n\n\u003carticle\u003e\n    \u003cheader\u003e\n        \u003ch2\u003eTitle\u003c/h2\u003e\n    \u003c/header\u003e\n    \u003cp\u003e\n        My article\n    \u003c/p\u003e\n\u003c/article\u003e\n\n\u003caside\u003e\n    Writen by me\n\u003c/aside\u003e\n\n\u003csection id=\"comments\"\u003e\n    \u003carticle\u003eComment 1\u003c/article\u003e\n    \u003carticle\u003eComment 2\u003c/article\u003e\n\u003c/section\u003e\n\n\u003cfooter\u003e\nCopyright notice\n\u003c/footer\u003e\n```\n\ntag | element\n--- | ---\n**header** | header of document or section\n**footer** | footer of document or section\n**section** | section\n**article** | article, forum post, blog post, comment\n**aside** | aside content related to surrounding content\n**nav** | navigation links\n\n### New elements\n```html\n\u003cfigure\u003e\n    \u003cimg src=\"image.png\" alt=\"figure 1\" /\u003e\n    \u003cfigcaption\u003eFigure 1\u003c/figcaption\u003e\n\u003c/figure\u003e\n\n\u003cdetails\u003e\n    \u003csummary\u003eDeclaration of M. X on \u003ctime datetime=\"2013-12-25\"\u003eChristmas day\u003c/time\u003e\u003c/summary\u003e\n    \u003cp\u003eM. X said...\u003c/p\u003e\n\u003c/details\u003e\n\nDownloading progress : \u003cprogress value=\"53\" max=\"100\"\u003e\u003c/progress\u003e\nDisk space : \u003cmeter value=\"62\" min=\"10\" max=\"350\"\u003e\u003c/meter\u003e\n```\n\ntag | element\n--- | ---\n**figure** | an illustration\n**figcaption** | caption of a figure element\n**details** | details that can be shown or hidden\n**summary** | visible heading of a details element\n**progress** | progress of a task\n**meter** | display a gauge\n**time** | machine-readable time indication","lastmodified":"2022-08-03T10:31:04.493738425Z","tags":null},"/WebNet/HTTP":{"title":"","content":"# HTTP Messages\n\nHTTP messages are how data is exchanged between a server and a client. There are two types of messages: [HTTP Request](Web\u0026Net/Net/HTTP%20Request.md) sent by the client to trigger an action on the server, and [HTPP Response](Web\u0026Net/Net/HTPP%20Response.md), the answer from the server.\n\nWeb developers, or webmasters, rarely craft these textual HTTP messages themselves: software, a Web browser, proxy, or Web server, perform this action. They provide HTTP messages through config files (for proxies or servers), APIs (for browsers), or other interfaces.\n\n**The 2 main point are :**  \n[Methods](Web\u0026Net/Net/Methods.md)  \n[Status Codes](Web\u0026Net/Net/Status%20Codes.md)\n\nSee also :  \n[HTTP 2](Web\u0026Net/Net/HTTP%202.md)  \n[HTTP3](Web\u0026Net/Net/HTTP3.md)  \n\n![From a user-, script-, or server- generated event, an HTTP/1.x msg is generated, and if HTTP/2 is in use, it is binary framed into an HTTP/2 stream, then sent.](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages/httpmsg2.png)\n\n\n![Requests and responses share a common structure in HTTP](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages/httpmsgstructure2.png)\n\n## Conclusion\n\nHTTP messages are the key in using HTTP; their structure is simple, and they are highly extensible. The HTTP/2 framing mechanism adds a new intermediate layer between the HTTP/1.x syntax and the underlying transport protocol, without fundamentally modifying it: building upon proven mechanisms.","lastmodified":"2022-08-03T10:31:04.493738425Z","tags":null},"/WebNet/MDN":{"title":"MDN","content":"\n# Resources\n\nThe following resources can help you better understand the concepts, elements, and APIs presented in this course.\n\n## HTML\n\n- [Overview](https://developer.mozilla.org/docs/Web/HTML)\n- [`doctype` element](https://developer.mozilla.org/docs/Web/HTML/Quirks_Mode_and_Standards_Mode)\n- [Elements](https://developer.mozilla.org/docs/Web/HTML/Element)\n- [What is the difference between HTML tags and elements?](https://stackoverflow.com/questions/8937384/what-is-the-difference-between-html-tags-and-elements)\n- [HTML tags vs. elements vs. attributes](https://www.456bereastreet.com/archive/200508/html_tags_vs_elements_vs_attributes/)\n- Images\n  - [`img` element](https://developer.mozilla.org/docs/Web/HTML/Element/Img)\n  - [Responsive images](https://developer.mozilla.org/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images)\n- [Links (anchor element)](https://developer.mozilla.org/docs/Web/HTML/Element/a)\n- Tables\n  - [`table` element](https://developer.mozilla.org/docs/Web/HTML/Element/table)\n  - [Table basics](https://developer.mozilla.org/docs/Learn/HTML/Tables/Basics)\n- Forms\n  - [`form` element](https://developer.mozilla.org/docs/Web/HTML/Element/form)\n  - [`input` element](https://developer.mozilla.org/docs/Web/HTML/Element/Input)\n  - [`label` element](https://developer.mozilla.org/docs/Web/HTML/Element/label)\n  - [Form basics](https://developer.mozilla.org/docs/Learn/Forms)\n  - [Sending data](https://developer.mozilla.org/docs/Learn/Forms/Sending_and_retrieving_form_data)\n  - [Difference between `name` and `id` attributes](https://stackoverflow.com/questions/1397592/difference-between-id-and-name-attributes-in-html)\n  - [Validation](https://developer.mozilla.org/docs/Learn/Forms/Form_validation)\n- [Using the viewport meta tag to control layout on mobile browsers](https://developer.mozilla.org/docs/Mozilla/Mobile/Viewport_meta_tag)\n- [`meta` element](https://developer.mozilla.org/docs/Web/HTML/Element/meta)\n  - [`http-equiv` attribute](https://stackoverflow.com/questions/6771258/what-does-meta-http-equiv-x-ua-compatible-content-ie-edge-do)\n\n## CSS\n\n- [Overview](https://developer.mozilla.org/docs/Web/CSS)\n- [`style` element](https://developer.mozilla.org/docs/Web/SVG/Element/style)\n- [`link` element](https://developer.mozilla.org/docs/Web/HTML/Element/link)\n- [How cascading works](https://developer.mozilla.org/docs/Learn/CSS/Building_blocks/Cascade_and_inheritance)\n- [Selectors](https://developer.mozilla.org/docs/Learn/CSS/Building_blocks/Selectors)\n  - [Cheat sheet](https://frontend30.com/css-selectors-cheatsheet/)\n- [Box model](https://developer.mozilla.org/docs/Web/CSS/CSS_Box_Model/Introduction_to_the_CSS_box_model)\n- [`float` property](https://developer.mozilla.org/docs/Web/CSS/float)\n- [Layout techniques](https://developer.mozilla.org/docs/Learn/CSS/CSS_layout/Introduction)\n- [Beginner's guide to media queries](https://developer.mozilla.org/docs/Learn/CSS/CSS_layout/Media_queries)\n\n## JavaScript\n\n- [Overview](https://developer.mozilla.org/docs/Web/javascript)\n- [`script` element](https://developer.mozilla.org/docs/Web/HTML/Element/script)\n- [Client-side APIs](https://developer.mozilla.org/docs/Learn/JavaScript/Client-side_web_APIs/Introduction)\n- [List of event targets](https://developer.mozilla.org/docs/Web/Events)\n- [`DOMContentLoaded` event](https://developer.mozilla.org/docs/Web/API/Document/DOMContentLoaded_event)\n- [List of Web APIs](https://developer.mozilla.org/docs/Web/API)\n- [Web Storage](https://developer.mozilla.org/docs/Web/API/Web_Storage_API)\n  - localStorage\n- Geolocation\n  - [API](https://developer.mozilla.org/docs/Web/API/Geolocation_API)\n  - [`getCurrentPosition` method](https://developer.mozilla.org/docs/Web/API/Geolocation/getCurrentPosition)\n  - [`GeolocationPosition` interface](https://developer.mozilla.org/docs/Web/API/GeolocationPosition)\n  - [`GeolocationCoordinates` interface](https://developer.mozilla.org/docs/Web/API/GeolocationCoordinates)\n\n## Tools\n\n- [Visual Studio Code](https://code.visualstudio.com/)\n- [Live Server](https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer)\n- [Can I Use](https://caniuse.com/)\n- [HTML Validator](https://validator.w3.org/)\n- [CSS Validator](http://www.css-validator.org/)\n- [20 Best Emmet Tips to Help You Code HTML/CSS Crazy Fast](https://beebom.com/best-emmet-tips-to-code-htmlcss-fast/)","lastmodified":"2022-08-03T10:31:04.493738425Z","tags":null},"/WebNet/Modern-Javascript":{"title":"","content":"# Notions\n## Destructuring objects and arrays\n\n*Destructuring* is a convenient way of creating new variables by extracting some values from data stored in objects or arrays.\n\nTo name a few use cases, *destructuring* can be used to destructure function parameters or *this.props* in React projects for instance.\n\n### Explanation with sample code\n\n- Object\n\nLet’s consider the following object for all the samples:\n\n```js\nconst person = {\n  firstName: \"Nick\",\n  lastName: \"Anderson\",\n  age: 35,\n  sex: \"M\"\n}\n```\n\nWithout destructuring\n\n```js\nconst nickname = person.firstName;\nconst age = person.age;\nconst city = person.city || \"Paris\";\n```\n\nWith destructuring, all in one line:\n\n```js\nconst { firstName: nickname, age, city = \"Paris\" } = person; // That's it !\n```\n\n\u003cbr/\u003e\n\nDestructuring is even more pleasant to use with arrow functions :\n\n```js\nconst joinFirstLastName = ({ firstName, lastName }) =\u003e firstName + '-' + lastName;\n\njoinFirstLastName(person); // \"Nick-Anderson\"\n```\n\n- Array\n\nLet’s consider the following array:\n\n```js\nconst myArray = [\"a\", \"b\", \"c\"];\n```\n\nWithout destructuring\n\n```js\nconst x = myArray[0];\nconst y = myArray[1];\n```\n\nWith destructuring\n\n```js\nconst [x, y] = myArray; // That's it !\n\nconsole.log(x) // \"a\"\nconsole.log(y) // \"b\"\n```\n\n### Useful resources\n\n- [ES6 Features - Destructuring Assignment](http://es6-features.org/#ArrayMatching)\n- [Destructuring Objects - WesBos](http://wesbos.com/destructuring-objects/)\n- [ExploringJS - Destructuring](http://exploringjs.com/es6/ch_destructuring.html)\n\n## Array methods - map / filter / reduce / find\n\n*Map*, *filter*, *reduce* and *find* are array methods that are coming from a programming paradigm named [*functional programming*](https://medium.com/javascript-scene/master-the-javascript-interview-what-is-functional-programming-7f218c68b3a0).\n\nTo sum it up:\n\n- **Array.prototype.map()** does something on each elements\n- **Array.prototype.filter()** decides element by element if it should keep it\n- **Array.prototype.reduce()** aggregates the elements into a single value\n- **Array.prototype.find()** returns the first element that satisfies the provided condition.\n\nI recommend to use them as much as possible in following the principles of functional programming because they are composable, concise and elegant.\n\nWith those four methods, you can avoid the use of *for* and *forEach* loops in most situations. When you are tempted to do a *for* loop, try to do it with *map*, *filter*, *reduce* and *find* composed. You might struggle to do it at first because it requires you to learn a new way of thinking, but once you’ve got it things get easier.\n\n#### Sample code\n\n```js\nconst numbers = [0, 1, 2, 3, 4, 5, 6];\nconst doubledNumbers = numbers.map(n =\u003e n * 2); // [0, 2, 4, 6, 8, 10, 12]\nconst evenNumbers = numbers.filter(n =\u003e n % 2 === 0); // [0, 2, 4, 6]\nconst sum = numbers.reduce((prev, next) =\u003e prev + next, 0); // 21\nconst greaterThanFour = numbers.find((n) =\u003e n\u003e4); // 5\n```\n\nCompute total grade sum for students with grades 10 or above by composing map, filter and reduce:\n\n```js\nconst students = [\n  { name: \"Nick\", grade: 10 },\n  { name: \"John\", grade: 15 },\n  { name: \"Julia\", grade: 19 },\n  { name: \"Nathalie\", grade: 9 },\n];\n\nconst aboveTenSum = students\n  .map(student =\u003e student.grade) // we map the students array to an array of their grades\n  .filter(grade =\u003e grade \u003e= 10) // we filter the grades array to keep those 10 or above\n  .reduce((prev, next) =\u003e prev + next, 0); // we sum all the grades 10 or above one by one\n\nconsole.log(aboveTenSum) // 44 -- 10 (Nick) + 15 (John) + 19 (Julia), Nathalie below 10 is ignored\n```\n\n\n## Spread operator “…”\n\nThe spread operator `...` has been introduced with ES2015 and is used to expand elements of an iterable (like an array) into places where multiple elements can fit.\n\n### Sample code\n\n```js\nconst arr1 = [\"a\", \"b\", \"c\"];\nconst arr2 = [...arr1, \"d\", \"e\", \"f\"]; // [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"]\n```\n\n### Explanation\n\n#### In iterables (like arrays)\n\nIf we have the two following arrays:\n\n```js\nconst arr1 = [\"a\", \"b\", \"c\"];\nconst arr2 = [arr1, \"d\", \"e\", \"f\"]; // [[\"a\", \"b\", \"c\"], \"d\", \"e\", \"f\"]\n```\n\n*arr2* the first element is an array because *arr1* is injected as is into *arr2*. But what we want is *arr2* to be an array of letters. To do so, we can *spread* the elements of *arr1* into *arr2*.\n\nWith spread operator\n\n```js\nconst arr1 = [\"a\", \"b\", \"c\"];\nconst arr2 = [...arr1, \"d\", \"e\", \"f\"]; // [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"]\n```\n\n#### Function rest parameter\n\nIn function parameters, we can use the rest operator to inject parameters into an array we can loop in. There is already an **arguments** object bound to every function that is equal to an array of all the parameters passed into the function.\n\n```js\nfunction myFunc() {\n  for (var i = 0; i \u003c arguments.length; i++) {\n    console.log(arguments[i]);\n  }\n}\n\nmyFunc(\"Nick\", \"Anderson\", 10, 12, 6);\n// \"Nick\"\n// \"Anderson\"\n// 10\n// 12\n// 6\n```\n\nBut let’s say that we want this function to create a new student with its grades and with its average grade. Wouldn’t it be more convenient to extract the first two parameters into two separate variables, and then have all the grades in an array we can iterate over?\n\nThat’s exactly what the rest operator allows us to do!\n\n```js\nfunction createStudent(firstName, lastName, ...grades) {\n  // firstName = \"Nick\"\n  // lastName = \"Anderson\"\n  // [10, 12, 6] -- \"...\" takes all other parameters passed and creates a \"grades\" array variable that contains them\n\n  const avgGrade = grades.reduce((acc, curr) =\u003e acc + curr, 0) / grades.length; // computes average grade from grades\n\n  return {\n    firstName: firstName,\n    lastName: lastName,\n    grades: grades,\n    avgGrade: avgGrade\n  }\n}\n\nconst student = createStudent(\"Nick\", \"Anderson\", 10, 12, 6);\nconsole.log(student);\n// {\n//   firstName: \"Nick\",\n//   lastName: \"Anderson\",\n//   grades: [10, 12, 6],\n//   avgGrade: 9,33\n// }\n```\n\n\u003e **Note:** createStudent function is bad because we don’t check if grades.length exists or is different from 0. But it’s easier to read this way, so I didn’t handle this case.\n\n#### Object properties spreading\n\nFor this one, I recommend you read previous explanations about the rest operator on iterables and function parameters.\n\n```js\nconst myObj = { x: 1, y: 2, a: 3, b: 4 };\nconst { x, y, ...z } = myObj; // object destructuring here\nconsole.log(x); // 1\nconsole.log(y); // 2\nconsole.log(z); // { a: 3, b: 4 }\n\n// z is the rest of the object destructured: myObj object minus x and y properties destructured\n\nconst n = { x, y, ...z };\nconsole.log(n); // { x: 1, y: 2, a: 3, b: 4 }\n\n// Here z object properties are spread into n\n```\n\n### External resources\n\n- [TC39 - Object rest/spread](https://github.com/tc39/proposal-object-rest-spread)\n- [Spread operator introduction - WesBos](https://github.com/wesbos/es6-articles/blob/master/28%20-%20Spread%20Operator%20Introduction.md)\n- [JavaScript \u0026 the spread operator](https://codeburst.io/javascript-the-spread-operator-a867a71668ca)\n- [6 Great uses of the spread operator](https://davidwalsh.name/spread-operator)\n\n\n## Promises\n\nA promise is an object which can be returned synchronously from an asynchronous function ([ref](https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-promise-27fc71e77261#3cd0)).\n\nPromises can be used to avoid [callback hell](http://callbackhell.com/), and they are more and more frequently encountered in modern JavaScript projects.\n\n### Sample code\n\n```js\nconst fetchingPosts = new Promise((res, rej) =\u003e {\n  $.get(\"/posts\")\n    .done(posts =\u003e res(posts))\n    .fail(err =\u003e rej(err));\n});\n\nfetchingPosts\n  .then(posts =\u003e console.log(posts))\n  .catch(err =\u003e console.log(err));\n```\n\n### Explanation\n\nWhen you do an *Ajax request* the response is not synchronous because you want a resource that takes some time to come. It even may never come if the resource you have requested is unavailable for some reason (404).\n\nTo handle that kind of situation, ES2015 has given us *promises*. Promises can have three different states:\n\n- Pending\n- Fulfilled\n- Rejected\n\nLet’s say we want to use promises to handle an Ajax request to fetch the resource X.\n\n#### Create the promise\n\nWe firstly are going to create a promise. We will use the jQuery get method to do our Ajax request to X.\n\n```js\nconst xFetcherPromise = new Promise( // Create promise using \"new\" keyword and store it into a variable\n  function(resolve, reject) { // Promise constructor takes a function parameter which has resolve and reject parameters itself\n    $.get(\"X\") // Launch the Ajax request\n      .done(function(X) { // Once the request is done...\n        resolve(X); // ... resolve the promise with the X value as parameter\n      })\n      .fail(function(error) { // If the request has failed...\n        reject(error); // ... reject the promise with the error as parameter\n      });\n  }\n)\n```\n\nAs seen in the above sample, the Promise object takes an *executor* function which takes two parameters **resolve** and **reject**. Those parameters are functions which when called are going to move the promise *pending* state to respectively a *fulfilled* and *rejected* state.\n\nThe promise is in pending state after instance creation and its *executor* function is executed immediately. Once one of the function *resolve* or *reject* is called in the *executor* function, the promise will call its associated handlers.\n\n#### Promise handlers usage\n\nTo get the promise result (or error), we must attach to it handlers by doing the following:\n\n```js\nxFetcherPromise\n  .then(function(X) {\n    console.log(X);\n  })\n  .catch(function(err) {\n    console.log(err)\n  })\n```\n\nIf the promise succeeds, *resolve* is executed and the function passed as `.then` parameter is executed.\n\nIf it fails, *reject* is executed and the function passed as `.catch` parameter is executed.\n\n\u003e **Note :** If the promise has already been fulfilled or rejected when a corresponding handler is attached, the handler will be called, so there is no race condition between an asynchronous operation completing and its handlers being attached. [(Ref: MDN)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise#Description)\n\n### External Resources\n\n- [JavaScript Promises for dummies - Jecelyn Yeen](https://scotch.io/tutorials/javascript-promises-for-dummies)\n- [JavaScript Promise API - David Walsh](https://davidwalsh.name/promises)\n- [Using promises - MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Using_promises)\n- [What is a promise - Eric Elliott](https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-promise-27fc71e77261)\n- [JavaScript Promises: an Introduction - Jake Archibald](https://developers.google.com/web/fundamentals/getting-started/primers/promises)\n- [Promise documentation - MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)\n## Imports / Exports\n\nES6 modules are used to access variables or functions in a module explicitly exported by the modules it imports.\n\nI highly recommend to take a look at MDN resources on import/export (see external resources below), it is both straightforward and complete.\n\n#### Explanation with sample code\n\n#### Named exports\n\nNamed exports are used to export several values from a module.\n\n\u003e **Note :** You can only name-export [first-class citizens](https://en.wikipedia.org/wiki/First-class_citizen) that have a name.\n\n```js\n// mathConstants.js\nexport const pi = 3.14;\nexport const exp = 2.7;\nexport const alpha = 0.35;\n\n// -------------\n\n// myFile.js\nimport { pi, exp } from './mathConstants.js'; // Named import -- destructuring-like syntax\nconsole.log(pi) // 3.14\nconsole.log(exp) // 2.7\n\n// -------------\n\n// mySecondFile.js\nimport * as constants from './mathConstants.js'; // Inject all exported values into constants variable\nconsole.log(constants.pi) // 3.14\nconsole.log(constants.exp) // 2.7\n```\n\nWhile named imports looks like *destructuring*, they have a different syntax and are not the same. They don’t support default values nor *deep* destructuring.\n\nBesides, you can do aliases but the syntax is different from the one used in destructuring:\n\n```js\nimport { foo as bar } from 'myFile.js'; // foo is imported and injected into a new bar variable\n```\n\n#### Default import / export\n\nConcerning the default export, there is only a single default export per module. A default export can be a function, a class, an object or anything else. This value is considered the “main” exported value since it will be the simplest to import. [Ref: MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export#Description)\n\n```js\n// coolNumber.js\nconst ultimateNumber = 42;\nexport default ultimateNumber;\n\n// ------------\n\n// myFile.js\nimport number from './coolNumber.js';\n// Default export, independently from its name, is automatically injected into number variable;\nconsole.log(number) // 42\n```\n\nFunction exporting:\n\n```js\n// sum.js\nexport default function sum(x, y) {\n  return x + y;\n}\n// -------------\n\n// myFile.js\nimport sum from './sum.js';\nconst result = sum(1, 2);\nconsole.log(result) // 3\n```\n\n### External resources\n\n- [ES6 Modules in bulletpoints](https://ponyfoo.com/articles/es6#modules)\n- [Export - MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export)\n- [Import - MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import)\n- [Understanding ES6 Modules](https://www.sitepoint.com/understanding-es6-modules/)\n- [Destructuring special case - import statements](https://ponyfoo.com/articles/es6-destructuring-in-depth#special-case-import-statements)\n- [Misunderstanding ES6 Modules - Kent C. Dodds](https://medium.com/@kentcdodds/misunderstanding-es6-modules-upgrading-babel-tears-and-a-solution-ad2d5ab93ce0)\n- [Modules in JavaScript](http://exploringjs.com/es6/ch_modules.html#sec_modules-in-javascript)\n\n## Async Await\n\nIn addition to Promises, there is a new syntax you might encounter to handle asynchronous code named *async / await*.\n\nThe purpose of async/await functions is to simplify the behavior of using promises synchronously and to perform some behavior on a group of Promises. Just as Promises are similar to structured callbacks, async/await is similar to combining generators and promises. Async functions *always* return a Promise. ([Ref: MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function))\n\n\u003e **Note :** You must understand what promises are and how they work before trying to understand async / await since they rely on it.\n\n\u003e **Note 2:** [*await* must be used in an *async* function](https://hackernoon.com/6-reasons-why-javascripts-async-await-blows-promises-away-tutorial-c7ec10518dd9#f3f0), which means that you can’t use await in the top level of our code since that is not inside an async function.\n\n### Sample code\n\n```js\nasync function getGithubUser(username) { // async keyword allows usage of await in the function and means function returns a promise\n  const response = await fetch(`https://api.github.com/users/${username}`); // Execution is paused here until the Promise returned by fetch is resolved\n  return response.json();\n}\n\ngetGithubUser('mbeaudru')\n  .then(user =\u003e console.log(user)) // logging user response - cannot use await syntax since this code isn't in async function\n  .catch(err =\u003e console.log(err)); // if an error is thrown in our async function, we will catch it here\n```\n\n### Explanation with sample code\n\n*Async / Await* is built on promises but they allow a more imperative style of code.\n\nThe *async* operator marks a function as asynchronous and will always return a *Promise*. You can use the *await* operator in an *async* function to pause execution on that line until the returned Promise from the expression either resolves or rejects.\n\n```js\nasync function myFunc() {\n  // we can use await operator because this function is async\n  return \"hello world\";\n}\n\nmyFunc().then(msg =\u003e console.log(msg)) // \"hello world\" -- myFunc's return value is turned into a promise because of async operator\n```\n\nWhen the *return* statement of an async function is reached, the Promise is fulfilled with the value returned. If an error is thrown inside an async function, the Promise state will turn to *rejected*. If no value is returned from an async function, a Promise is still returned and resolves with no value when execution of the async function is complete.\n\n*await* operator is used to wait for a *Promise* to be fulfilled and can only be used inside an *async* function body. When encountered, the code execution is paused until the promise is fulfilled.\n\n\u003e **Note :** *fetch* is a function that returns a Promise that allows to do an AJAX request\n\nLet’s see how we could fetch a github user with promises first:\n\n```js\nfunction getGithubUser(username) {\n  return fetch(`https://api.github.com/users/${username}`).then(response =\u003e response.json());\n}\n\ngetGithubUser('mbeaudru')\n  .then(user =\u003e console.log(user))\n  .catch(err =\u003e console.log(err));\n```\n\nHere’s the *async / await* equivalent:\n\n```js\nasync function getGithubUser(username) { // promise + await keyword usage allowed\n  const response = await fetch(`https://api.github.com/users/${username}`); // Execution stops here until fetch promise is fulfilled\n  return response.json();\n}\n\ngetGithubUser('mbeaudru')\n  .then(user =\u003e console.log(user))\n  .catch(err =\u003e console.log(err));\n```\n\n*async / await* syntax is particularly convenient when you need to chain promises that are interdependent.\n\nFor instance, if you need to get a token in order to be able to fetch a blog post on a database and then the author informations:\n\n\u003e **Note :** *await* expressions needs to be wrapped in parentheses to call its resolved value’s methods and properties on the same line.\n\n```js\nasync function fetchPostById(postId) {\n  const token = (await fetch('token_url')).json().token;\n  const post = (await fetch(`/posts/${postId}?token=${token}`)).json();\n  const author = (await fetch(`/users/${post.authorId}`)).json();\n\n  post.author = author;\n  return post;\n}\n\nfetchPostById('gzIrzeo64')\n  .then(post =\u003e console.log(post))\n  .catch(err =\u003e console.log(err));\n```\n\n#### Error handling\n\nUnless we add *try / catch* blocks around *await* expressions, uncaught exceptions – regardless of whether they were thrown in the body of your *async* function or while it’s suspended during *await* – will reject the promise returned by the *async* function. Using the `throw` statement in an async function is the same as returning a Promise that rejects. [(Ref: PonyFoo)](https://ponyfoo.com/articles/understanding-javascript-async-await#error-handling).\n\n\u003e **Note :** Promises behave the same!\n\nWith promises, here is how you would handle the error chain:\n\n```js\nfunction getUser() { // This promise will be rejected!\n  return new Promise((res, rej) =\u003e rej(\"User not found !\"));\n}\n\nfunction getAvatarByUsername(userId) {\n  return getUser(userId).then(user =\u003e user.avatar);\n}\n\nfunction getUserAvatar(username) {\n  return getAvatarByUsername(username).then(avatar =\u003e ({ username, avatar }));\n}\n\ngetUserAvatar('mbeaudru')\n  .then(res =\u003e console.log(res))\n  .catch(err =\u003e console.log(err)); // \"User not found !\"\n```\n\nThe equivalent with *async / await*:\n\n```js\nasync function getUser() { // The returned promise will be rejected!\n  throw \"User not found !\";\n}\n\nasync function getAvatarByUsername(userId) =\u003e {\n  const user = await getUser(userId);\n  return user.avatar;\n}\n\nasync function getUserAvatar(username) {\n  var avatar = await getAvatarByUsername(username);\n  return { username, avatar };\n}\n\ngetUserAvatar('mbeaudru')\n  .then(res =\u003e console.log(res))\n  .catch(err =\u003e console.log(err)); // \"User not found !\"\n```\n\n### External resources\n\n- [Async/Await - JavaScript.Info](https://javascript.info/async-await)\n- [ES7 Async/Await](http://rossboucher.com/await/#/)\n- [6 Reasons Why JavaScript’s Async/Await Blows Promises Away](https://hackernoon.com/6-reasons-why-javascripts-async-await-blows-promises-away-tutorial-c7ec10518dd9)\n- [JavaScript awaits](https://dev.to/kayis/javascript-awaits)\n- [Using Async Await in Express with Node 8](https://medium.com/@Abazhenov/using-async-await-in-express-with-node-8-b8af872c0016)\n- [Async Function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)\n- [Await](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await)\n- [Using async / await in express with node 8](https://medium.com/@Abazhenov/using-async-await-in-express-with-node-8-b8af872c0016)\n\n## Truthy / Falsy\n\nIn JavaScript, a truthy or falsy value is a value that is being casted into a boolean when evaluated in a boolean context. An example of boolean context would be the evaluation of an `if` condition:\n\nEvery value will be casted to `true` unless they are equal to:\n\n- `false`\n- `0`\n- `\"\"` (empty string)\n- `null`\n- `undefined`\n- `NaN`\n\nHere are examples of *boolean context*:\n\n- `if` condition evaluation\n\n```js\nif (myVar) {}\n```\n\n`myVar` can be any [first-class citizen](https://en.wikipedia.org/wiki/First-class_citizen) (variable, function, boolean) but it will be casted into a boolean because it’s evaluated in a boolean context.\n\n- After logical **NOT** `!` operator\n\nThis operator returns false if its single operand can be converted to true; otherwise, returns true.\n\n```js\n!0 // true -- 0 is falsy so it returns true\n!!0 // false -- 0 is falsy so !0 returns true so !(!0) returns false\n!!\"\" // false -- empty string is falsy so NOT (NOT false) equals false\n```\n\n- With the *Boolean* object constructor\n\n```js\nnew Boolean(0) // false\nnew Boolean(1) // true\n```\n\n- In a ternary evaluation\n\n```js\nmyVar ? \"truthy\" : \"falsy\"\n```\n\nmyVar is evaluated in a boolean context.\n\nBe careful when comparing 2 values. The object values (that should be cast to true) is **not** being casted to Boolean but it forced to convert into a primitive value one using [ToPrimitives specification](http://javascript.info/object-toprimitive). Internally, when an object is compared to Boolean value like `[] == true`, it does `[].toString() == true` so…\n\n```js\nlet a = [] == true // a is false since [].toString() give \"\" back.\nlet b = [1] == true // b is true since [1].toString() give \"1\" back.\nlet c = [2] == true // c is false since [2].toString() give \"2\" back.\n```\n\n### External resources\n\n- [Truthy (MDN)](https://developer.mozilla.org/en-US/docs/Glossary/Truthy)\n- [Falsy (MDN)](https://developer.mozilla.org/en-US/docs/Glossary/Falsy)\n- [Truthy and Falsy values in JS - Josh Clanton](http://adripofjavascript.com/blog/drips/truthy-and-falsy-values-in-javascript.html)\n\n## Anamorphisms and Catamorphisms\n\n### Anamorphisms\n\nAnamorphisms are functions that map from some object to a more complex structure containing the type of the object. It is the process of *unfolding* a simple structure into a more complex one. Consider unfolding an integer to a list of integers. The integer is our initial object and the list of integers is the more complex structure.\n\n**Sample code**\n\n```js\nfunction downToOne(n) {\n  const list = [];\n\n  for (let i = n; i \u003e 0; --i) {\n    list.push(i);\n  }\n\n  return list;\n}\n\ndownToOne(5)\n  //=\u003e [ 5, 4, 3, 2, 1 ]\n```\n\n### Catamorphisms\n\nCatamorphisms are the opposite of Anamorphisms, in that they take objects of more complex structure and *fold* them into simpler structures. Take the following example `product` which take a list of integers and returns a single integer.\n\n**Sample code**\n\n```js\nfunction product(list) {\n  let product = 1;\n\n  for (const n of list) {\n    product = product * n;\n  }\n\n  return product;\n}\n\nproduct(downToOne(5)) // 120\n```\n\n### External resources\n\n- [Anamorphisms in JavaScript](http://raganwald.com/2016/11/30/anamorphisms-in-javascript.html)\n- [Anamorphism](https://en.wikipedia.org/wiki/Anamorphism)\n- [Catamorphism](https://en.wikipedia.org/wiki/Catamorphism)\n\n## Generators\n\nAnother way to write the `downToOne` function is to use a Generator. To instantiate a `Generator` object, one must use the `function *` declaration. Generators are functions that can be exited and later re-entered with its context (variable bindings) saved across re-entrances.\n\nFor example, the `downToOne` function above can be rewritten as:\n\n```js\nfunction * downToOne(n) {\n  for (let i = n; i \u003e 0; --i) {\n    yield i;\n  }\n}\n\n[...downToOne(5)] // [ 5, 4, 3, 2, 1 ]\n```\n\nGenerators return an iterable object. When the iterator’s `next()` function is called, it is executed until the first `yield` expression, which specifies the value to be returned from the iterator or with `yield*`, which delegates to another generator function. When a `return` expression is called in the generator, it will mark the generator as done and pass back as the return value. Further calls to `next()` will not return any new values.\n\n**Sample code**\n\n```js\n// Yield Example\nfunction * idMaker() {\n  var index = 0;\n  while (index \u003c 2) {\n    yield index;\n    index = index + 1;\n  }\n}\n\nvar gen = idMaker();\n\ngen.next().value; // 0\ngen.next().value; // 1\ngen.next().value; // undefined\n```\n\nThe `yield*` expression enables a generator to call another generator function during iteration.\n\n```js\n// Yield * Example\nfunction * genB(i) {\n  yield i + 1;\n  yield i + 2;\n  yield i + 3;\n}\n\nfunction * genA(i) {\n  yield i;\n  yield* genB(i);\n  yield i + 10;\n}\n\nvar gen = genA(10);\n\ngen.next().value; // 10\ngen.next().value; // 11\ngen.next().value; // 12\ngen.next().value; // 13\ngen.next().value; // 20\n```\n\n```js\n// Generator Return Example\nfunction* yieldAndReturn() {\n  yield \"Y\";\n  return \"R\";\n  yield \"unreachable\";\n}\n\nvar gen = yieldAndReturn()\ngen.next(); // { value: \"Y\", done: false }\ngen.next(); // { value: \"R\", done: true }\ngen.next(); // { value: undefined, done: true }\n```\n\n### External resources\n\n- [Mozilla MDN Web Docs, Iterators and Generators](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_Generators#Generators)\n\n## Static Methods\n\n### Short explanation\n\nThe `static` keyword is used in classes to declare static methods. Static methods are functions in a class that belongs to the class object and are not available to any instance of that class.\n\n### Sample code\n\n```js\nclass Repo {\n  static getName() {\n    return \"Repo name is modern-js-cheatsheet\"\n  }\n}\n\n// Note that we did not have to create an instance of the Repo class\nconsole.log(Repo.getName()) // Repo name is modern-js-cheatsheet\n\nlet r = new Repo();\nconsole.log(r.getName()) // Uncaught TypeError: r.getName is not a function\n```\n\n### Detailed explanation\n\nStatic methods can be called within another static method by using the `this` keyword, this doesn’t work for non-static methods though. Non-static methods cannot directly access static methods using the `this` keyword.\n\n##### Calling other static methods from a static method.\n\nTo call a static method from another static method, the `this` keyword can be used like so;\n\n```js\nclass Repo {\n  static getName() {\n    return \"Repo name is modern-js-cheatsheet\"\n  }\n\n  static modifyName() {\n    return this.getName() + '-added-this'\n  }\n}\n\nconsole.log(Repo.modifyName()) // Repo name is modern-js-cheatsheet-added-this\n```\n\n#### Calling static methods from non-static methods.\n\nNon-static methods can call static methods in 2 ways;\n\n1.  ###### Using the class name.\n    \n\nTo get access to a static method from a non-static method we use the class name and call the static method like a property. e.g `ClassName.StaticMethodName`\n\n```js\nclass Repo {\n  static getName() {\n    return \"Repo name is modern-js-cheatsheet\"\n  }\n\n  useName() {\n    return Repo.getName() + ' and it contains some really important stuff'\n  }\n}\n\n// we need to instantiate the class to use non-static methods\nlet r = new Repo()\nconsole.log(r.useName()) // Repo name is modern-js-cheatsheet and it contains some really important stuff\n```\n\n2.  ##### Using the constructor\n    \n\nStatic methods can be called as properties on the constructor object.\n\n```js\nclass Repo {\n  static getName() {\n    return \"Repo name is modern-js-cheatsheet\"\n  }\n\n  useName() {\n    // Calls the static method as a property of the constructor\n    return this.constructor.getName() + ' and it contains some really important stuff'\n  }\n}\n\n// we need to instantiate the class to use non-static methods\nlet r = new Repo()\nconsole.log(r.useName()) // Repo name is modern-js-cheatsheet and it contains some really important stuff\n```\n\n### External resources\n\n- [static keyword- MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/static)\n- [Static Methods- Javascript.info](https://javascript.info/class#static-methods)\n- [Static Members in ES6- OdeToCode](http://odetocode.com/blogs/scott/archive/2015/02/02/static-members-in-es6.aspx)","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/Net/HTPP-Response":{"title":"","content":"## [HTTP Responses](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#http_responses \"Permalink to HTTP Responses\")\n\n### [Status line](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#status_line \"Permalink to Status line\")\n\nThe start line of an HTTP response, called the _status line_, contains the following information:\n\n1.  The _protocol version_, usually `HTTP/1.1`.\n2.  A [Status Codes](Web\u0026Net/Net/Status%20Codes.md), indicating success or failure of the request. Common status codes are [`200`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/200), [`404`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404), or [`302`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302)\n3.  A _status text_. A brief, purely informational, textual description of the status code to help a human understand the HTTP message.\n\nA typical status line looks like: `HTTP/1.1 404 Not Found`.\n\n### [Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#headers_2 \"Permalink to Headers\")\n\n[HTTP headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers) for responses follow the same structure as any other header: a case-insensitive string followed by a colon (`':'`) and a value whose structure depends upon the type of the header. The whole header, including its value, presents as a single line.\n\nMany different headers can appear in responses. These can be divided into several groups:\n\n-   [General headers](https://developer.mozilla.org/en-US/docs/Glossary/General_header), like [`Via`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Via), apply to the whole message.\n-   [Response headers](https://developer.mozilla.org/en-US/docs/Glossary/Response_header), like [`Vary`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Vary) and [`Accept-Ranges`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Ranges), give additional information about the server which doesn't fit in the status line.\n-   [Representation headers](https://developer.mozilla.org/en-US/docs/Glossary/Representation_header) like [`Content-Type`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) that describe the original format of the message data and any encoding applied (only present if the message has a body).\n\n![Example of headers in an HTTP response](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages/http_response_headers3.png)\n\n### [Body](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#body_2 \"Permalink to Body\")\n\nThe last part of a response is the body. Not all responses have one: responses with a status code that sufficiently answers the request without the need for corresponding payload (like [`201`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/201) **`Created`** or [`204`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/204) **`No Content`**) usually don't.\n\nBodies can be broadly divided into three categories:\n\n-   Single-resource bodies, consisting of a single file of known length, defined by the two headers: [`Content-Type`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) and [`Content-Length`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Length).\n-   Single-resource bodies, consisting of a single file of unknown length, encoded by chunks with [`Transfer-Encoding`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Transfer-Encoding) set to `chunked`.\n-   [Multiple-resource bodies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#multipartform-data), consisting of a multipart body, each containing a different section of information. These are relatively rare.\n\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/Net/HTTP-2":{"title":"","content":"","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/Net/HTTP-Request":{"title":"","content":"\n## [HTTP Requests](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#http_requests \"Permalink to HTTP Requests\")\n\n### [Start line](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#start_line \"Permalink to Start line\")\n\nHTTP requests are messages sent by the client to initiate an action on the server. Their _start-line_ contain three elements:\n\n1.  An [HTTP Methods](Web\u0026Net/Net/Methods.md),\n2.  The _request target_, usually a URL , or the absolute path of the protocol, port, and domain are usually characterized by the request context. The format of this request target varies between different HTTP methods. It can be\n    -   An absolute path, ultimately followed by a `'?'` and query string. This is the most common form, known as the _origin form_, and is used with `GET`, `POST`, `HEAD`, and `OPTIONS` methods.\n        -   `POST / HTTP/1.1`\n        -   `GET /background.png HTTP/1.0`\n        -   `HEAD /test.html?query=alibaba HTTP/1.1`\n        -   `OPTIONS /anypage.html HTTP/1.0`\n    -   A complete URL, known as the _absolute form_, is mostly used with `GET` when connected to a proxy. `GET https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages HTTP/1.1`\n    -   The authority component of a URL, consisting of the domain name and optionally the port (prefixed by a `':'`), is called the _authority form_. It is only used with `CONNECT` when setting up an HTTP tunnel. `CONNECT developer.mozilla.org:80 HTTP/1.1`\n    -   The _asterisk form_, a simple asterisk (`'*'`) is used with `OPTIONS`, representing the server as a whole. `OPTIONS * HTTP/1.1`\n3.  The _HTTP version_, which defines the structure of the remaining message, acting as an indicator of the expected version to use for the response.\n\n### [Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#headers \"Permalink to Headers\")\n\n[HTTP headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers) from a request follow the same basic structure of an HTTP header: a case-insensitive string followed by a colon (`':'`) and a value whose structure depends upon the header. The whole header, including the value, consist of one single line, which can be quite long.\n\nMany different headers can appear in requests. They can be divided in several groups:\n\n-   [General headers](https://developer.mozilla.org/en-US/docs/Glossary/General_header), like [`Via`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Via), apply to the message as a whole.\n-   [Request headers](https://developer.mozilla.org/en-US/docs/Glossary/Request_header), like [`User-Agent`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent) or [`Accept`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept), modify the request by specifying it further (like [`Accept-Language`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language)), by giving context (like [`Referer`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer)), or by conditionally restricting it (like [`If-None`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/If-None \"This is a link to an unwritten page\")).\n-   [Representation headers](https://developer.mozilla.org/en-US/docs/Glossary/Representation_header) like [`Content-Type`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) that describe the original format of the message data and any encoding applied (only present if the message has a body).\n\n![Example of headers in an HTTP request](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages/http_request_headers3.png)\n\n### [Body](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#body \"Permalink to Body\")\n\nThe final part of the request is its body. Not all requests have one: requests fetching resources, like `GET`, `HEAD`, `DELETE`, or `OPTIONS`, usually don't need one. Some requests send data to the server in order to update it: as often the case with `POST` requests (containing HTML form data).\n\nBodies can be broadly divided into two categories:\n\n-   Single-resource bodies, consisting of one single file, defined by the two headers: [`Content-Type`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) and [`Content-Length`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Length).\n-   [Multiple-resource bodies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#multipartform-data), consisting of a multipart body, each containing a different bit of information. This is typically associated with [HTML Forms](https://developer.mozilla.org/en-US/docs/Learn/Forms).\n\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/Net/HTTP3":{"title":"","content":"## [HTTP/2 Frames](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages#http2_frames \"Permalink to HTTP/2 Frames\")\n\nHTTP/1.x messages have a few drawbacks for performance:\n\n-   Headers, unlike bodies, are uncompressed.\n-   Headers are often very similar from one message to the next one, yet still repeated across connections.\n-   No multiplexing can be done. Several connections need opening on the same server: and warm TCP connections are more efficient than cold ones.\n\nHTTP/2 introduces an extra step: it divides HTTP/1.x messages into frames which are embedded in a stream. Data and header frames are separated, which allows header compression. Several streams can be combined together, a process called _multiplexing_, allowing more efficient use of underlying TCP connections.\n\n![HTTP/2 modify the HTTP message to divide them in frames (part of a single stream), allowing for more optimization.](https://developer.mozilla.org/en-US/docs/Web/HTTP/Messages/binary_framing2.png)\n\nHTTP frames are now transparent to Web developers. This is an additional step in HTTP/2, between HTTP/1.1 messages and the underlying transport protocol. No changes are needed in the APIs used by Web developers to utilize HTTP frames; when available in both the browser and the server, HTTP/2 is switched on and used.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/Net/Methods":{"title":"","content":"# KNOW YOUR HTTP methods WELL\n\n\u003e The request method token is the primary source of request semantics; it indicates the purpose for which the client has made this request and what is expected by the client as a successful result.\n\nContinue reading on [RFC7231#4.1](https://tools.ietf.org/html/rfc7231#section-4.1), [RFC2616#9](https://tools.ietf.org/html/rfc2616#section-9).\n\n## Safe\n\n\u003e Request methods are considered \"safe\" if their defined semantics are essentially read-only; i.e., the client does not request, and does not expect, any state change on the origin server as a result of applying a safe method to a target resource. Likewise, reasonable use of a safe method is not expected to cause any harm, loss of property, or unusual burden on the origin server.\n\nContinue reading on [RFC7231#4.2.1](https://tools.ietf.org/html/rfc7231#section-4.2.1), [RFC2616#9.1.1](https://tools.ietf.org/html/rfc2616#section-9.1.1).\n\n## Idempotent\n\n\u003e Request methods are considered \"idempotent\" if the intended effect of multiple identical requests is the same as for a single request. Of the request methods defined by this specification, the PUT, DELETE, and safe request methods are idempotent.\n\nContinue reading on [RFC7231#4.2.2](https://tools.ietf.org/html/rfc7231#section-4.2.2), [RFC2616#9.1.2](https://tools.ietf.org/html/rfc2616#section-9.1.2).\n\n## Cacheable\n\n\u003e Request methods are considered \"cacheable\" if it is possible and useful to answer a current client request with a stored response from a prior request. GET and HEAD are defined to be cacheable.\n\nContinue reading on [RFC7231#4.2.3](https://tools.ietf.org/html/rfc7231#section-4.2.3), [RFC2616#9.1.2](https://tools.ietf.org/html/rfc2616#section-9.1.2).\n\n## Common\n\n\u003e POST and PATCH are not cacheable by default, like GET and HEAD, but become cacheable by using appropriate `Cache-Control` or `Expires` response headers.\n\nmethod | description | safe | idem. | cache. | spec\n-----: | :---------- | :--: | :---: | :----: | :---\n`CONNECT` | \"requests that the recipient establish a tunnel to the destination origin server identified by the request-target and, if successful, thereafter restrict its behavior to blind forwarding of packets, in both directions, until the connection is closed.\" | ✔ | ✔ | ✘ | [RFC7231#4.3.6](https://tools.ietf.org/html/rfc7231#section-4.3.6),\u003cbr\u003e[RFC2616#9.9](https://tools.ietf.org/html/rfc2616#section-9.9)\n`DELETE` | \"requests that the origin server remove the association between the target resource and its current functionality.\" | ✘ | ✔ | ✘ | [RFC7231#4.3.5](https://tools.ietf.org/html/rfc7231#section-4.3.5),\u003cbr\u003e[RFC2616#9.7](https://tools.ietf.org/html/rfc2616#section-9.7)\n`GET` | \"requests transfer of a current selected representation for the target resource.\" | ✔ | ✔ | ✔ | [RFC7231#4.3.1](https://tools.ietf.org/html/rfc7231#section-4.3.1),\u003cbr\u003e[RFC2616#9.3](https://tools.ietf.org/html/rfc2616#section-9.3)\n`HEAD` | \"is identical to GET except that the server MUST NOT send a message body in the response (i.e., the response terminates at the end of the header block).\" | ✔ | ✔ | ✔ | [RFC7231#4.3.2](https://tools.ietf.org/html/rfc7231#section-4.3.2),\u003cbr\u003e[RFC2616#9.4](https://tools.ietf.org/html/rfc2616#section-9.4)\n`OPTIONS` | \"requests information about the communication options available on the request/response chain identified by the effective request URI.\" | ✔ | ✔ | ✘ | [RFC7231#4.3.7](https://tools.ietf.org/html/rfc7231#section-4.3.7),\u003cbr\u003e[RFC2616#9.2](https://tools.ietf.org/html/rfc2616#section-9.2)\n`POST` | \"requests that the target resource process the representation enclosed in the request according to the resource's own specific semantics.\" | ✘ | ✘ | ✘ | [RFC7231#4.3.3](https://tools.ietf.org/html/rfc7231#section-4.3.3),\u003cbr\u003e[RFC2616#9.5](https://tools.ietf.org/html/rfc2616#section-9.5)\n`PUT` | \"requests that the state of the target resource be created or replaced with the state defined by the representation enclosed in the request message payload.\" | ✘ | ✔ | ✘ | [RFC7231#4.3.4](https://tools.ietf.org/html/rfc7231#section-4.3.4),\u003cbr\u003e[RFC2616#9.6](https://tools.ietf.org/html/rfc2616#section-9.6)\n`TRACE` | \"is used to invoke a remote, application-layer loopback of the request message.\" | ✔ | ✔ | ✘ | [RFC7231#4.3.8](https://tools.ietf.org/html/rfc7231#section-4.3.8),\u003cbr\u003e[RFC2616#9.8](https://tools.ietf.org/html/rfc2616#section-9.8)\n\n## Registered\n\nFor a full up-to-date list, continue reading on [RFC7237](https://tools.ietf.org/html/rfc7237#appendix-A).\n\nmethod | description | safe | idem. | cache. | spec\n-----: | :---------- | :--: | :---: | :----: | :---\n`ACL` | | ✘ | ✔ | | [RFC3744#8.1](https://tools.ietf.org/html/rfc3744#section-8.1)\n`BASELINE-CONTROL` | | ✘ | ✔ | | [RFC3253#12.6](https://tools.ietf.org/html/rfc3253#section-12.6)\n`BIND` | | ✘ | ✔ | | [RFC5842#4](https://tools.ietf.org/html/rfc5842#section-4)\n`CHECKIN` | | ✘ | ✔ | | [RFC3253#4.4](https://tools.ietf.org/html/rfc3253#section-4.4),\u003cbr\u003e[RFC3253#9.4](https://tools.ietf.org/html/rfc3253#section-9.4)\n`CHECKOUT` | | ✘ | ✔ | | [RFC3253#4.3](https://tools.ietf.org/html/rfc3253#section-4.3),\u003cbr\u003e[RFC3253#8.8](https://tools.ietf.org/html/rfc3253#section-8.8)\n`COPY` | | ✘ | ✔ | | [RFC4918#9.8](https://tools.ietf.org/html/rfc4918#section-9.8)\n`LABEL` | | ✘ | ✔ | | [RFC3253#8.2](https://tools.ietf.org/html/rfc3253#section-8.2)\n`LINK` | | ✘ | ✔ | | [RFC2068#19.6.1.2](https://tools.ietf.org/html/rfc2068#section-19.6.1.2)\n`LOCK` | | ✘ | ✘ | | [RFC4918#9.10](https://tools.ietf.org/html/rfc4918#section-9.10)\n`MERGE` | | ✘ | ✔ | | [RFC3253#11.2](https://tools.ietf.org/html/rfc3253#section-11.2)\n`MKACTIVITY` | | ✘ | ✔ | | [RFC3253#13.5](https://tools.ietf.org/html/rfc3253#section-13.5)\n`MKCALENDAR` | | ✘ | ✔ | | [RFC4791#5.3.1](https://tools.ietf.org/html/rfc4791#section-5.3.1)\n`MKCOL` | | ✘ | ✔ | | [RFC4918#9.3](https://tools.ietf.org/html/rfc4918#section-9.3)\n`MKREDIRECTREF` | | ✘ | ✔ | | [RFC4437#6](https://tools.ietf.org/html/rfc4437#section-6)\n`MKWORKSPACE` | | ✘ | ✔ | | [RFC3253#6.3](https://tools.ietf.org/html/rfc3253#section-6.3)\n`MOVE` | | ✘ | ✔ | | [RFC4918#9.9](https://tools.ietf.org/html/rfc4918#section-9.9)\n`ORDERPATCH` | | ✘ | ✔ | | [RFC3648#7](https://tools.ietf.org/html/rfc3648#section-7)\n`PATCH` | \"requests that a set of changes described in the request entity be applied to the resource identified by the Request-URI.\" | ✘ | ✘ | ✘ | [RFC5789](https://tools.ietf.org/html/rfc5789#section-2)\n`PROPFIND` | | ✔ | ✔ | | [RFC4918#9.1](https://tools.ietf.org/html/rfc4918#section-9.1)\n`PROPPATCH` | | ✘ | ✔ | | [RFC4918#9.2](https://tools.ietf.org/html/rfc4918#section-9.2)\n`REBIND` | | ✘ | ✔ | | [RFC5842#6](https://tools.ietf.org/html/rfc5842#section-6)\n`REPORT` | | ✔ | ✔ | | [RFC3253#3.6](https://tools.ietf.org/html/rfc3253#section-3.6)\n`SEARCH` | | ✔ | ✔ | | [RFC5323#2](https://tools.ietf.org/html/rfc5323#section-2)\n`UNBIND` | | ✘ | ✔ | | [RFC5842#5](https://tools.ietf.org/html/rfc5842#section-5)\n`UNCHECKOUT` | | ✘ | ✔ | | [RFC3253#4.5](https://tools.ietf.org/html/rfc3253#section-4.5)\n`UNLINK` | | ✘ | ✔ | | [RFC2068#19.6.1.3](https://tools.ietf.org/html/rfc2068#section-19.6.1.3)\n`UNLOCK` | | ✘ | ✔ | | [RFC4918#9.11](https://tools.ietf.org/html/rfc4918#section-9.11)\n`UPDATE` | | ✘ | ✔ | | [RFC3253#7.1](https://tools.ietf.org/html/rfc3253#section-7.1)\n`UPDATEREDIRECTREF` | | ✘ | ✔ | | [RFC4437#7](https://tools.ietf.org/html/rfc4437#section-7)\n`VERSION-CONTROL` | | ✘ | ✔ | | [RFC3253#3.5](https://tools.ietf.org/html/rfc3253#section-3.5)\n\n## Sources\n\n* [RFC7231 Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content](https://tools.ietf.org/html/rfc7231)\n* [RFC7616 HTTP Digest Access Authentication](https://tools.ietf.org/html/rfc7616)\n* [RFC7617 The 'Basic' HTTP Authentication Scheme](https://tools.ietf.org/html/rfc7617)\n* [RFC5789 PATCH Method for HTTP](https://tools.ietf.org/html/rfc5789)\n* OBSOLETE ~~[RFC2616 Hypertext Transfer Protocol -- HTTP/1.1](https://tools.ietf.org/html/rfc2616#)~~\n* Yours truly\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/Net/Status-Codes":{"title":"","content":"# KNOW YOUR HTTP status codes WELL\n\n\u003e The status-code element is a 3-digit integer code giving the result of the attempt to understand and satisfy the request.\n\nContinue reading on [RFC7231#6](https://tools.ietf.org/html/rfc7231#section-6), [RFC2616#10](https://tools.ietf.org/html/rfc2616#section-10).\n\n## Classes\n\n\u003e The first digit of the status-code defines the class of response. The last two digits do not have any categorization role. There are 5 values for the first digit:\n\nContinue reading on [RFC7231#6](https://tools.ietf.org/html/rfc7231#section-6), [RFC2616#10](https://tools.ietf.org/html/rfc2616#section-10).\n\n## Common\n\n### 1xx\n\ncode | reason | description | spec\n---: | :----- | :---------- | :---\n`1xx` | **Informational** | \"indicates an interim response for communicating connection status or request progress prior to completing the requested action and sending a final response.\" ~ [sure](http://www.urbandictionary.com/define.php?term=sure) | [RFC7231#6.2](https://tools.ietf.org/html/rfc7231#section-6.2),\u003cbr\u003e [RFC2616#10.1](https://tools.ietf.org/html/rfc2616#section-10.1)\n`100` | Continue | \"indicates that the initial part of a request has been received and has not yet been rejected by the server.\" | [RFC7231#6.2.1](https://tools.ietf.org/html/rfc7231#section-6.2.1),\u003cbr\u003e [RFC2616#10.1.1](https://tools.ietf.org/html/rfc2616#section-10.1.1)\n`101` | Switching Protocols | \"indicates that the server understands and is willing to comply with the client's request, via the Upgrade header field, for a change in the application protocol being used on this connection.\" | [RFC7231#6.2.2](https://tools.ietf.org/html/rfc7231#section-6.2.2),\u003cbr\u003e[RFC2616#10.1.2](https://tools.ietf.org/html/rfc2616#section-10.1.2)\n\n### 2xx\n\ncode | reason | description | spec\n---: | :----- | :---------- | :---\n`2xx` | **Successful** | \"indicates that the client's request was successfully received, understood, and accepted.\" ~ [cool](https://twitter.com/DanaDanger/status/183316183494311936) | [RFC7231#6.3](https://tools.ietf.org/html/rfc7231#section-6.3),\u003cbr\u003e [RFC2616#10.2](https://tools.ietf.org/html/rfc2616#section-10.2)\n`200` | OK | \"indicates that the request has succeeded.\" | [RFC7231#6.3.1](https://tools.ietf.org/html/rfc7231#section-6.3.1),\u003cbr\u003e[RFC2616#10.2.1](https://tools.ietf.org/html/rfc2616#section-10.2.1)\n`201` | Created | \"indicates that the request has been fulfilled and has resulted in one or more new resources being created.\" | [RFC7231#6.3.2](https://tools.ietf.org/html/rfc7231#section-6.3.2),\u003cbr\u003e[RFC2616#10.2.2](https://tools.ietf.org/html/rfc2616#section-10.2.2)\n`202` | Accepted | \"indicates that the request has been accepted for processing, but the processing has not been completed.\" | [RFC7231#6.3.3](https://tools.ietf.org/html/rfc7231#section-6.3.3),\u003cbr\u003e[RFC2616#10.2.3](https://tools.ietf.org/html/rfc2616#section-10.2.3)\n`203` | Non-Authoritative Information | \"indicates that the request was successful but the enclosed payload has been modified from that of the origin server's 200 (OK) response by a transforming proxy.\" | [RFC7231#6.3.4](https://tools.ietf.org/html/rfc7231#section-6.3.4),\u003cbr\u003e[RFC2616#10.2.4](https://tools.ietf.org/html/rfc2616#section-10.2.4)\n`204` | No Content | \"indicates that the server has successfully fulfilled the request and that there is no additional content to send in the response payload body.\" | [RFC7231#6.3.5](https://tools.ietf.org/html/rfc7231#section-6.3.5),\u003cbr\u003e[RFC2616#10.2.5](https://tools.ietf.org/html/rfc2616#section-10.2.5)\n`205` | Reset Content | \"indicates that the server has fulfilled the request and desires that the user agent reset the \"document view\", which caused the request to be sent, to its original state as received from the origin server.\" | [RFC7231#6.3.6](https://tools.ietf.org/html/rfc7231#section-6.3.6),\u003cbr\u003e[RFC2616#10.2.6](https://tools.ietf.org/html/rfc2616#section-10.2.6)\n`206` | Partial Content | \"indicates that the server is successfully fulfilling a range request for the target resource by transferring one or more parts of the selected representation that correspond to the satisfiable ranges found in the requests's Range header field.\" | [RFC7233#4.1](https://tools.ietf.org/html/rfc7233#section-4.1),\u003cbr\u003e[RFC2616#10.2.7](https://tools.ietf.org/html/rfc2616#section-10.2.7)\n\n### 3xx\n\ncode | reason | description | spec\n---: | :----- | :---------- | :---\n`3xx` | **Redirection** | \"indicates that further action needs to be taken by the user agent in order to fulfill the request.\" ~ [ask that dude over there](https://twitter.com/DanaDanger/status/183316183494311936) | [RFC7231#6.4](https://tools.ietf.org/html/rfc7231#section-6.4),\u003cbr\u003e [RFC2616#10.3](https://tools.ietf.org/html/rfc2616#section-10.3)\n`300` | Multiple Choices | \"indicates that the target resource has more than one representation, each with its own more specific identifier, and information about the alternatives is being provided so that the user (or user agent) can select a preferred representation by redirecting its request to one or more of those identifiers.\" | [RFC7231#6.4.1](https://tools.ietf.org/html/rfc7231#section-6.4.1),\u003cbr\u003e[RFC2616#10.3.1](https://tools.ietf.org/html/rfc2616#section-10.3.1)\n`301` | Moved Permanently | \"indicates that the target resource has been assigned a new permanent URI and any future references to this resource ought to use one of the enclosed URIs.\" | [RFC7231#6.4.2](https://tools.ietf.org/html/rfc7231#section-6.4.2),\u003cbr\u003e[RFC2616#10.3.2](https://tools.ietf.org/html/rfc2616#section-10.3.2)\n`302` | Found | \"indicates that the target resource resides temporarily under a different URI.\" | [RFC7231#6.4.3](https://tools.ietf.org/html/rfc7231#section-6.4.3),\u003cbr\u003e[RFC2616#10.3.3](https://tools.ietf.org/html/rfc2616#section-10.3.3)\n`303` | See Other | \"indicates that the server is redirecting the user agent to a different resource, as indicated by a URI in the Location header field, that is intended to provide an indirect response to the original request.\" | [RFC7231#6.4.4](https://tools.ietf.org/html/rfc7231#section-6.4.4),\u003cbr\u003e[RFC2616#10.3.4](https://tools.ietf.org/html/rfc2616#section-10.3.4)\n`304` | Not Modified | \"indicates that a conditional GET request has been received and would have resulted in a 200 (OK) response if it were not for the fact that the condition has evaluated to false.\" | [RFC7232#4.1](https://tools.ietf.org/html/rfc7232#section-4.1),\u003cbr\u003e[RFC2616#10.3.5](https://tools.ietf.org/html/rfc2616#section-10.3.5)\n`305` | Use Proxy | *deprecated* | [RFC7231#6.4.5](https://tools.ietf.org/html/rfc7231#section-6.4.5),\u003cbr\u003e[RFC2616#10.3.6](https://tools.ietf.org/html/rfc2616#section-10.3.6)\n`306` | | *unused* | [RFC7231#6.4.6](https://tools.ietf.org/html/rfc7231#section-6.4.6),\u003cbr\u003e[RFC2616#10.3.7](https://tools.ietf.org/html/rfc2616#section-10.3.7)\n`307` | Temporary Redirect | \"indicates that the target resource resides temporarily under a different URI and the user agent MUST NOT change the request method if it performs an automatic redirection to that URI.\" | [RFC7231#6.4.7](https://tools.ietf.org/html/rfc7231#section-6.4.7),\u003cbr\u003e[RFC2616#10.3.8](https://tools.ietf.org/html/rfc2616#section-10.3.8)\n\n### 4xx\n\ncode | reason | description | spec\n---: | :----- | :---------- | :---\n`4xx` | **Client Error** | \"indicates that the client seems to have erred.\" ~ [*you* fucked up](https://twitter.com/DanaDanger/status/183316183494311936) | [RFC7231#6.5](https://tools.ietf.org/html/rfc7231#section-6.5),\u003cbr\u003e [RFC2616#10.4](https://tools.ietf.org/html/rfc2616#section-10.4)\n`400` | Bad Request | \"indicates that the server cannot or will not process the request because the received syntax is invalid, nonsensical, or exceeds some limitation on what the server is willing to process.\" | [RFC7231#6.5.1](https://tools.ietf.org/html/rfc7231#section-6.5.1),\u003cbr\u003e[RFC2616#10.4.1](https://tools.ietf.org/html/rfc2616#section-10.4.1)\n`401` | Unauthorized | \"indicates that the request has not been applied because it lacks valid authentication credentials for the target resource.\" | [RFC7235#6.3.1](https://tools.ietf.org/html/rfc7235#section-3.1),\u003cbr\u003e[RFC2616#10.4.2](https://tools.ietf.org/html/rfc2616#section-10.4.2)\n`402` | Payment Required | *reserved* | [RFC7231#6.5.2](https://tools.ietf.org/html/rfc7231#section-6.5.2),\u003cbr\u003e[RFC2616#10.4.3](https://tools.ietf.org/html/rfc2616#section-10.4.3)\n`403` | Forbidden | \"indicates that the server understood the request but refuses to authorize it.\" | [RFC7231#6.5.3](https://tools.ietf.org/html/rfc7231#section-6.5.3),\u003cbr\u003e[RFC2616#10.4.4](https://tools.ietf.org/html/rfc2616#section-10.4.4)\n`404` | Not Found | \"indicates that the origin server did not find a current representation for the target resource or is not willing to disclose that one exists.\" | [RFC7231#6.5.4](https://tools.ietf.org/html/rfc7231#section-6.5.4),\u003cbr\u003e[RFC2616#10.4.5](https://tools.ietf.org/html/rfc2616#section-10.4.5)\n`405` | Method Not Allowed | \"indicates that the method specified in the request-line is known by the origin server but not supported by the target resource.\" | [RFC7231#6.5.5](https://tools.ietf.org/html/rfc7231#section-6.5.5),\u003cbr\u003e[RFC2616#10.4.6](https://tools.ietf.org/html/rfc2616#section-10.4.6)\n`406` | Not Acceptable | \"indicates that the target resource does not have a current representation that would be acceptable to the user agent, according to the proactive negotiation header fields received in the request, and the server is unwilling to supply a default representation.\" | [RFC7231#6.5.6](https://tools.ietf.org/html/rfc7231#section-6.5.6),\u003cbr\u003e[RFC2616#10.4.7](https://tools.ietf.org/html/rfc2616#section-10.4.7)\n`407` | Proxy Authentication Required | \"is similar to 401 (Unauthorized), but indicates that the client needs to authenticate itself in order to use a proxy.\" | [RFC7235#3.2](https://tools.ietf.org/html/rfc7235#section-3.2),\u003cbr\u003e[RFC2616#10.4.8](https://tools.ietf.org/html/rfc2616#section-10.4.8)\n`408` | Request Timeout | \"indicates that the server did not receive a complete request message within the time that it was prepared to wait.\" | [RFC7231#6.5.7](https://tools.ietf.org/html/rfc7231#section-6.5.7),\u003cbr\u003e[RFC2616#10.4.9](https://tools.ietf.org/html/rfc2616#section-10.4.9)\n`409` | Conflict | \"indicates that the request could not be completed due to a conflict with the current state of the resource.\" | [RFC7231#6.5.8](https://tools.ietf.org/html/rfc7231#section-6.5.8),\u003cbr\u003e[RFC2616#10.4.10](https://tools.ietf.org/html/rfc2616#section-10.4.10)\n`410` | Gone | \"indicates that access to the target resource is no longer available at the origin server and that this condition is likely to be permanent.\" | [RFC7231#6.5.9](https://tools.ietf.org/html/rfc7231#section-6.5.9),\u003cbr\u003e[RFC2616#10.4.11](https://tools.ietf.org/html/rfc2616#section-10.4.11)\n`411` | Length Required | \"indicates that the server refuses to accept the request without a defined Content-Length.\" | [RFC7231#6.5.10](https://tools.ietf.org/html/rfc7231#section-6.5.10),\u003cbr\u003e[RFC2616#10.4.12](https://tools.ietf.org/html/rfc2616#section-10.4.12)\n`412` | Precondition Failed | \"indicates that one or more preconditions given in the request header fields evaluated to false when tested on the server.\" | [RFC7232#4.2](https://tools.ietf.org/html/rfc7232#section-4.2),\u003cbr\u003e[RFC2616#10.4.13](https://tools.ietf.org/html/rfc2616#section-10.4.13)\n`413` | Payload Too Large | \"indicates that the server is refusing to process a request because the request payload is larger than the server is willing or able to process.\" | [RFC7231#6.5.11](https://tools.ietf.org/html/rfc7231#section-6.5.11),\u003cbr\u003e[RFC2616#10.4.14](https://tools.ietf.org/html/rfc2616#section-10.4.14)\n`414` | URI Too Long | \"indicates that the server is refusing to service the request because the request-target is longer than the server is willing to interpret.\" | [RFC7231#6.5.12](https://tools.ietf.org/html/rfc7231#section-6.5.12),\u003cbr\u003e[RFC2616#10.4.15](https://tools.ietf.org/html/rfc2616#section-10.4.15)\n`415` | Unsupported Media Type | \"indicates that the origin server is refusing to service the request because the payload is in a format not supported by the target resource for this method.\" | [RFC7231#6.5.13](https://tools.ietf.org/html/rfc7231#section-6.5.13),\u003cbr\u003e[RFC2616#10.4.16](https://tools.ietf.org/html/rfc2616#section-10.4.16)\n`416` | Range Not Satisfiable | \"indicates that none of the ranges in the request's Range header field overlap the current extent of the selected resource or that the set of ranges requested has been rejected due to invalid ranges or an excessive request of small or overlapping ranges.\" | [RFC7233#4.4](https://tools.ietf.org/html/rfc7233#section-4.4),\u003cbr\u003e[RFC2616#10.4.17](https://tools.ietf.org/html/rfc2616#section-10.4.17)\n`417` | Expectation Failed | \"indicates that the expectation given in the request's Expect header field could not be met by at least one of the inbound servers.\" | [RFC7231#6.5.14](https://tools.ietf.org/html/rfc7231#section-6.5.14),\u003cbr\u003e[RFC2616#10.4.18](https://tools.ietf.org/html/rfc2616#section-10.4.18)\n`418` | I'm a teapot | \"Any attempt to brew coffee with a teapot should result in the error code 418 I'm a teapot.\" | [RFC2324#2.3.2](https://tools.ietf.org/html/rfc2324#section-2.3.2)\n`426` | Upgrade Required | \"indicates that the server refuses to perform the request using the current protocol but might be willing to do so after the client upgrades to a different protocol.\" | [RFC7231#6.5.15](https://tools.ietf.org/html/rfc7231#section-6.5.15)\n\n### 5xx\n\ncode | reason | description | spec\n---: | :----- | :---------- | :---\n`5xx` | **Server Error** | \"indicates that the server is aware that it has erred or is incapable of performing the requested method.\" ~ [*we* fucked up](https://twitter.com/DanaDanger/status/183316183494311936) | [RFC7231#6.6](https://tools.ietf.org/html/rfc7231#section-6.6),\u003cbr\u003e [RFC2616#10.5](https://tools.ietf.org/html/rfc2616#section-10.5)\n`500` | Internal Server Error | \"indicates that the server encountered an unexpected condition that prevented it from fulfilling the request.\" | [RFC7231#6.6.1](https://tools.ietf.org/html/rfc7231#section-6.6.1),\u003cbr\u003e[RFC2616#10.5.2](https://tools.ietf.org/html/rfc2616#section-10.5.1)\n`501` | Not Implemented | \"indicates that the server does not support the functionality required to fulfill the request.\" | [RFC7231#6.6.2](https://tools.ietf.org/html/rfc7231#section-6.6.2),\u003cbr\u003e[RFC2616#10.5.3](https://tools.ietf.org/html/rfc2616#section-10.5.2)\n`502` | Bad Gateway | \"indicates that the server, while acting as a gateway or proxy, received an invalid response from an inbound server it accessed while attempting to fulfill the request.\" | [RFC7231#6.6.3](https://tools.ietf.org/html/rfc7231#section-6.6.3),\u003cbr\u003e[RFC2616#10.5.4](https://tools.ietf.org/html/rfc2616#section-10.5.3)\n`503` | Service Unavailable | \"indicates that the server is currently unable to handle the request due to a temporary overload or scheduled maintenance, which will likely be alleviated after some delay.\" | [RFC7231#6.6.4](https://tools.ietf.org/html/rfc7231#section-6.6.4),\u003cbr\u003e[RFC2616#10.5.5](https://tools.ietf.org/html/rfc2616#section-10.5.4)\n`504` | Gateway Time-out | \"indicates that the server, while acting as a gateway or proxy, did not receive a timely response from an upstream server it needed to access in order to complete the request.\" | [RFC7231#6.6.5](https://tools.ietf.org/html/rfc7231#section-6.6.5),\u003cbr\u003e[RFC2616#10.5.6](https://tools.ietf.org/html/rfc2616#section-10.5.5)\n`505` | HTTP Version Not Supported | \"indicates that the server does not support, or refuses to support, the protocol version that was used in the request message.\" | [RFC7231#6.6.6](https://tools.ietf.org/html/rfc7231#section-6.6.6),\u003cbr\u003e[RFC2616#10.5.6](https://tools.ietf.org/html/rfc2616#section-10.5.6)\n\n## Extensions\n\ncode | reason | description | spec\n---: | :----- | :---------- | :---\n`102` | Processing | \"is an interim response used to inform the client that the server has accepted the complete request, but has not yet completed it.\" | [RFC5218#10.1](https://tools.ietf.org/html/rfc2518#section-10.1)\n`207` | Multi-Status | \"provides status for multiple independent operations.\" | [RFC5218#10.2](https://tools.ietf.org/html/rfc2518#section-10.2)\n`226` | IM Used | \"The server has fulfilled a GET request for the resource, and the response is a representation of the result of one or more instance-manipulations applied to the current instance.\" | [RFC3229#10.4.1](https://tools.ietf.org/html/rfc3229#section-10.4.1)\n`308` | Permanent Redirect | \"The target resource has been assigned a new permanent URI and any future references to this resource outght to use one of the enclosed URIs. [...] This status code is similar to 301 Moved Permanently (Section 7.3.2 of rfc7231), except that it does not allow rewriting the request method from POST to GET.\" | [RFC7538](https://tools.ietf.org/html/rfc7538)\n`422` | Unprocessable Entity | \"means the server understands the content type of the request entity (hence a 415(Unsupported Media Type) status code is inappropriate), and the syntax of the request entity is correct (thus a 400 (Bad Request) status code is inappropriate) but was unable to process the contained instructions.\" | [RFC5218#10.3](https://tools.ietf.org/html/rfc2518#section-10.3)\n`423` | Locked | \"means the source or destination resource of a method is locked.\" | [RFC5218#10.4](https://tools.ietf.org/html/rfc2518#section-10.4)\n`424` | Failed Dependency | \"means that the method could not be performed on the resource because the requested action depended on another action and that action failed.\" | [RFC5218#10.5](https://tools.ietf.org/html/rfc2518#section-10.5)\n`428` | Precondition Required | \"indicates that the origin server requires the request to be conditional.\" | [RFC6585#3](https://tools.ietf.org/html/rfc6585#section-3)\n`429` | Too Many Requests | \"indicates that the user has sent too many requests in a given amount of time (\"rate limiting\").\" | [RFC6585#4](https://tools.ietf.org/html/rfc6585#section-4)\n`431` | Request Header Fields Too Large | \"indicates that the server is unwilling to process the request because its header fields are too large.\" | [RFC6585#5](https://tools.ietf.org/html/rfc6585#section-5)\n`451` | Unavailable For Legal Reasons | \"This status code indicates that the server is denying access to the resource in response to a legal demand.\" | [draft-ietf-httpbis-legally-restricted-status](https://tools.ietf.org/html/draft-ietf-httpbis-legally-restricted-status)\n`506` | Variant Also Negotiates | \"indicates that the server has an internal configuration error: the chosen variant resource is configured to engage in transparent content negotiation itself, and is therefore not a proper end point in the negotiation process.\" | [RFC2295#8.1](https://tools.ietf.org/html/rfc2295#section-8.1)\n`507` | Insufficient Storage | \"means the method could not be performed on the resource because the server is unable to store the representation needed to successfully complete the request.\" | [RFC5218#10.6](https://tools.ietf.org/html/rfc2518#section-10.6)\n`511` | Network Authentication Required | \"indicates that the client needs to authenticate to gain network access.\" | [RFC6585#6](https://tools.ietf.org/html/rfc6585#section-6)\n`7xx` | **Developer Error** | [err](http://www.urbandictionary.com/define.php?term=err) | [7xx-rfc](http://documentup.com/joho/7XX-rfc)\n\nA chunk of extension codes can be found in [RFC2326 Real Time Streaming Protocol (RTSP)](https://tools.ietf.org/html/rfc2326#).\n\nFor a full up-to-date list, continue reading on [HTTP Status Code Registry](https://www.iana.org/assignments/http-status-codes/http-status-codes.xml), [Wikipedia](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes).\n\n## Sources\n\n* [RFC7231 Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content](https://tools.ietf.org/html/rfc7231#)\n* [RFC7232 Hypertext Transfer Protocol (HTTP/1.1): Conditional Requests](https://tools.ietf.org/html/rfc7232#)\n* [RFC7233 Hypertext Transfer Protocol (HTTP/1.1): Range Requests](https://tools.ietf.org/html/rfc7233#)\n* [RFC2616 Hypertext Transfer Protocol -- HTTP/1.1](https://tools.ietf.org/html/rfc2616#)\n* [RFC2518 HTTP Extensions for Distributed Authoring -- WEBDAV](https://tools.ietf.org/html/rfc2518)\n* [RFC6585 Additional HTTP Status Codes](https://tools.ietf.org/html/rfc6585#)\n* [Dana Contreras](https://twitter.com/DanaDanger)\n* [John Barton](http://whoisjohnbarton.com)\n* [Urban Dictionary](http://www.urbandictionary.com)\n* Yours truly\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/Node":{"title":"","content":"# Node\n[Introduction](Web\u0026Net/node/Introduction.md)\n## Error Handling\n[manage-error](Web\u0026Net/node/error-handling/manage-error.md)\n\n[verror](Web\u0026Net/node/error-handling/verror.md)\n\n## Events\n[events](Web\u0026Net/node/events/events.md)\n\n[once](Web\u0026Net/node/events/once.md)\n\n## Pattern\n\n[patterns](Web\u0026Net/node/node-patterns/patterns.md)\n\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/Introduction":{"title":"","content":"# What is NodeJS?\n\n\n---\n\n## Content\n\nNode.js is an extremely powerful JavaScript framework which was built upon Google Chrome’s V8 JavaScript engine. It provides an asynchronous[1], event driven, I/O based cross-platform runtime environment for the development of server-side JavaScript applications.\n\nNode can be used to build a variety of applications including single and multi-page web applications, real-time chat applications, command line applications and more. There are a number of advantages associated with Node.js:\n\n- It is free to download and to use and allows entire server side applications to be built only using JavaScript.\n- Due to Node.js being a lightweight framework it includes the bare minimum number of required modules, consequently improving running speeds and performance. It also allows for external code to be included in case the code is useful for the application being built.\n- Node performs faster than other frameworks because it’s asynchronous by default.\n- It’s a cross-platform framework which runs on Windows, Mac and Linux.\n\n\n\n[1:Asynchronous]\nEven though JavaScript is single threaded, V8 JavaScript engine is not. In order to resolve functions that would be holding back the main thread, Node sends those instructions to the engine through *APIs* and subscribes to an event that marks the end of the computation for that process, through an event loop.\n\nThe result is then reintroduced into the JavaScript main runtime stack. This whole process is what makes the Node environment *asynchronous*.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/error-handling/manage-error":{"title":"","content":"# First-error callbacks in Node\n\n\n---\n\n## Content\n\nThe `\"error-first\"` callback (also \"errorback\" or \"err-back\") has become the standard protocol for **Node** as to enable a balanced, non-blocking flow of control and processing power across applications and modules.\n\nThe parameters of an error-first callback functions should look like:\n\n```javascript\nfunction(err, data)\n```\n\nThe first argument is an error object. If the response is successful `err` will be equal to `null`. Otherwise it will take the type of error.\n\nImplementing an \"error-first\" callback:\n\n```javascript\nfs.readFile('/text.txt',\n function(err, data) {\n   if (err) {\n     console.log('error')\n     console.log(err)\n   } else {\n     console.log(data);\n   }\n});\n```\n\nNote that the errors can be more specific:\n\n```javascript\n// ...\nfunction(err, data) {\n  if (err.fileNotFound) {\n    console.log('wrong source')\n  }\n}\n\n```\n\n\n# `try-catch` only for **sync** code\n\n\n---\n\n## Content\n\nAll *JavaScript* errors are handled as exceptions that will **instantly** generate and `throw` and error. To handle them, `try-catch` constructor is used.\n\nHowever, most errors from within **asynchronous** APIs behave differently (mostly with callbacks or `EventEmitters`) so they can't be handled with `try-catch`.\n\nFor example, `JSON.parse` method happens **synchronously**. We can handle its errors with a `try-catch` block:\n\n```javascript\nfunction readJSON(filePath, callback) {  \n  fs.readFile(filePath, (err, data) =\u003e {\n    let parsedJson;\n\n    // Handle error\n    if (err) {\n       return callback(err);\n    }\n\n    // Parse JSON with JSON.parse method\n    try {\n      parsedJson = JSON.parse(data);\n    } catch (exception) {\n      return callback(exception);\n    }\n\n    return callback(null, parsedJson);\n  });\n}\n\n```\n\n# uncaughtException listener in Node.js\n\n\n---\n\n## Content\n\nUse an `uncaughtException` listener to prevent a program crashing due to an unhandled exception.\n\nFor example:\n\n```javascript\nprocess.on('uncaughtException',\n  function(err) {\n     console.log('exception: ' + err);\n  }\n)\n```\n\nAn unhandled exception means an application is in an **undefined state**. It is not possible to continue the program safely and should restart.\n\nNote that `uncaughtException` is a crude mechanism for exception handling and is therefore not recommended in production.","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/error-handling/verror":{"title":"","content":"\n# Wrapping Errors in Node.Js Using `node-verror`\n\n\n---\n\n## Content\n\nThe module `node-verror` can be used to produce useful error messages in Node.js. It has two classes `VError` and `WError`.\n\n### `VError` Class\n\n`VError` is used to **combine errors**. It is possible to nest errors so that each layer in the stack annotates the error:\n\n```javascript\nlet VError = require(\"verror\");\nlet err1 = new Error(\"file not found.\");\nlet err2 = new VError(\n  err1,\n  'failed to open \"%s\"',\n  \"eg.txt\"\n);\nlet err3 = new VError(\n  err2,\n  \"request failed\"\n);\nconsole.error(err3.message);\n```\n\nThis gives the message:\n\n```bash\nrequest failed: failed to open \"eg.txt\":\nfile not found\n```\n\n### `WError` Class\n\nTo avoid giving detail about the error at every layer in stack, use `WError` to **wrap errors**.  For example the code above could be changed to:\n\n```javascript\n//... same as above\nlet err3 = new WError(\n  err2,\n  \"request failed\"\n);\nconsole.error(err3.message);\n// 'request failed'\n```\n\nTo see the whole message (as well as the class associated with each error) use `console.error(err3.toString());`.","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/events/events":{"title":"","content":"# Consuming events\n\n\n---\n\n## Content\n\nNode applications are event driven applications, an event occurs upon a change of state in an application, for example, a button being clicked, or data being inputted.\n\nNode events are consumed when an in-application event occurs, modules subscribe to events by listening to the event on a given object. For example, in a file system, an event could be that a file has been edited:\n\n```javascript\nlet system = require('.filesystem.js');\nsystem.file.on('edit', function() {\n\n  // do something...\n\n});\n```\n\nIn this example, the `system.file` object is an event emitter, a module can listen to this object by both using the `.on` method and passing in a function which is called whenever an event with that given name occurs.\n\nEvents can also produce relevant data, for example if you wanted to know who edited a file in the system:\n\n```javascript\nsystem.file.on('edit', function\n                      (fileID, initials) {\n\n  console.log('File number %d was edited'\n          + 'by %s', fileID, initials);\n\n});\n```\n\nTo unsubscribe to events, use the `.removeListener`  method and specify the event type and the event listener function.\n\n```javascript\nfunction onEdit(fileID, initials) {\n  // on edit, do something...\n}\n\nsystem.file.removeListener('edit', onEdit);\n```\n\n# Event Delivery\n\n\n---\n\n## Content\n\nNode is asynchronous, however as no I/O is involved in emitting events, the delivery of events is treated synchronously. Therefore:\n\n```javascript\nconst EventEmitter = require('events')\n  .EventEmitter;\n\nconst emitter = new EventEmitter();\n\nemitter.on('hi', function() {\n  console.log('hi!');\n});\n\nemitter.on('hi', function() {\n  console.log('hi again!');\n});\n\nconsole.log('pre hi');\nemitter.emit('hi');\nconsole.log('post hi');\n```\n\nGives the following output:\n\n```plain-text\npre hi\nhi!\nhi again!\npost hi\n```\n\nRemember that when emitting events, listeners will be called before `emitter.emit` returns.\n\n# Handling event errors\n\n\n---\n\n## Content\n\nAll events are treated equally as all event types are defined by an arbitrary string. When an event emitter[1] emits an event with no attached listeners the event is ignored.\n\nIf the event is called *error* however, the error is thrown into the event loop, then generating an uncaught exception. To stop this from breaking the application, uncaught exceptions can be caught by listening to the `uncaughtException` which the global event emitter object emits. Take `test` as a sample event emitter:\n\n```javascript\ntest.on(‘uncaughtException’, function(err)\n{\n  console.error(‘uncaught exception: ‘,\n                    err.stack || err);\n\n\n  closeApp(function(err) {\n    if (err)\n      // error closing down\n\n\n    test.exit(1);\n  });\n\n});\n```\n\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/events/once":{"title":"","content":"\n# Listening to events just once\n\n\n---\n\n## Content\n\nEvents are actions that happen within your JavaScript application and are signaled by the system such that we can *react* to them. \n\nThis is a frequent technique with multiple applications including handling asynchronous code (e.g. child processes) and processing continuous streams of information (e.g. read a really long file).\n\nWe can choose what events to react to through an event listener. However, there might be cases when reacting to these events every time they happen can cause undesired side effects.\n\nIn this case, it might be useful to **listen to events just once**[1].\n\nLet's look at an example to see how this can translate into practice. Picture a node application with a database. Whenever our application crashes unexpectedly we want to free up the database resources. Yet, if we run the \"free database resources\" operation twice, this can cause undesired errors on the database layer.\n\nNormally, we'd *listen to* uncaught error events like this:\n\n```js\nprocess.on('uncaughtException', (err) =\u003e {\n  console.error('There was an uncaught error', err)\n  closeDBConnection();\n  process.exit(1) // signals that process ended with an error (as per Node docs) \n});\n```\n\nNow, let's say the application throws 5 unexpected exceptions at the same time. This will lead to this procedure being triggered 5 times concomitantly which might lead to issues in the database shutdown procedure (as mentioned earlier).\n\nTo **listen to events just once** you would call `process.once` instead:\n\n```js\nprocess.once('uncaughtException', (err) =\u003e {\n  console.error('There was an uncaught error', err)\n  closeDBConnection();\n  process.exit(1) // signals that process ended with an error (as per Node docs) \n});\n```\n\nVoilà, this will ensure that we'll react only to the first emitted `uncaughtException` event.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/node-patterns/patterns":{"title":"","content":"# Factories design pattern\n\n\n---\n\n## Content\n\nIn order to avoid custom object creation with different arguments, **factories** can be used instead. Their usage is obvious when working with complex constructors or you want to avoid *copypasta*.\n\nFactories will create objects for you so *you don't have to*.\n\nBasic factories pattern:\n\n```javascript\n//enki.js\nfunction Enki (args) {\n  this.args = args;\n}\n\nfunction create (args) {\n  //args should be modified here\n  return new Enki(args);\n}\n\nmodule.exports.create = create;\n```\n\n\n# Middleware/pipeline design pattern\n\n\n---\n\n## Content\n\nThe **middleware** or **pipeline** concept is used everywhere in Node.js. They represent a series of processing units connected subsequently: **the output of one unit is the input for the next one**.\n\n```javascript\nfunction(/*input/output */, next) {\n  next(/* err and/or output */)\n};\n```\n\n**Koa** framework does it like this:\n\n```javascript\napp.use = function(fn) {\n  this.middleware.push(fn);\n  return this;\n};\n```\n\nThis concept is usually implemented through `async.waterfall` or `async.auto`:\n\n```javascript\nasync.waterfall([\n  function(callback) {\n    callback(...);\n  },\n  function(args, callback){\n    callback(...);\n  }\n]};\n```\n\nFamous Node.js streams also use the concept of pipelining:\n\n```javascript\nfs.createReadStream(\"file.gz\")\n  .pipe(zlib.createGunzip())\n  .pipe(through(function write(data) {\n      //handle data\n      this.queue(data);\n   })\n  //write to your file\n  .pipe(fs.createWritableStream(\"out.txt\"));\n```\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/operational-vs-programmer-errors/README":{"title":"","content":"name: Operational vs. Programmer Errors\ntype: insights-list\ndescription: How to distinguish between types of errors.\nsection: 1\ninsights:\n  - operational-vs-programmer-errors\n  - handling-operational-errors\n  - handling-programmer-errors\naspects:\n  - introduction\n  - workout\n \n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/operational-vs-programmer-errors/handling-operational-errors":{"title":"","content":"\n# Handling Operational Errors\n\n\n---\n\n## Content\n\nThere isn't a single place in the application where errors can pop up, so you should be prepared to handle them wherever you are making a HTTP request, performing I/O operations, forking processes or validation input. You may end up handling the same error at different points of the stack, since those functions can't do more than passing the error.\n\nFor most operational errors, the message will most likely point to what is left to do. For example, trying to access a file that is not yet created will *return* (async) or *throw* (sync) an `ENOENT: no such file or directory` error.\n\nWhile we're at it, let's focus on the difference between asynchronous and synchronous functions. Consider the following snippet:\n\n```javascript\nimport fs from 'fs';\n\nfunction readAndParseFile(path,\n  user_callback) {\n    try {\n      fs.readFile(path, (err, text) =\u003e {\n        if(err) throw err;\n      });\n    } catch(err) {\n      user_callback(err);\n    }\n}\n```\n\nCan you identify why the following anti-pattern will fail? `try/catch` expects a synchronous exception (an \"synchronous\" looking approach using `async/await` won't work either). By the time `fs.read()` returns the error to the callback (or Promise), the `try/catch` block will be marked as successful and exited.\n\nMoreover, always try to document your code and prepare for failure. Take, for example, a case where you want to accept only email addresses as username. Depending on what whether you want the code to work sync or async (but always write this down), you can either throw as soon as you receive the wrong input (`if(!input.match(/regex_here/))` or return an error to a callback/promise.\n\nYou should follow the same pattern and expect it from the others. Most of the times it will be stated in the documentation if a function is synchronous or asynchronous.\n\nA stricter approach with regard to handling anything that requires non-standardized input is the safest bet. By regulating the the input range yourself, you are avoiding having to guess what the client meant (or intentionally delivered), which might lead to long-lasting, hard to discover bugs and backwards-compatibility issues after fixing. Otherwise, what should have been an easy to deal with operational error will quickly become a programmer error.\n\n\n---\n\n## Practice\n\nCan you identify what will be the stack trace of the following snippet?\n\n```javascript\nconst throw_example = () =\u003e {\n  return new Promise((resolve, reject) =\u003e {\n    setTimeout(() =\u003e {\n      throw new Error('throw_example');\n    }, 0);\n  });\n};\n\nconst reject_example = () =\u003e {\n  return new Promise((resolve, reject) =\u003e {\n    setTimeout(() =\u003e {\n      reject(new Error('reject_example'));\n    }, 0);\n  });\n};\n\nconst main = async () =\u003e {\n  try {\n    await reject_example();\n    await throw_example();\n  } catch (err) {\n    console.log(err.message);\n  }\n};\n\nmain();\n```\n\n???\n\n- No error shown, only the message reject_example.\n- An exception with the message throw_example.\n- An exception with the message reject_example.\n- No error shown, only the message throw_example.\n\n\n---\n\n## Revision\n\nFor correctness and consistency, when writing an asynchronous function, errors raised should be ???\n\n- returned\n- thrown\n- discarded\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/operational-vs-programmer-errors/handling-programmer-errors":{"title":"","content":"\n# Handling Programmer Errors\n\n\n---\n\n## Content\n\nProgrammer errors are *bugs*. Hence, they **can't and shouldn't** be handled. The only way to deal with them is to debug and fix the problem. If the error is expected, that makes it operational.\n\nIn production, if such an error is encountered while fulfilling a request, there are two workarounds until the next deploy: *recover* or *crash immediately*.\n\nRecovering means allowing the operation to fail but continue handling requests. But this is a problem you hadn't considered, so there is no way to know if this will be an one time only or it will wreak havoc among the other connections. For example, a variable left `null` or `undefined` will cause following requests to blow up as well, a connection can be left in an authenticated state, also used for new connections or memory may leak.\n\nUndoubtedly, the best response is to *crash and restart* the server. This is the fastest way to fully restore the service - or as much as possible, considering the bug - until the problem is fixed for good. Going straight for the cause instead of wasting time treating the symptoms will often reduce the number of times a server crashes.\n\nRemember that programmer errors on the server become operational errors on the client. They are the ones that have to deal with servers crashes and network issues. Most of the times, even just logging the error message for the user to see is better than providing no feedback of what is happening.\n\n\n---\n\n## Practice\n\nCan you identify what a successful system recovery implies?\n\n???\n\n- Allowing a request to fail and reverting the state changes\n- Allowing a request to fail\n- Restarting the system\n- Fixing the programmer error\n- Handling the programmer error properly\n\n\n---\n\n## Revision\n\nDrawing an analogy between a disease and a server crashing, which of the following statements are equivalent?\n\n```javascript\nCause\n???\n\nSymptoms\n???\n\nTreatment\n???\n```\n\n- Programmer error\n- Service outage\n- Fixing the bug\n- Handling the programmer error\n- Operational error\n- Enclosing the code inside a try/catch block\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/node/operational-vs-programmer-errors/operational-vs-programmer-errors":{"title":"","content":"\n# Operational vs. Programmer Errors\n\n\n---\n\n## Content\n\nErrors in Node start off as scary. What if my server dies when there are hundreds of people connected? Do I restart it and disconnect all users? Do I handle all the possible errors such that no unwanted restart is needed?\n\nThe most accurate answer is likely also the most general one: it depends. Some errors are to be expected. Others are not.\n\n**Operational errors** are a subset of the \"expected errors\". Your server doesn't accept passwords shorter than 10 characters, so it returns an error. You sent the wrong parameter to the API you're using and received a 400 Bad Request. You simply ran out of memory by opening too many files without closing them.\n\nThese are usually *run-time* errors which can be handled gracefully, without the risk of leaking any data or unexpected behavior. They do not represent a bug - mistakes happen everywhere and you are expected as a programmer to handles others'.\n\n**Programmer errors**, on the other hand, are considered bugs. Reading an undefined value, a leaking database connection, calling async functions without a callback or not validating user input are all examples of errors that usually require the application to be restarted. Moreover, not handling an external operational error (400 or 500 HTTP codes) in your code is also  considered to be a programmer error.\n\nHowever, restarting the server won't solve bugs and the only permanent solution is to change the code in question.\n\nTo make the distinction between the two types is the first step in being able to properly handle them.\n\n\u003e 💡 You might have also heard of \"exceptions\". \n\nAn exception is a \"thrown error\":\n\n```javascript\nif(err){\n  throw new Error('exception here');  \n}\n\ncallback(new Error('error here'));\n```\n\n\n---\n\n## Practice\n\nCan you identify type of error most likely depicted in the following snippet?\n\n```javascript\nimport http from 'http';\n...\n// create the request header\nhttp.request({host: test.com,\n  port: 80,\n  path: '/signup',\n  method: 'POST'\n  }, (res, err) =\u003e err \u0026\u0026 console.log(err))\n  // add the data\n    .write(\n      'username': 'enki',\n      'password': 'enki'\n    );\n```\n\n???\n\n- Handled operational error\n- Unhandled operational error\n- Handled programmer error\n- Unhandled programmer error\n\n\n---\n\n## Revision\n\nA programmer error is\n\n???\n\n- a problem where the program unexpectedly crashes\n- a problem where the program expectedly crashes\n- a problem with the server configuration\n- a problem on the client\n- an unhandled exception\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/Positioning":{"title":"","content":"[block-elements-characteristics](Web\u0026Net/styling/positioning/block-elements-characteristics.md)\n\n[floating-elements](Web\u0026Net/styling/positioning/floating-elements.md)\n\n[inline-block-elements-characteristics](Web\u0026Net/styling/positioning/inline-block-elements-characteristics.md)\n\n[inline-elements-characteristics](Web\u0026Net/styling/positioning/inline-elements-characteristics.md)\n\n[positioning-elements](Web\u0026Net/styling/positioning/positioning-elements.md)\n\n\n\n[clearfix-for-layouts](Web\u0026Net/styling/positioning-tips/clearfix-for-layouts.md)\n\n[cells](Web\u0026Net/styling/positioning-tips/cells.md)\n\n[direction-column-reverse](Web\u0026Net/styling/positioning-tips/direction-column-reverse.md)\n\n[equal-width-table-cells](Web\u0026Net/styling/positioning-tips/equal-width-table-cells.md)\n\n[position-elements-with-position-sticky](Web\u0026Net/web/styling/positioning-tips/position-elements-with-position-sticky.md)","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/animations/advanced-animations":{"title":"","content":"\n\n# Animations in Webkit browsers\n\n## Content\n\nMany Webkit browsers still use the `-webkit-prefixed` version of animations, keyframes, and transitions.\n\nUntil they fully adopt the standard version, it's good practice to include both versions (`unprefixed` \u0026 `webkit`) in your code:\n\n```css\ndiv {\n  -webkit-animation-duration: 2s;\n  animation-duration: 2s;\n  -webkit-animation-name: bounceIn;\n  animation-name: bounceIn;\n}\n```\n\n`Autoprefixer` is a tool which calculates which prefixes are required and which are outdated. When autoprefixer adds prefixes to the code, it also fixes any differences the syntax may have.\n\n\n---\n# Making shapes with transform\n\n\n---\n\n## Content\n\n`Rotate` certain shapes using `transform` can be used to obtain other shapes.\n\nApplying the `transform` property on a regular square can create a diamond, for example:\n\n```css\n#diamond {\n  transform: rotate(45deg);\n}\n```\n\nThe default rotation point is the center of the element. `transform-origin` can change that: it can take 2 (for 2D shapes) or 3 (for 3D shapes) values, as the `x` and `y` coordinates of the new rotation point.\n\nThe center of a 2D shape is:\n\n```css\ntransform-origin: 50% 50%;\n/* or */\ntransform-origin: center center;\n/* for known dimensions: 500px × 20em*/\ntransform-origin: 250px 10em;\n```\n\nOther values :\n\n```css\ntransform-origin: top left;\ntransform-origin: right bottom;\ntransform-origin: left center;\n```\n\nThis is the default rotation around its center:\n\n![diamondtransform.svg](https://img.enkipro.com/afacbc50fedc953093d5d1aba5b4d385.png)\n\n# Manipulating shapes using border\n\n\n---\n\n## Content\n\nYou can make shapes by defining the properties of the `border`, as seen below:\n\n```css\n#triangle {\n  width: 0;\n  height: 0;\n  border-left: 80px solid white;\n  border-right: 80px solid transparent;\n  border-top: 80px solid transparent;\n  border-bottom: 80px solid transparent;\n}\n```\n\nBy setting the `background` of three `borders` to be `transparent`, the shape of a triangle is mimicked.\n\nFor the following image, these are the borders that are not transparent:\n\n- **A** : *border-left* (code snippet above)\n- **B** : *border-right*\n- **C** : *border-top*\n- **D** : *border-bottom*\n\n![HtmlToSvg.svg](https://img.enkipro.com/34ca2aafa9de4ed519daa02ad9052127.png)\n\n# Manipulating shapes using clip-path\n\n\n---\n\n## Content\n\nYou can use functions that are applied to `shape-outside` to `clip-path`, ie, `inset()`, `polygon()`, `ellipse()`.\nBelow is an example of `clip-path` in action:\n\n```css\n#element {\n  width: 300px;\n  height: 150px;\n  clip-path:\n    polygon(0% 0%, 100% 100%, 0% 100%);\n}\n```\n\nThe list separated by commas define the *(x,y)* coordinates for each point. Translated into *px*, its equivalent would be `polygon(0px 0px, 300px 150px, 0px 150px)`. Three points will determine a triangle.\n\n![clippathtriangle.svg](https://img.enkipro.com/9b9a4914d020ad42c618f59d8fe30abf.png)\n\nIf you want text to wrap around a shape, you have to combine `clip-path` with the `shape-outside` property.\n\n\u003e 💡 Top-left corner of the `element` is located at `(0%,0%)`, while the bottom-right one at `(100%, 100%)`.\n\nTake a look at these two square Enki logos:\n\n![manipulating-shapes-enki-logo-example](https://img.enkipro.com/3dc5e3eea131276d0e75a779141a2fc9.png)\n\nHere's the HTML code:\n```html\n\u003c!-- Regular Enki Logo --\u003e\n\u003cimg src=\"https://img.enkipro.com/3369b724e5749ae19442e4677362c1e8.png\"\u003e\n\n\u003c!-- Enki Logo with a class called \"clipped\" --\u003e\n\u003cimg class=\"clipped\" src=\"https://img.enkipro.com/3369b724e5749ae19442e4677362c1e8.png\"\u003e\n```\n\nLet's see what happens when we use `ellipse` instead of `polygon`:\n```css\n.clipped { \n  clip-path: ellipse(65px 30px at 125px 40px);\n}\n```\n![enki-image-output-for-manipulating-shapes](https://img.enkipro.com/a50732d668d8f66212f89a8420942551.png)\n\n# Manipulating shapes using shape-outside\n\n\n---\n\n## Content\n\nYou can wrap pieces of text around shapes using `shape-outside`. As of `CSS3`, this property only works on elements that have the property of `float` applied upon it.\n\nExample:\n\n```css\n#element {\n  float: left;\n  shape-outside: circle(50%);\n  width: 100px;\n  height: 100px;\n}\n```\n\nThis is the visual equivalent of the above snippet:\n\n![shapeoutsidecircle.svg](https://img.enkipro.com/bf10605b36534f1e04e0fd2e3d2972a7.png)\n\nOther functions instead of `circle()` include: `ellipse()`, `polygon()`, `inset()`.\n\nHowever, this property is not supported by IE and does not change the actual shape of the element.\n\n# Pause and play CSS animations\n\n\n---\n\n## Content\n\nYou can *pause* and *play* CSS animation by changing its `animation-play-state` property.\n\nSetting it to *paused* stops your animation in place, until you change `animation-play-state` to running, for example on hover.\n\n```css\n.animating_thing {\n    animation: spin 10s linear infinite;\n    animation-play-state: paused;\n}\n.animating_thing:hover {\n    animation-play-state: running;\n}\n```\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/animations/animations":{"title":"","content":"# Animation basics in CSS\n\n\n---\n\n## Content\n\nThere are two main properties when it comes to animating : `animation` and `keyframes`.\n\n`animation` : how an element should transition (duration, speed).\n\n`keyframes` : the actions an element should follow throughout the animation.\n\n`animation-delay`  : delays the execution of an animation by a specified amount of time.\n\nSample code of a circle moving inside a square:  \n\n```css\n#ball {\nposition: relative;\nanimation: ball 4s linear infinite;\nanimation-delay: 1s;\n}\n@keyframes ball {\n    0% { top: 50px; left: 50px; }\n    25% { top: 50px; left: 200px; }\n    50% { top: 200px; left: 200px; }\n    75% { top: 200px; left: 50px; }\n    100% { top: 50px; left: 50px; }\n}\n```\n\n*1s* is necessary for the ball to get from any point to the next. Because of the `infinite` value, the animation will not stop by itself.\n\n![animationsvgmin.svg](https://img.enkipro.com/f3391cbe5ba0db6aab629bfd8a191e7a.png)\n\nYou can also *pause* and *play* CSS animation by changing its `animation-play-state` property.\n\nSetting it to *paused* stops your animation in place, until you change `animation-play-state` to running, for example on hover.\n\n```css\n#ball {\n    animation: spin 10s linear infinite;\n    animation-play-state: paused;\n}\n#ball {\n    animation-play-state: running;\n}\n```\n\n\n# Shorthand Transitions\n\n\n---\n\n## Content\n\nDeclaring each transition property individually can be intensive, especially using `vendor prefixes`.\n\nInstead, try the shorthand property `transition` that supports all the different values.\n\nUsing only this alone it is possible to set every transition value in order of `transition-property`, `transition-duration`, `transition-timing-function`, and lastly `transition-delay`.\n\n```css\n.box {\n  background: #2db34a;\n  border-radius: 6px;\n  transition: background .2s linear;\n}\n.box:hover {\n  background: #ff7b29;\n  border-radius: 50%;\n}\n```\n\nFor setting many transitions at once, set every individual group of transition values, then use a comma to separate each group of additional ones.","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/centring":{"title":"","content":"# Horizontal centering fluid blocks\n\n\n---\n\n## Content\n\nTo horizontally center blocks of unknown width:\n\n```css\n#horizontal-center {\n  position: absolute;\n  left: 50%;\n  transform: translateX(-50%);\n}\n```\n\nThe `left` property relates to the size of the parent so the left of child will be in the middle. The `transform` property relates to the child size. Hence it will be centered.\n\nYou can check out the evolution here:\n\n![HtmlToSvg.svg](https://img.enkipro.com/ff255695f9032f0cff8fb0417b180705.png)\n\n# Vertical centering fluid blocks\n\n\n---\n\n## Content\n\nTo vertically center blocks of unknown height:\n\n```css\n.elem {\n  position: absolute;\n  top: 50%;\n  transform: translateY(-50%);\n}\n```\n\nThis is how the properties would position the element:\n\n![HtmlToSvg.svg](https://img.enkipro.com/26ef6523907e513af1de985571a360cf.png)\n\nThe `top` property relates to the size of `.elem`'s parent. Setting it to 50% means the top of `.elem` will be in the middle. The `transform` property relates to the size of `.elem` itself.   \n\nTherefore moving it up by 50% of its height, means the middle of `.elem` will be in the middle of its parent element.\n\n\n---\n\n# Horizontal centering with margin: 0 auto;\n\n\n---\n\n## Content\n\nTo horizontally center **block elements** of a known width:\n\n```css\n#horizontal-center {\n  width: 960px;\n  margin: 0 auto;\n}\n```\n\nThe 2 value shorthand notation of `margin` targets `top/bottom-margins` and `left/right-margins`. Because the element is **block**, it occupies the whole width of the container.\n\nThe element also has a known width, so the browser can calculate the container's unused width. The `auto` value tells the browser to equally distantiate the block element from the left and the right margin, which effectively centers it horizontally.\n\n\n---\n\n# Vertical centering with margin-top\n\n\n---\n\n## Content\n\nTo vertically center block elements of known height:\n\n```css\n.vertical-center {\n  position: absolute;\n  top: 50%;\n  height: 400px;\n  margin-top: -200px;\n}\n```\n\nYou can check out the evolution here:\n\n![HtmlToSvg.svg](https://img.enkipro.com/3179ba1e9d0b35a33abec9b3d20ce4d5.png)\n\n`top: 50%` will put the top of the element in the center of its parent. `margin-top: -200px` will make the content of the element start 200px before its top. By combining both, we manage to center an element of known height.\n\n\n---\n\n# Vertically-center anything\n\n\n---\n\n## Content\n\nUse `flexbox` to center anything vertically:\n\n```css\nhtml, body {\n  height: 100%;\n  margin: 0;\n}\n\nbody {\n  align-items: center;\n  display: flex;\n}\n```\n\nThere may be some unwanted behaviour in IE11.\n\n\n---","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/features":{"title":"","content":"# Use SVG for icons\n\n\n---\n\n## Content\n\nSince `SVG` (Scalable Vector Graphics) scales well for all resolution types, it is useful for icons:\n\n```css\n.logo {\n  background: url(\"logo.svg\");\n}\n```\n\n`SVG` is supported in all browsers back to IE9.\n\n# At-Rules @ \n\n\n---\n\n## Content\n\nThe at-rule (`@`) informs CSS with instructions on how to behave.\n\nThe regular form for `@` is:\n\n```css\n@[KEYWORD] (RULE);\n```\n\nRegular @keywords include: `charset`, `import`, and `namespace`.\n\nThe nested form for `@` is:\n\n```css\n@[KEYWORD] {\n/* Nested Statements */\n};\n```\n\nNested `@keywords` include: `document`, `font-face`, `keyframes`, `media`, `page`, and `supports`.\n\nThese are useful when you want to check if the browser supports a property:\n\n```css\n@supports (image-rendering and\n    -moz-crisp-edges) {\n /* CSS code if supported*/\nimage-rendering:\n   -webkit-optimize-contrast;\n}\n```\n\nOr you want different image scaling depending on screen size:\n\n```css\n@media screen and (max-width:720px){\n  .thumbnail{\n    width: 10vh;\n    height: 10vh;\n  }\n}\n\n@media screen and (min-width: 720px){\n  .thumbnail{\n    width: 15vh;\n    height: 15vh;\n  }\n}\n```\n\n\n\n# Simpler maths with calc()\n\n\n---\n\n## Content\n\nFor styling a 7-column grid you may use something like :\n\n```css\n.column-1-7 {\n   width: 14.2857%;\n}\n.column-2-7 {\n   width: 28.5714%;\n}\n.column-3-7 {\n   width: 42.8571%;\n}\n```\n\nUse the calc() function instead to make the maths behind the layout easier to understand :\n\n```css\n.column-1-7 {\n   width: calc(100% / 7);\n}\n.column-2-7 {\n   width: calc(100% / 7 * 2);\n}\n.column-3-7 {\n   width: calc(100% / 7 * 3);\n}\n```\n\nYou can also mix units!\n\n```css\n.mixing {\n   width: calc(50% + 30px);\n}\n\n```\n\n\n---\n\n# Combining selectors\n\n\n---\n\n## Content\n\nTwo selectors can be combined to refer to a certain element. The most common ones are '+' and '~'.  \n\n### X+Y\n\n```css\nul + p {\n   color: orangered;\n}\n\n```\n\nThis is referred to as *an adjacent selector*. It will select only the element that is **immediately preceded** by the former element. In this case, only the first paragraph after each `ul` will have red text.\n\n### X~Y\n\n```css\nul ~ p {\n   font-weight: bold;\n}\n\n```\n\nThis sibling combinator is similar to `X + Y`, however, it's less strict. While an adjacent selector `(ul + p)` will only select the first element that is immediately preceded by the former selector, this one is more generalized. It will select, referring to our example above, any p elements, as long as they follow a `ul`.\n\nConsider the HTML code:\n\n```html\n\u003cul\u003e\n \u003cli\u003eFirst list item.\u003c/li\u003e\n \u003cp\u003e A paragraph nested inside the\n                 list.\u003c/p\u003e\n\u003c/ul\u003e\n\u003cp\u003eA paragraph immediately after ul.\u003c/p\u003e\n\u003cp\u003eA second paragraph after ul.\u003c/p\u003e\n```\n\nBoth of the selectors are used in this example:\n\n![HtmlToSvgmin.svg](https://img.enkipro.com/55077de02fb561f44f83e976dba488a8.png)\n\n\n---\n\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/flexbox":{"title":"","content":"\n### Simple example\n\n```css\n.container {\n  display: flex;\n}\n```\n\n```css\n.container \u003e div {\n  flex: 1 1 auto;\n}\n```\n\n### Container\n\n```css\n  display: flex;\n  display: inline-flex;\n```\n\n```css\n  flex-direction: row;            /* ltr - default */\n  flex-direction: row-reverse;    /* rtl */\n  flex-direction: column;         /* top-bottom */\n  flex-direction: column-reverse; /* bottom-top */\n```\n\n```css\n  flex-wrap: nowrap; /* one-line */\n  flex-wrap: wrap;   /* multi-line */\n```\n\n```css\n  align-items: flex-start; /* vertical-align to top */\n  align-items: flex-end;   /* vertical-align to bottom */\n  align-items: center;     /* vertical-align to center */\n  align-items: stretch;    /* same height on all (default) */\n```\n\n```css\n  justify-content: flex-start;    /* [xxx        ] */\n  justify-content: center;        /* [    xxx    ] */\n  justify-content: flex-end;      /* [        xxx] */\n  justify-content: space-between; /* [x    x    x] */\n  justify-content: space-around;  /* [ x   x   x ] */\n  justify-content: space-evenly;  /* [  x  x  x  ] */\n```\n\n```css\n}\n```\n{: .-setup}\n\n### Child\n\n```css\n.container \u003e div {\n```\n{: .-setup}\n\n```css\n  /* This: */\n  flex: 1 0 auto;\n\n  /* Is equivalent to this: */\n  flex-grow: 1;\n  flex-shrink: 0;\n  flex-basis: auto;\n```\n\n```css\n  order: 1;\n```\n\n```css\n  align-self: flex-start;  /* left */\n  margin-left: auto;       /* right */\n```\n\n```css\n}\n```\n{: .-setup}\n\n\n## Tricks\n\n### Vertical center\n\n```css\n.container {\n  display: flex;\n}\n\n.container \u003e div {\n  width: 100px;\n  height: 100px;\n  margin: auto;\n}\n```\n\n### Vertical center (2)\n\n```css\n.container {\n  display: flex;\n  align-items: center;     /* vertical */\n  justify-content: center; /* horizontal */\n}\n```\n\n### Reordering\n\n```css\n.container \u003e .top {\n order: 1;\n}\n\n.container \u003e .bottom {\n order: 2;\n}\n```\n\n### Mobile layout\n\n\n```css\n.container {\n  display: flex;\n  flex-direction: column;\n}\n\n.container \u003e .top {\n  flex: 0 0 100px;\n}\n\n.container \u003e .content {\n  flex: 1 0 auto;\n}\n```\n\nA fixed-height top bar and a dynamic-height content area.\n\n### Table-like\n\n```css\n.container {\n  display: flex;\n}\n\n/* the 'px' values here are just suggested percentages */\n.container \u003e .checkbox { flex: 1 0 20px; }\n.container \u003e .subject  { flex: 1 0 400px; }\n.container \u003e .date     { flex: 1 0 120px; }\n```\n\nThis creates columns that have different widths, but size accordingly according\nto the circumstances.\n\n### Vertical\n\n\n```css\n.container {\n  align-items: center;\n}\n```\n\nVertically-center all items.\n\n### Left and right\n\n```css\n.menu \u003e .left  { align-self: flex-start; }\n.menu \u003e .right { align-self: flex-end; }\n```\n\n## References\n{: .-one-column}\n\n * [MDN: Using CSS flexbox](https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Flexible_boxes)\n * [Ultimate flexbox cheatsheet](http://www.sketchingwithcss.com/samplechapter/cheatsheet.html)","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning-tips/cells":{"title":"","content":"\n# Controlling cellpadding and cellspacing in CSS\n\n\n---\n\n## Content\n\nCellpadding refers to the space between the cell content and the cell wall, while, cellspacing refers to the space between table cells.\n\nTo control the \"cellpadding\" in CSS, apply `padding` on table cells, for example:\n\n```css\ntd {\n  padding: 10px;\n}\n```\n\nTo control the \"cellspacing\" in CSS, apply `border-spacing` and `border-collapse` to the table, for example:\n\n```css\ntable {\n  border-spacing: 10px;\n  border-collapse: separate;\n}\n```\n\nThis is how the table would look with all the above mentioned properties:\n\n![HtmlToSvg.svg](https://img.enkipro.com/5cd4ebde7bebedb1168c64d4f3d8ee61.png)\n\n\n---\n\n## Practice\n\nApply a cellpadding of 15px to a table:\n\n```css\n??? {\n   ??? : 15px;\n}\n```\n\n- `td`\n- `padding`\n- `table`\n- `cell-padding`\n- `tr`\n\n\n---\n\n## Revision\n\nWhat does the following CSS code snippet do?\n\n```css\ntable {\n   padding: 8px;\n   border-spacing: 6px;\n   border-collapse: separate;\n}\n```\n\n???\n\n- Controls the cellpadding and cellspacing of the table.\n- Alters the table.\n- Adds a border to the table without padding.\n- Adds a border to the table with padding.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning-tips/clearfix-for-layouts":{"title":"","content":"\n# Clearfix for layouts\n\n\n---\n\n## Content\n\nUse `clearfix` to make an element automatically clear its child elements, so there would be no need for additional markup :\n\n```css\n.clearfix:after {\n  content: \"\";\n  clear: both;\n}\n```\n\nThis hack is useful in cases like where `float` is used to arrange elements one after the other. Because of how `floats` work (they make other elements wrap around them), their container won't resize to surround them.\n\nHere is an example, where the left child has `float:left` property, and the right one, `float:right`:\n\n![newclearfix.svg](https://img.enkipro.com/f547238149eddde20aafdd25e528d22f.png)\n\nAll you have to do is add `clearfix` class to the container and the floating element:\n\n```html\n\u003cdiv class=\"clearfix\"\u003e\n   \u003cdiv style=\"float: left;\"\n   class=\"clearfix\"\u003eSidebar\u003c/div\u003e\n\u003c/div\u003e\n```\n\nThe hack forces the content after the floats to render below them (`clear` property specifies on which side of the element floating elements are not allowed).\n\nNow, the parent will resize itself to surround the floating children.\n\n\n---\n\n## Practice\n\nWhat does `clear` property do?\n\n???\n\n- It doesn’t allow float elements on specified sides.\n- It doesn’t allow any type of elements on specified sides.\n- It allows float elements on specified sides.\n\n\n---\n\n## Revision\n\nWhat does the following CSS code do, when you have a floated image inside an element smaller than said image?\n\n```css\n.clearfix {\n   overflow: auto;\n}\n```\n\n???\n\n- Alters the elements size so it contains the image.\n- Alters the images size so it fits inside the element.\n- Hides the element.\n- Hides the image.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning-tips/direction-column-reverse":{"title":"","content":"\n# Direction : column-reverse\n\n\n---\n\n## Content\n\nIn Flexbox, `column-reverse` enables users to arrange elements vertically in reverse order.\n\n```html\n\u003cdiv class=\"parent\"\u003e\n  \u003cdiv class=\"child-1\"\u003eChild 1\u003c/div\u003e\n  \u003cdiv class=\"child-2\"\u003eChild 2\u003c/div\u003e\n  \u003cdiv class=\"child-3\"\u003eChild 3\u003c/div\u003e\n  \u003cdiv class=\"child-4\"\u003eChild 4\u003c/div\u003e\n\u003c/div\u003e\n\n```\n\n---\n\n```css\n.parent{\n  width:100%;\n  display:flex;\n  flex-direction:column-reverse;\n}\n\n```\n\nThe four child boxes inside class parent will be displayed **vertically** on top of one another in reverse order, starting from the bottom of the parent element:\n\n![566ed55387abab0c00bccab0.svg](https://img.enkipro.com/c9bd35fa50bf1db13c2a2b28764e8e7a.png)\n\n\n---\n\n## Practice\n\nWhich of the following elements will be displayed first?\n\n```html\n\u003cdiv class=\"foobar\"\u003e\n  \u003cp\u003eChild 1\u003c/p\u003e\n  \u003cp\u003eChild 2\u003c/p\u003e\n\u003c/div\u003e\n```\n\n```css\n.foobar {\n  display: flex;\n  flex-direction: column-reverse;\n}\n```\n\n```plain-text\nChild ???\n```\n\n- 2\n- 1\n\n\n---\n\n## Revision\n\nWhen using Flexbox, how does `column-reverse` allow users to arrange elements?\n\n ???\n\n- Vertically in reverse order.\n- Vertically in normal order.\n- Horizontally in reverse order.\n- Horizontally in normal order.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning-tips/equal-width-table-cells":{"title":"","content":"\n# Equal width table cells\n\n\n---\n\n## Content\n\nUse `table-layout: fixed` to keep a table's cells at equal width:\n\n```css\n#second-table {\n  table-layout: fixed;\n}\n```\n\nThis is how the table would look without the property:\n\n![NOtablelayout.svg](https://img.enkipro.com/f59b772c26e3a1435b15c9bbb88f2c19.png)\n\nAnd with it:\n\n![WITHtablelayout.svg](https://img.enkipro.com/5edbddd3060680b17da3cd3a20f2d25f.png)\n\n\n---\n\n## Revision\n\nWhat does the following CSS property do? ???\n\n```css\ntable-layout: fixed;\n```\n\n- Maintains table cells at an equal width.\n- Stops the table size from being altered.\n- Stops the table layout from being altered.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning/block-elements-characteristics":{"title":"","content":"\n# Block Elements Characteristics\n\n\n---\n\n## Content\n\nA block element has the following characteristics:\n\n- It always begins on a new line\n- Its `height`, `line-height`, `top-margin` and `bottom-margin` can be specified\n- Its width defaults to 100% of its containing element, unless otherwise specified\n\nExamples of block elements include `\u003cdiv\u003e`, `\u003cp\u003e`, `\u003ch1\u003e`, `\u003cform\u003e`, `\u003cul\u003e` and `\u003cli\u003e`.\n\nMost of the newer tags, such as `\u003carticle\u003e`, `\u003caside\u003e`, `\u003cmain\u003e` etc. are also displayed as `block` by default.\n\n\n---\n\n## Practice\n\nWhich of the following element is * not * a block element?\n\n???\n\n- `\u003cspan\u003e`\n- `\u003cform\u003e`\n- `\u003cul\u003e`\n- `\u003carticle\u003e`\n\n\n---\n\n## Revision\n\nWhich of the following is not a block element?\n\n???\n\n- `\u003cimg\u003e`\n- `\u003cdiv\u003e`\n- `\u003ch1\u003e`\n- `\u003cform\u003e`\n- `\u003cli\u003e`\n- `\u003cp\u003e`\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning/floating-elements":{"title":"","content":"\n# Floating Elements\n\n\n---\n\n## Content\n\nAnother way to position elements on page is with `floats`. This property allows elements to be positioned to the left or right side of the parent element. All other elements will flow around the floated element.\n\nOne use-case is floating an image to the side of a block of text, as the text will surround the image:\n\n```css\n#imageleft{\n  float: left;\n  width: 150px;\n  height: 150px;\n}\n#imageright{\n  float: right;\n  width: 150px;\n  height: 150px;\np{\n  font-size: 30px;\n  font-color: #ffffff;\n}\n```\n\n![min.svg](https://img.enkipro.com/1deb6d42e45d2bd90fc68736575f71c0.png)\n\nIt can also be used to align elements to the side of the last one:\n\n```css\n.elem{\n  width: 120px;\n  height: 100px;\n  margin: 15px;\n}\n.leftelem{\n  float: left;\n}\n.rightelem{\n  float: right;\n}\n\n```\n\nAnd the HTML:\n\n```html\n\u003cdiv class=\"elem leftelem\"\u003eLeft\u003c/div\u003e\n\u003cdiv class=\"elem leftelem\"\u003eLeft\u003c/div\u003e\n\u003cdiv class=\"elem leftelem\"\u003eLeft\u003c/div\u003e\n\u003cdiv class=\"elem rightelem\"\n  id=\"first-right-elem\"\u003eRight\u003c/div\u003e\n\u003cdiv class=\"elem rightelem\"\u003eRight\u003c/div\u003e\n\u003cdiv class=\"elem rightelem\"\u003eRight\u003c/div\u003e\n```\n\n![woclearmin.svg](https://img.enkipro.com/4755d5867013fb92808d58f7f83b80dc.png)\n\nHowever, this might not be the layout we were looking to achieve. As there is space left for 2 more rectangle on the first line, `float:right` will position them in the empty space.\n\nTo push all right floating elements on the next line, we have to use a property called `clear`. This property doesn't allow any `float` elements to the side specified by its value. The three most used values are: `left`, `right` and `both`.\n\nBecause we want the first right element to start on a new line, we have to `clear` floating elements to the left of it:\n\n```css\n#first-right-elem{\n  clear:left;\n}\n```\n\nAnd the result will be:\n\n![clearmin.svg](https://img.enkipro.com/b84c371f37e5eb86d96a9cb45e41a52e.png)\n\n\n---\n\n## Revision\n\nText ??? a floated element.\n\n- surrounds\n- pushes\n- overlaps\n- underlaps\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning/inline-block-elements-characteristics":{"title":"","content":"\n# Inline-block Elements Characteristics\n\n\n---\n\n## Content\n\nThere aren't any *inline-block* elements per se: they are *inline* elements that accept some *block-specific* properties.\n\nWith that being said, the `inline-block` behavior has the following characteristics:\n\n- It can fit on the same line as other `inline` or `inline-block` elements (inline)\n- Its `height`, `line-height`, `top-margin` and `bottom-margin` can be specified (block)\n- Its width defaults to 100% of its containing element, but it can be changed. (block)\n\nThe only elements which inherently *behave* like this are *replaced elements*, such as `img`, `video` or *form elements*, like `input` and `textarea`.\n\nWhat's so special about replaced elements is that they have internal sizes (think of an 1024×768 image) and can be rendered without manually specifying their `width` or `height`.\n\nIn short, `inline-block` is trying to replicate the behavior of replaced elements and make it available to others.\n\n\n---\n\n## Revision\n\nWhose behavior is `display:inline-block` trying to replicate?\n\n???\n\n- Replaced elements'\n- Inline elements'\n- Block elements'\n- Newer elements'\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning/inline-elements-characteristics":{"title":"","content":"\n# Inline Elements Characteristics\n\n\n---\n\n## Content\n\nAn inline element has the following characteristics:\n\n- It begins on the same line as its siblings\n- Its `height`, `line-height`, `top-margin` and `bottom-margin` can't be changed\n- Its width is as wide as the content and can't be modified\n\nExamples of inline elements include `\u003cspan\u003e`, `\u003ca\u003e`, `\u003clabel\u003e`, `\u003cinput\u003e`, `\u003cimg\u003e`, `\u003cstrong\u003e` and `\u003cem\u003e`.\n\nExample of useless CSS:\n\n```css\nspan {\n  height: 20px; /* no effect! */\n  top: 20px; /* no effect! */\n}\n\n```\n\n\n---\n\n## Practice\n\nWhich of the following elements is * not * an inline element?\n\n???\n\n- `\u003cform\u003e`\n- `\u003clabel\u003e`\n- `\u003cstrong\u003e`\n- `\u003cinput\u003e`\n\n\n---\n\n## Revision\n\nWhich of the following elements is not inline?\n\n???\n\n- `\u003cp\u003e`\n- `\u003cem\u003e`\n- `\u003cspan\u003e`\n- `\u003cinput\u003e`\n- `\u003cimg\u003e`\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/positioning/positioning-elements":{"title":"","content":"\n# Positioning Elements\n\n\n---\n\n## Content\n\nNow that you can tell how much space an element takes when rendered based on its properties, the next step is to position it in the page layout. Three *basic* ways to position elements are: *relative positioning*, *absolute positioning* and *floating* them.\n\nBy default every element has a `position` value of `static`, which places it in the normal flow of the page. However, the static element *does not* accept any box offset properties: `top`, `bottom`, `left`, `right`. To take advantage of the offsets, one must overwrite the `static` value with either `relative` or `absolute`.\n\n### Relative positioning\n\nThe `relative` value of the `position` property places elements in the normal flow of the page, while allowing access to the box offsets:\n\n```css\ndiv{\n  width:200px;\n  height: 100px;\n}\n#relpos{\n  position: relative;\n  left: 15px;\n  top:15px;\n}\n```\n\nAnd the HTML:\n\n```html\n\u003cdiv\u003e Static\u003c/div\u003e\n\u003cdiv id=\"relpos\"\u003eRelative\u003c/div\u003e\n\u003cdiv\u003e Static\u003c/div\u003e\n```\n\n![min.svg](https://img.enkipro.com/02de8ce36c2166210b9b6891b3f05195.png)\n\nThe difference between `margin` and `padding` and *offsets* is that instead of pushing the surrounding elements, *box offsets* will make them overlap.\n\n### Absolute positioning\n\nOn the other hand, the `absolute` value of `position` will make the element appear outside of the normal flow of the page.\n\nAdditionally, *box offsets* move them in relation to the first `non-static` positioned parent. In case such a parent does not exist, the element will use the `\u003cbody\u003e` as reference.\n\n```css\n#container{\n  background-color:white;\n  position:relative;\n#relpos{\n  position: absolute;\n  left: 20px;\n  top:20px;\n}\n```\n\n![absmin.svg](https://img.enkipro.com/9cb21bc6ef841c54284d317b70f5d367.png)\n\nThe third basic way of position elements, *floating*, will be covered in the next insight.\n\n\n---\n\n## Practice\n\nAn element with `position: absolute` is positioned in relation to ???.\n\n- its first non-static ancestor.\n- its first relative positioned ancestor.\n- its first absolute positioned ancestor.\n- its parent.\n\n\n---\n\n## Revision\n\nFor which value of `position` you cannot use box offsets?\n\n???\n\n- Static\n- Relative\n- Absolute\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/Introduction":{"title":"","content":"# Required and optional pseudo classes\n\n\n---\n\n## Content\n\nEspecially when creating a form, some fields in it are mandatory for user to complete.\n\nAll modern browsers support the `:required` and `:optional` pseudo classes:\n\n```css\n:required {\n  border: 2px solid red;\n}\n\n:optional {\n  border: 2px solid blue;\n}\n\n```\n\nAn example of a form they can be applied on:\n\n```html\n\u003cform\u003e\n  \u003clabel\u003eName:\u003c/label\u003e\n  \u003cinput type=\"text\"/\u003e\n  \u003cbr /\u003e\n  \u003clabel\u003eUsername:\u003c/label\u003e\n  \u003cinput type=\"text\" required/\u003e\n  \u003cbr/\u003e\n  \u003cinput type=\"submit\"\n              value=\"Submit\"\u003e\n\u003c/form\u003e\n```\n\n`:required` and :`optional` can be chained together with other pseudo class selectors:\n\n```css\ninput:required:focus {\n  border: 1px solid pink;\n  outline: none;\n}\n\n```\n\n*Note*: Any element that doesn't have the `required` attribute is considered `optional`.\n\n\n---\n\n## Revision\n\nWhat does the following CSS code do? ???\n\n```css\n:required {\n   border: 2px solid black;\n}\n:optional {\n   border: 2px dotted blue;\n}\n```\n\n- Sets the border of compulsory fields solid and black. Sets the border of optional fields dotted and blue.\n- Sets the border of compulsory fields dotted and blue. Sets the border of optional fields solid and black.\n- Returns an error.\n- Makes the border of all fields solid and black.\n- Makes the border of all fields dotted and blue.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/README":{"title":"","content":"name: Pseudo Elements\ndescription: Special types of elements.\ninsights:\n  - use-pseudo-elements-to-style-specific-parts-of-an-element\n  - styling-elements-using-before-and-after\n  - drop-caps-with-first-letter\n  - use-attribute-selectors-with-empty-links\n  - change-selected-area-color\naspects:\n  - introduction\n  - workout\n  - deep\n \n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/drag-and-drop":{"title":"","content":"\n# Drag-and-Drop pseudo-class :drop\n\n\n---\n\n## Content\n\nThe `:drop` selector allows styling of the drop zone (the place where the element is supposed to be dropped), during the time when the user is dragging (or carrying) the element to be dropped.\n\n```css\n.spot {\n  background: #ccc;\n}\n\n.spot:drop {\n  background: hotpink;\n}\n\n```\n\nThe above CSS will apply a neutral gray background color to the .spot element when the user is not dragging. But when the user starts dragging to the `.spot` element, the background color will change and stay that way until the item is dropped.\n\n\n---\n\n## Revision\n\nWhat will the following CSS code do whilst dragging and not dragging? ???\n\n```css\n.bg {\n   background-color: white;\n}\n\n.bg:drop {\n   background-color: red;\n}\n```\n\n- Whilst dragging, the background colour is red. Whilst not dragging, the background colour is white.\n- Whilst dragging, the background colour is white. Whilst not dragging, the background colour is red.\n- The background colour is always red.\n- The background colour is always white.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/empty-blank":{"title":"","content":"\n# :empty and :blank\n\n\n---\n\n## Content\n\nWith `:empty` you can select an element based on there being no children in it, whether that be elements, text nodes, or even white space nodes. So with `:empty`, even if the element contains a single space and nothing else, it will not be considered “empty”.\n\nThe `:blank` pseudo-class, however, will select an element as long as it has no text and no other child elements, regardless of white space. So it could contain white space, line breaks, etc., and it would still qualify.\n\nExample:\n\nHTML:\n\n```html\n\u003cp\u003e\u003c/p\u003e\n\u003cp\u003e \u003c/p\u003e\n\n```\n\nCSS:\n\n```css\np:blank {\n  outline: solid 1px red;\n}\n\np:empty {\n  border: solid 1px green;\n}\n\n```\n\nThe `:empty` pseudo-class will select only the first element, because it’s completely empty. But the `:blank` pseudo-class will apply to both, because they are both “blank” with respects to text and elements.\n\n\n---\n\n## Practice\n\nWhich pseudo-class would select the following element?\n\n```html\n\u003cp\u003e \u003c/p\u003e\n```\n\n```css\n???\n```\n\n- `:blank`\n- `:empty`\n- `neither...`\n\n\n---\n\n## Revision\n\nWhich lines of HTML code would a *:blank* pseudo class apply to?\n\n```html\n1 \u003cp\u003ePseudo classes!\u003c/p\u003e\n2 \u003cp\u003e\u003c/p\u003e\n3 \u003cp\u003e:empty and :blank\u003c/p\u003e\n4 \u003cp\u003e \u003c/p\u003e\n5 \u003cp\u003e.\u003c/p\u003e\n```\n\n???\n\n- 2nd and 4th\n- 2nd, 4th, 5th\n- 1st, 3rd, 5th\n- 4th and 5th\n- 2nd and 5th\n- 1st and 3rd\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/highlight":{"title":"","content":"\n# Highlight input forms using :focus pseudo-class\n\n\n---\n\n## Content\n\nResponsiveness can make the forms more user-friendly and easier to read.\n\nThe `:focus` pseudo-class allows us to target the form element that is clicked on. This means we can change how the input is displayed to better inform the user on what to input.  \n\n```css\ninput:focus{\n  background-color: red;\n}\n```\n\nPseudo-classes can be combined with classes, or other selectors, to specify different elements:\n\n```css\n.name:focus{\n  background-color: red;\n}\n\n.surname:focus{\n  background-color: blue;\n}\n```\n\n\n---\n\n## Practice\n\nWhat does the `:focus` pseudo class allow?\n???\n\n- The clicked on form element to be targeted.\n- Input forms to be created.\n- Creates a focus point within a page.\n\n\n---\n\n## Revision\n\nWhat does the following CSS code do?\n\n```css\nname:focus {\n   background-color: red;\n}\ndob:focus {\n   background-color: green;\n}\n```\n\n???\n\n- Sets the background colour of the name input to red, and of the date of birth input to green.\n- Sets the background colour of the name input to red and the rest of the page to green.\n- Sets the background colour of the date of birth input to green and the rest of the page to red.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/hover":{"title":"","content":"\n# The hover Pseudo-Class\n\n\n---\n\n## Content\n\nOne of the most versatile and used pseudo-classes is `:hover`. Whenever an element on a website reacts to the mouse pointer being on top of it, usually it is because of the `:hover` pseudo-class matching.\n\nIn the previous insight, the example was:\n\n```css\na:hover {\n  color: yellow;\n}\n```\n\nUnlike other pseudo-classes that are link-related (e.g. `:visited`) , you can use `:hover` for almost any element. *Buttons* are usually styled using this property to inform the user that by performing a click action, the webpage will respond in some way.\n\nThe drawback of this pseudo-class is that it doesn't work on most mobile devices, as the screen can't recognize a *hovering* state. Depending on the browser, the `:hover` pseudo-class might never match, match only for a very short time after touching the element or even continue lasting the user stopped touching the element.\n\n\n---\n\n## Practice\n\nIs the following statement true?\n\nThe `:hover` pseudo-class can only be applied to `\u003ca\u003e` (link) elements.\n\n???\n\n- False\n- True\n- Partially true, applicable to some browsers\n\n\n---\n\n## Revision\n\nIn which of the following cases, will the `:hover` pseudo-class most likely work as expected?\n\n1. When the browser is running on a touch-screen device.\n2. When it is randomly mixed with other link-specific pseudo-classes.\n3. When it is applied on a button, in a browser running on a PC.\n4. When it is not used.\n\n```plain-text\n???.\n```\n\n- 3\n- 1\n- 2\n- 4\n- None\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/in-out-of-range":{"title":"","content":"\n# The :in-range \u0026 :out-of-range Pseudo-Classes\n\n\n---\n\n## Content\n\nAnother set of pseudo-classes that can be applied only to elements that have (and can take) a range limitation, such as `\u003cinput\u003e`s, are `:in-range` and `:out-of-range`.\n\n`:in-range` and `:out-of-range` match if values contained in the `\u003cinput\u003e` field are inside the range limits (specified by the `min` and `max` attributes) and outside, respectively. They can be used to provide feedback to the user without the use of `JavaScript`:\n\n```html\n\u003cform\u003e\n  \u003clabel\u003eHow old are you?\u003c/label\u003e\n  \u003cinput type=\"number\" min=\"1\" max=\"120\"\u003e\n\u003c/form\u003e\n```\n\nAnd the CSS:\n\n```css\ninput:in-range {\n  background-color: green;\n}\n\ninput:out-of-range {\n  background-color: red;\n  border: 2px solid red;\n}\n```\n\nWould change the background color of the field depending on the value introduced.\n\n\n---\n\n## Practice\n\nFor either `:in-range` and `:out-of-range` pseudo-classes to match, the element has to have\n\n???\n\n- min, max or both attributes\n- range attribute\n- the type of input\n\n\n---\n\n## Revision\n\nFor either `:in-range` and `:out-of-range` pseudo-classes to match, the element has to have\n\n???\n\n- min, max or both attributes\n- range attribute\n- the type of input\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/matches-pseudo-class":{"title":"","content":"\n# Matches-any pseudo-class :is\n\n\n---\n\n## Content\n\nThe `:is` pseudo-class allows the application of rules to groups of selectors.\n\n```css\np:is(.alert,.error,.warn){\n    color:red;\n}\n```\n\nThe above will make the text of all elements matching `.alert`, `.error` and `.warn` red.\n\nIt could be used to apply a particular style rule to a similar element group.\n\n\u003e 💡 `:is()` used to be called `:matches()` but was renamed. However, older browser versions still support it to provide backwards compatibility.\n\n---\n\n## Practice\n\nComplete the following code snippet to set the color of the chosen selectors text blue:\n\n```css\np???(s1, s2, s3){\n    ???:blue;\n}\n```\n\n- `:is`\n- `color`\n- `:selects`\n- `background-color`\n- `.is`\n- `.selects`\n\n\n---\n\n## Revision\n\nWhat does the following CSS code snippet do?\n\n```css\np:is(s1, s2, s3) {\n   font-family: \"Arial Narrow\";\n   background-color: red;\n}\n```\n\n???\n\n- Sets the font family and background colour for all elements matching s1, s2 and s3.\n- Sets the font family and background colour for all elements not matching s1, s2 and s3.\n- Sets the font family and background colour for all elements.\n- Does nothing.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/not":{"title":"","content":"\n# Use :not() to apply/unapply styles\n\n\n---\n\n## Content\n\nRather than adding a border to a navigation bar, and then removing it for the last element:\n\n```css\n/* add border */\n.nav li {\n  border-right: 2px solid #FFF;\n}\n\n/* last element */\n.nav li:last-child {\n  border-right: none;\n}\n```\n\nUse the `:not()` pseudo-class to only apply to the elements you want:\n\n```css\n.nav li:not(:last-child) {\n  border-right: 2px solid #FFF;\n}\n```\n\n\n---\n\n## Practice\n\nComplete the code snippet:\n\n```css\n.nav li???(:last-child) {\n  border-left: 5px dashed #FFF;\n}\n```\n\n- `:not`\n- `.not`\n- `::not`\n- `not`\n\n\n---\n\n## Revision\n\nWhat does the following CSS code do?\n\n```css\n.div li:not(:last-child) {\n\n}\n```\n\n???\n\n- Allows styles to be applied to all elements except for the final element.\n- Allows styles to be applied specifically to the final element.\n- Allows styles to be applied to every other element.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/nth-child":{"title":"","content":"\n# The nth-child Property\n\n\n---\n\n## Content\n\nThe basic usage of the `nth-child` pseudo-class is to select a single child of the targeted element, like so:\n\n```css\nul:nth-child(3){\n  color: orangered;\n}\n```\n\nOr, to select more children:\n\n```css\nul:nth-child(3), ul:nth-child(5){\n  color: orangered;\n}\n```\n\nWould change the color of the 3rd and 5th children. But this can get very messy when working with big lists.\n\nHowever, `nth-child` accepts *expressions* between the parentheses:\n\n```css\nul:nth-child(3n+2){\n  color: orangered;\n}\n```\n\nThe counter for n starts at *0* and ends when it hits the total number of direct children of the element. For the **3n+2** expression, the values table for 6 children is:\n\n```bash\n3×0+2 = 2nd child\n3×1+2 = 5th child\n3×2+2 = 8th child\n3×3+2 = 11th child\n3×4+2 = 14th child\n3×5+2 = 17th child\n```\n\nAs the list has *6* elements, the expression is relevant only for the 2nd and the 5th. However, it saves a lot of typing.\n\nTo select all the children from the fifth one to the end of the list, the expression is **n+5**.\n\nNegative values of *n* can be used to select children from the bottom up. For example, to select items *1 through 5* and change their color:\n\n```bash\n# -n+5\n-(0) + 5 = 5th\n-(1) + 5 = 4th\n-(2) + 5 = 3rd\n-(3) + 5 = 2nd\n-(4) + 5 = 1st\n-(5) + 5 = 0 (no element)\n```\n\nThis is 6 items list:\n\n```html\n\u003cul\u003e\n  \u003cli\u003eFirst list item\u003c/li\u003e\n  \u003cli\u003eSecond list item\u003c/li\u003e\n  \u003cli\u003eThird list item\u003c/li\u003e\n  \u003cli\u003eFourth list item\u003c/li\u003e\n  \u003cli\u003eFifth list item\u003c/li\u003e\n  \u003cli\u003eSixth list item\u003c/li\u003e\n\u003c/ul\u003e\n```\n\nAnd the CSS:\n\n```css\nli {\n  color: white;\n}\n\nli:nth-child(-n+5) {\n  color: orangered;\n}\n```\n\n![HtmlToSvgmin.svg](https://img.enkipro.com/314f902f9748cf7e54dcf197adb0ca01.png)\n\n\n---\n\n## Revision\n\nWhich items would the following CSS code select? ???\n\n```css\nli:nth-child(-n+7) {\n   display: block;\n}\n```\n\n- Items 1 through 7.\n- Items 0 through 7.\n- Items 1 through 6\n- Items -1 through 7.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-classes/pseudo":{"title":"","content":"\n# Use pseudo-classes to describe a special state of an element\n\n\n---\n\n## Content\n\nUnlike regular classes, pseudo-classes are not specified in the HTML. They are preceded by a colon, for example `a:hover`. This is a dynamic pseudo-class and its effects  are applied in response to  the user's actions.\n\nThe order of the declaration of dynamic pseudo-classes is important in order for it to be effective.\n\nThe following is a common order used for links (`\u003ca\u003e` elements):\n\n```css\na:link {  /* unvisited link */\n  color: black;\n}\na:visited {   /* visited link */\n  color: blue;\n}\na:hover { /* user hovers over link */\n  color: yellow;\n}\na:active  { /* selected link */\n  color: red;\n}   \n```\n\nIf defined in a different order (other than *LVHA*), there's a big chance they will override one another.\n\n[Code example](http://codepen.io/mihaiberq/pen/wzGvWq)\n\n\n---\n\n## Practice\n\nWhat symbol must a pseudo-class be preceded by?\n\n```plain-text\n???\n```\n\n- `:`\n- `;`\n- `+`\n- `=`\n- `::`\n\n\n---\n\n## Revision\n\nWhat is the common order of pseudo-classes used for links?\n??? ??? ??? ???\n\n- `ps:link {`\n- `ps:visited {`\n- `ps:hover {`\n- `ps:active {`\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-elements/before-after":{"title":"","content":"\n# Styling elements with ::before \u0026 ::after\n\n\n---\n\n## Content\n\nUse the `::before` selector to add and style content just before the first child of an element.\nSimilarly, use the `::after` selector to add and style content after the last child of the element.\n\nConsider the following HTML code:\n\n```html\n  \u003cp\u003eFirst\u003c/p\u003e\n  \u003cp\u003eSecond\u003c/p\u003e\n  \u003cp\u003eThird\u003c/p\u003e\n```\n\nAnd the following CSS snippet:\n\n```css\n  p::before{\n    content: '#';\n    color: red;\n  }\n\n  p::after{\n    content: '?';\n    color: aqua;\n  }\n```\n\nThis adds a red **#** at the start of every `p` element and a blue **?** at the end of them.\n\n![HtmlToSvgmin.svg](https://img.enkipro.com/04042139dfbb5bbe310b0eba0b903359.png)\n\n`content` is mandatory to display the element but can be empty (`content:\"\";`).\n\nBoth `::before` and `::after` can be used to display shapes, images or even borders.\n\n[codepen.io](http://codepen.io/anon/pen/MKgrXB)\n\n\n---\n\n## Practice\n\nWhich CSS property is mandatory to display `::before` and `::after` pseudo-elements but can be empty?\n\n ???\n\n- `content`\n- `element`\n- `div`\n- `class`\n\n\n---\n\n## Revision\n\nUsing the `::before` and `::after` selectors, what does the following CSS code do?\n\n```css\ndiv::before {\n   content: 'Hello!';\n   color: white;\n}\ndiv::after {\n   content: 'Goodbye!';\n   color: black;\n}\n```\n\n???\n\n- Adds a white Hello! before every div element with a black Goodbye! after.\n- Adds a white Hello! after every div element with a black Goodbye! before.\n- It does nothing, improper CSS.\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-elements/first-letter":{"title":"","content":"\n# Drop caps with ::first-letter\n\n\n---\n\n## Content\n\nUsing the `::first-line` and `::first-letter` pseudo elements that have been  introduced in CSS1, a nice typographic effect like a drop cap can be achieved.\n\n```css\np::first-letter {\n    font-size: 20px;\n}\n```\n\nThis will only work if the  first letter is not preceded by another pseudo-element  such as `::before`.\n\nIf there are multiple targeted elements in a row, each first letter will be affected. In order to avoid this `::first-child` or `::first-of-type` pseudo-elements can be used:\n\n```css\np::first-child::first-letter {\n    font-size: 20px;\n}\n```\n\nThe first line of a text can also be enhanced:\n\n```css\np::first-line {\n  font-size: 15px;\n}\n```\n\nAn usage example of the pseudo-elements:\n\n![HtmlToSvg.svg](https://img.enkipro.com/1c1f257c27f513aac7ff7fa09cbd468a.png)\n\n\n---\n\n## Practice\n\nChange the size of the first letter of a paragraph to `50px` :\n\n```css\np.special ??? {\n  ??? : 50px;\n}\n```\n\n- `::first-letter`\n- `font-size`\n- `::first-child:first-line`\n- `size`\n- `font-height`\n\n\n---\n\n## Revision\n\nThe `::first-letter` pseudo-element won't have the expected result if the targeted element\n\n???.\n\n- `has a ::before pseudo-element set`\n- `has an ::after pseudo-element set`\n- is not a paragraph\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudo-elements/selection":{"title":"","content":"\n# Change selected area color\n\n\n---\n\n## Content\n\nHighlighted text area colors can be easily change with the `::selection` pseudo element.\n\nApply `::selection` on a paragraph:\n\n```css\np::selection {\n  background: black;\n  color: white;\n}\n```\n\nGecko is the only engine requiring the prefix, so adding an other rule is required to support all browsers :\n\n```css\np::-moz-selection {\n  background: black;\n  color: white;\n}\n```\n\n\n---\n\n## Practice\n\nWhat rule must be added in order for the selection pseudo-element to be supported on all browsers?\n\n???\n\n- `::-moz-selection`\n- `::-support-selection`\n- `::-sup-selection`\n- `::-gecko-selection`\n\n\n---\n\n## Revision\n\nWhich pseudo element is used to select a text area, for example if you wanted to change its background colour? ???\n\n- `::selection`\n- `:selection`\n- `::select`\n- `:select`\n- `::selector`\n- `:selector`\n","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null},"/WebNet/styling/pseudoClass":{"title":"","content":"\n\n[Introduction](Web\u0026Net/styling/pseudo-classes/Introduction.md)\n\n[drag-and-drop](Web\u0026Net/styling/pseudo-classes/drag-and-drop.md)\n\n[empty-blank](Web\u0026Net/styling/pseudo-classes/empty-blank.md)\n\n[highlight](Web\u0026Net/styling/pseudo-classes/highlight.md)\n\n[hover](Web\u0026Net/styling/pseudo-classes/hover.md)\n\n[in-out-of-range](Web\u0026Net/styling/pseudo-classes/in-out-of-range.md)\n\n[matches-pseudo-class](Web\u0026Net/styling/pseudo-classes/matches-pseudo-class.md)\n\n[not](Web\u0026Net/styling/pseudo-classes/not.md)\n\n[nth-child](Web\u0026Net/styling/pseudo-classes/nth-child.md)\n\n[pseudo](Web\u0026Net/styling/pseudo-classes/pseudo.md)\n\n\n[before-after](Web\u0026Net/styling/pseudo-elements/before-after.md)\n\n[first-letter](Web\u0026Net/styling/pseudo-elements/first-letter.md)\n\n[selection](Web\u0026Net/styling/pseudo-elements/selection.md)","lastmodified":"2022-08-03T10:31:04.497738401Z","tags":null}}